{"episode_reward_mean": 439.1919186724029, "timesteps_total": 64191, "iterations_since_restore": 1, "timesteps_since_restore": 64191, "num_metric_batches_dropped": 0, "episode_reward_max": 623.9666782830367, "custom_metrics": {"outflow_rate_min": 216.2893024044423, "system_level_velocity_min": 6.578103263169653, "cost1_max": 256.6755158305824, "system_level_velocity_max": 9.923285876344899, "cost2_min": -81.36158790373779, "outflow_rate_max": 540.6868709878654, "system_level_velocity_mean": 7.8821203679860625, "cost1_mean": 203.7686339903165, "cost2_mean": -56.91627212548986, "outflow_rate_mean": 352.5386564710288, "cost2_max": -39.40510234186405, "cost1_min": 169.5577345923314}, "policy_reward_mean": {}, "timesteps_this_iter": 64191, "training_iteration": 1, "node_ip": "10.138.0.2", "episode_reward_min": 286.8801540079313, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 47.65212869644165, "info": {"num_steps_trained": 64191, "sample_time_ms": 29538.586, "load_time_ms": 71.185, "grad_time_ms": 17307.92, "update_time_ms": 582.062, "default": {"policy_loss": -0.0019303718581795692, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8792949914932251, "total_loss": 1.623018503189087, "cur_kl_coeff": 0.20000001788139343, "vf_loss": 1.6242116689682007, "kl": 0.0036861139815300703, "entropy": 1.4097058773040771}, "num_steps_sampled": 64191}, "episodes_total": 27, "done": false, "date": "2019-05-21_07-03-46", "time_total_s": 47.65212869644165, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c05d5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c05d860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c05d160>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 47.65212869644165, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558422226}
{"episode_reward_mean": 410.01050428813966, "timesteps_total": 127907, "iterations_since_restore": 2, "timesteps_since_restore": 127907, "num_metric_batches_dropped": 0, "episode_reward_max": 623.9666782830367, "custom_metrics": {"outflow_rate_min": 208.00131147540986, "system_level_velocity_min": 5.437324663790588, "cost1_max": 256.6755158305824, "system_level_velocity_max": 9.923285876344899, "cost2_min": -81.36158790373779, "outflow_rate_max": 540.6868709878654, "system_level_velocity_mean": 7.713245325910078, "cost1_mean": 198.83670543854643, "cost2_mean": -54.41100944591622, "outflow_rate_mean": 319.55642932623863, "cost2_max": -29.995554632387247, "cost1_min": 142.0936687881449}, "policy_reward_mean": {}, "timesteps_this_iter": 63716, "training_iteration": 2, "node_ip": "10.138.0.2", "episode_reward_min": 269.9250194721419, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 93.86605834960938, "info": {"num_steps_trained": 127907, "sample_time_ms": 29051.515, "load_time_ms": 38.948, "grad_time_ms": 17413.516, "update_time_ms": 295.237, "default": {"policy_loss": -0.0032207577023655176, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9362121820449829, "total_loss": 1.594510793685913, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 1.5968974828720093, "kl": 0.008341043256223202, "entropy": 1.402811884880066}, "num_steps_sampled": 127907}, "episodes_total": 54, "done": false, "date": "2019-05-21_07-04-32", "time_total_s": 93.86605834960938, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfffef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfff5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfff278>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 46.213929653167725, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558422272}
{"episode_reward_mean": 469.3768400495972, "timesteps_total": 190448, "iterations_since_restore": 3, "timesteps_since_restore": 190448, "num_metric_batches_dropped": 0, "episode_reward_max": 742.8466325300793, "custom_metrics": {"outflow_rate_min": 208.00131147540986, "system_level_velocity_min": 5.437324663790588, "cost1_max": 268.58879617582477, "system_level_velocity_max": 10.16155567599206, "cost2_min": -94.9637064356353, "outflow_rate_max": 827.0342208970704, "system_level_velocity_mean": 7.9298280299890544, "cost1_mean": 205.25667641613526, "cost2_mean": -57.000321094860716, "outflow_rate_mean": 381.1949192579614, "cost2_max": -29.995554632387247, "cost1_min": 142.0936687881449}, "policy_reward_mean": {}, "timesteps_this_iter": 62541, "training_iteration": 3, "node_ip": "10.138.0.2", "episode_reward_min": 269.9250194721419, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 140.89754796028137, "info": {"num_steps_trained": 190448, "sample_time_ms": 29328.282, "load_time_ms": 29.382, "grad_time_ms": 17286.04, "update_time_ms": 200.098, "default": {"policy_loss": -0.006120899226516485, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9307601451873779, "total_loss": 3.464991807937622, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 3.4698710441589355, "kl": 0.012414520606398582, "entropy": 1.364130973815918}, "num_steps_sampled": 190448}, "episodes_total": 81, "done": false, "date": "2019-05-21_07-05-19", "time_total_s": 140.89754796028137, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000358>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 47.031489610672, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558422319}
{"episode_reward_mean": 577.4133948278468, "timesteps_total": 252389, "iterations_since_restore": 4, "timesteps_since_restore": 252389, "num_metric_batches_dropped": 0, "episode_reward_max": 1098.6054192947238, "custom_metrics": {"outflow_rate_min": 208.00131147540986, "system_level_velocity_min": 5.437324663790588, "cost1_max": 314.5968346945609, "system_level_velocity_max": 18.395928584850704, "cost2_min": -129.63367303982358, "outflow_rate_max": 1064.5120257381207, "system_level_velocity_mean": 8.723475366711291, "cost1_mean": 222.85427652101015, "cost2_mean": -65.02091764101189, "outflow_rate_mean": 515.2337176858471, "cost2_max": -22.006105398910485, "cost1_min": 22.923787205826866}, "policy_reward_mean": {}, "timesteps_this_iter": 61941, "training_iteration": 4, "node_ip": "10.138.0.2", "episode_reward_min": 53.568809707122156, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 186.99052834510803, "info": {"num_steps_trained": 252389, "sample_time_ms": 29601.64, "load_time_ms": 24.837, "grad_time_ms": 16849.01, "update_time_ms": 151.898, "default": {"policy_loss": -0.0051742070354521275, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8687341809272766, "total_loss": 8.142261505126953, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 8.146414756774902, "kl": 0.010210453532636166, "entropy": 1.3291313648223877}, "num_steps_sampled": 252389}, "episodes_total": 109, "done": false, "date": "2019-05-21_07-06-05", "time_total_s": 186.99052834510803, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0187b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0185c0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 46.09298038482666, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558422365}
{"episode_reward_mean": 742.4361754896938, "timesteps_total": 316807, "iterations_since_restore": 5, "timesteps_since_restore": 316807, "num_metric_batches_dropped": 0, "episode_reward_max": 1192.5767996230554, "custom_metrics": {"outflow_rate_min": 208.00131147540986, "system_level_velocity_min": 6.272962527430548, "cost1_max": 331.5497752031795, "system_level_velocity_max": 18.395928584850704, "cost2_min": -150.45981680223935, "outflow_rate_max": 1230.9510780580674, "system_level_velocity_mean": 9.700148953445273, "cost1_mean": 250.63764617515707, "cost2_mean": -80.37051162926691, "outflow_rate_mean": 703.4351611497502, "cost2_max": -22.006105398910485, "cost1_min": 22.923787205826866}, "policy_reward_mean": {}, "timesteps_this_iter": 64418, "training_iteration": 5, "node_ip": "10.138.0.2", "episode_reward_min": 53.568809707122156, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 234.07734513282776, "info": {"num_steps_trained": 316807, "sample_time_ms": 29935.491, "load_time_ms": 21.426, "grad_time_ms": 16613.357, "update_time_ms": 122.866, "default": {"policy_loss": -0.003180739236995578, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.860657811164856, "total_loss": 9.472463607788086, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 9.474930763244629, "kl": 0.007148867938667536, "entropy": 1.32258939743042}, "num_steps_sampled": 316807}, "episodes_total": 136, "done": false, "date": "2019-05-21_07-06-53", "time_total_s": 234.07734513282776, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfffb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfff5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfff860>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 47.08681678771973, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558422413}
{"episode_reward_mean": 917.1994192161885, "timesteps_total": 379745, "iterations_since_restore": 6, "timesteps_since_restore": 379745, "num_metric_batches_dropped": 0, "episode_reward_max": 1226.0207471355982, "custom_metrics": {"outflow_rate_min": 310.5942857142859, "system_level_velocity_min": 7.210445884990462, "cost1_max": 353.8000049906184, "system_level_velocity_max": 18.395928584850704, "cost2_min": -150.45981680223935, "outflow_rate_max": 1265.1814054797665, "system_level_velocity_mean": 10.751080719761083, "cost1_mean": 280.46054853683586, "cost2_mean": -94.90845505056545, "outflow_rate_mean": 907.3401739488988, "cost2_max": -22.006105398910485, "cost1_min": 22.923787205826866}, "policy_reward_mean": {}, "timesteps_this_iter": 62938, "training_iteration": 6, "node_ip": "10.138.0.2", "episode_reward_min": 53.568809707122156, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 283.45281171798706, "info": {"num_steps_trained": 379745, "sample_time_ms": 30314.501, "load_time_ms": 18.855, "grad_time_ms": 16686.553, "update_time_ms": 103.666, "default": {"policy_loss": -0.005205461289733648, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8102389574050903, "total_loss": 12.137422561645508, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 12.141618728637695, "kl": 0.010096973739564419, "entropy": 1.316520094871521}, "num_steps_sampled": 379745}, "episodes_total": 163, "done": false, "date": "2019-05-21_07-07-42", "time_total_s": 283.45281171798706, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018a90>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 49.3754665851593, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558422462}
{"episode_reward_mean": 1050.9775647026506, "timesteps_total": 441496, "iterations_since_restore": 7, "timesteps_since_restore": 441496, "num_metric_batches_dropped": 0, "episode_reward_max": 1278.2916542341375, "custom_metrics": {"outflow_rate_min": 677.7746970889061, "system_level_velocity_min": 8.780741703851946, "cost1_max": 356.3848066264797, "system_level_velocity_max": 13.420332779582168, "cost2_min": -150.45981680223935, "outflow_rate_max": 1343.9416278908614, "system_level_velocity_mean": 11.480917741183445, "cost1_mean": 305.9476818721397, "cost2_mean": -106.32954638938884, "outflow_rate_mean": 1049.3978090829917, "cost2_max": -61.75610177672648, "cost1_min": 233.46358521330308}, "policy_reward_mean": {}, "timesteps_this_iter": 61751, "training_iteration": 7, "node_ip": "10.138.0.2", "episode_reward_min": 651.5810627916409, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 329.6037709712982, "info": {"num_steps_trained": 441496, "sample_time_ms": 30486.922, "load_time_ms": 17.741, "grad_time_ms": 16373.143, "update_time_ms": 89.983, "default": {"policy_loss": -0.0038510416634380817, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7009118795394897, "total_loss": 18.872982025146484, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 18.87596893310547, "kl": 0.00864969752728939, "entropy": 1.3154847621917725}, "num_steps_sampled": 441496}, "episodes_total": 190, "done": false, "date": "2019-05-21_07-08-28", "time_total_s": 329.6037709712982, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfecdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000b38>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 46.15095925331116, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558422508}
{"episode_reward_mean": 1111.666145280577, "timesteps_total": 498857, "iterations_since_restore": 8, "timesteps_since_restore": 498857, "num_metric_batches_dropped": 0, "episode_reward_max": 1278.2916542341375, "custom_metrics": {"outflow_rate_min": 882.092906954589, "system_level_velocity_min": 9.06069625539187, "cost1_max": 368.6216458166205, "system_level_velocity_max": 13.995038184093152, "cost2_min": -142.0420196404075, "outflow_rate_max": 1345.1308113598561, "system_level_velocity_mean": 11.89721781031165, "cost1_mean": 317.610645867637, "cost2_mean": -108.95006502666351, "outflow_rate_mean": 1125.5456059661465, "cost2_max": -66.06202789002344, "cost1_min": 237.0843393214973}, "policy_reward_mean": {}, "timesteps_this_iter": 57361, "training_iteration": 8, "node_ip": "10.138.0.2", "episode_reward_min": 870.6040381229913, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 373.6830265522003, "info": {"num_steps_trained": 498857, "sample_time_ms": 30480.194, "load_time_ms": 16.844, "grad_time_ms": 16017.774, "update_time_ms": 79.587, "default": {"policy_loss": -0.004311108496040106, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6465227007865906, "total_loss": 22.033992767333984, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 22.037227630615234, "kl": 0.01077309064567089, "entropy": 1.3041449785232544}, "num_steps_sampled": 498857}, "episodes_total": 218, "done": false, "date": "2019-05-21_07-09-12", "time_total_s": 373.6830265522003, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016cc0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 44.0792555809021, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558422552}
{"episode_reward_mean": 1149.3879584719857, "timesteps_total": 558996, "iterations_since_restore": 9, "timesteps_since_restore": 558996, "num_metric_batches_dropped": 0, "episode_reward_max": 1278.2916542341375, "custom_metrics": {"outflow_rate_min": 940.6581438817645, "system_level_velocity_min": 9.06069625539187, "cost1_max": 379.07377833961664, "system_level_velocity_max": 14.28457238588814, "cost2_min": -159.01788709438085, "outflow_rate_max": 1345.1308113598561, "system_level_velocity_mean": 12.278219071836464, "cost1_mean": 327.7128158765208, "cost2_mean": -107.81515839531977, "outflow_rate_mean": 1177.4654968464704, "cost2_max": -79.49760456231222, "cost1_min": 237.0843393214973}, "policy_reward_mean": {}, "timesteps_this_iter": 60139, "training_iteration": 9, "node_ip": "10.138.0.2", "episode_reward_min": 976.785919750382, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 419.1242551803589, "info": {"num_steps_trained": 558996, "sample_time_ms": 30645.116, "load_time_ms": 16.26, "grad_time_ms": 15723.193, "update_time_ms": 71.464, "default": {"policy_loss": -0.004385795444250107, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6123444437980652, "total_loss": 25.740800857543945, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 25.744211196899414, "kl": 0.009767269715666771, "entropy": 1.317357063293457}, "num_steps_sampled": 558996}, "episodes_total": 248, "done": false, "date": "2019-05-21_07-09-58", "time_total_s": 419.1242551803589, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0184e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018a90>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 45.44122862815857, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558422598}
{"episode_reward_mean": 1164.308566171293, "timesteps_total": 622513, "iterations_since_restore": 10, "timesteps_since_restore": 622513, "num_metric_batches_dropped": 0, "episode_reward_max": 1278.04967930337, "custom_metrics": {"outflow_rate_min": 960.1758631863186, "system_level_velocity_min": 9.788533437822226, "cost1_max": 379.07377833961664, "system_level_velocity_max": 14.28457238588814, "cost2_min": -159.01788709438085, "outflow_rate_max": 1345.1308113598561, "system_level_velocity_mean": 12.491622264025922, "cost1_mean": 333.53270974416716, "cost2_mean": -112.39812016003245, "outflow_rate_mean": 1196.4499608038882, "cost2_max": -79.49760456231222, "cost1_min": 261.18206761721}, "policy_reward_mean": {}, "timesteps_this_iter": 63517, "training_iteration": 10, "node_ip": "10.138.0.2", "episode_reward_min": 980.1702642279228, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 468.1050510406494, "info": {"num_steps_trained": 622513, "sample_time_ms": 30919.027, "load_time_ms": 15.526, "grad_time_ms": 15699.17, "update_time_ms": 65.194, "default": {"policy_loss": -0.0051594991236925125, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7071195840835571, "total_loss": 21.917835235595703, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 21.922019958496094, "kl": 0.009762030094861984, "entropy": 1.318468451499939}, "num_steps_sampled": 622513}, "episodes_total": 278, "done": false, "date": "2019-05-21_07-10-47", "time_total_s": 468.1050510406494, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00a320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00ac50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00a0f0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 48.98079586029053, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558422647}
{"episode_reward_mean": 1181.3868105060253, "timesteps_total": 684713, "iterations_since_restore": 11, "timesteps_since_restore": 684713, "num_metric_batches_dropped": 0, "episode_reward_max": 1368.9072733699136, "custom_metrics": {"outflow_rate_min": 960.1758631863186, "system_level_velocity_min": 9.788533437822226, "cost1_max": 394.4259797659272, "system_level_velocity_max": 14.663891481855586, "cost2_min": -159.49510933050428, "outflow_rate_max": 1410.6229796315665, "system_level_velocity_mean": 12.623360629246385, "cost1_mean": 337.3334343052522, "cost2_mean": -121.32444840760859, "outflow_rate_mean": 1210.8003396622858, "cost2_max": -85.01147027853435, "cost1_min": 261.18206761721}, "policy_reward_mean": {}, "timesteps_this_iter": 62200, "training_iteration": 11, "node_ip": "10.138.0.2", "episode_reward_min": 980.1702642279228, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 516.7855787277222, "info": {"num_steps_trained": 684713, "sample_time_ms": 31338.952, "load_time_ms": 9.471, "grad_time_ms": 15450.159, "update_time_ms": 7.707, "default": {"policy_loss": -0.004591365344822407, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6632583737373352, "total_loss": 27.75273895263672, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 27.756330490112305, "kl": 0.00997173972427845, "entropy": 1.3136781454086304}, "num_steps_sampled": 684713}, "episodes_total": 313, "done": false, "date": "2019-05-21_07-11-36", "time_total_s": 516.7855787277222, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003a90>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 48.680527687072754, "hostname": "flow-main", "episodes_this_iter": 35, "timestamp": 1558422696}
{"episode_reward_mean": 1193.0740565736253, "timesteps_total": 747404, "iterations_since_restore": 12, "timesteps_since_restore": 747404, "num_metric_batches_dropped": 0, "episode_reward_max": 1383.5610722342656, "custom_metrics": {"outflow_rate_min": 1085.8552233509497, "system_level_velocity_min": 9.86203299932945, "cost1_max": 398.4193512655596, "system_level_velocity_max": 14.833972976539108, "cost2_min": -159.49510933050428, "outflow_rate_max": 1456.1740561341128, "system_level_velocity_mean": 12.676360065892426, "cost1_mean": 339.0612931158868, "cost2_mean": -129.75321259847723, "outflow_rate_mean": 1214.1922860792242, "cost2_max": -98.34553821552942, "cost1_min": 262.04078904031223}, "policy_reward_mean": {}, "timesteps_this_iter": 62691, "training_iteration": 12, "node_ip": "10.138.0.2", "episode_reward_min": 1006.6611824667264, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 563.4384064674377, "info": {"num_steps_trained": 747404, "sample_time_ms": 31687.968, "load_time_ms": 9.518, "grad_time_ms": 15146.861, "update_time_ms": 7.594, "default": {"policy_loss": -0.003922810312360525, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7099238634109497, "total_loss": 26.811580657958984, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 26.814617156982422, "kl": 0.00884555745869875, "entropy": 1.3170876502990723}, "num_steps_sampled": 747404}, "episodes_total": 345, "done": false, "date": "2019-05-21_07-12-22", "time_total_s": 563.4384064674377, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0005c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0002e8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 46.652827739715576, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558422742}
{"episode_reward_mean": 1205.578502953342, "timesteps_total": 808852, "iterations_since_restore": 13, "timesteps_since_restore": 808852, "num_metric_batches_dropped": 0, "episode_reward_max": 1383.5610722342656, "custom_metrics": {"outflow_rate_min": 1091.2031750613367, "system_level_velocity_min": 9.86203299932945, "cost1_max": 398.4193512655596, "system_level_velocity_max": 14.833972976539108, "cost2_min": -159.49510933050428, "outflow_rate_max": 1456.1740561341128, "system_level_velocity_mean": 12.804115111544402, "cost1_mean": 342.4648067503312, "cost2_mean": -131.83215869567417, "outflow_rate_mean": 1228.1128400054865, "cost2_max": -104.89056185021107, "cost1_min": 262.04078904031223}, "policy_reward_mean": {}, "timesteps_this_iter": 61448, "training_iteration": 13, "node_ip": "10.138.0.2", "episode_reward_min": 1006.6611824667264, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 612.4581258296967, "info": {"num_steps_trained": 808852, "sample_time_ms": 31953.206, "load_time_ms": 9.155, "grad_time_ms": 15080.142, "update_time_ms": 7.346, "default": {"policy_loss": -0.006359632592648268, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7407472133636475, "total_loss": 25.240747451782227, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 25.24580955505371, "kl": 0.012977143749594688, "entropy": 1.3097114562988281}, "num_steps_sampled": 808852}, "episodes_total": 372, "done": false, "date": "2019-05-21_07-13-11", "time_total_s": 612.4581258296967, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfff2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfffe48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000048>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 49.01971936225891, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558422791}
{"episode_reward_mean": 1208.3153473838674, "timesteps_total": 870298, "iterations_since_restore": 14, "timesteps_since_restore": 870298, "num_metric_batches_dropped": 0, "episode_reward_max": 1383.5610722342656, "custom_metrics": {"outflow_rate_min": 1091.848153846154, "system_level_velocity_min": 10.693603238377579, "cost1_max": 400.1723122778426, "system_level_velocity_max": 14.963294419258736, "cost2_min": -157.713656510349, "outflow_rate_max": 1456.1740561341128, "system_level_velocity_mean": 12.905652264658638, "cost1_mean": 344.9903187850488, "cost2_mean": -132.17692638644533, "outflow_rate_mean": 1233.565965925346, "cost2_max": -104.89056185021107, "cost1_min": 281.04375231099175}, "policy_reward_mean": {}, "timesteps_this_iter": 61446, "training_iteration": 14, "node_ip": "10.138.0.2", "episode_reward_min": 995.2505896817377, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 661.4656038284302, "info": {"num_steps_trained": 870298, "sample_time_ms": 32118.637, "load_time_ms": 8.363, "grad_time_ms": 15205.421, "update_time_ms": 7.44, "default": {"policy_loss": -0.0066342842765152454, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7552387118339539, "total_loss": 22.5908203125, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 22.596111297607422, "kl": 0.013438209891319275, "entropy": 1.3233622312545776}, "num_steps_sampled": 870298}, "episodes_total": 398, "done": false, "date": "2019-05-21_07-14-00", "time_total_s": 661.4656038284302, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0001d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000160>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 49.00747799873352, "hostname": "flow-main", "episodes_this_iter": 26, "timestamp": 1558422840}
{"episode_reward_mean": 1204.0551708048602, "timesteps_total": 931741, "iterations_since_restore": 15, "timesteps_since_restore": 931741, "num_metric_batches_dropped": 0, "episode_reward_max": 1400.345284346324, "custom_metrics": {"outflow_rate_min": 1047.6286363636364, "system_level_velocity_min": 10.086797009706734, "cost1_max": 400.1723122778426, "system_level_velocity_max": 14.963294419258736, "cost2_min": -160.96784653391228, "outflow_rate_max": 1479.2876688034025, "system_level_velocity_mean": 12.826931541934709, "cost1_mean": 342.68753802761086, "cost2_mean": -133.48523128036854, "outflow_rate_mean": 1228.1803499993453, "cost2_max": -108.16303456901177, "cost1_min": 263.78543868840995}, "policy_reward_mean": {}, "timesteps_this_iter": 61443, "training_iteration": 15, "node_ip": "10.138.0.2", "episode_reward_min": 995.2505896817377, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 708.9325304031372, "info": {"num_steps_trained": 931741, "sample_time_ms": 32175.968, "load_time_ms": 8.074, "grad_time_ms": 15189.156, "update_time_ms": 7.671, "default": {"policy_loss": -0.006388346664607525, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7261297702789307, "total_loss": 27.282461166381836, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 27.287683486938477, "kl": 0.011660242453217506, "entropy": 1.3433449268341064}, "num_steps_sampled": 931741}, "episodes_total": 424, "done": false, "date": "2019-05-21_07-14-48", "time_total_s": 708.9325304031372, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0008d0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 47.46692657470703, "hostname": "flow-main", "episodes_this_iter": 26, "timestamp": 1558422888}
{"episode_reward_mean": 1202.8186708469275, "timesteps_total": 994623, "iterations_since_restore": 16, "timesteps_since_restore": 994623, "num_metric_batches_dropped": 0, "episode_reward_max": 1400.345284346324, "custom_metrics": {"outflow_rate_min": 1047.6286363636364, "system_level_velocity_min": 10.086797009706734, "cost1_max": 405.94940149638296, "system_level_velocity_max": 15.093351918101, "cost2_min": -160.96784653391228, "outflow_rate_max": 1479.2876688034025, "system_level_velocity_mean": 12.818915626728778, "cost1_mean": 342.7244777332891, "cost2_mean": -134.27743450697852, "outflow_rate_mean": 1228.3514572595125, "cost2_max": -110.14214080127314, "cost1_min": 263.78543868840995}, "policy_reward_mean": {}, "timesteps_this_iter": 62882, "training_iteration": 16, "node_ip": "10.138.0.2", "episode_reward_min": 995.2505896817377, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 758.7001578807831, "info": {"num_steps_trained": 994623, "sample_time_ms": 32184.917, "load_time_ms": 8.229, "grad_time_ms": 15217.61, "update_time_ms": 7.61, "default": {"policy_loss": -0.007329978048801422, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7341729998588562, "total_loss": 28.53435516357422, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 28.540420532226562, "kl": 0.012644561007618904, "entropy": 1.3439446687698364}, "num_steps_sampled": 994623}, "episodes_total": 452, "done": false, "date": "2019-05-21_07-15-38", "time_total_s": 758.7001578807831, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0000f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0005f8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 49.767627477645874, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558422938}
{"episode_reward_mean": 1209.1824868497786, "timesteps_total": 1057074, "iterations_since_restore": 17, "timesteps_since_restore": 1057074, "num_metric_batches_dropped": 0, "episode_reward_max": 1400.345284346324, "custom_metrics": {"outflow_rate_min": 1047.6286363636364, "system_level_velocity_min": 10.086797009706734, "cost1_max": 405.94940149638296, "system_level_velocity_max": 15.093351918101, "cost2_min": -160.96784653391228, "outflow_rate_max": 1479.2876688034025, "system_level_velocity_mean": 12.929552344764891, "cost1_mean": 345.9680546173601, "cost2_mean": -134.43613759102277, "outflow_rate_mean": 1238.6966924704438, "cost2_max": -104.21396993078523, "cost1_min": 263.78543868840995}, "policy_reward_mean": {}, "timesteps_this_iter": 62451, "training_iteration": 17, "node_ip": "10.138.0.2", "episode_reward_min": 995.2505896817377, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 804.773006439209, "info": {"num_steps_trained": 1057074, "sample_time_ms": 31963.187, "load_time_ms": 7.741, "grad_time_ms": 15432.692, "update_time_ms": 7.85, "default": {"policy_loss": -0.007761015091091394, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6973000764846802, "total_loss": 32.311580657958984, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 32.3179817199707, "kl": 0.01360792014747858, "entropy": 1.337609887123108}, "num_steps_sampled": 1057074}, "episodes_total": 479, "done": false, "date": "2019-05-21_07-16-24", "time_total_s": 804.773006439209, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018c50>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 46.0728485584259, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558422984}
{"episode_reward_mean": 1224.0320640634736, "timesteps_total": 1119395, "iterations_since_restore": 18, "timesteps_since_restore": 1119395, "num_metric_batches_dropped": 0, "episode_reward_max": 1423.9525572186678, "custom_metrics": {"outflow_rate_min": 1057.8876923076919, "system_level_velocity_min": 10.086797009706734, "cost1_max": 411.60647753970653, "system_level_velocity_max": 15.235806457797167, "cost2_min": -160.96784653391228, "outflow_rate_max": 1489.4236897283533, "system_level_velocity_mean": 13.028025308694314, "cost1_mean": 348.9390803568445, "cost2_mean": -134.8494010895399, "outflow_rate_mean": 1250.5052299787576, "cost2_max": -104.21396993078523, "cost1_min": 263.78543868840995}, "policy_reward_mean": {}, "timesteps_this_iter": 62321, "training_iteration": 18, "node_ip": "10.138.0.2", "episode_reward_min": 1040.5778048322954, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 852.0958507061005, "info": {"num_steps_trained": 1119395, "sample_time_ms": 32074.45, "load_time_ms": 7.335, "grad_time_ms": 15645.928, "update_time_ms": 8.17, "default": {"policy_loss": -0.008016721345484257, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6958772540092468, "total_loss": 33.09175491333008, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 33.09836196899414, "kl": 0.014108394272625446, "entropy": 1.325134515762329}, "num_steps_sampled": 1119395}, "episodes_total": 508, "done": false, "date": "2019-05-21_07-17-11", "time_total_s": 852.0958507061005, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0181d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018e80>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 47.32284426689148, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558423031}
{"episode_reward_mean": 1221.304797310078, "timesteps_total": 1180098, "iterations_since_restore": 19, "timesteps_since_restore": 1180098, "num_metric_batches_dropped": 0, "episode_reward_max": 1423.9525572186678, "custom_metrics": {"outflow_rate_min": 1043.865564296847, "system_level_velocity_min": 10.124376079415676, "cost1_max": 411.60647753970653, "system_level_velocity_max": 15.307343310250788, "cost2_min": -156.9034264759435, "outflow_rate_max": 1501.3793197278908, "system_level_velocity_mean": 13.125445883988778, "cost1_mean": 351.96471795061376, "cost2_mean": -130.4116810694814, "outflow_rate_mean": 1246.6589995512102, "cost2_max": -92.72347649607076, "cost1_min": 267.8225939514256}, "policy_reward_mean": {}, "timesteps_this_iter": 60703, "training_iteration": 19, "node_ip": "10.138.0.2", "episode_reward_min": 1027.367090525205, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 901.7190971374512, "info": {"num_steps_trained": 1180098, "sample_time_ms": 31962.412, "load_time_ms": 6.975, "grad_time_ms": 16172.672, "update_time_ms": 8.292, "default": {"policy_loss": -0.008964098058640957, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6979687809944153, "total_loss": 31.79534149169922, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 31.80267906188965, "kl": 0.01627262681722641, "entropy": 1.3221852779388428}, "num_steps_sampled": 1180098}, "episodes_total": 536, "done": false, "date": "2019-05-21_07-18-01", "time_total_s": 901.7190971374512, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0187f0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 49.62324643135071, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558423081}
{"episode_reward_mean": 1226.1854065964287, "timesteps_total": 1240552, "iterations_since_restore": 20, "timesteps_since_restore": 1240552, "num_metric_batches_dropped": 0, "episode_reward_max": 1423.9525572186678, "custom_metrics": {"outflow_rate_min": 1043.865564296847, "system_level_velocity_min": 9.503983666663034, "cost1_max": 411.60647753970653, "system_level_velocity_max": 15.307343310250788, "cost2_min": -158.28676737115796, "outflow_rate_max": 1501.3793197278908, "system_level_velocity_mean": 13.206412324757448, "cost1_mean": 354.15531087399927, "cost2_mean": -127.11796242996257, "outflow_rate_mean": 1249.2861596306486, "cost2_max": -92.72347649607076, "cost1_min": 253.26935335302971}, "policy_reward_mean": {}, "timesteps_this_iter": 60454, "training_iteration": 20, "node_ip": "10.138.0.2", "episode_reward_min": 1027.367090525205, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 947.4149532318115, "info": {"num_steps_trained": 1240552, "sample_time_ms": 31595.221, "load_time_ms": 6.733, "grad_time_ms": 16208.893, "update_time_ms": 8.179, "default": {"policy_loss": -0.011393928900361061, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7144418358802795, "total_loss": 34.40324020385742, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 34.41263198852539, "kl": 0.020053895190358162, "entropy": 1.3200968503952026}, "num_steps_sampled": 1240552}, "episodes_total": 566, "done": false, "date": "2019-05-21_07-18-47", "time_total_s": 947.4149532318115, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0002b0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 45.69585609436035, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558423127}
{"episode_reward_mean": 1219.8288946475036, "timesteps_total": 1301859, "iterations_since_restore": 21, "timesteps_since_restore": 1301859, "num_metric_batches_dropped": 0, "episode_reward_max": 1399.3073318376883, "custom_metrics": {"outflow_rate_min": 1027.2922472501239, "system_level_velocity_min": 9.503983666663034, "cost1_max": 427.3144416591117, "system_level_velocity_max": 15.972625100397265, "cost2_min": -158.28676737115796, "outflow_rate_max": 1501.3793197278908, "system_level_velocity_mean": 13.212415803357349, "cost1_mean": 354.20690646232055, "cost2_mean": -127.55042776727862, "outflow_rate_mean": 1233.3620813284972, "cost2_max": -92.72347649607076, "cost1_min": 253.26935335302971}, "policy_reward_mean": {}, "timesteps_this_iter": 61307, "training_iteration": 21, "node_ip": "10.138.0.2", "episode_reward_min": 1001.6952607961059, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 994.1766896247864, "info": {"num_steps_trained": 1301859, "sample_time_ms": 31470.849, "load_time_ms": 6.649, "grad_time_ms": 16142.397, "update_time_ms": 8.237, "default": {"policy_loss": -0.007754748221486807, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.741441011428833, "total_loss": 32.70772933959961, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 32.71357727050781, "kl": 0.012720647267997265, "entropy": 1.319166660308838}, "num_steps_sampled": 1301859}, "episodes_total": 597, "done": false, "date": "2019-05-21_07-19-33", "time_total_s": 994.1766896247864, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0009b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000198>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 46.76173639297485, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558423173}
{"episode_reward_mean": 1221.7814027501474, "timesteps_total": 1361981, "iterations_since_restore": 22, "timesteps_since_restore": 1361981, "num_metric_batches_dropped": 0, "episode_reward_max": 1399.3073318376883, "custom_metrics": {"outflow_rate_min": 1027.2922472501239, "system_level_velocity_min": 9.503983666663034, "cost1_max": 427.3144416591117, "system_level_velocity_max": 15.972625100397265, "cost2_min": -164.8195617057482, "outflow_rate_max": 1501.2780230098278, "system_level_velocity_mean": 13.2617401079628, "cost1_mean": 355.2507761073835, "cost2_mean": -130.3256471028718, "outflow_rate_mean": 1234.6534295332347, "cost2_max": -92.72347649607076, "cost1_min": 253.26935335302971}, "policy_reward_mean": {}, "timesteps_this_iter": 60122, "training_iteration": 22, "node_ip": "10.138.0.2", "episode_reward_min": 1001.6952607961059, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1040.298001050949, "info": {"num_steps_trained": 1361981, "sample_time_ms": 31338.114, "load_time_ms": 6.493, "grad_time_ms": 16221.759, "update_time_ms": 8.174, "default": {"policy_loss": -0.007873058319091797, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7483699917793274, "total_loss": 31.4324893951416, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 31.438392639160156, "kl": 0.01314571499824524, "entropy": 1.3217049837112427}, "num_steps_sampled": 1361981}, "episodes_total": 624, "done": false, "date": "2019-05-21_07-20-20", "time_total_s": 1040.298001050949, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0167f0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 46.12131142616272, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558423220}
{"episode_reward_mean": 1220.435819012321, "timesteps_total": 1422900, "iterations_since_restore": 23, "timesteps_since_restore": 1422900, "num_metric_batches_dropped": 0, "episode_reward_max": 1399.3073318376883, "custom_metrics": {"outflow_rate_min": 1027.2922472501239, "system_level_velocity_min": 9.884465881452694, "cost1_max": 427.3144416591117, "system_level_velocity_max": 15.972625100397265, "cost2_min": -164.8195617057482, "outflow_rate_max": 1501.2780230098278, "system_level_velocity_mean": 13.274675961602872, "cost1_mean": 355.28817147824316, "cost2_mean": -133.98516773341996, "outflow_rate_mean": 1230.6589374006737, "cost2_max": -106.21320042245364, "cost1_min": 261.1599420788081}, "policy_reward_mean": {}, "timesteps_this_iter": 60919, "training_iteration": 23, "node_ip": "10.138.0.2", "episode_reward_min": 1001.6952607961059, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1087.6213920116425, "info": {"num_steps_trained": 1422900, "sample_time_ms": 31336.281, "load_time_ms": 6.623, "grad_time_ms": 16055.303, "update_time_ms": 8.078, "default": {"policy_loss": -0.008151139132678509, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7472856640815735, "total_loss": 33.099491119384766, "cur_kl_coeff": 0.15000000596046448, "vf_loss": 33.10531997680664, "kl": 0.015498879365622997, "entropy": 1.3231180906295776}, "num_steps_sampled": 1422900}, "episodes_total": 654, "done": false, "date": "2019-05-21_07-21-07", "time_total_s": 1087.6213920116425, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000908>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 47.32339096069336, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558423267}
{"episode_reward_mean": 1208.7030976397825, "timesteps_total": 1484826, "iterations_since_restore": 24, "timesteps_since_restore": 1484826, "num_metric_batches_dropped": 0, "episode_reward_max": 1399.3073318376883, "custom_metrics": {"outflow_rate_min": 1029.5161766720191, "system_level_velocity_min": 10.070612317903887, "cost1_max": 427.3144416591117, "system_level_velocity_max": 15.972625100397265, "cost2_min": -164.8195617057482, "outflow_rate_max": 1501.2780230098278, "system_level_velocity_mean": 13.102472907856898, "cost1_mean": 350.21269885926154, "cost2_mean": -137.24605044201428, "outflow_rate_mean": 1218.6369345160695, "cost2_max": -110.72990312364671, "cost1_min": 265.3311994443802}, "policy_reward_mean": {}, "timesteps_this_iter": 61926, "training_iteration": 24, "node_ip": "10.138.0.2", "episode_reward_min": 1001.6952607961059, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1134.6108334064484, "info": {"num_steps_trained": 1484826, "sample_time_ms": 31243.629, "load_time_ms": 7.104, "grad_time_ms": 15947.19, "update_time_ms": 8.029, "default": {"policy_loss": -0.007119098678231239, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7688745260238647, "total_loss": 29.80263328552246, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 29.807781219482422, "kl": 0.013128113001585007, "entropy": 1.325770378112793}, "num_steps_sampled": 1484826}, "episodes_total": 683, "done": false, "date": "2019-05-21_07-21-54", "time_total_s": 1134.6108334064484, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502518>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 46.98944139480591, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558423314}
{"episode_reward_mean": 1187.2159750259154, "timesteps_total": 1545705, "iterations_since_restore": 25, "timesteps_since_restore": 1545705, "num_metric_batches_dropped": 0, "episode_reward_max": 1385.8405269717057, "custom_metrics": {"outflow_rate_min": 466.57782141583624, "system_level_velocity_min": 10.363833673034003, "cost1_max": 430.61935888360443, "system_level_velocity_max": 18.22385058529001, "cost2_min": -164.8195617057482, "outflow_rate_max": 1458.3074859458889, "system_level_velocity_mean": 13.03980369800002, "cost1_mean": 343.6518002664611, "cost2_mean": -136.43600266189688, "outflow_rate_mean": 1200.9258562587725, "cost2_max": -22.79493876889129, "cost1_min": 22.886661840122944}, "policy_reward_mean": {}, "timesteps_this_iter": 60879, "training_iteration": 25, "node_ip": "10.138.0.2", "episode_reward_min": 55.579640216962886, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1183.664771080017, "info": {"num_steps_trained": 1545705, "sample_time_ms": 31265.842, "load_time_ms": 7.532, "grad_time_ms": 16083.599, "update_time_ms": 7.98, "default": {"policy_loss": -0.008376693353056908, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7677199244499207, "total_loss": 31.716384887695312, "cur_kl_coeff": 0.15000000596046448, "vf_loss": 31.72244644165039, "kl": 0.015434899367392063, "entropy": 1.3189300298690796}, "num_steps_sampled": 1545705}, "episodes_total": 711, "done": false, "date": "2019-05-21_07-22-43", "time_total_s": 1183.664771080017, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0037f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003898>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 49.053937673568726, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558423363}
{"episode_reward_mean": 1189.7547742050483, "timesteps_total": 1607830, "iterations_since_restore": 26, "timesteps_since_restore": 1607830, "num_metric_batches_dropped": 0, "episode_reward_max": 1385.8405269717057, "custom_metrics": {"outflow_rate_min": 466.57782141583624, "system_level_velocity_min": 10.447879051438678, "cost1_max": 430.61935888360443, "system_level_velocity_max": 18.22385058529001, "cost2_min": -161.6156918063802, "outflow_rate_max": 1477.8525899645426, "system_level_velocity_mean": 13.185772678807059, "cost1_mean": 347.67541831931936, "cost2_mean": -135.40416479916547, "outflow_rate_mean": 1203.209285352289, "cost2_max": -22.79493876889129, "cost1_min": 22.886661840122944}, "policy_reward_mean": {}, "timesteps_this_iter": 62125, "training_iteration": 26, "node_ip": "10.138.0.2", "episode_reward_min": 55.579640216962886, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1229.0754778385162, "info": {"num_steps_trained": 1607830, "sample_time_ms": 31025.282, "load_time_ms": 7.597, "grad_time_ms": 15886.827, "update_time_ms": 8.062, "default": {"policy_loss": -0.009770581498742104, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8120116591453552, "total_loss": 27.78957748413086, "cur_kl_coeff": 0.15000000596046448, "vf_loss": 27.797142028808594, "kl": 0.01470375619828701, "entropy": 1.3165391683578491}, "num_steps_sampled": 1607830}, "episodes_total": 738, "done": false, "date": "2019-05-21_07-23-29", "time_total_s": 1229.0754778385162, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfff6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfff080>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 45.410706758499146, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558423409}
{"episode_reward_mean": 1193.0056195011343, "timesteps_total": 1669256, "iterations_since_restore": 27, "timesteps_since_restore": 1669256, "num_metric_batches_dropped": 0, "episode_reward_max": 1385.8405269717057, "custom_metrics": {"outflow_rate_min": 466.57782141583624, "system_level_velocity_min": 10.447879051438678, "cost1_max": 430.61935888360443, "system_level_velocity_max": 18.22385058529001, "cost2_min": -162.12767405750512, "outflow_rate_max": 1477.8525899645426, "system_level_velocity_mean": 13.211108603497468, "cost1_mean": 348.2353735216756, "cost2_mean": -135.43132710520047, "outflow_rate_mean": 1208.6228522553533, "cost2_max": -22.79493876889129, "cost1_min": 22.886661840122944}, "policy_reward_mean": {}, "timesteps_this_iter": 61426, "training_iteration": 27, "node_ip": "10.138.0.2", "episode_reward_min": 55.579640216962886, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1274.7795968055725, "info": {"num_steps_trained": 1669256, "sample_time_ms": 31144.552, "load_time_ms": 7.757, "grad_time_ms": 15731.742, "update_time_ms": 7.975, "default": {"policy_loss": -0.008017920888960361, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7522451877593994, "total_loss": 32.124847412109375, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 32.130638122558594, "kl": 0.014828060753643513, "entropy": 1.2989894151687622}, "num_steps_sampled": 1669256}, "episodes_total": 764, "done": false, "date": "2019-05-21_07-24-14", "time_total_s": 1274.7795968055725, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502eb8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 45.704118967056274, "hostname": "flow-main", "episodes_this_iter": 26, "timestamp": 1558423454}
{"episode_reward_mean": 1196.9517855072245, "timesteps_total": 1731782, "iterations_since_restore": 28, "timesteps_since_restore": 1731782, "num_metric_batches_dropped": 0, "episode_reward_max": 1372.9112342116146, "custom_metrics": {"outflow_rate_min": 466.57782141583624, "system_level_velocity_min": 10.447879051438678, "cost1_max": 411.8991591190333, "system_level_velocity_max": 18.22385058529001, "cost2_min": -162.12767405750512, "outflow_rate_max": 1477.8525899645426, "system_level_velocity_mean": 13.256125220394386, "cost1_mean": 349.4389389917646, "cost2_mean": -135.84046398190966, "outflow_rate_mean": 1210.63755144653, "cost2_max": -22.79493876889129, "cost1_min": 22.886661840122944}, "policy_reward_mean": {}, "timesteps_this_iter": 62526, "training_iteration": 28, "node_ip": "10.138.0.2", "episode_reward_min": 55.579640216962886, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1322.4738836288452, "info": {"num_steps_trained": 1731782, "sample_time_ms": 31150.371, "load_time_ms": 7.963, "grad_time_ms": 15762.048, "update_time_ms": 7.739, "default": {"policy_loss": -0.008689538575708866, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7441495060920715, "total_loss": 33.482666015625, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 33.488929748535156, "kl": 0.016161639243364334, "entropy": 1.3087916374206543}, "num_steps_sampled": 1731782}, "episodes_total": 791, "done": false, "date": "2019-05-21_07-25-02", "time_total_s": 1322.4738836288452, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022748>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 47.694286823272705, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558423502}
{"episode_reward_mean": 1214.2390172534895, "timesteps_total": 1794490, "iterations_since_restore": 29, "timesteps_since_restore": 1794490, "num_metric_batches_dropped": 0, "episode_reward_max": 1391.1949317628114, "custom_metrics": {"outflow_rate_min": 1067.295598917212, "system_level_velocity_min": 10.749524334631777, "cost1_max": 426.8007655556712, "system_level_velocity_max": 15.89608875403378, "cost2_min": -162.12767405750512, "outflow_rate_max": 1477.8525899645426, "system_level_velocity_mean": 13.263393202451512, "cost1_mean": 354.1798119264776, "cost2_mean": -137.13782321450498, "outflow_rate_mean": 1223.3845670685319, "cost2_max": -113.98195116019438, "cost1_min": 283.96255835564887}, "policy_reward_mean": {}, "timesteps_this_iter": 62708, "training_iteration": 29, "node_ip": "10.138.0.2", "episode_reward_min": 1058.0351050533156, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1367.8211040496826, "info": {"num_steps_trained": 1794490, "sample_time_ms": 30956.9, "load_time_ms": 7.816, "grad_time_ms": 15529.954, "update_time_ms": 7.73, "default": {"policy_loss": -0.008842500858008862, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7336344122886658, "total_loss": 37.800743103027344, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 37.807010650634766, "kl": 0.017165809869766235, "entropy": 1.3070237636566162}, "num_steps_sampled": 1794490}, "episodes_total": 819, "done": false, "date": "2019-05-21_07-25-47", "time_total_s": 1367.8211040496826, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022a58>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 45.3472204208374, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558423547}
{"episode_reward_mean": 1210.2705278904489, "timesteps_total": 1856907, "iterations_since_restore": 30, "timesteps_since_restore": 1856907, "num_metric_batches_dropped": 0, "episode_reward_max": 1391.1949317628114, "custom_metrics": {"outflow_rate_min": 1034.2421247357297, "system_level_velocity_min": 9.897834761168939, "cost1_max": 426.8007655556712, "system_level_velocity_max": 15.89608875403378, "cost2_min": -162.12767405750512, "outflow_rate_max": 1473.646801387094, "system_level_velocity_mean": 13.169355343684899, "cost1_mean": 351.43156693441443, "cost2_mean": -136.73944084662529, "outflow_rate_mean": 1218.3346742361039, "cost2_max": -107.32761334349885, "cost1_min": 257.38474934724167}, "policy_reward_mean": {}, "timesteps_this_iter": 62417, "training_iteration": 30, "node_ip": "10.138.0.2", "episode_reward_min": 1019.9898513752235, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1416.582851409912, "info": {"num_steps_trained": 1856907, "sample_time_ms": 31149.328, "load_time_ms": 7.843, "grad_time_ms": 15640.811, "update_time_ms": 7.993, "default": {"policy_loss": -0.009136333130300045, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.736685037612915, "total_loss": 37.656612396240234, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 37.66305923461914, "kl": 0.01790887676179409, "entropy": 1.3137321472167969}, "num_steps_sampled": 1856907}, "episodes_total": 847, "done": false, "date": "2019-05-21_07-26-36", "time_total_s": 1416.582851409912, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022c50>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 48.76174736022949, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558423596}
{"episode_reward_mean": 1205.483075328081, "timesteps_total": 1920014, "iterations_since_restore": 31, "timesteps_since_restore": 1920014, "num_metric_batches_dropped": 0, "episode_reward_max": 1426.5511284016873, "custom_metrics": {"outflow_rate_min": 994.9818181818182, "system_level_velocity_min": 9.897834761168939, "cost1_max": 436.15341445344154, "system_level_velocity_max": 16.274438654333757, "cost2_min": -159.74905241010876, "outflow_rate_max": 1534.827750459278, "system_level_velocity_mean": 13.092376724114484, "cost1_mean": 348.9987997627318, "cost2_mean": -135.53088955895583, "outflow_rate_mean": 1214.161630537446, "cost2_max": -107.32761334349885, "cost1_min": 257.38474934724167}, "policy_reward_mean": {}, "timesteps_this_iter": 63107, "training_iteration": 31, "node_ip": "10.138.0.2", "episode_reward_min": 1013.8795810215162, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1464.9103078842163, "info": {"num_steps_trained": 1920014, "sample_time_ms": 31091.751, "load_time_ms": 7.429, "grad_time_ms": 15855.12, "update_time_ms": 8.024, "default": {"policy_loss": -0.008825642056763172, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7640444040298462, "total_loss": 39.04569625854492, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 39.05207824707031, "kl": 0.016315169632434845, "entropy": 1.2971203327178955}, "num_steps_sampled": 1920014}, "episodes_total": 877, "done": false, "date": "2019-05-21_07-27-25", "time_total_s": 1464.9103078842163, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0221d0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 48.3274564743042, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558423645}
{"episode_reward_mean": 1199.2240560165797, "timesteps_total": 1983065, "iterations_since_restore": 32, "timesteps_since_restore": 1983065, "num_metric_batches_dropped": 0, "episode_reward_max": 1426.5511284016873, "custom_metrics": {"outflow_rate_min": 994.9818181818182, "system_level_velocity_min": 9.562472606826654, "cost1_max": 436.15341445344154, "system_level_velocity_max": 16.274438654333757, "cost2_min": -154.36002955102583, "outflow_rate_max": 1534.827750459278, "system_level_velocity_mean": 13.138733814270237, "cost1_mean": 350.0631493498524, "cost2_mean": -133.51031280048775, "outflow_rate_mean": 1206.841171991329, "cost2_max": -107.32761334349885, "cost1_min": 247.24148940475231}, "policy_reward_mean": {}, "timesteps_this_iter": 63051, "training_iteration": 32, "node_ip": "10.138.0.2", "episode_reward_min": 1000.550855564039, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1514.7227199077606, "info": {"num_steps_trained": 1983065, "sample_time_ms": 31224.568, "load_time_ms": 7.417, "grad_time_ms": 16091.033, "update_time_ms": 8.258, "default": {"policy_loss": -0.008304011076688766, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8002352714538574, "total_loss": 35.84038543701172, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 35.846309661865234, "kl": 0.015851542353630066, "entropy": 1.299276351928711}, "num_steps_sampled": 1983065}, "episodes_total": 905, "done": false, "date": "2019-05-21_07-28-14", "time_total_s": 1514.7227199077606, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022b70>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 49.81241202354431, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558423694}
{"episode_reward_mean": 1202.8644380688027, "timesteps_total": 2044380, "iterations_since_restore": 33, "timesteps_since_restore": 2044380, "num_metric_batches_dropped": 0, "episode_reward_max": 1426.5511284016873, "custom_metrics": {"outflow_rate_min": 994.9818181818182, "system_level_velocity_min": 9.562472606826654, "cost1_max": 436.15341445344154, "system_level_velocity_max": 16.274438654333757, "cost2_min": -168.86576316422025, "outflow_rate_max": 1534.827750459278, "system_level_velocity_mean": 13.185979771437346, "cost1_mean": 351.15944753785874, "cost2_mean": -134.6362335891261, "outflow_rate_mean": 1213.6885865156196, "cost2_max": -107.32761334349885, "cost1_min": 247.24148940475231}, "policy_reward_mean": {}, "timesteps_this_iter": 61315, "training_iteration": 33, "node_ip": "10.138.0.2", "episode_reward_min": 1000.550855564039, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1562.750911474228, "info": {"num_steps_trained": 2044380, "sample_time_ms": 31232.351, "load_time_ms": 7.219, "grad_time_ms": 16152.267, "update_time_ms": 8.526, "default": {"policy_loss": -0.009745117276906967, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7765083909034729, "total_loss": 43.00432586669922, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 43.011539459228516, "kl": 0.016886498779058456, "entropy": 1.2963075637817383}, "num_steps_sampled": 2044380}, "episodes_total": 938, "done": false, "date": "2019-05-21_07-29-03", "time_total_s": 1562.750911474228, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0312e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0313c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c031160>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 48.028191566467285, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558423743}
{"episode_reward_mean": 1211.8236649043654, "timesteps_total": 2104809, "iterations_since_restore": 34, "timesteps_since_restore": 2104809, "num_metric_batches_dropped": 0, "episode_reward_max": 1394.0312468888872, "custom_metrics": {"outflow_rate_min": 1018.5878603368323, "system_level_velocity_min": 9.562472606826654, "cost1_max": 433.2478290173897, "system_level_velocity_max": 16.18526524285394, "cost2_min": -168.86576316422025, "outflow_rate_max": 1481.1761466704806, "system_level_velocity_mean": 13.351467933328284, "cost1_mean": 355.6778208858335, "cost2_mean": -134.9856588324037, "outflow_rate_mean": 1224.9169590144736, "cost2_max": -103.2939793046256, "cost1_min": 247.24148940475231}, "policy_reward_mean": {}, "timesteps_this_iter": 60429, "training_iteration": 34, "node_ip": "10.138.0.2", "episode_reward_min": 1000.550855564039, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1608.016143321991, "info": {"num_steps_trained": 2104809, "sample_time_ms": 31128.965, "load_time_ms": 7.211, "grad_time_ms": 16085.099, "update_time_ms": 8.476, "default": {"policy_loss": -0.010339894331991673, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.797392725944519, "total_loss": 42.28861618041992, "cur_kl_coeff": 0.15000000596046448, "vf_loss": 42.29612350463867, "kl": 0.01890057697892189, "entropy": 1.2865158319473267}, "num_steps_sampled": 2104809}, "episodes_total": 968, "done": false, "date": "2019-05-21_07-29-48", "time_total_s": 1608.016143321991, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfffe10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018c88>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 45.26523184776306, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558423788}
{"episode_reward_mean": 1229.5560157033685, "timesteps_total": 2161670, "iterations_since_restore": 35, "timesteps_since_restore": 2161670, "num_metric_batches_dropped": 0, "episode_reward_max": 1389.9192905360226, "custom_metrics": {"outflow_rate_min": 1032.3344939751041, "system_level_velocity_min": 10.248193503145522, "cost1_max": 434.078459699673, "system_level_velocity_max": 16.187430381251627, "cost2_min": -168.86576316422025, "outflow_rate_max": 1476.654224998034, "system_level_velocity_mean": 13.73339685991284, "cost1_mean": 366.36418244171284, "cost2_mean": -130.5296585934461, "outflow_rate_mean": 1251.8554366590513, "cost2_max": -98.1691694324909, "cost1_min": 265.9453140960726}, "policy_reward_mean": {}, "timesteps_this_iter": 56861, "training_iteration": 35, "node_ip": "10.138.0.2", "episode_reward_min": 1003.850536728423, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1650.2126531600952, "info": {"num_steps_trained": 2161670, "sample_time_ms": 30682.142, "load_time_ms": 7.254, "grad_time_ms": 15846.444, "update_time_ms": 8.379, "default": {"policy_loss": -0.010971211828291416, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7868417501449585, "total_loss": 41.82978820800781, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 41.83810043334961, "kl": 0.01768196001648903, "entropy": 1.2685638666152954}, "num_steps_sampled": 2161670}, "episodes_total": 997, "done": false, "date": "2019-05-21_07-30-30", "time_total_s": 1650.2126531600952, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502908>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 42.19650983810425, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558423830}
{"episode_reward_mean": 1228.292370086679, "timesteps_total": 2221362, "iterations_since_restore": 36, "timesteps_since_restore": 2221362, "num_metric_batches_dropped": 0, "episode_reward_max": 1389.9192905360226, "custom_metrics": {"outflow_rate_min": 1032.3344939751041, "system_level_velocity_min": 10.248193503145522, "cost1_max": 434.078459699673, "system_level_velocity_max": 16.187430381251627, "cost2_min": -164.85949780537157, "outflow_rate_max": 1476.654224998034, "system_level_velocity_mean": 13.851864507449315, "cost1_mean": 369.76917287894685, "cost2_mean": -126.88707038131005, "outflow_rate_mean": 1255.697543476458, "cost2_max": -90.50204287223508, "cost1_min": 265.9453140960726}, "policy_reward_mean": {}, "timesteps_this_iter": 59692, "training_iteration": 36, "node_ip": "10.138.0.2", "episode_reward_min": 1003.850536728423, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1693.324134349823, "info": {"num_steps_trained": 2221362, "sample_time_ms": 30441.116, "load_time_ms": 7.025, "grad_time_ms": 15858.23, "update_time_ms": 8.414, "default": {"policy_loss": -0.010657819919288158, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8030126094818115, "total_loss": 38.05738830566406, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 38.065277099609375, "kl": 0.018463127315044403, "entropy": 1.2990891933441162}, "num_steps_sampled": 2221362}, "episodes_total": 1024, "done": false, "date": "2019-05-21_07-31-13", "time_total_s": 1693.324134349823, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e4d99b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d898>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 43.11148118972778, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558423873}
{"episode_reward_mean": 1233.4536590042899, "timesteps_total": 2280433, "iterations_since_restore": 37, "timesteps_since_restore": 2280433, "num_metric_batches_dropped": 0, "episode_reward_max": 1380.3005684735447, "custom_metrics": {"outflow_rate_min": 1076.421392578713, "system_level_velocity_min": 10.899998138121932, "cost1_max": 440.102476987444, "system_level_velocity_max": 16.512867368575503, "cost2_min": -164.85949780537157, "outflow_rate_max": 1470.392843602068, "system_level_velocity_mean": 14.064588976003302, "cost1_mean": 375.77269565135515, "cost2_mean": -122.33167950100625, "outflow_rate_mean": 1269.6387334149865, "cost2_max": -90.50204287223508, "cost1_min": 288.98236078389147}, "policy_reward_mean": {}, "timesteps_this_iter": 59071, "training_iteration": 37, "node_ip": "10.138.0.2", "episode_reward_min": 1030.341773476243, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1737.6180868148804, "info": {"num_steps_trained": 2280433, "sample_time_ms": 30153.004, "load_time_ms": 7.109, "grad_time_ms": 16002.055, "update_time_ms": 8.246, "default": {"policy_loss": -0.009692157618701458, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7718325853347778, "total_loss": 43.794700622558594, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 43.80168533325195, "kl": 0.018091361969709396, "entropy": 1.2665964365005493}, "num_steps_sampled": 2280433}, "episodes_total": 1052, "done": false, "date": "2019-05-21_07-31-58", "time_total_s": 1737.6180868148804, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00df28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d1d0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 44.29395246505737, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558423918}
{"episode_reward_mean": 1229.618177775421, "timesteps_total": 2338751, "iterations_since_restore": 38, "timesteps_since_restore": 2338751, "num_metric_batches_dropped": 0, "episode_reward_max": 1380.3005684735447, "custom_metrics": {"outflow_rate_min": 1076.421392578713, "system_level_velocity_min": 10.899998138121932, "cost1_max": 444.1276310393422, "system_level_velocity_max": 16.634902498750503, "cost2_min": -156.3521770594924, "outflow_rate_max": 1470.392843602068, "system_level_velocity_mean": 14.11886211172943, "cost1_mean": 376.9568717385942, "cost2_mean": -118.9138157510354, "outflow_rate_mean": 1267.375728963374, "cost2_max": -90.50204287223508, "cost1_min": 288.98236078389147}, "policy_reward_mean": {}, "timesteps_this_iter": 58318, "training_iteration": 38, "node_ip": "10.138.0.2", "episode_reward_min": 1030.341773476243, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1782.8279705047607, "info": {"num_steps_trained": 2338751, "sample_time_ms": 29929.769, "load_time_ms": 6.85, "grad_time_ms": 15977.246, "update_time_ms": 8.559, "default": {"policy_loss": -0.01022570114582777, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7463680505752563, "total_loss": 45.35691452026367, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 45.36443328857422, "kl": 0.018048133701086044, "entropy": 1.2920188903808594}, "num_steps_sampled": 2338751}, "episodes_total": 1081, "done": false, "date": "2019-05-21_07-32-43", "time_total_s": 1782.8279705047607, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dd30>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 45.20988368988037, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558423963}
{"episode_reward_mean": 1226.398742089755, "timesteps_total": 2397090, "iterations_since_restore": 39, "timesteps_since_restore": 2397090, "num_metric_batches_dropped": 0, "episode_reward_max": 1380.3005684735447, "custom_metrics": {"outflow_rate_min": 1076.421392578713, "system_level_velocity_min": 10.899998138121932, "cost1_max": 446.1649179366517, "system_level_velocity_max": 16.792932033784663, "cost2_min": -156.3521770594924, "outflow_rate_max": 1468.838473416154, "system_level_velocity_mean": 14.093093200301253, "cost1_mean": 375.8905591720941, "cost2_mean": -119.24093592801336, "outflow_rate_mean": 1266.9423087659059, "cost2_max": -98.22288944743326, "cost1_min": 288.98236078389147}, "policy_reward_mean": {}, "timesteps_this_iter": 58339, "training_iteration": 39, "node_ip": "10.138.0.2", "episode_reward_min": 1030.341773476243, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1829.4718542099, "info": {"num_steps_trained": 2397090, "sample_time_ms": 30030.123, "load_time_ms": 6.728, "grad_time_ms": 16007.11, "update_time_ms": 8.895, "default": {"policy_loss": -0.008771974593400955, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7572115659713745, "total_loss": 43.3685188293457, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 43.3746337890625, "kl": 0.01771204173564911, "entropy": 1.299458622932434}, "num_steps_sampled": 2397090}, "episodes_total": 1108, "done": false, "date": "2019-05-21_07-33-30", "time_total_s": 1829.4718542099, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00def0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d5c0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 46.64388370513916, "hostname": "flow-main", "episodes_this_iter": 27, "timestamp": 1558424010}
{"episode_reward_mean": 1234.0242256626505, "timesteps_total": 2455796, "iterations_since_restore": 40, "timesteps_since_restore": 2455796, "num_metric_batches_dropped": 0, "episode_reward_max": 1380.8434006658033, "custom_metrics": {"outflow_rate_min": 1098.3821656813502, "system_level_velocity_min": 11.066306673128672, "cost1_max": 456.78469346044335, "system_level_velocity_max": 17.220975676208074, "cost2_min": -148.67992660294587, "outflow_rate_max": 1508.6211918076408, "system_level_velocity_mean": 14.339717569469398, "cost1_mean": 381.9321771506829, "cost2_mean": -117.31145948634891, "outflow_rate_mean": 1279.0623349067766, "cost2_max": -93.20922953310236, "cost1_min": 292.52741612994305}, "policy_reward_mean": {}, "timesteps_this_iter": 58706, "training_iteration": 40, "node_ip": "10.138.0.2", "episode_reward_min": 1078.5562747005538, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1874.8997371196747, "info": {"num_steps_trained": 2455796, "sample_time_ms": 29901.924, "load_time_ms": 6.567, "grad_time_ms": 15807.269, "update_time_ms": 8.642, "default": {"policy_loss": -0.007721333298832178, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7405576705932617, "total_loss": 49.62504959106445, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 49.63024139404297, "kl": 0.016877371817827225, "entropy": 1.2738986015319824}, "num_steps_sampled": 2455796}, "episodes_total": 1137, "done": false, "date": "2019-05-21_07-34-15", "time_total_s": 1874.8997371196747, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00ddd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00da90>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 45.42788290977478, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558424055}
{"episode_reward_mean": 1224.8408358820698, "timesteps_total": 2513702, "iterations_since_restore": 41, "timesteps_since_restore": 2513702, "num_metric_batches_dropped": 0, "episode_reward_max": 1380.8434006658033, "custom_metrics": {"outflow_rate_min": 1096.9190228833445, "system_level_velocity_min": 10.962782024063666, "cost1_max": 456.78469346044335, "system_level_velocity_max": 17.220975676208074, "cost2_min": -148.67992660294587, "outflow_rate_max": 1508.6211918076408, "system_level_velocity_mean": 14.221298170964092, "cost1_mean": 378.49546211248907, "cost2_mean": -117.10537149563793, "outflow_rate_mean": 1277.491825985814, "cost2_max": -89.34747048029891, "cost1_min": 287.10700460386016}, "policy_reward_mean": {}, "timesteps_this_iter": 57906, "training_iteration": 41, "node_ip": "10.138.0.2", "episode_reward_min": 1055.3251446736251, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1918.594314813614, "info": {"num_steps_trained": 2513702, "sample_time_ms": 29752.048, "load_time_ms": 6.568, "grad_time_ms": 15494.508, "update_time_ms": 8.668, "default": {"policy_loss": -0.009908538311719894, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7077281475067139, "total_loss": 57.649845123291016, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 57.656864166259766, "kl": 0.019297106191515923, "entropy": 1.289002537727356}, "num_steps_sampled": 2513702}, "episodes_total": 1169, "done": false, "date": "2019-05-21_07-34-59", "time_total_s": 1918.594314813614, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00db70>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 43.69457769393921, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558424099}
{"episode_reward_mean": 1206.8077018373783, "timesteps_total": 2571195, "iterations_since_restore": 42, "timesteps_since_restore": 2571195, "num_metric_batches_dropped": 0, "episode_reward_max": 1380.8434006658033, "custom_metrics": {"outflow_rate_min": 475.6851915157954, "system_level_velocity_min": 10.130844073982997, "cost1_max": 456.78469346044335, "system_level_velocity_max": 18.106998937267157, "cost2_min": -139.22141923814627, "outflow_rate_max": 1508.6211918076408, "system_level_velocity_mean": 14.275722461806089, "cost1_mean": 375.13578508762066, "cost2_mean": -113.84437644634667, "outflow_rate_mean": 1267.585157547436, "cost2_max": -22.65669529262, "cost1_min": 23.98377522714354}, "policy_reward_mean": {}, "timesteps_this_iter": 57493, "training_iteration": 42, "node_ip": "10.138.0.2", "episode_reward_min": 58.12822198250561, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 1962.2278497219086, "info": {"num_steps_trained": 2571195, "sample_time_ms": 29570.602, "load_time_ms": 6.91, "grad_time_ms": 15059.176, "update_time_ms": 8.495, "default": {"policy_loss": -0.009721663780510426, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7277776002883911, "total_loss": 50.033016204833984, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 50.03977584838867, "kl": 0.0197325199842453, "entropy": 1.2884355783462524}, "num_steps_sampled": 2571195}, "episodes_total": 1199, "done": false, "date": "2019-05-21_07-35-42", "time_total_s": 1962.2278497219086, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00da58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016a90>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.37, "time_this_iter_s": 43.63353490829468, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558424142}
{"episode_reward_mean": 1202.4920493538789, "timesteps_total": 2628187, "iterations_since_restore": 43, "timesteps_since_restore": 2628187, "num_metric_batches_dropped": 0, "episode_reward_max": 1356.1459935902376, "custom_metrics": {"outflow_rate_min": 475.6851915157954, "system_level_velocity_min": 10.130844073982997, "cost1_max": 456.78469346044335, "system_level_velocity_max": 18.106998937267157, "cost2_min": -136.3775864005765, "outflow_rate_max": 1465.8142036556405, "system_level_velocity_mean": 14.262433595249906, "cost1_mean": 375.13644566376985, "cost2_mean": -109.15615473446412, "outflow_rate_mean": 1267.1123022613804, "cost2_max": -22.65669529262, "cost1_min": 23.98377522714354}, "policy_reward_mean": {}, "timesteps_this_iter": 56992, "training_iteration": 43, "node_ip": "10.138.0.2", "episode_reward_min": 58.12822198250561, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2006.3830182552338, "info": {"num_steps_trained": 2628187, "sample_time_ms": 29383.005, "load_time_ms": 7.089, "grad_time_ms": 14861.18, "update_time_ms": 8.29, "default": {"policy_loss": -0.008618451654911041, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6799114346504211, "total_loss": 59.0787467956543, "cur_kl_coeff": 0.15000000596046448, "vf_loss": 59.08453369140625, "kl": 0.018858028575778008, "entropy": 1.2865006923675537}, "num_steps_sampled": 2628187}, "episodes_total": 1233, "done": false, "date": "2019-05-21_07-36-27", "time_total_s": 2006.3830182552338, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c046240>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.37, "time_this_iter_s": 44.155168533325195, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558424187}
{"episode_reward_mean": 1210.3661319109676, "timesteps_total": 2683652, "iterations_since_restore": 44, "timesteps_since_restore": 2683652, "num_metric_batches_dropped": 0, "episode_reward_max": 1356.1459935902376, "custom_metrics": {"outflow_rate_min": 475.6851915157954, "system_level_velocity_min": 10.130844073982997, "cost1_max": 451.03269342369504, "system_level_velocity_max": 18.106998937267157, "cost2_min": -136.3775864005765, "outflow_rate_max": 1465.8142036556405, "system_level_velocity_mean": 14.502922065910768, "cost1_mean": 381.6560690472431, "cost2_mean": -104.230059366773, "outflow_rate_mean": 1275.0796589561119, "cost2_max": -22.65669529262, "cost1_min": 23.98377522714354}, "policy_reward_mean": {}, "timesteps_this_iter": 55465, "training_iteration": 44, "node_ip": "10.138.0.2", "episode_reward_min": 58.12822198250561, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2047.4966115951538, "info": {"num_steps_trained": 2683652, "sample_time_ms": 28982.163, "load_time_ms": 7.183, "grad_time_ms": 14846.588, "update_time_ms": 8.295, "default": {"policy_loss": -0.009692232124507427, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.733594536781311, "total_loss": 51.80868911743164, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 51.81550598144531, "kl": 0.019177444279193878, "entropy": 1.2723718881607056}, "num_steps_sampled": 2683652}, "episodes_total": 1262, "done": false, "date": "2019-05-21_07-37-08", "time_total_s": 2047.4966115951538, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d668>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.37, "time_this_iter_s": 41.113593339920044, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558424228}
{"episode_reward_mean": 1218.1077923469134, "timesteps_total": 2740554, "iterations_since_restore": 45, "timesteps_since_restore": 2740554, "num_metric_batches_dropped": 0, "episode_reward_max": 1338.4677782476858, "custom_metrics": {"outflow_rate_min": 1074.4718206310981, "system_level_velocity_min": 10.949145666375234, "cost1_max": 451.03269342369504, "system_level_velocity_max": 16.954493903559285, "cost2_min": -125.54806972042209, "outflow_rate_max": 1465.8142036556405, "system_level_velocity_mean": 14.476438090794908, "cost1_mean": 385.738711902239, "cost2_mean": -101.32666106345889, "outflow_rate_mean": 1275.9612555370397, "cost2_max": -76.9185570142584, "cost1_min": 291.6070161222588}, "policy_reward_mean": {}, "timesteps_this_iter": 56902, "training_iteration": 45, "node_ip": "10.138.0.2", "episode_reward_min": 1027.1656012251285, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2091.1481850147247, "info": {"num_steps_trained": 2740554, "sample_time_ms": 28931.846, "load_time_ms": 6.757, "grad_time_ms": 15039.467, "update_time_ms": 8.34, "default": {"policy_loss": -0.009346742182970047, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7425568699836731, "total_loss": 52.96636199951172, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 52.9730110168457, "kl": 0.01796289160847664, "entropy": 1.2826857566833496}, "num_steps_sampled": 2740554}, "episodes_total": 1295, "done": false, "date": "2019-05-21_07-37-52", "time_total_s": 2091.1481850147247, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022b00>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 43.65157341957092, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558424272}
{"episode_reward_mean": 1214.7293037160002, "timesteps_total": 2796930, "iterations_since_restore": 46, "timesteps_since_restore": 2796930, "num_metric_batches_dropped": 0, "episode_reward_max": 1338.4677782476858, "custom_metrics": {"outflow_rate_min": 1074.4718206310981, "system_level_velocity_min": 10.949145666375234, "cost1_max": 451.03269342369504, "system_level_velocity_max": 16.954493903559285, "cost2_min": -125.54806972042209, "outflow_rate_max": 1465.8142036556405, "system_level_velocity_mean": 14.519452905637301, "cost1_mean": 386.9789564419018, "cost2_mean": -98.58452959953894, "outflow_rate_mean": 1267.507535284086, "cost2_max": -76.9185570142584, "cost1_min": 288.1995368855703}, "policy_reward_mean": {}, "timesteps_this_iter": 56376, "training_iteration": 46, "node_ip": "10.138.0.2", "episode_reward_min": 1027.1656012251285, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2134.257406234741, "info": {"num_steps_trained": 2796930, "sample_time_ms": 28826.215, "load_time_ms": 6.675, "grad_time_ms": 15146.926, "update_time_ms": 8.383, "default": {"policy_loss": -0.010604946874082088, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7462044358253479, "total_loss": 49.46926498413086, "cur_kl_coeff": 0.15000000596046448, "vf_loss": 49.47707748413086, "kl": 0.018616193905472755, "entropy": 1.2876431941986084}, "num_steps_sampled": 2796930}, "episodes_total": 1323, "done": false, "date": "2019-05-21_07-38-35", "time_total_s": 2134.257406234741, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c031b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d5c0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 43.10922122001648, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558424315}
{"episode_reward_mean": 1210.2238254583165, "timesteps_total": 2852293, "iterations_since_restore": 47, "timesteps_since_restore": 2852293, "num_metric_batches_dropped": 0, "episode_reward_max": 1325.5236313821254, "custom_metrics": {"outflow_rate_min": 1049.3105119340303, "system_level_velocity_min": 10.748534573336276, "cost1_max": 444.0354195773684, "system_level_velocity_max": 16.736067079634967, "cost2_min": -123.3459166526134, "outflow_rate_max": 1419.829595768848, "system_level_velocity_mean": 14.48258710398493, "cost1_mean": 386.19040048209035, "cost2_mean": -95.22446404762655, "outflow_rate_mean": 1262.802797170471, "cost2_max": -73.55597749215293, "cost1_min": 283.7924532029298}, "policy_reward_mean": {}, "timesteps_this_iter": 55363, "training_iteration": 47, "node_ip": "10.138.0.2", "episode_reward_min": 1005.160158897275, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2178.2152860164642, "info": {"num_steps_trained": 2852293, "sample_time_ms": 28989.778, "load_time_ms": 6.602, "grad_time_ms": 14952.61, "update_time_ms": 8.669, "default": {"policy_loss": -0.010461444966495037, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7370252013206482, "total_loss": 48.54293441772461, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 48.55033874511719, "kl": 0.020415253937244415, "entropy": 1.2807807922363281}, "num_steps_sampled": 2852293}, "episodes_total": 1352, "done": false, "date": "2019-05-21_07-39-19", "time_total_s": 2178.2152860164642, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d240>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 43.95787978172302, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558424359}
{"episode_reward_mean": 1215.4517335907046, "timesteps_total": 2907140, "iterations_since_restore": 48, "timesteps_since_restore": 2907140, "num_metric_batches_dropped": 0, "episode_reward_max": 1325.5236313821254, "custom_metrics": {"outflow_rate_min": 1049.3105119340303, "system_level_velocity_min": 10.748534573336276, "cost1_max": 444.0354195773684, "system_level_velocity_max": 16.736067079634967, "cost2_min": -118.23594713198864, "outflow_rate_max": 1408.9626350120463, "system_level_velocity_mean": 14.592819100393342, "cost1_mean": 389.26605180868614, "cost2_mean": -92.86754080772796, "outflow_rate_mean": 1268.0826425224157, "cost2_max": -69.63909373614871, "cost1_min": 283.7924532029298}, "policy_reward_mean": {}, "timesteps_this_iter": 54847, "training_iteration": 48, "node_ip": "10.138.0.2", "episode_reward_min": 1005.160158897275, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2221.6076180934906, "info": {"num_steps_trained": 2907140, "sample_time_ms": 29006.909, "load_time_ms": 6.716, "grad_time_ms": 14755.086, "update_time_ms": 8.502, "default": {"policy_loss": -0.010599032044410706, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6196216344833374, "total_loss": 60.63778305053711, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 60.644371032714844, "kl": 0.01783156581223011, "entropy": 1.2676422595977783}, "num_steps_sampled": 2907140}, "episodes_total": 1381, "done": false, "date": "2019-05-21_07-40-02", "time_total_s": 2221.6076180934906, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dfd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00db38>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 43.39233207702637, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558424402}
{"episode_reward_mean": 1212.2682109449386, "timesteps_total": 2962556, "iterations_since_restore": 49, "timesteps_since_restore": 2962556, "num_metric_batches_dropped": 0, "episode_reward_max": 1325.5236313821254, "custom_metrics": {"outflow_rate_min": 1049.3105119340303, "system_level_velocity_min": 10.748534573336276, "cost1_max": 444.0354195773684, "system_level_velocity_max": 16.736067079634967, "cost2_min": -118.23594713198864, "outflow_rate_max": 1422.2840919370065, "system_level_velocity_mean": 14.544933675334073, "cost1_mean": 387.952209269972, "cost2_mean": -91.22375985727565, "outflow_rate_mean": 1266.9937993669646, "cost2_max": -67.6201023411502, "cost1_min": 283.7924532029298}, "policy_reward_mean": {}, "timesteps_this_iter": 55416, "training_iteration": 49, "node_ip": "10.138.0.2", "episode_reward_min": 1005.160158897275, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2265.767979621887, "info": {"num_steps_trained": 2962556, "sample_time_ms": 29117.335, "load_time_ms": 6.647, "grad_time_ms": 14398.472, "update_time_ms": 8.178, "default": {"policy_loss": -0.009840804152190685, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6997432708740234, "total_loss": 51.210350036621094, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 51.21687698364258, "kl": 0.014722902327775955, "entropy": 1.2935869693756104}, "num_steps_sampled": 2962556}, "episodes_total": 1410, "done": false, "date": "2019-05-21_07-40-46", "time_total_s": 2265.767979621887, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d4a8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 44.160361528396606, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558424446}
{"episode_reward_mean": 1223.7398136054137, "timesteps_total": 3017240, "iterations_since_restore": 50, "timesteps_since_restore": 3017240, "num_metric_batches_dropped": 0, "episode_reward_max": 1327.416330172882, "custom_metrics": {"outflow_rate_min": 1077.6512305793756, "system_level_velocity_min": 11.004101218089376, "cost1_max": 445.39671629395485, "system_level_velocity_max": 16.761752437798595, "cost2_min": -115.21765484434445, "outflow_rate_max": 1422.2840919370065, "system_level_velocity_mean": 14.779829815677772, "cost1_mean": 394.2432448340137, "cost2_mean": -89.15710036772634, "outflow_rate_mean": 1281.7365622548525, "cost2_max": -67.6201023411502, "cost1_min": 291.478144357111}, "policy_reward_mean": {}, "timesteps_this_iter": 54684, "training_iteration": 50, "node_ip": "10.138.0.2", "episode_reward_min": 1067.411036130807, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2306.3357808589935, "info": {"num_steps_trained": 3017240, "sample_time_ms": 28970.615, "load_time_ms": 6.551, "grad_time_ms": 14061.169, "update_time_ms": 8.068, "default": {"policy_loss": -0.008588605560362339, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6606910824775696, "total_loss": 56.16873550415039, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 56.173641204833984, "kl": 0.016407983377575874, "entropy": 1.283850908279419}, "num_steps_sampled": 3017240}, "episodes_total": 1438, "done": false, "date": "2019-05-21_07-41-27", "time_total_s": 2306.3357808589935, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502518>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 40.56780123710632, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558424487}
{"episode_reward_mean": 1213.462727757006, "timesteps_total": 3072419, "iterations_since_restore": 51, "timesteps_since_restore": 3072419, "num_metric_batches_dropped": 0, "episode_reward_max": 1327.416330172882, "custom_metrics": {"outflow_rate_min": 1077.6512305793756, "system_level_velocity_min": 11.449531799147056, "cost1_max": 450.01385053150364, "system_level_velocity_max": 16.944311645302495, "cost2_min": -132.33842757891483, "outflow_rate_max": 1422.2840919370065, "system_level_velocity_mean": 14.657336871945086, "cost1_mean": 390.59318573446427, "cost2_mean": -89.80907104766278, "outflow_rate_mean": 1271.7464750559384, "cost2_max": -67.6201023411502, "cost1_min": 301.6666098284012}, "policy_reward_mean": {}, "timesteps_this_iter": 55179, "training_iteration": 51, "node_ip": "10.138.0.2", "episode_reward_min": 1067.411036130807, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2348.3580770492554, "info": {"num_steps_trained": 3072419, "sample_time_ms": 28807.882, "load_time_ms": 6.678, "grad_time_ms": 14056.758, "update_time_ms": 7.941, "default": {"policy_loss": -0.010413700714707375, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6460918188095093, "total_loss": 61.1613883972168, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 61.1682243347168, "kl": 0.01594334840774536, "entropy": 1.3074158430099487}, "num_steps_sampled": 3072419}, "episodes_total": 1469, "done": false, "date": "2019-05-21_07-42-09", "time_total_s": 2348.3580770492554, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502e80>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 42.02229619026184, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558424529}
{"episode_reward_mean": 1199.1434644639469, "timesteps_total": 3125222, "iterations_since_restore": 52, "timesteps_since_restore": 3125222, "num_metric_batches_dropped": 0, "episode_reward_max": 1327.416330172882, "custom_metrics": {"outflow_rate_min": 496.2871102902245, "system_level_velocity_min": 11.449531799147056, "cost1_max": 450.01385053150364, "system_level_velocity_max": 18.392007354559013, "cost2_min": -132.33842757891483, "outflow_rate_max": 1410.5993353506392, "system_level_velocity_mean": 14.702824261545427, "cost1_mean": 386.72253601702744, "cost2_mean": -86.79112571785132, "outflow_rate_mean": 1267.2272678353297, "cost2_max": -19.97065268122971, "cost1_min": 24.1544606149248}, "policy_reward_mean": {}, "timesteps_this_iter": 52803, "training_iteration": 52, "node_ip": "10.138.0.2", "episode_reward_min": 58.84580776400096, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2389.8894209861755, "info": {"num_steps_trained": 3125222, "sample_time_ms": 28558.668, "load_time_ms": 6.522, "grad_time_ms": 14094.533, "update_time_ms": 7.855, "default": {"policy_loss": -0.009064420126378536, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5695348381996155, "total_loss": 70.37207794189453, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 70.3778076171875, "kl": 0.014837088994681835, "entropy": 1.3097413778305054}, "num_steps_sampled": 3125222}, "episodes_total": 1502, "done": false, "date": "2019-05-21_07-42-51", "time_total_s": 2389.8894209861755, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf160>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.37, "time_this_iter_s": 41.531343936920166, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558424571}
{"episode_reward_mean": 1197.5607693514257, "timesteps_total": 3176617, "iterations_since_restore": 53, "timesteps_since_restore": 3176617, "num_metric_batches_dropped": 0, "episode_reward_max": 1322.9715462689746, "custom_metrics": {"outflow_rate_min": 496.2871102902245, "system_level_velocity_min": 11.465974583993491, "cost1_max": 450.01385053150364, "system_level_velocity_max": 18.392007354559013, "cost2_min": -132.33842757891483, "outflow_rate_max": 1410.5993353506392, "system_level_velocity_mean": 14.831595832747603, "cost1_mean": 389.9075382948291, "cost2_mean": -82.81826304623159, "outflow_rate_mean": 1270.4193887752779, "cost2_max": -19.97065268122971, "cost1_min": 24.1544606149248}, "policy_reward_mean": {}, "timesteps_this_iter": 51395, "training_iteration": 53, "node_ip": "10.138.0.2", "episode_reward_min": 58.84580776400096, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2429.0535192489624, "info": {"num_steps_trained": 3176617, "sample_time_ms": 27974.859, "load_time_ms": 6.275, "grad_time_ms": 14178.481, "update_time_ms": 7.846, "default": {"policy_loss": -0.009469802491366863, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5339024662971497, "total_loss": 62.27958297729492, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 62.28549575805664, "kl": 0.015815578401088715, "entropy": 1.3007423877716064}, "num_steps_sampled": 3176617}, "episodes_total": 1531, "done": false, "date": "2019-05-21_07-43-30", "time_total_s": 2429.0535192489624, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba4e0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.37, "time_this_iter_s": 39.164098262786865, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558424610}
{"episode_reward_mean": 1194.5069341069075, "timesteps_total": 3229241, "iterations_since_restore": 54, "timesteps_since_restore": 3229241, "num_metric_batches_dropped": 0, "episode_reward_max": 1308.3654268955274, "custom_metrics": {"outflow_rate_min": 496.2871102902245, "system_level_velocity_min": 11.088459682447139, "cost1_max": 445.60870735043386, "system_level_velocity_max": 18.392007354559013, "cost2_min": -112.85366799341757, "outflow_rate_max": 1383.0381921731591, "system_level_velocity_mean": 14.961437865970213, "cost1_mean": 393.08528779141795, "cost2_mean": -78.76536306314287, "outflow_rate_mean": 1270.7118321652958, "cost2_max": -19.97065268122971, "cost1_min": 24.1544606149248}, "policy_reward_mean": {}, "timesteps_this_iter": 52624, "training_iteration": 54, "node_ip": "10.138.0.2", "episode_reward_min": 58.84580776400096, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2470.6207094192505, "info": {"num_steps_trained": 3229241, "sample_time_ms": 28036.366, "load_time_ms": 5.82, "grad_time_ms": 14162.853, "update_time_ms": 7.9, "default": {"policy_loss": -0.010377424769103527, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5980343222618103, "total_loss": 67.05332946777344, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 67.0602035522461, "kl": 0.015576750040054321, "entropy": 1.3114686012268066}, "num_steps_sampled": 3229241}, "episodes_total": 1562, "done": false, "date": "2019-05-21_07-44-11", "time_total_s": 2470.6207094192505, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502ef0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.37, "time_this_iter_s": 41.567190170288086, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558424651}
{"episode_reward_mean": 1200.6454668902077, "timesteps_total": 3283198, "iterations_since_restore": 55, "timesteps_since_restore": 3283198, "num_metric_batches_dropped": 0, "episode_reward_max": 1305.2627539677617, "custom_metrics": {"outflow_rate_min": 1071.9182937062933, "system_level_velocity_min": 11.088459682447139, "cost1_max": 445.60870735043386, "system_level_velocity_max": 16.79031940099161, "cost2_min": -112.85366799341757, "outflow_rate_max": 1370.2336068309255, "system_level_velocity_mean": 14.980905052451936, "cost1_mean": 397.98432885039625, "cost2_mean": -78.82421118599643, "outflow_rate_mean": 1270.9905213334332, "cost2_max": -60.454954523382526, "cost1_min": 291.089841254255}, "policy_reward_mean": {}, "timesteps_this_iter": 53957, "training_iteration": 55, "node_ip": "10.138.0.2", "episode_reward_min": 1012.1524589862958, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2513.033030986786, "info": {"num_steps_trained": 3283198, "sample_time_ms": 28181.041, "load_time_ms": 5.987, "grad_time_ms": 13896.879, "update_time_ms": 7.9, "default": {"policy_loss": -0.00950591079890728, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6338186860084534, "total_loss": 64.58761596679688, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 64.59352111816406, "kl": 0.016013583168387413, "entropy": 1.316494345664978}, "num_steps_sampled": 3283198}, "episodes_total": 1592, "done": false, "date": "2019-05-21_07-44-54", "time_total_s": 2513.033030986786, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaff98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafb00>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 42.4123215675354, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558424694}
{"episode_reward_mean": 1193.1614399367093, "timesteps_total": 3336688, "iterations_since_restore": 56, "timesteps_since_restore": 3336688, "num_metric_batches_dropped": 0, "episode_reward_max": 1349.645750824616, "custom_metrics": {"outflow_rate_min": 495.5886028826135, "system_level_velocity_min": 11.088459682447139, "cost1_max": 451.3530224950905, "system_level_velocity_max": 18.313686388897576, "cost2_min": -115.6260550321951, "outflow_rate_max": 1454.7185301970756, "system_level_velocity_mean": 14.988180227404824, "cost1_mean": 393.5817869348141, "cost2_mean": -81.56154290087055, "outflow_rate_mean": 1269.245477598056, "cost2_max": -19.81100595908913, "cost1_min": 22.816027874229196}, "policy_reward_mean": {}, "timesteps_this_iter": 53490, "training_iteration": 56, "node_ip": "10.138.0.2", "episode_reward_min": 55.23432043893948, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2552.616084098816, "info": {"num_steps_trained": 3336688, "sample_time_ms": 28329.575, "load_time_ms": 5.945, "grad_time_ms": 13397.656, "update_time_ms": 7.791, "default": {"policy_loss": -0.010319996625185013, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6045227646827698, "total_loss": 69.79961395263672, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 69.80633544921875, "kl": 0.01601003296673298, "entropy": 1.3034123182296753}, "num_steps_sampled": 3336688}, "episodes_total": 1625, "done": false, "date": "2019-05-21_07-45-34", "time_total_s": 2552.616084098816, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf470>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 39.58305311203003, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558424734}
{"episode_reward_mean": 1189.5966083171534, "timesteps_total": 3389425, "iterations_since_restore": 57, "timesteps_since_restore": 3389425, "num_metric_batches_dropped": 0, "episode_reward_max": 1349.645750824616, "custom_metrics": {"outflow_rate_min": 495.5886028826135, "system_level_velocity_min": 11.093861400027775, "cost1_max": 451.3530224950905, "system_level_velocity_max": 18.313686388897576, "cost2_min": -115.6260550321951, "outflow_rate_max": 1454.7185301970756, "system_level_velocity_mean": 14.908050673010433, "cost1_mean": 391.38992018783887, "cost2_mean": -84.21973618577617, "outflow_rate_mean": 1266.1368287155933, "cost2_max": -19.81100595908913, "cost1_min": 22.816027874229196}, "policy_reward_mean": {}, "timesteps_this_iter": 52737, "training_iteration": 57, "node_ip": "10.138.0.2", "episode_reward_min": 55.23432043893948, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2592.644547224045, "info": {"num_steps_trained": 3389425, "sample_time_ms": 28089.19, "load_time_ms": 5.877, "grad_time_ms": 13243.215, "update_time_ms": 7.632, "default": {"policy_loss": -0.010823400691151619, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6298820972442627, "total_loss": 58.67380905151367, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 58.681190490722656, "kl": 0.01529912929981947, "entropy": 1.3105186223983765}, "num_steps_sampled": 3389425}, "episodes_total": 1653, "done": false, "date": "2019-05-21_07-46-14", "time_total_s": 2592.644547224045, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba470>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 40.02846312522888, "hostname": "flow-main", "episodes_this_iter": 28, "timestamp": 1558424774}
{"episode_reward_mean": 1176.448166728597, "timesteps_total": 3442746, "iterations_since_restore": 58, "timesteps_since_restore": 3442746, "num_metric_batches_dropped": 0, "episode_reward_max": 1349.645750824616, "custom_metrics": {"outflow_rate_min": 495.5886028826135, "system_level_velocity_min": 11.093861400027775, "cost1_max": 451.3530224950905, "system_level_velocity_max": 18.313686388897576, "cost2_min": -115.6260550321951, "outflow_rate_max": 1454.7185301970756, "system_level_velocity_mean": 14.920162719739688, "cost1_mean": 386.8081318010874, "cost2_mean": -84.17357153031917, "outflow_rate_mean": 1256.9475889016678, "cost2_max": -19.81100595908913, "cost1_min": 22.816027874229196}, "policy_reward_mean": {}, "timesteps_this_iter": 53321, "training_iteration": 58, "node_ip": "10.138.0.2", "episode_reward_min": 55.23432043893948, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2634.5604178905487, "info": {"num_steps_trained": 3442746, "sample_time_ms": 27829.386, "load_time_ms": 5.936, "grad_time_ms": 13355.152, "update_time_ms": 7.707, "default": {"policy_loss": -0.011265655979514122, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.655972421169281, "total_loss": 62.75932312011719, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 62.76681900024414, "kl": 0.01677967980504036, "entropy": 1.3025665283203125}, "num_steps_sampled": 3442746}, "episodes_total": 1684, "done": false, "date": "2019-05-21_07-46-56", "time_total_s": 2634.5604178905487, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafc18>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 686.75, "time_this_iter_s": 41.915870666503906, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558424816}
{"episode_reward_mean": 1189.6525249346894, "timesteps_total": 3495842, "iterations_since_restore": 59, "timesteps_since_restore": 3495842, "num_metric_batches_dropped": 0, "episode_reward_max": 1349.645750824616, "custom_metrics": {"outflow_rate_min": 503.78388481436684, "system_level_velocity_min": 11.093861400027775, "cost1_max": 451.3530224950905, "system_level_velocity_max": 18.03060944117046, "cost2_min": -115.6260550321951, "outflow_rate_max": 1454.7185301970756, "system_level_velocity_mean": 14.981066560121976, "cost1_mean": 392.85318031817616, "cost2_mean": -83.87688076086735, "outflow_rate_mean": 1267.476154593012, "cost2_max": -20.538289734022975, "cost1_min": 25.7135925476377}, "policy_reward_mean": {}, "timesteps_this_iter": 53096, "training_iteration": 59, "node_ip": "10.138.0.2", "episode_reward_min": 62.17223457766207, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2673.751280784607, "info": {"num_steps_trained": 3495842, "sample_time_ms": 27338.845, "load_time_ms": 6.009, "grad_time_ms": 13348.115, "update_time_ms": 7.802, "default": {"policy_loss": -0.010910718701779842, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6075745820999146, "total_loss": 65.4443588256836, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 65.45136260986328, "kl": 0.01733049750328064, "entropy": 1.3063299655914307}, "num_steps_sampled": 3495842}, "episodes_total": 1713, "done": false, "date": "2019-05-21_07-47-35", "time_total_s": 2673.751280784607, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafcf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf128>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.4, "time_this_iter_s": 39.19086289405823, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558424855}
{"episode_reward_mean": 1187.378855695018, "timesteps_total": 3548793, "iterations_since_restore": 60, "timesteps_since_restore": 3548793, "num_metric_batches_dropped": 0, "episode_reward_max": 1307.8073576905124, "custom_metrics": {"outflow_rate_min": 503.78388481436684, "system_level_velocity_min": 11.24672625176584, "cost1_max": 450.6197864933509, "system_level_velocity_max": 18.03060944117046, "cost2_min": -106.74929523100789, "outflow_rate_max": 1401.617910686252, "system_level_velocity_mean": 14.895403924775092, "cost1_mean": 390.361702734947, "cost2_mean": -82.957520377198, "outflow_rate_mean": 1270.1366640319056, "cost2_max": -20.538289734022975, "cost1_min": 25.7135925476377}, "policy_reward_mean": {}, "timesteps_this_iter": 52951, "training_iteration": 60, "node_ip": "10.138.0.2", "episode_reward_min": 62.17223457766207, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2714.1718604564667, "info": {"num_steps_trained": 3548793, "sample_time_ms": 27300.093, "load_time_ms": 6.219, "grad_time_ms": 13371.78, "update_time_ms": 8.088, "default": {"policy_loss": -0.009494451805949211, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.587719202041626, "total_loss": 65.18395233154297, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 65.18987274169922, "kl": 0.015914520248770714, "entropy": 1.308789610862732}, "num_steps_sampled": 3548793}, "episodes_total": 1742, "done": false, "date": "2019-05-21_07-48-15", "time_total_s": 2714.1718604564667, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba860>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.4, "time_this_iter_s": 40.42057967185974, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558424895}
{"episode_reward_mean": 1185.8627212332112, "timesteps_total": 3600922, "iterations_since_restore": 61, "timesteps_since_restore": 3600922, "num_metric_batches_dropped": 0, "episode_reward_max": 1307.8073576905124, "custom_metrics": {"outflow_rate_min": 503.78388481436684, "system_level_velocity_min": 11.08138695189149, "cost1_max": 450.6197864933509, "system_level_velocity_max": 18.03060944117046, "cost2_min": -106.74929523100789, "outflow_rate_max": 1398.8277949765104, "system_level_velocity_mean": 14.900099158294081, "cost1_mean": 390.3799358991332, "cost2_mean": -82.76893678404595, "outflow_rate_mean": 1271.5372157365025, "cost2_max": -20.538289734022975, "cost1_min": 25.7135925476377}, "policy_reward_mean": {}, "timesteps_this_iter": 52129, "training_iteration": 61, "node_ip": "10.138.0.2", "episode_reward_min": 62.17223457766207, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2756.380370616913, "info": {"num_steps_trained": 3600922, "sample_time_ms": 27225.354, "load_time_ms": 6.223, "grad_time_ms": 13464.986, "update_time_ms": 8.072, "default": {"policy_loss": -0.010337742045521736, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.639126718044281, "total_loss": 66.44322204589844, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 66.45000457763672, "kl": 0.01577189192175865, "entropy": 1.2989565134048462}, "num_steps_sampled": 3600922}, "episodes_total": 1772, "done": false, "date": "2019-05-21_07-48-58", "time_total_s": 2756.380370616913, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbaba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0227b8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.4, "time_this_iter_s": 42.20851016044617, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558424938}
{"episode_reward_mean": 1198.2537900438442, "timesteps_total": 3652546, "iterations_since_restore": 62, "timesteps_since_restore": 3652546, "num_metric_batches_dropped": 0, "episode_reward_max": 1307.8073576905124, "custom_metrics": {"outflow_rate_min": 1016.8303774716128, "system_level_velocity_min": 11.08138695189149, "cost1_max": 453.71618911639223, "system_level_velocity_max": 17.43341248387394, "cost2_min": -106.74929523100789, "outflow_rate_max": 1418.6354356837605, "system_level_velocity_mean": 15.184596375423473, "cost1_mean": 398.7785613258402, "cost2_mean": -83.01291605881097, "outflow_rate_mean": 1286.1938730866746, "cost2_max": -51.87978943818185, "cost1_min": 140.45436916420834}, "policy_reward_mean": {}, "timesteps_this_iter": 51624, "training_iteration": 62, "node_ip": "10.138.0.2", "episode_reward_min": 373.8856677997412, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2796.644239425659, "info": {"num_steps_trained": 3652546, "sample_time_ms": 27131.993, "load_time_ms": 6.079, "grad_time_ms": 13432.348, "update_time_ms": 8.146, "default": {"policy_loss": -0.01094661932438612, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5922693014144897, "total_loss": 71.26837158203125, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 71.27589416503906, "kl": 0.01521915104240179, "entropy": 1.30123770236969}, "num_steps_sampled": 3652546}, "episodes_total": 1806, "done": false, "date": "2019-05-21_07-49-38", "time_total_s": 2796.644239425659, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf668>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.15, "time_this_iter_s": 40.26386880874634, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558424978}
{"episode_reward_mean": 1186.1249963425967, "timesteps_total": 3705891, "iterations_since_restore": 63, "timesteps_since_restore": 3705891, "num_metric_batches_dropped": 0, "episode_reward_max": 1298.1487992262728, "custom_metrics": {"outflow_rate_min": 495.41473081823796, "system_level_velocity_min": 10.413768665977457, "cost1_max": 453.71618911639223, "system_level_velocity_max": 18.178707671953752, "cost2_min": -110.56464581428943, "outflow_rate_max": 1424.8334054676798, "system_level_velocity_mean": 15.38642744274129, "cost1_mean": 399.5149402911203, "cost2_mean": -82.19386236478275, "outflow_rate_mean": 1273.8862217684195, "cost2_max": -22.41877069641775, "cost1_min": 26.61073031098756}, "policy_reward_mean": {}, "timesteps_this_iter": 53345, "training_iteration": 63, "node_ip": "10.138.0.2", "episode_reward_min": 63.562035404892946, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2836.61589384079, "info": {"num_steps_trained": 3705891, "sample_time_ms": 27244.277, "load_time_ms": 6.328, "grad_time_ms": 13400.057, "update_time_ms": 8.174, "default": {"policy_loss": -0.011740590445697308, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.660350501537323, "total_loss": 64.31413269042969, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 64.32152557373047, "kl": 0.019318480044603348, "entropy": 1.3243340253829956}, "num_steps_sampled": 3705891}, "episodes_total": 1836, "done": false, "date": "2019-05-21_07-50-18", "time_total_s": 2836.61589384079, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf2e8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.56, "time_this_iter_s": 39.971654415130615, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558425018}
{"episode_reward_mean": 1183.3881766837821, "timesteps_total": 3758220, "iterations_since_restore": 64, "timesteps_since_restore": 3758220, "num_metric_batches_dropped": 0, "episode_reward_max": 1314.8925921541786, "custom_metrics": {"outflow_rate_min": 495.41473081823796, "system_level_velocity_min": 10.413768665977457, "cost1_max": 453.71618911639223, "system_level_velocity_max": 18.178707671953752, "cost2_min": -110.56464581428943, "outflow_rate_max": 1424.8334054676798, "system_level_velocity_mean": 15.308882790179423, "cost1_mean": 397.35557879018523, "cost2_mean": -82.94706485090383, "outflow_rate_mean": 1270.8902271926956, "cost2_max": -22.41877069641775, "cost1_min": 26.61073031098756}, "policy_reward_mean": {}, "timesteps_this_iter": 52329, "training_iteration": 64, "node_ip": "10.138.0.2", "episode_reward_min": 63.562035404892946, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2876.1937346458435, "info": {"num_steps_trained": 3758220, "sample_time_ms": 27087.001, "load_time_ms": 6.67, "grad_time_ms": 13357.84, "update_time_ms": 8.188, "default": {"policy_loss": -0.010698864236474037, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6436686515808105, "total_loss": 59.58393096923828, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 59.590946197509766, "kl": 0.016396868973970413, "entropy": 1.3154324293136597}, "num_steps_sampled": 3758220}, "episodes_total": 1865, "done": false, "date": "2019-05-21_07-50-57", "time_total_s": 2876.1937346458435, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba588>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.56, "time_this_iter_s": 39.57784080505371, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558425057}
{"episode_reward_mean": 1182.1474564897608, "timesteps_total": 3809835, "iterations_since_restore": 65, "timesteps_since_restore": 3809835, "num_metric_batches_dropped": 0, "episode_reward_max": 1314.8925921541786, "custom_metrics": {"outflow_rate_min": 495.41473081823796, "system_level_velocity_min": 10.413768665977457, "cost1_max": 453.71618911639223, "system_level_velocity_max": 18.178707671953752, "cost2_min": -110.56464581428943, "outflow_rate_max": 1424.8334054676798, "system_level_velocity_mean": 15.118985735604872, "cost1_mean": 395.475312052179, "cost2_mean": -83.92649300323022, "outflow_rate_mean": 1265.764469946774, "cost2_max": -22.41877069641775, "cost1_min": 26.61073031098756}, "policy_reward_mean": {}, "timesteps_this_iter": 51615, "training_iteration": 65, "node_ip": "10.138.0.2", "episode_reward_min": 63.562035404892946, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2915.994720697403, "info": {"num_steps_trained": 3809835, "sample_time_ms": 26940.606, "load_time_ms": 6.667, "grad_time_ms": 13244.422, "update_time_ms": 8.357, "default": {"policy_loss": -0.012088032439351082, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5963250398635864, "total_loss": 68.55487060546875, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 68.56306457519531, "kl": 0.017290497198700905, "entropy": 1.315189003944397}, "num_steps_sampled": 3809835}, "episodes_total": 1897, "done": false, "date": "2019-05-21_07-51-37", "time_total_s": 2915.994720697403, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafa90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf1d0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.41, "time_this_iter_s": 39.80098605155945, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558425097}
{"episode_reward_mean": 1197.8681202717012, "timesteps_total": 3862121, "iterations_since_restore": 66, "timesteps_since_restore": 3862121, "num_metric_batches_dropped": 0, "episode_reward_max": 1314.8925921541786, "custom_metrics": {"outflow_rate_min": 1089.0290274841439, "system_level_velocity_min": 11.6551027487562, "cost1_max": 453.3924594697703, "system_level_velocity_max": 17.232512903869445, "cost2_min": -103.50966231139645, "outflow_rate_max": 1409.9888702182361, "system_level_velocity_mean": 15.112635772206838, "cost1_mean": 399.9295288817601, "cost2_mean": -83.94020038301875, "outflow_rate_mean": 1280.833731222005, "cost2_max": -64.96468957554626, "cost1_min": 305.2707163880732}, "policy_reward_mean": {}, "timesteps_this_iter": 52286, "training_iteration": 66, "node_ip": "10.138.0.2", "episode_reward_min": 1010.9688091547187, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2956.4206471443176, "info": {"num_steps_trained": 3862121, "sample_time_ms": 27063.108, "load_time_ms": 6.632, "grad_time_ms": 13206.537, "update_time_ms": 8.351, "default": {"policy_loss": -0.011519290506839752, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.648715615272522, "total_loss": 64.62897491455078, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 64.6366195678711, "kl": 0.017192760482430458, "entropy": 1.3232234716415405}, "num_steps_sampled": 3862121}, "episodes_total": 1926, "done": false, "date": "2019-05-21_07-52-18", "time_total_s": 2956.4206471443176, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbaf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbaef0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 40.42592644691467, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558425138}
{"episode_reward_mean": 1196.8353293954583, "timesteps_total": 3915730, "iterations_since_restore": 67, "timesteps_since_restore": 3915730, "num_metric_batches_dropped": 0, "episode_reward_max": 1314.8925921541786, "custom_metrics": {"outflow_rate_min": 1089.0290274841439, "system_level_velocity_min": 11.6551027487562, "cost1_max": 453.54179039309327, "system_level_velocity_max": 17.232512903869445, "cost2_min": -102.77030702260501, "outflow_rate_max": 1409.9888702182361, "system_level_velocity_mean": 15.287756389316206, "cost1_mean": 404.31020873933284, "cost2_mean": -82.22986152695948, "outflow_rate_mean": 1274.9982876151182, "cost2_max": -64.96468957554626, "cost1_min": 305.2707163880732}, "policy_reward_mean": {}, "timesteps_this_iter": 53609, "training_iteration": 67, "node_ip": "10.138.0.2", "episode_reward_min": 1010.9688091547187, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 2995.977053165436, "info": {"num_steps_trained": 3915730, "sample_time_ms": 27083.691, "load_time_ms": 6.628, "grad_time_ms": 13140.985, "update_time_ms": 8.124, "default": {"policy_loss": -0.011774538084864616, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6637489795684814, "total_loss": 59.17389678955078, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 59.181800842285156, "kl": 0.01722279191017151, "entropy": 1.324183464050293}, "num_steps_sampled": 3915730}, "episodes_total": 1957, "done": false, "date": "2019-05-21_07-52-57", "time_total_s": 2995.977053165436, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc10b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1128>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 39.556406021118164, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558425177}
{"episode_reward_mean": 1164.590172418959, "timesteps_total": 3967956, "iterations_since_restore": 68, "timesteps_since_restore": 3967956, "num_metric_batches_dropped": 0, "episode_reward_max": 1312.8431469002544, "custom_metrics": {"outflow_rate_min": 479.9591201957086, "system_level_velocity_min": 10.926848295223193, "cost1_max": 453.54179039309327, "system_level_velocity_max": 17.697517740798308, "cost2_min": -102.77030702260501, "outflow_rate_max": 1402.0372464032448, "system_level_velocity_mean": 15.13536373494178, "cost1_mean": 395.6092231804151, "cost2_mean": -80.23793003089837, "outflow_rate_mean": 1243.9682323095467, "cost2_max": -18.145604413572194, "cost1_min": 18.086332349042074}, "policy_reward_mean": {}, "timesteps_this_iter": 52226, "training_iteration": 68, "node_ip": "10.138.0.2", "episode_reward_min": 42.95663349997189, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3036.050299167633, "info": {"num_steps_trained": 3967956, "sample_time_ms": 26972.459, "load_time_ms": 6.407, "grad_time_ms": 13067.407, "update_time_ms": 7.851, "default": {"policy_loss": -0.012575022876262665, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7240136861801147, "total_loss": 57.64664840698242, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 57.655147552490234, "kl": 0.018138235434889793, "entropy": 1.3518356084823608}, "num_steps_sampled": 3967956}, "episodes_total": 1988, "done": false, "date": "2019-05-21_07-53-38", "time_total_s": 3036.050299167633, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafa90>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.27, "time_this_iter_s": 40.073246002197266, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558425218}
{"episode_reward_mean": 1158.4915056645098, "timesteps_total": 4021129, "iterations_since_restore": 69, "timesteps_since_restore": 4021129, "num_metric_batches_dropped": 0, "episode_reward_max": 1312.8431469002544, "custom_metrics": {"outflow_rate_min": 479.9591201957086, "system_level_velocity_min": 10.926848295223193, "cost1_max": 453.54179039309327, "system_level_velocity_max": 17.697517740798308, "cost2_min": -99.3883600493721, "outflow_rate_max": 1402.0372464032448, "system_level_velocity_mean": 15.272796400956304, "cost1_mean": 398.771289283222, "cost2_mean": -76.68891535144473, "outflow_rate_mean": 1234.8706324533546, "cost2_max": -18.145604413572194, "cost1_min": 18.086332349042074}, "policy_reward_mean": {}, "timesteps_this_iter": 53173, "training_iteration": 69, "node_ip": "10.138.0.2", "episode_reward_min": 42.95663349997189, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3075.0304911136627, "info": {"num_steps_trained": 4021129, "sample_time_ms": 26855.726, "load_time_ms": 6.622, "grad_time_ms": 13161.488, "update_time_ms": 7.696, "default": {"policy_loss": -0.011021502315998077, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6602115631103516, "total_loss": 63.4378776550293, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 63.444862365722656, "kl": 0.017935341224074364, "entropy": 1.3493947982788086}, "num_steps_sampled": 4021129}, "episodes_total": 2017, "done": false, "date": "2019-05-21_07-54-17", "time_total_s": 3075.0304911136627, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0229e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022be0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.27, "time_this_iter_s": 38.98019194602966, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558425257}
{"episode_reward_mean": 1135.0089403079062, "timesteps_total": 4073521, "iterations_since_restore": 70, "timesteps_since_restore": 4073521, "num_metric_batches_dropped": 0, "episode_reward_max": 1312.8431469002544, "custom_metrics": {"outflow_rate_min": 479.9591201957086, "system_level_velocity_min": 10.926848295223193, "cost1_max": 453.54179039309327, "system_level_velocity_max": 18.458406983329372, "cost2_min": -97.42475178238958, "outflow_rate_max": 1410.122163692817, "system_level_velocity_mean": 15.114609880819792, "cost1_mean": 389.76237147151596, "cost2_mean": -76.23478499049787, "outflow_rate_mean": 1216.8344096528804, "cost2_max": -18.145604413572194, "cost1_min": 18.086332349042074}, "policy_reward_mean": {}, "timesteps_this_iter": 52392, "training_iteration": 70, "node_ip": "10.138.0.2", "episode_reward_min": 42.95663349997189, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3115.9153978824615, "info": {"num_steps_trained": 4073521, "sample_time_ms": 26667.781, "load_time_ms": 6.797, "grad_time_ms": 13394.946, "update_time_ms": 7.526, "default": {"policy_loss": -0.010701438412070274, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6691557765007019, "total_loss": 64.58769226074219, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 64.5943832397461, "kl": 0.017835186794400215, "entropy": 1.3667234182357788}, "num_steps_sampled": 4073521}, "episodes_total": 2047, "done": false, "date": "2019-05-21_07-54-57", "time_total_s": 3115.9153978824615, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc10f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1dd8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 686.67, "time_this_iter_s": 40.88490676879883, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558425297}
{"episode_reward_mean": 1140.3976369355287, "timesteps_total": 4126137, "iterations_since_restore": 71, "timesteps_since_restore": 4126137, "num_metric_batches_dropped": 0, "episode_reward_max": 1287.2564246134248, "custom_metrics": {"outflow_rate_min": 482.3428678261924, "system_level_velocity_min": 11.408752582279421, "cost1_max": 452.8466886379289, "system_level_velocity_max": 18.458406983329372, "cost2_min": -97.42475178238958, "outflow_rate_max": 1410.122163692817, "system_level_velocity_mean": 15.043616241862454, "cost1_mean": 392.23464897147954, "cost2_mean": -75.23809734046078, "outflow_rate_mean": 1219.1474097463722, "cost2_max": -24.39921771908059, "cost1_min": 26.301970410631284}, "policy_reward_mean": {}, "timesteps_this_iter": 52616, "training_iteration": 71, "node_ip": "10.138.0.2", "episode_reward_min": 62.202327792817535, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3157.3787961006165, "info": {"num_steps_trained": 4126137, "sample_time_ms": 26668.912, "load_time_ms": 6.865, "grad_time_ms": 13319.362, "update_time_ms": 7.842, "default": {"policy_loss": -0.011256962083280087, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5783299803733826, "total_loss": 70.28358459472656, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 70.29073333740234, "kl": 0.018255284056067467, "entropy": 1.3533995151519775}, "num_steps_sampled": 4126137}, "episodes_total": 2079, "done": false, "date": "2019-05-21_07-55-39", "time_total_s": 3157.3787961006165, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafe80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafcf8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.4, "time_this_iter_s": 41.46339821815491, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558425339}
{"episode_reward_mean": 1139.3077121124759, "timesteps_total": 4179104, "iterations_since_restore": 72, "timesteps_since_restore": 4179104, "num_metric_batches_dropped": 0, "episode_reward_max": 1287.2564246134248, "custom_metrics": {"outflow_rate_min": 482.3428678261924, "system_level_velocity_min": 11.157225345496517, "cost1_max": 452.8466886379289, "system_level_velocity_max": 18.458406983329372, "cost2_min": -97.42475178238958, "outflow_rate_max": 1410.122163692817, "system_level_velocity_mean": 15.088713994541866, "cost1_mean": 393.4745940558082, "cost2_mean": -73.63884717346681, "outflow_rate_mean": 1217.0401151254816, "cost2_max": -24.39921771908059, "cost1_min": 26.301970410631284}, "policy_reward_mean": {}, "timesteps_this_iter": 52967, "training_iteration": 72, "node_ip": "10.138.0.2", "episode_reward_min": 62.202327792817535, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3196.422657728195, "info": {"num_steps_trained": 4179104, "sample_time_ms": 26761.391, "load_time_ms": 6.966, "grad_time_ms": 13105.815, "update_time_ms": 8.013, "default": {"policy_loss": -0.01133770402520895, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6254236698150635, "total_loss": 64.25115966796875, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 64.25855255126953, "kl": 0.01755671389400959, "entropy": 1.3666353225708008}, "num_steps_sampled": 4179104}, "episodes_total": 2111, "done": false, "date": "2019-05-21_07-56-18", "time_total_s": 3196.422657728195, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbac50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbaeb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbaa90>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.4, "time_this_iter_s": 39.043861627578735, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558425378}
{"episode_reward_mean": 1143.7896916832067, "timesteps_total": 4229959, "iterations_since_restore": 73, "timesteps_since_restore": 4229959, "num_metric_batches_dropped": 0, "episode_reward_max": 1266.3386824360787, "custom_metrics": {"outflow_rate_min": 971.565139224412, "system_level_velocity_min": 11.157225345496517, "cost1_max": 446.056060719039, "system_level_velocity_max": 16.85531975207259, "cost2_min": -96.53297459400676, "outflow_rate_max": 1364.580682415349, "system_level_velocity_mean": 14.963554714149636, "cost1_mean": 394.90939126094565, "cost2_mean": -71.01629053889728, "outflow_rate_mean": 1216.0893184490888, "cost2_max": -50.70842844067258, "cost1_min": 288.3276738540685}, "policy_reward_mean": {}, "timesteps_this_iter": 50855, "training_iteration": 73, "node_ip": "10.138.0.2", "episode_reward_min": 969.3602392525365, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3235.1101582050323, "info": {"num_steps_trained": 4229959, "sample_time_ms": 26797.384, "load_time_ms": 6.722, "grad_time_ms": 12943.123, "update_time_ms": 8.005, "default": {"policy_loss": -0.011315657757222652, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5994950532913208, "total_loss": 64.9443359375, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 64.9516372680664, "kl": 0.017815666273236275, "entropy": 1.3730047941207886}, "num_steps_sampled": 4229959}, "episodes_total": 2142, "done": false, "date": "2019-05-21_07-56-57", "time_total_s": 3235.1101582050323, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc14e0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 38.68750047683716, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558425417}
{"episode_reward_mean": 1147.472616966309, "timesteps_total": 4282001, "iterations_since_restore": 74, "timesteps_since_restore": 4282001, "num_metric_batches_dropped": 0, "episode_reward_max": 1266.3386824360787, "custom_metrics": {"outflow_rate_min": 971.565139224412, "system_level_velocity_min": 11.157225345496517, "cost1_max": 446.056060719039, "system_level_velocity_max": 16.85531975207259, "cost2_min": -96.53297459400676, "outflow_rate_max": 1364.580682415349, "system_level_velocity_mean": 15.088869320539526, "cost1_mean": 398.5938276624948, "cost2_mean": -67.79212488039084, "outflow_rate_mean": 1218.5170520079112, "cost2_max": -49.41761132178266, "cost1_min": 288.3276738540685}, "policy_reward_mean": {}, "timesteps_this_iter": 52042, "training_iteration": 74, "node_ip": "10.138.0.2", "episode_reward_min": 961.9597797369116, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3273.8525924682617, "info": {"num_steps_trained": 4282001, "sample_time_ms": 26845.246, "load_time_ms": 6.484, "grad_time_ms": 12812.912, "update_time_ms": 7.915, "default": {"policy_loss": -0.011183550581336021, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5548698902130127, "total_loss": 62.54498291015625, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 62.5522575378418, "kl": 0.017361339181661606, "entropy": 1.3634754419326782}, "num_steps_sampled": 4282001}, "episodes_total": 2175, "done": false, "date": "2019-05-21_07-57-36", "time_total_s": 3273.8525924682617, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1438>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 38.74243426322937, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558425456}
{"episode_reward_mean": 1150.0470541672096, "timesteps_total": 4334454, "iterations_since_restore": 75, "timesteps_since_restore": 4334454, "num_metric_batches_dropped": 0, "episode_reward_max": 1254.1535005484045, "custom_metrics": {"outflow_rate_min": 971.565139224412, "system_level_velocity_min": 11.435762282515897, "cost1_max": 445.3592364920644, "system_level_velocity_max": 16.828928046943297, "cost2_min": -90.10954451011925, "outflow_rate_max": 1364.580682415349, "system_level_velocity_mean": 15.08077790495817, "cost1_mean": 398.58869572060996, "cost2_mean": -66.30119888602715, "outflow_rate_mean": 1219.4433501730182, "cost2_max": -47.51634683856078, "cost1_min": 297.4825388546682}, "policy_reward_mean": {}, "timesteps_this_iter": 52453, "training_iteration": 75, "node_ip": "10.138.0.2", "episode_reward_min": 961.9597797369116, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3311.916485309601, "info": {"num_steps_trained": 4334454, "sample_time_ms": 26600.858, "load_time_ms": 6.484, "grad_time_ms": 12883.121, "update_time_ms": 7.767, "default": {"policy_loss": -0.011383578181266785, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5985639691352844, "total_loss": 62.07505416870117, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 62.082645416259766, "kl": 0.01685483381152153, "entropy": 1.3762086629867554}, "num_steps_sampled": 4334454}, "episodes_total": 2206, "done": false, "date": "2019-05-21_07-58-14", "time_total_s": 3311.916485309601, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafc18>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 38.06389284133911, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558425494}
{"episode_reward_mean": 1152.2749324988308, "timesteps_total": 4385513, "iterations_since_restore": 76, "timesteps_since_restore": 4385513, "num_metric_batches_dropped": 0, "episode_reward_max": 1253.5733898350354, "custom_metrics": {"outflow_rate_min": 992.8344826336454, "system_level_velocity_min": 11.494160211156617, "cost1_max": 441.6706263039369, "system_level_velocity_max": 16.726737660205178, "cost2_min": -90.10954451011925, "outflow_rate_max": 1359.7142393035163, "system_level_velocity_mean": 15.1500877276386, "cost1_mean": 400.4574679197139, "cost2_mean": -64.2822992075051, "outflow_rate_mean": 1222.5274134200417, "cost2_max": -45.051039101206605, "cost1_min": 301.54650572068635}, "policy_reward_mean": {}, "timesteps_this_iter": 51059, "training_iteration": 76, "node_ip": "10.138.0.2", "episode_reward_min": 961.9597797369116, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3350.4238591194153, "info": {"num_steps_trained": 4385513, "sample_time_ms": 26213.316, "load_time_ms": 6.458, "grad_time_ms": 13077.898, "update_time_ms": 7.805, "default": {"policy_loss": -0.011271561495959759, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5374749302864075, "total_loss": 61.54952621459961, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 61.5566291809082, "kl": 0.018539682030677795, "entropy": 1.364434003829956}, "num_steps_sampled": 4385513}, "episodes_total": 2235, "done": false, "date": "2019-05-21_07-58-52", "time_total_s": 3350.4238591194153, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbaba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba588>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 38.50737380981445, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558425532}
{"episode_reward_mean": 1154.94779355408, "timesteps_total": 4437351, "iterations_since_restore": 77, "timesteps_since_restore": 4437351, "num_metric_batches_dropped": 0, "episode_reward_max": 1244.006385211153, "custom_metrics": {"outflow_rate_min": 992.8344826336454, "system_level_velocity_min": 11.494160211156617, "cost1_max": 443.5653402538945, "system_level_velocity_max": 16.854433142020262, "cost2_min": -90.10954451011925, "outflow_rate_max": 1359.7142393035163, "system_level_velocity_mean": 15.22426962940711, "cost1_mean": 402.29273549863535, "cost2_mean": -61.43043462143042, "outflow_rate_mean": 1224.1147358574385, "cost2_max": -39.810929008547596, "cost1_min": 301.78562554475775}, "policy_reward_mean": {}, "timesteps_this_iter": 51838, "training_iteration": 77, "node_ip": "10.138.0.2", "episode_reward_min": 984.4589074125815, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3390.1094110012054, "info": {"num_steps_trained": 4437351, "sample_time_ms": 26236.39, "load_time_ms": 6.114, "grad_time_ms": 13069.324, "update_time_ms": 7.998, "default": {"policy_loss": -0.011934558860957623, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5320972800254822, "total_loss": 66.8858413696289, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 66.89344024658203, "kl": 0.019272321835160255, "entropy": 1.3839830160140991}, "num_steps_sampled": 4437351}, "episodes_total": 2266, "done": false, "date": "2019-05-21_07-59-32", "time_total_s": 3390.1094110012054, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc16d8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 39.68555188179016, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558425572}
{"episode_reward_mean": 1154.0915056883025, "timesteps_total": 4489130, "iterations_since_restore": 78, "timesteps_since_restore": 4489130, "num_metric_batches_dropped": 0, "episode_reward_max": 1239.469345963525, "custom_metrics": {"outflow_rate_min": 992.8344826336454, "system_level_velocity_min": 11.494160211156617, "cost1_max": 443.5653402538945, "system_level_velocity_max": 16.854433142020262, "cost2_min": -90.10954451011925, "outflow_rate_max": 1341.459554261, "system_level_velocity_mean": 15.208677618379635, "cost1_mean": 401.6127240300317, "cost2_mean": -59.64634853555178, "outflow_rate_mean": 1224.9391158451117, "cost2_max": -34.92947906445239, "cost1_min": 301.78562554475775}, "policy_reward_mean": {}, "timesteps_this_iter": 51779, "training_iteration": 78, "node_ip": "10.138.0.2", "episode_reward_min": 975.4424628012092, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3428.997358083725, "info": {"num_steps_trained": 4489130, "sample_time_ms": 26349.931, "load_time_ms": 6.221, "grad_time_ms": 12837.575, "update_time_ms": 8.058, "default": {"policy_loss": -0.011557123623788357, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5512070655822754, "total_loss": 65.11839294433594, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 65.12591552734375, "kl": 0.01793232373893261, "entropy": 1.396517038345337}, "num_steps_sampled": 4489130}, "episodes_total": 2296, "done": false, "date": "2019-05-21_08-00-11", "time_total_s": 3428.997358083725, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc10b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1828>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 38.88794708251953, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558425611}
{"episode_reward_mean": 1153.360370449129, "timesteps_total": 4541675, "iterations_since_restore": 79, "timesteps_since_restore": 4541675, "num_metric_batches_dropped": 0, "episode_reward_max": 1239.469345963525, "custom_metrics": {"outflow_rate_min": 929.3796118887544, "system_level_velocity_min": 10.774678116596585, "cost1_max": 443.5653402538945, "system_level_velocity_max": 16.854433142020262, "cost2_min": -96.71145991908712, "outflow_rate_max": 1341.459554261, "system_level_velocity_mean": 15.163249305239392, "cost1_mean": 400.80591772561655, "cost2_mean": -58.44034528708252, "outflow_rate_mean": 1217.8210320778846, "cost2_max": -34.92947906445239, "cost1_min": 280.26557082020884}, "policy_reward_mean": {}, "timesteps_this_iter": 52545, "training_iteration": 79, "node_ip": "10.138.0.2", "episode_reward_min": 919.3223239256153, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3468.3820786476135, "info": {"num_steps_trained": 4541675, "sample_time_ms": 26443.78, "load_time_ms": 6.247, "grad_time_ms": 12785.497, "update_time_ms": 8.173, "default": {"policy_loss": -0.010687598027288914, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5567076802253723, "total_loss": 64.90210723876953, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 64.90869140625, "kl": 0.018235336989164352, "entropy": 1.4174785614013672}, "num_steps_sampled": 4541675}, "episodes_total": 2325, "done": false, "date": "2019-05-21_08-00-50", "time_total_s": 3468.3820786476135, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00da90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d208>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 39.38472056388855, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558425650}
{"episode_reward_mean": 1147.9505578255284, "timesteps_total": 4593600, "iterations_since_restore": 80, "timesteps_since_restore": 4593600, "num_metric_batches_dropped": 0, "episode_reward_max": 1232.312151101508, "custom_metrics": {"outflow_rate_min": 929.3796118887544, "system_level_velocity_min": 10.774678116596585, "cost1_max": 437.43441290227145, "system_level_velocity_max": 16.517487589516954, "cost2_min": -96.71145991908712, "outflow_rate_max": 1340.4257711305313, "system_level_velocity_mean": 14.990546940951084, "cost1_mean": 396.8377126503285, "cost2_mean": -57.40409672346125, "outflow_rate_mean": 1207.107324448912, "cost2_max": -34.92947906445239, "cost1_min": 280.26557082020884}, "policy_reward_mean": {}, "timesteps_this_iter": 51925, "training_iteration": 80, "node_ip": "10.138.0.2", "episode_reward_min": 919.3223239256153, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3507.75160074234, "info": {"num_steps_trained": 4593600, "sample_time_ms": 26332.454, "load_time_ms": 6.301, "grad_time_ms": 12743.264, "update_time_ms": 8.12, "default": {"policy_loss": -0.011340247467160225, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4900326132774353, "total_loss": 70.81239318847656, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 70.81968688964844, "kl": 0.017980705946683884, "entropy": 1.4191077947616577}, "num_steps_sampled": 4593600}, "episodes_total": 2358, "done": false, "date": "2019-05-21_08-01-30", "time_total_s": 3507.75160074234, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc10f0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 39.36952209472656, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558425690}
{"episode_reward_mean": 1140.9988685416447, "timesteps_total": 4645675, "iterations_since_restore": 81, "timesteps_since_restore": 4645675, "num_metric_batches_dropped": 0, "episode_reward_max": 1232.312151101508, "custom_metrics": {"outflow_rate_min": 929.3796118887544, "system_level_velocity_min": 10.774678116596585, "cost1_max": 440.8946246221516, "system_level_velocity_max": 16.63920073932994, "cost2_min": -96.71145991908712, "outflow_rate_max": 1312.0712397311424, "system_level_velocity_mean": 14.853378869222936, "cost1_mean": 393.6834043055652, "cost2_mean": -55.96048845267438, "outflow_rate_mean": 1190.9290571673305, "cost2_max": -37.929668292517846, "cost1_min": 280.26557082020884}, "policy_reward_mean": {}, "timesteps_this_iter": 52075, "training_iteration": 81, "node_ip": "10.138.0.2", "episode_reward_min": 900.8487884227438, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3546.3169684410095, "info": {"num_steps_trained": 4645675, "sample_time_ms": 25976.101, "load_time_ms": 6.249, "grad_time_ms": 12807.365, "update_time_ms": 8.027, "default": {"policy_loss": -0.012836465612053871, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5422021150588989, "total_loss": 64.90522766113281, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 64.91368103027344, "kl": 0.019510703161358833, "entropy": 1.4391469955444336}, "num_steps_sampled": 4645675}, "episodes_total": 2388, "done": false, "date": "2019-05-21_08-02-08", "time_total_s": 3546.3169684410095, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba860>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 38.565367698669434, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558425728}
{"episode_reward_mean": 1144.1555296095914, "timesteps_total": 4697559, "iterations_since_restore": 82, "timesteps_since_restore": 4697559, "num_metric_batches_dropped": 0, "episode_reward_max": 1232.312151101508, "custom_metrics": {"outflow_rate_min": 931.9509003765835, "system_level_velocity_min": 11.095526867416144, "cost1_max": 440.8946246221516, "system_level_velocity_max": 16.63920073932994, "cost2_min": -80.75718369989582, "outflow_rate_max": 1292.5724048006423, "system_level_velocity_mean": 14.9538268756075, "cost1_mean": 396.81579729481246, "cost2_mean": -54.258365123699384, "outflow_rate_mean": 1189.906073331769, "cost2_max": -36.30746387141374, "cost1_min": 291.6111410658559}, "policy_reward_mean": {}, "timesteps_this_iter": 51884, "training_iteration": 82, "node_ip": "10.138.0.2", "episode_reward_min": 900.8487884227438, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3587.069684743881, "info": {"num_steps_trained": 4697559, "sample_time_ms": 25960.235, "load_time_ms": 6.05, "grad_time_ms": 12993.586, "update_time_ms": 8.208, "default": {"policy_loss": -0.01137114129960537, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5261054635047913, "total_loss": 65.41227722167969, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 65.41954040527344, "kl": 0.01824234426021576, "entropy": 1.4435471296310425}, "num_steps_sampled": 4697559}, "episodes_total": 2422, "done": false, "date": "2019-05-21_08-02-49", "time_total_s": 3587.069684743881, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0165f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016cf8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 40.752716302871704, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558425769}
{"episode_reward_mean": 1138.2790879576694, "timesteps_total": 4749184, "iterations_since_restore": 83, "timesteps_since_restore": 4749184, "num_metric_batches_dropped": 0, "episode_reward_max": 1231.3677516980124, "custom_metrics": {"outflow_rate_min": 934.1180980134467, "system_level_velocity_min": 11.095526867416144, "cost1_max": 440.8946246221516, "system_level_velocity_max": 16.63920073932994, "cost2_min": -80.75718369989582, "outflow_rate_max": 1292.5724048006423, "system_level_velocity_mean": 14.907472232853474, "cost1_mean": 395.56796157672807, "cost2_mean": -54.70738171043223, "outflow_rate_mean": 1183.0459688404671, "cost2_max": -36.30746387141374, "cost1_min": 291.6111410658559}, "policy_reward_mean": {}, "timesteps_this_iter": 51625, "training_iteration": 83, "node_ip": "10.138.0.2", "episode_reward_min": 900.8487884227438, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3626.442015647888, "info": {"num_steps_trained": 4749184, "sample_time_ms": 26090.456, "load_time_ms": 6.273, "grad_time_ms": 12931.629, "update_time_ms": 8.477, "default": {"policy_loss": -0.01337859034538269, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.554844081401825, "total_loss": 60.18824005126953, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 60.197532653808594, "kl": 0.01814550720155239, "entropy": 1.4607274532318115}, "num_steps_sampled": 4749184}, "episodes_total": 2453, "done": false, "date": "2019-05-21_08-03-29", "time_total_s": 3626.442015647888, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0220f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022320>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 39.37233090400696, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558425809}
{"episode_reward_mean": 1133.7491953545277, "timesteps_total": 4799608, "iterations_since_restore": 84, "timesteps_since_restore": 4799608, "num_metric_batches_dropped": 0, "episode_reward_max": 1221.9175826927635, "custom_metrics": {"outflow_rate_min": 947.0201888653983, "system_level_velocity_min": 11.181831719614367, "cost1_max": 438.7820929255484, "system_level_velocity_max": 16.609600016370944, "cost2_min": -82.0601249315053, "outflow_rate_max": 1292.5724048006423, "system_level_velocity_mean": 14.94014311587496, "cost1_mean": 396.2466167752767, "cost2_mean": -54.780153255256, "outflow_rate_mean": 1183.5380468454607, "cost2_max": -32.454825722650355, "cost1_min": 293.52030137086507}, "policy_reward_mean": {}, "timesteps_this_iter": 50424, "training_iteration": 84, "node_ip": "10.138.0.2", "episode_reward_min": 918.8575255729572, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3664.295451402664, "info": {"num_steps_trained": 4799608, "sample_time_ms": 26154.16, "load_time_ms": 6.221, "grad_time_ms": 12778.701, "update_time_ms": 8.725, "default": {"policy_loss": -0.01251960452646017, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.45340800285339355, "total_loss": 70.31893920898438, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 70.32740783691406, "kl": 0.018015315756201744, "entropy": 1.453405737876892}, "num_steps_sampled": 4799608}, "episodes_total": 2486, "done": false, "date": "2019-05-21_08-04-07", "time_total_s": 3664.295451402664, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502eb8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 37.853435754776, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558425847}
{"episode_reward_mean": 1130.3100608379477, "timesteps_total": 4850045, "iterations_since_restore": 85, "timesteps_since_restore": 4850045, "num_metric_batches_dropped": 0, "episode_reward_max": 1221.9175826927635, "custom_metrics": {"outflow_rate_min": 947.0201888653983, "system_level_velocity_min": 11.181831719614367, "cost1_max": 438.7820929255484, "system_level_velocity_max": 16.609600016370944, "cost2_min": -82.0601249315053, "outflow_rate_max": 1272.1910724953436, "system_level_velocity_mean": 14.967818724149636, "cost1_mean": 396.86161185731527, "cost2_mean": -52.85033897626948, "outflow_rate_mean": 1178.0871009761393, "cost2_max": -32.454825722650355, "cost1_min": 293.52030137086507}, "policy_reward_mean": {}, "timesteps_this_iter": 50437, "training_iteration": 85, "node_ip": "10.138.0.2", "episode_reward_min": 918.8575255729572, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3702.1552155017853, "info": {"num_steps_trained": 4850045, "sample_time_ms": 25996.139, "load_time_ms": 6.073, "grad_time_ms": 12914.382, "update_time_ms": 8.564, "default": {"policy_loss": -0.01163309346884489, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.46352410316467285, "total_loss": 62.23661422729492, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 62.24399185180664, "kl": 0.018890907987952232, "entropy": 1.4616782665252686}, "num_steps_sampled": 4850045}, "episodes_total": 2516, "done": false, "date": "2019-05-21_08-04-44", "time_total_s": 3702.1552155017853, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0162e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0167b8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 37.859764099121094, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558425884}
{"episode_reward_mean": 1121.7408448437172, "timesteps_total": 4900778, "iterations_since_restore": 86, "timesteps_since_restore": 4900778, "num_metric_batches_dropped": 0, "episode_reward_max": 1219.2610125053275, "custom_metrics": {"outflow_rate_min": 947.0201888653983, "system_level_velocity_min": 11.181831719614367, "cost1_max": 437.4079228283932, "system_level_velocity_max": 16.54341835897816, "cost2_min": -82.0601249315053, "outflow_rate_max": 1258.0847522448198, "system_level_velocity_mean": 14.934655515155661, "cost1_mean": 395.7538806582863, "cost2_mean": -50.314617590868494, "outflow_rate_mean": 1165.9215768757058, "cost2_max": -31.5473689380865, "cost1_min": 293.52030137086507}, "policy_reward_mean": {}, "timesteps_this_iter": 50733, "training_iteration": 86, "node_ip": "10.138.0.2", "episode_reward_min": 918.8575255729572, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3740.642299890518, "info": {"num_steps_trained": 4900778, "sample_time_ms": 25918.311, "load_time_ms": 6.15, "grad_time_ms": 12989.068, "update_time_ms": 8.755, "default": {"policy_loss": -0.012405067682266235, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.45734336972236633, "total_loss": 63.9947624206543, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 64.00289154052734, "kl": 0.019019633531570435, "entropy": 1.4795979261398315}, "num_steps_sampled": 4900778}, "episodes_total": 2546, "done": false, "date": "2019-05-21_08-05-23", "time_total_s": 3740.642299890518, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbad30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbab00>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 38.48708438873291, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558425923}
{"episode_reward_mean": 1122.3165711039367, "timesteps_total": 4951354, "iterations_since_restore": 87, "timesteps_since_restore": 4951354, "num_metric_batches_dropped": 0, "episode_reward_max": 1219.2610125053275, "custom_metrics": {"outflow_rate_min": 923.6465365214541, "system_level_velocity_min": 11.181831719614367, "cost1_max": 437.4079228283932, "system_level_velocity_max": 16.54341835897816, "cost2_min": -82.0601249315053, "outflow_rate_max": 1258.0847522448198, "system_level_velocity_mean": 14.909426804260713, "cost1_mean": 395.18438903611417, "cost2_mean": -49.14420138052283, "outflow_rate_mean": 1161.317032956773, "cost2_max": -31.5473689380865, "cost1_min": 293.52030137086507}, "policy_reward_mean": {}, "timesteps_this_iter": 50576, "training_iteration": 87, "node_ip": "10.138.0.2", "episode_reward_min": 917.5415336520382, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3780.001493215561, "info": {"num_steps_trained": 4951354, "sample_time_ms": 25850.731, "load_time_ms": 6.253, "grad_time_ms": 13023.955, "update_time_ms": 8.882, "default": {"policy_loss": -0.012298050336539745, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.48881959915161133, "total_loss": 59.764705657958984, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 59.772918701171875, "kl": 0.018145252019166946, "entropy": 1.4684014320373535}, "num_steps_sampled": 4951354}, "episodes_total": 2576, "done": false, "date": "2019-05-21_08-06-02", "time_total_s": 3780.001493215561, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502898>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 39.359193325042725, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558425962}
{"episode_reward_mean": 1119.046797097472, "timesteps_total": 5001267, "iterations_since_restore": 88, "timesteps_since_restore": 5001267, "num_metric_batches_dropped": 0, "episode_reward_max": 1222.3705081016567, "custom_metrics": {"outflow_rate_min": 493.63113451374596, "system_level_velocity_min": 11.205085090175139, "cost1_max": 438.4163467974907, "system_level_velocity_max": 18.097158702196086, "cost2_min": -80.67511925185096, "outflow_rate_max": 1268.6179833478473, "system_level_velocity_mean": 15.062221578832819, "cost1_mean": 394.8306924133581, "cost2_mean": -47.149814313232255, "outflow_rate_mean": 1162.228117755113, "cost2_max": -16.33300226549206, "cost1_min": 24.45888387964366}, "policy_reward_mean": {}, "timesteps_this_iter": 49913, "training_iteration": 88, "node_ip": "10.138.0.2", "episode_reward_min": 61.75376635567209, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3818.338203430176, "info": {"num_steps_trained": 5001267, "sample_time_ms": 25797.3, "load_time_ms": 6.045, "grad_time_ms": 13023.002, "update_time_ms": 8.945, "default": {"policy_loss": -0.010547718964517117, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.32778313755989075, "total_loss": 72.53731536865234, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 72.54351806640625, "kl": 0.019257454201579094, "entropy": 1.4584053754806519}, "num_steps_sampled": 5001267}, "episodes_total": 2608, "done": false, "date": "2019-05-21_08-06-41", "time_total_s": 3818.338203430176, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016a20>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.38, "time_this_iter_s": 38.33671021461487, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558426001}
{"episode_reward_mean": 1123.6487508287519, "timesteps_total": 5051871, "iterations_since_restore": 89, "timesteps_since_restore": 5051871, "num_metric_batches_dropped": 0, "episode_reward_max": 1232.5425733541776, "custom_metrics": {"outflow_rate_min": 493.63113451374596, "system_level_velocity_min": 11.205085090175139, "cost1_max": 441.6333095032324, "system_level_velocity_max": 18.097158702196086, "cost2_min": -70.69353443251485, "outflow_rate_max": 1281.1643644298963, "system_level_velocity_mean": 15.15492509406432, "cost1_mean": 397.1461064406243, "cost2_mean": -47.447234697649684, "outflow_rate_mean": 1171.4719142441222, "cost2_max": -16.33300226549206, "cost1_min": 24.45888387964366}, "policy_reward_mean": {}, "timesteps_this_iter": 50604, "training_iteration": 89, "node_ip": "10.138.0.2", "episode_reward_min": 61.75376635567209, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3856.2349421977997, "info": {"num_steps_trained": 5051871, "sample_time_ms": 25730.049, "load_time_ms": 5.697, "grad_time_ms": 12940.596, "update_time_ms": 9.104, "default": {"policy_loss": -0.010188493877649307, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.45566052198410034, "total_loss": 58.925575256347656, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 58.93183898925781, "kl": 0.0174484234303236, "entropy": 1.462968349456787}, "num_steps_sampled": 5051871}, "episodes_total": 2637, "done": false, "date": "2019-05-21_08-07-19", "time_total_s": 3856.2349421977997, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba550>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.38, "time_this_iter_s": 37.8967387676239, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558426039}
{"episode_reward_mean": 1126.4859253596348, "timesteps_total": 5101599, "iterations_since_restore": 90, "timesteps_since_restore": 5101599, "num_metric_batches_dropped": 0, "episode_reward_max": 1232.5425733541776, "custom_metrics": {"outflow_rate_min": 493.63113451374596, "system_level_velocity_min": 11.370153242362102, "cost1_max": 441.6333095032324, "system_level_velocity_max": 18.097158702196086, "cost2_min": -75.53896573328693, "outflow_rate_max": 1281.1643644298963, "system_level_velocity_mean": 15.212034390764561, "cost1_mean": 398.4842901166637, "cost2_mean": -48.739654304616934, "outflow_rate_mean": 1181.2188643393192, "cost2_max": -16.33300226549206, "cost1_min": 24.45888387964366}, "policy_reward_mean": {}, "timesteps_this_iter": 49728, "training_iteration": 90, "node_ip": "10.138.0.2", "episode_reward_min": 61.75376635567209, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3893.873907327652, "info": {"num_steps_trained": 5101599, "sample_time_ms": 25756.541, "load_time_ms": 5.276, "grad_time_ms": 12744.687, "update_time_ms": 9.179, "default": {"policy_loss": -0.012273037806153297, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4198251962661743, "total_loss": 68.71746826171875, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 68.72562408447266, "kl": 0.018309226259589195, "entropy": 1.4433696269989014}, "num_steps_sampled": 5101599}, "episodes_total": 2669, "done": false, "date": "2019-05-21_08-07-56", "time_total_s": 3893.873907327652, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c031b38>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.38, "time_this_iter_s": 37.638965129852295, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558426076}
{"episode_reward_mean": 1128.6119830656257, "timesteps_total": 5150465, "iterations_since_restore": 91, "timesteps_since_restore": 5150465, "num_metric_batches_dropped": 0, "episode_reward_max": 1232.5425733541776, "custom_metrics": {"outflow_rate_min": 925.4221885429461, "system_level_velocity_min": 11.370153242362102, "cost1_max": 441.6333095032324, "system_level_velocity_max": 17.240110800452275, "cost2_min": -75.53896573328693, "outflow_rate_max": 1296.8255628135453, "system_level_velocity_mean": 15.291398277538095, "cost1_mean": 401.3716813303318, "cost2_mean": -49.45705243747007, "outflow_rate_mean": 1192.8452231332972, "cost2_max": -25.936166362516854, "cost1_min": 133.0793151986789}, "policy_reward_mean": {}, "timesteps_this_iter": 48866, "training_iteration": 91, "node_ip": "10.138.0.2", "episode_reward_min": 335.15698188744494, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3931.2751994132996, "info": {"num_steps_trained": 5150465, "sample_time_ms": 25994.065, "load_time_ms": 5.185, "grad_time_ms": 12394.249, "update_time_ms": 9.015, "default": {"policy_loss": -0.011837048456072807, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3085894286632538, "total_loss": 73.32315063476562, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 73.33069610595703, "kl": 0.019078411161899567, "entropy": 1.4369139671325684}, "num_steps_sampled": 5150465}, "episodes_total": 2702, "done": false, "date": "2019-05-21_08-08-34", "time_total_s": 3931.2751994132996, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016a20>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.07, "time_this_iter_s": 37.40129208564758, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558426114}
{"episode_reward_mean": 1110.9554148213167, "timesteps_total": 5199130, "iterations_since_restore": 92, "timesteps_since_restore": 5199130, "num_metric_batches_dropped": 0, "episode_reward_max": 1226.2128380307465, "custom_metrics": {"outflow_rate_min": 501.5345766397923, "system_level_velocity_min": 11.370153242362102, "cost1_max": 437.5221277238655, "system_level_velocity_max": 18.611118843906123, "cost2_min": -75.53896573328693, "outflow_rate_max": 1296.8255628135453, "system_level_velocity_mean": 15.355720517670719, "cost1_mean": 397.6516980948778, "cost2_mean": -49.9355937895795, "outflow_rate_mean": 1183.5692268549406, "cost2_max": -18.7291173071816, "cost1_min": 24.24905938454048}, "policy_reward_mean": {}, "timesteps_this_iter": 48665, "training_iteration": 92, "node_ip": "10.138.0.2", "episode_reward_min": 58.76543439289793, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 3968.615283727646, "info": {"num_steps_trained": 5199130, "sample_time_ms": 25759.397, "load_time_ms": 5.234, "grad_time_ms": 12287.746, "update_time_ms": 8.702, "default": {"policy_loss": -0.01006416417658329, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3853236436843872, "total_loss": 68.40367126464844, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 68.41007232666016, "kl": 0.0162779800593853, "entropy": 1.4392104148864746}, "num_steps_sampled": 5199130}, "episodes_total": 2736, "done": false, "date": "2019-05-21_08-09-11", "time_total_s": 3968.615283727646, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1f28>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.44, "time_this_iter_s": 37.34008431434631, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558426151}
{"episode_reward_mean": 1105.6568584212596, "timesteps_total": 5247117, "iterations_since_restore": 93, "timesteps_since_restore": 5247117, "num_metric_batches_dropped": 0, "episode_reward_max": 1226.2128380307465, "custom_metrics": {"outflow_rate_min": 501.5345766397923, "system_level_velocity_min": 11.232418843703872, "cost1_max": 439.42836372409585, "system_level_velocity_max": 18.611118843906123, "cost2_min": -71.3622939172605, "outflow_rate_max": 1296.8255628135453, "system_level_velocity_mean": 15.457918354812273, "cost1_mean": 399.7264980369484, "cost2_mean": -48.13964294865287, "outflow_rate_mean": 1178.5009320893587, "cost2_max": -18.7291173071816, "cost1_min": 24.24905938454048}, "policy_reward_mean": {}, "timesteps_this_iter": 47987, "training_iteration": 93, "node_ip": "10.138.0.2", "episode_reward_min": 58.76543439289793, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4006.3076524734497, "info": {"num_steps_trained": 5247117, "sample_time_ms": 25378.24, "load_time_ms": 5.141, "grad_time_ms": 12500.039, "update_time_ms": 8.481, "default": {"policy_loss": -0.0102992570027709, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3823048770427704, "total_loss": 63.21219253540039, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 63.21852111816406, "kl": 0.017640935257077217, "entropy": 1.4340497255325317}, "num_steps_sampled": 5247117}, "episodes_total": 2766, "done": false, "date": "2019-05-21_08-09-49", "time_total_s": 4006.3076524734497, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0220f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0229b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022240>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.44, "time_this_iter_s": 37.69236874580383, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558426189}
{"episode_reward_mean": 1107.3196809076123, "timesteps_total": 5295824, "iterations_since_restore": 94, "timesteps_since_restore": 5295824, "num_metric_batches_dropped": 0, "episode_reward_max": 1208.7915894797868, "custom_metrics": {"outflow_rate_min": 501.5345766397923, "system_level_velocity_min": 11.232418843703872, "cost1_max": 440.35183411494893, "system_level_velocity_max": 18.611118843906123, "cost2_min": -71.3622939172605, "outflow_rate_max": 1275.735232195742, "system_level_velocity_mean": 15.534490677665628, "cost1_mean": 404.37031776661576, "cost2_mean": -46.565807059992004, "outflow_rate_mean": 1173.8638033834661, "cost2_max": -18.7291173071816, "cost1_min": 24.24905938454048}, "policy_reward_mean": {}, "timesteps_this_iter": 48707, "training_iteration": 94, "node_ip": "10.138.0.2", "episode_reward_min": 58.76543439289793, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4042.304276943207, "info": {"num_steps_trained": 5295824, "sample_time_ms": 25057.271, "load_time_ms": 5.257, "grad_time_ms": 12633.855, "update_time_ms": 8.223, "default": {"policy_loss": -0.01209832914173603, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.41726651787757874, "total_loss": 61.711585998535156, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 61.7197265625, "kl": 0.017611617222428322, "entropy": 1.4371328353881836}, "num_steps_sampled": 5295824}, "episodes_total": 2796, "done": false, "date": "2019-05-21_08-10-25", "time_total_s": 4042.304276943207, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00db38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018ef0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.37, "time_this_iter_s": 35.99662446975708, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558426225}
{"episode_reward_mean": 1115.9941162898308, "timesteps_total": 5344288, "iterations_since_restore": 95, "timesteps_since_restore": 5344288, "num_metric_batches_dropped": 0, "episode_reward_max": 1208.7915894797868, "custom_metrics": {"outflow_rate_min": 955.0810158730161, "system_level_velocity_min": 11.232418843703872, "cost1_max": 442.1220355198103, "system_level_velocity_max": 16.85098217514099, "cost2_min": -71.3622939172605, "outflow_rate_max": 1275.735232195742, "system_level_velocity_mean": 15.51309671722105, "cost1_mean": 408.2689812810864, "cost2_mean": -45.90592027260297, "outflow_rate_mean": 1177.5192252347288, "cost2_max": -33.00330632405242, "cost1_min": 297.21391024075035}, "policy_reward_mean": {}, "timesteps_this_iter": 48464, "training_iteration": 95, "node_ip": "10.138.0.2", "episode_reward_min": 898.3380946400013, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4079.743548631668, "info": {"num_steps_trained": 5344288, "sample_time_ms": 25311.437, "load_time_ms": 5.149, "grad_time_ms": 12341.166, "update_time_ms": 8.357, "default": {"policy_loss": -0.011485225521028042, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4562205970287323, "total_loss": 61.785987854003906, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 61.79386901855469, "kl": 0.01602702960371971, "entropy": 1.4465786218643188}, "num_steps_sampled": 5344288}, "episodes_total": 2829, "done": false, "date": "2019-05-21_08-11-03", "time_total_s": 4079.743548631668, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00de10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d6a0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 37.439271688461304, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558426263}
{"episode_reward_mean": 1100.2918482864434, "timesteps_total": 5392560, "iterations_since_restore": 96, "timesteps_since_restore": 5392560, "num_metric_batches_dropped": 0, "episode_reward_max": 1208.7915894797868, "custom_metrics": {"outflow_rate_min": 496.2871102902245, "system_level_velocity_min": 12.485439596535736, "cost1_max": 442.1220355198103, "system_level_velocity_max": 18.669815924742043, "cost2_min": -70.52227229954698, "outflow_rate_max": 1275.735232195742, "system_level_velocity_mean": 15.610007713712587, "cost1_mean": 402.7808469077616, "cost2_mean": -45.619859561037494, "outflow_rate_mean": 1172.6407371947798, "cost2_max": -18.11281985331396, "cost1_min": 24.411802173587624}, "policy_reward_mean": {}, "timesteps_this_iter": 48272, "training_iteration": 96, "node_ip": "10.138.0.2", "episode_reward_min": 59.97908005316296, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4117.816204547882, "info": {"num_steps_trained": 5392560, "sample_time_ms": 25575.975, "load_time_ms": 5.072, "grad_time_ms": 12037.337, "update_time_ms": 8.092, "default": {"policy_loss": -0.013662186451256275, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.36729317903518677, "total_loss": 69.10906982421875, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 69.11821746826172, "kl": 0.02005932852625847, "entropy": 1.450862169265747}, "num_steps_sampled": 5392560}, "episodes_total": 2862, "done": false, "date": "2019-05-21_08-11-41", "time_total_s": 4117.816204547882, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba588>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.44, "time_this_iter_s": 38.07265591621399, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558426301}
{"episode_reward_mean": 1097.93117062463, "timesteps_total": 5441626, "iterations_since_restore": 97, "timesteps_since_restore": 5441626, "num_metric_batches_dropped": 0, "episode_reward_max": 1221.0970910970725, "custom_metrics": {"outflow_rate_min": 496.2871102902245, "system_level_velocity_min": 12.485439596535736, "cost1_max": 442.1220355198103, "system_level_velocity_max": 18.669815924742043, "cost2_min": -70.52227229954698, "outflow_rate_max": 1282.7267132867134, "system_level_velocity_mean": 15.563575325694078, "cost1_mean": 401.34190412180857, "cost2_mean": -45.38796088353501, "outflow_rate_mean": 1167.4766725440682, "cost2_max": -18.11281985331396, "cost1_min": 24.411802173587624}, "policy_reward_mean": {}, "timesteps_this_iter": 49066, "training_iteration": 97, "node_ip": "10.138.0.2", "episode_reward_min": 59.97908005316296, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4154.311626434326, "info": {"num_steps_trained": 5441626, "sample_time_ms": 25260.434, "load_time_ms": 5.039, "grad_time_ms": 12065.17, "update_time_ms": 7.926, "default": {"policy_loss": -0.012688592076301575, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3946457505226135, "total_loss": 66.54590606689453, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 66.55331420898438, "kl": 0.015634208917617798, "entropy": 1.4681063890457153}, "num_steps_sampled": 5441626}, "episodes_total": 2893, "done": false, "date": "2019-05-21_08-12-17", "time_total_s": 4154.311626434326, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0037f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003780>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.44, "time_this_iter_s": 36.49542188644409, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558426337}
{"episode_reward_mean": 1103.4217453381593, "timesteps_total": 5490597, "iterations_since_restore": 98, "timesteps_since_restore": 5490597, "num_metric_batches_dropped": 0, "episode_reward_max": 1222.0458656716653, "custom_metrics": {"outflow_rate_min": 496.2871102902245, "system_level_velocity_min": 12.5368806064439, "cost1_max": 445.2371524480668, "system_level_velocity_max": 18.669815924742043, "cost2_min": -62.89978007384036, "outflow_rate_max": 1287.3726722001986, "system_level_velocity_mean": 15.636198111057109, "cost1_mean": 403.04188423307176, "cost2_mean": -44.95238010259804, "outflow_rate_mean": 1169.2909629190078, "cost2_max": -18.11281985331396, "cost1_min": 24.411802173587624}, "policy_reward_mean": {}, "timesteps_this_iter": 48971, "training_iteration": 98, "node_ip": "10.138.0.2", "episode_reward_min": 59.97908005316296, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4190.981925010681, "info": {"num_steps_trained": 5490597, "sample_time_ms": 24921.203, "load_time_ms": 4.996, "grad_time_ms": 12237.623, "update_time_ms": 8.081, "default": {"policy_loss": -0.012134076096117496, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.421382874250412, "total_loss": 61.728111267089844, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 61.73537826538086, "kl": 0.014438746497035027, "entropy": 1.4477204084396362}, "num_steps_sampled": 5490597}, "episodes_total": 2923, "done": false, "date": "2019-05-21_08-12-54", "time_total_s": 4190.981925010681, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0186a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018ef0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.44, "time_this_iter_s": 36.67029857635498, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558426374}
{"episode_reward_mean": 1119.897764712045, "timesteps_total": 5538968, "iterations_since_restore": 99, "timesteps_since_restore": 5538968, "num_metric_batches_dropped": 0, "episode_reward_max": 1222.0458656716653, "custom_metrics": {"outflow_rate_min": 947.172068298218, "system_level_velocity_min": 12.084242336750473, "cost1_max": 445.2371524480668, "system_level_velocity_max": 17.362279859058415, "cost2_min": -62.89978007384036, "outflow_rate_max": 1287.3726722001986, "system_level_velocity_mean": 15.708298893991731, "cost1_mean": 409.3785890499187, "cost2_mean": -44.83208181676084, "outflow_rate_mean": 1184.10093900683, "cost2_max": -29.597404557516683, "cost1_min": 133.63375728697315}, "policy_reward_mean": {}, "timesteps_this_iter": 48371, "training_iteration": 99, "node_ip": "10.138.0.2", "episode_reward_min": 342.39212081789674, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4228.415734052658, "info": {"num_steps_trained": 5538968, "sample_time_ms": 24891.049, "load_time_ms": 4.994, "grad_time_ms": 12216.421, "update_time_ms": 7.916, "default": {"policy_loss": -0.01157163456082344, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.44280731678009033, "total_loss": 56.61648941040039, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 56.62319564819336, "kl": 0.01441712211817503, "entropy": 1.4443187713623047}, "num_steps_sampled": 5538968}, "episodes_total": 2952, "done": false, "date": "2019-05-21_08-13-31", "time_total_s": 4228.415734052658, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbac18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba2b0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.07, "time_this_iter_s": 37.43380904197693, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558426411}
{"episode_reward_mean": 1124.7517178078872, "timesteps_total": 5587905, "iterations_since_restore": 100, "timesteps_since_restore": 5587905, "num_metric_batches_dropped": 0, "episode_reward_max": 1223.1076180359482, "custom_metrics": {"outflow_rate_min": 945.8538982630274, "system_level_velocity_min": 11.802635681477152, "cost1_max": 446.0260790623414, "system_level_velocity_max": 17.0101564346689, "cost2_min": -62.89978007384036, "outflow_rate_max": 1294.269230769231, "system_level_velocity_mean": 15.659185579218605, "cost1_mean": 411.06476911360573, "cost2_mean": -45.58536184240424, "outflow_rate_mean": 1183.8394632157074, "cost2_max": -33.51841075865957, "cost1_min": 313.9318045255012}, "policy_reward_mean": {}, "timesteps_this_iter": 48937, "training_iteration": 100, "node_ip": "10.138.0.2", "episode_reward_min": 926.8687506305805, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4265.791512489319, "info": {"num_steps_trained": 5587905, "sample_time_ms": 24851.409, "load_time_ms": 5.01, "grad_time_ms": 12227.891, "update_time_ms": 9.789, "default": {"policy_loss": -0.011257189325988293, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.41651198267936707, "total_loss": 63.702754974365234, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 63.709251403808594, "kl": 0.014103475026786327, "entropy": 1.460292100906372}, "num_steps_sampled": 5587905}, "episodes_total": 2981, "done": false, "date": "2019-05-21_08-14-09", "time_total_s": 4265.791512489319, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d780>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 37.37577843666077, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558426449}
{"episode_reward_mean": 1124.0108836807185, "timesteps_total": 5636909, "iterations_since_restore": 101, "timesteps_since_restore": 5636909, "num_metric_batches_dropped": 0, "episode_reward_max": 1223.1076180359482, "custom_metrics": {"outflow_rate_min": 945.8538982630274, "system_level_velocity_min": 11.802635681477152, "cost1_max": 446.0260790623414, "system_level_velocity_max": 17.09106723735746, "cost2_min": -61.31640638409364, "outflow_rate_max": 1294.269230769231, "system_level_velocity_mean": 15.656914030302486, "cost1_mean": 410.5228473763835, "cost2_mean": -45.78602982025947, "outflow_rate_mean": 1187.5643759414834, "cost2_max": -33.51841075865957, "cost1_min": 313.09142986329704}, "policy_reward_mean": {}, "timesteps_this_iter": 49004, "training_iteration": 101, "node_ip": "10.138.0.2", "episode_reward_min": 922.3531726288694, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4306.994373083115, "info": {"num_steps_trained": 5636909, "sample_time_ms": 24741.984, "load_time_ms": 4.67, "grad_time_ms": 12716.636, "update_time_ms": 9.763, "default": {"policy_loss": -0.012394689954817295, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.41570916771888733, "total_loss": 71.10552978515625, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 71.11312866210938, "kl": 0.014215539209544659, "entropy": 1.482923150062561}, "num_steps_sampled": 5636909}, "episodes_total": 3015, "done": false, "date": "2019-05-21_08-14-50", "time_total_s": 4306.994373083115, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022898>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 699.57, "time_this_iter_s": 41.202860593795776, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558426490}
{"episode_reward_mean": 1115.2383895248918, "timesteps_total": 5685857, "iterations_since_restore": 102, "timesteps_since_restore": 5685857, "num_metric_batches_dropped": 0, "episode_reward_max": 1226.7575534529235, "custom_metrics": {"outflow_rate_min": 945.8538982630274, "system_level_velocity_min": 11.802635681477152, "cost1_max": 447.6642834521914, "system_level_velocity_max": 17.12569568208539, "cost2_min": -63.148052765128725, "outflow_rate_max": 1330.4040885978113, "system_level_velocity_mean": 15.508521178748538, "cost1_mean": 405.72644251071836, "cost2_mean": -46.29261110467678, "outflow_rate_mean": 1180.508608792808, "cost2_max": -34.23795189641838, "cost1_min": 313.09142986329704}, "policy_reward_mean": {}, "timesteps_this_iter": 48948, "training_iteration": 102, "node_ip": "10.138.0.2", "episode_reward_min": 922.3531726288694, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4343.381313323975, "info": {"num_steps_trained": 5685857, "sample_time_ms": 24692.533, "load_time_ms": 4.347, "grad_time_ms": 12671.869, "update_time_ms": 9.886, "default": {"policy_loss": -0.010654104873538017, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4215855598449707, "total_loss": 65.53633117675781, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 65.54234313964844, "kl": 0.013766922056674957, "entropy": 1.4842159748077393}, "num_steps_sampled": 5685857}, "episodes_total": 3048, "done": false, "date": "2019-05-21_08-15-26", "time_total_s": 4343.381313323975, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0035c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafe80>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 698.34, "time_this_iter_s": 36.386940240859985, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558426526}
{"episode_reward_mean": 1107.7398085845139, "timesteps_total": 5734790, "iterations_since_restore": 103, "timesteps_since_restore": 5734790, "num_metric_batches_dropped": 0, "episode_reward_max": 1226.7575534529235, "custom_metrics": {"outflow_rate_min": 939.5158678909955, "system_level_velocity_min": 11.941158890598249, "cost1_max": 447.6642834521914, "system_level_velocity_max": 17.12569568208539, "cost2_min": -63.148052765128725, "outflow_rate_max": 1330.4040885978113, "system_level_velocity_mean": 15.382472707347159, "cost1_mean": 402.25964842784816, "cost2_mean": -46.3111182555434, "outflow_rate_mean": 1174.6539352488005, "cost2_max": -34.23795189641838, "cost1_min": 313.09142986329704}, "policy_reward_mean": {}, "timesteps_this_iter": 48933, "training_iteration": 103, "node_ip": "10.138.0.2", "episode_reward_min": 922.3531726288694, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4381.948785543442, "info": {"num_steps_trained": 5734790, "sample_time_ms": 25034.61, "load_time_ms": 3.96, "grad_time_ms": 12419.362, "update_time_ms": 9.905, "default": {"policy_loss": -0.011183347553014755, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.40212732553482056, "total_loss": 63.612464904785156, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 63.61903381347656, "kl": 0.013666023500263691, "entropy": 1.4756070375442505}, "num_steps_sampled": 5734790}, "episodes_total": 3078, "done": false, "date": "2019-05-21_08-16-05", "time_total_s": 4381.948785543442, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc75f8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 698.34, "time_this_iter_s": 38.56747221946716, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558426565}
{"episode_reward_mean": 1102.5793011248854, "timesteps_total": 5783234, "iterations_since_restore": 104, "timesteps_since_restore": 5783234, "num_metric_batches_dropped": 0, "episode_reward_max": 1226.7575534529235, "custom_metrics": {"outflow_rate_min": 939.5158678909955, "system_level_velocity_min": 12.12028778692708, "cost1_max": 447.6642834521914, "system_level_velocity_max": 17.12569568208539, "cost2_min": -63.148052765128725, "outflow_rate_max": 1330.4040885978113, "system_level_velocity_mean": 15.264440944475702, "cost1_mean": 399.31357707665273, "cost2_mean": -45.822254984756775, "outflow_rate_mean": 1168.7087666847383, "cost2_max": -33.63068948614088, "cost1_min": 318.3674914126853}, "policy_reward_mean": {}, "timesteps_this_iter": 48444, "training_iteration": 104, "node_ip": "10.138.0.2", "episode_reward_min": 894.8724911785042, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4420.398626089096, "info": {"num_steps_trained": 5783234, "sample_time_ms": 25363.144, "load_time_ms": 3.802, "grad_time_ms": 12338.378, "update_time_ms": 9.945, "default": {"policy_loss": -0.010797097347676754, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.40370243787765503, "total_loss": 65.22660064697266, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 65.23200988769531, "kl": 0.015979884192347527, "entropy": 1.4871667623519897}, "num_steps_sampled": 5783234}, "episodes_total": 3111, "done": false, "date": "2019-05-21_08-16-44", "time_total_s": 4420.398626089096, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022fd0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 698.77, "time_this_iter_s": 38.4498405456543, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558426604}
{"episode_reward_mean": 1078.6556268885347, "timesteps_total": 5831179, "iterations_since_restore": 105, "timesteps_since_restore": 5831179, "num_metric_batches_dropped": 0, "episode_reward_max": 1214.900359401756, "custom_metrics": {"outflow_rate_min": 476.3371715798777, "system_level_velocity_min": 12.12028778692708, "cost1_max": 446.29627457668585, "system_level_velocity_max": 18.726247999926105, "cost2_min": -61.856817019285614, "outflow_rate_max": 1307.1354927810858, "system_level_velocity_mean": 15.390253997237256, "cost1_mean": 392.115783417751, "cost2_mean": -45.077474824063735, "outflow_rate_mean": 1158.581012813325, "cost2_max": -19.3206695228549, "cost1_min": 23.08864916161823}, "policy_reward_mean": {}, "timesteps_this_iter": 47945, "training_iteration": 105, "node_ip": "10.138.0.2", "episode_reward_min": 52.72062147042582, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4457.448605298996, "info": {"num_steps_trained": 5831179, "sample_time_ms": 25164.457, "load_time_ms": 3.852, "grad_time_ms": 12495.787, "update_time_ms": 9.914, "default": {"policy_loss": -0.01053022313863039, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.31998735666275024, "total_loss": 72.20587158203125, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 72.2114486694336, "kl": 0.01467282883822918, "entropy": 1.4642664194107056}, "num_steps_sampled": 5831179}, "episodes_total": 3146, "done": false, "date": "2019-05-21_08-17-21", "time_total_s": 4457.448605298996, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafb38>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 683.59, "time_this_iter_s": 37.0499792098999, "hostname": "flow-main", "episodes_this_iter": 35, "timestamp": 1558426641}
{"episode_reward_mean": 1080.5416120600883, "timesteps_total": 5879499, "iterations_since_restore": 106, "timesteps_since_restore": 5879499, "num_metric_batches_dropped": 0, "episode_reward_max": 1212.9888669287895, "custom_metrics": {"outflow_rate_min": 476.3371715798777, "system_level_velocity_min": 12.269984058915563, "cost1_max": 450.8974019995077, "system_level_velocity_max": 18.726247999926105, "cost2_min": -61.6145158341217, "outflow_rate_max": 1296.8626490942086, "system_level_velocity_mean": 15.495359878589586, "cost1_mean": 394.5411747264961, "cost2_mean": -44.08575710594268, "outflow_rate_mean": 1160.9195241079049, "cost2_max": -19.3206695228549, "cost1_min": 23.08864916161823}, "policy_reward_mean": {}, "timesteps_this_iter": 48320, "training_iteration": 106, "node_ip": "10.138.0.2", "episode_reward_min": 52.72062147042582, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4493.615842580795, "info": {"num_steps_trained": 5879499, "sample_time_ms": 24702.55, "load_time_ms": 3.831, "grad_time_ms": 12766.375, "update_time_ms": 10.011, "default": {"policy_loss": -0.012781203724443913, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.48493078351020813, "total_loss": 52.84177780151367, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 52.84925079345703, "kl": 0.015711136162281036, "entropy": 1.4897832870483398}, "num_steps_sampled": 5879499}, "episodes_total": 3175, "done": false, "date": "2019-05-21_08-17-57", "time_total_s": 4493.615842580795, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc71d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7438>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 683.59, "time_this_iter_s": 36.167237281799316, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558426677}
{"episode_reward_mean": 1081.0181387803557, "timesteps_total": 5926987, "iterations_since_restore": 107, "timesteps_since_restore": 5926987, "num_metric_batches_dropped": 0, "episode_reward_max": 1212.9888669287895, "custom_metrics": {"outflow_rate_min": 476.3371715798777, "system_level_velocity_min": 12.501974707661555, "cost1_max": 450.8974019995077, "system_level_velocity_max": 18.726247999926105, "cost2_min": -61.6145158341217, "outflow_rate_max": 1296.8626490942086, "system_level_velocity_mean": 15.648470387326295, "cost1_mean": 398.246403948735, "cost2_mean": -43.59539826662555, "outflow_rate_mean": 1160.015129302806, "cost2_max": -19.3206695228549, "cost1_min": 23.08864916161823}, "policy_reward_mean": {}, "timesteps_this_iter": 47488, "training_iteration": 107, "node_ip": "10.138.0.2", "episode_reward_min": 52.72062147042582, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4529.718531131744, "info": {"num_steps_trained": 5926987, "sample_time_ms": 24762.466, "load_time_ms": 3.791, "grad_time_ms": 12668.013, "update_time_ms": 10.265, "default": {"policy_loss": -0.011699480935931206, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.36240676045417786, "total_loss": 63.99767303466797, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 64.00444030761719, "kl": 0.014590154401957989, "entropy": 1.4966797828674316}, "num_steps_sampled": 5926987}, "episodes_total": 3204, "done": false, "date": "2019-05-21_08-18-33", "time_total_s": 4529.718531131744, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafc18>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 683.59, "time_this_iter_s": 36.1026885509491, "hostname": "flow-main", "episodes_this_iter": 29, "timestamp": 1558426713}
{"episode_reward_mean": 1083.3452940731129, "timesteps_total": 5974709, "iterations_since_restore": 108, "timesteps_since_restore": 5974709, "num_metric_batches_dropped": 0, "episode_reward_max": 1212.9888669287895, "custom_metrics": {"outflow_rate_min": 476.3371715798777, "system_level_velocity_min": 12.413558775966152, "cost1_max": 450.8974019995077, "system_level_velocity_max": 18.279853986793285, "cost2_min": -63.40157681916497, "outflow_rate_max": 1296.8626490942086, "system_level_velocity_mean": 15.729567039120905, "cost1_mean": 400.1615329552033, "cost2_mean": -43.22030566933033, "outflow_rate_mean": 1164.625656010601, "cost2_max": -21.13682609855758, "cost1_min": 24.15750220408476}, "policy_reward_mean": {}, "timesteps_this_iter": 47722, "training_iteration": 108, "node_ip": "10.138.0.2", "episode_reward_min": 58.298174830943665, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4567.293819904327, "info": {"num_steps_trained": 5974709, "sample_time_ms": 25067.567, "load_time_ms": 3.857, "grad_time_ms": 12453.281, "update_time_ms": 10.15, "default": {"policy_loss": -0.009213066659867764, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3110506534576416, "total_loss": 71.15242004394531, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 71.15734100341797, "kl": 0.012707343325018883, "entropy": 1.4896252155303955}, "num_steps_sampled": 5974709}, "episodes_total": 3237, "done": false, "date": "2019-05-21_08-19-11", "time_total_s": 4567.293819904327, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc78d0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 683.62, "time_this_iter_s": 37.57528877258301, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558426751}
{"episode_reward_mean": 1098.442102177502, "timesteps_total": 6022301, "iterations_since_restore": 109, "timesteps_since_restore": 6022301, "num_metric_batches_dropped": 0, "episode_reward_max": 1206.1524755922328, "custom_metrics": {"outflow_rate_min": 945.0273589156475, "system_level_velocity_min": 12.413558775966152, "cost1_max": 444.68986722979264, "system_level_velocity_max": 17.46360240623745, "cost2_min": -63.40157681916497, "outflow_rate_max": 1289.0228587696606, "system_level_velocity_mean": 15.679644674321445, "cost1_mean": 403.84642289490534, "cost2_mean": -44.330219049359904, "outflow_rate_mean": 1180.0345321856362, "cost2_max": -28.811645095891503, "cost1_min": 133.45269449999344}, "policy_reward_mean": {}, "timesteps_this_iter": 47592, "training_iteration": 109, "node_ip": "10.138.0.2", "episode_reward_min": 331.36972040684793, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4603.179557561874, "info": {"num_steps_trained": 6022301, "sample_time_ms": 24934.783, "load_time_ms": 3.893, "grad_time_ms": 12438.056, "update_time_ms": 10.109, "default": {"policy_loss": -0.009364110417664051, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.32065173983573914, "total_loss": 65.96770477294922, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 65.97232818603516, "kl": 0.014086096547544003, "entropy": 1.5019688606262207}, "num_steps_sampled": 6022301}, "episodes_total": 3268, "done": false, "date": "2019-05-21_08-19-47", "time_total_s": 4603.179557561874, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf358>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 690.25, "time_this_iter_s": 35.885737657547, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558426787}
{"episode_reward_mean": 1109.4102902522034, "timesteps_total": 6069913, "iterations_since_restore": 110, "timesteps_since_restore": 6069913, "num_metric_batches_dropped": 0, "episode_reward_max": 1206.1524755922328, "custom_metrics": {"outflow_rate_min": 945.0273589156475, "system_level_velocity_min": 12.413558775966152, "cost1_max": 444.6458273984479, "system_level_velocity_max": 17.46360240623745, "cost2_min": -63.40157681916497, "outflow_rate_max": 1289.0228587696606, "system_level_velocity_mean": 15.762770954294355, "cost1_mean": 406.34839001452457, "cost2_mean": -44.433925370495636, "outflow_rate_mean": 1191.8733971630045, "cost2_max": -28.811645095891503, "cost1_min": 133.45269449999344}, "policy_reward_mean": {}, "timesteps_this_iter": 47612, "training_iteration": 110, "node_ip": "10.138.0.2", "episode_reward_min": 331.36972040684793, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4640.729573249817, "info": {"num_steps_trained": 6069913, "sample_time_ms": 24994.832, "load_time_ms": 3.666, "grad_time_ms": 12397.218, "update_time_ms": 8.232, "default": {"policy_loss": -0.01220683753490448, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2784700095653534, "total_loss": 70.15934753417969, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 70.16641235351562, "kl": 0.015237038023769855, "entropy": 1.4922289848327637}, "num_steps_sampled": 6069913}, "episodes_total": 3300, "done": false, "date": "2019-05-21_08-20-24", "time_total_s": 4640.729573249817, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022208>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 690.25, "time_this_iter_s": 37.550015687942505, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558426824}
{"episode_reward_mean": 1125.1121820609953, "timesteps_total": 6118881, "iterations_since_restore": 111, "timesteps_since_restore": 6118881, "num_metric_batches_dropped": 0, "episode_reward_max": 1205.8276599940475, "custom_metrics": {"outflow_rate_min": 1053.4396068796073, "system_level_velocity_min": 12.607298734835199, "cost1_max": 444.6458273984479, "system_level_velocity_max": 17.067168038154456, "cost2_min": -63.40157681916497, "outflow_rate_max": 1289.0228587696606, "system_level_velocity_mean": 15.703893693830619, "cost1_mean": 411.35033200448777, "cost2_mean": -46.084323667465824, "outflow_rate_mean": 1196.2484843689751, "cost2_max": -31.567517093023145, "cost1_min": 332.5486878123122}, "policy_reward_mean": {}, "timesteps_this_iter": 48968, "training_iteration": 111, "node_ip": "10.138.0.2", "episode_reward_min": 1008.5344695718333, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4679.473881483078, "info": {"num_steps_trained": 6118881, "sample_time_ms": 25181.277, "load_time_ms": 3.833, "grad_time_ms": 11965.382, "update_time_ms": 8.309, "default": {"policy_loss": -0.0111338896676898, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4226973354816437, "total_loss": 62.64616775512695, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 62.65264129638672, "kl": 0.013806767761707306, "entropy": 1.5371143817901611}, "num_steps_sampled": 6118881}, "episodes_total": 3331, "done": false, "date": "2019-05-21_08-21-03", "time_total_s": 4679.473881483078, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1b70>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 38.74430823326111, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558426863}
{"episode_reward_mean": 1107.81259869949, "timesteps_total": 6167496, "iterations_since_restore": 112, "timesteps_since_restore": 6167496, "num_metric_batches_dropped": 0, "episode_reward_max": 1211.457671474407, "custom_metrics": {"outflow_rate_min": 959.2737501114246, "system_level_velocity_min": 11.469473237437724, "cost1_max": 447.8985945981751, "system_level_velocity_max": 17.670259550940415, "cost2_min": -67.50854177347263, "outflow_rate_max": 1301.0306413072353, "system_level_velocity_mean": 15.702640335866265, "cost1_mean": 404.81450064271615, "cost2_mean": -46.392938347087174, "outflow_rate_mean": 1187.9302663471544, "cost2_max": -28.2299633935283, "cost1_min": 140.97352980911393}, "policy_reward_mean": {}, "timesteps_this_iter": 48615, "training_iteration": 112, "node_ip": "10.138.0.2", "episode_reward_min": 357.79459349361275, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4718.438800573349, "info": {"num_steps_trained": 6167496, "sample_time_ms": 25422.546, "load_time_ms": 4.004, "grad_time_ms": 11981.12, "update_time_ms": 8.167, "default": {"policy_loss": -0.012531519867479801, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3937368392944336, "total_loss": 68.43032836914062, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 68.43768310546875, "kl": 0.015356641262769699, "entropy": 1.5322003364562988}, "num_steps_sampled": 6167496}, "episodes_total": 3364, "done": false, "date": "2019-05-21_08-21-42", "time_total_s": 4718.438800573349, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf438>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 690.35, "time_this_iter_s": 38.964919090270996, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558426902}
{"episode_reward_mean": 1096.690823120022, "timesteps_total": 6215327, "iterations_since_restore": 113, "timesteps_since_restore": 6215327, "num_metric_batches_dropped": 0, "episode_reward_max": 1211.457671474407, "custom_metrics": {"outflow_rate_min": 492.1257582523173, "system_level_velocity_min": 11.469473237437724, "cost1_max": 447.8985945981751, "system_level_velocity_max": 17.98002556524029, "cost2_min": -67.50854177347263, "outflow_rate_max": 1301.0306413072353, "system_level_velocity_mean": 15.70243457512954, "cost1_mean": 400.3467663639899, "cost2_mean": -46.122250907624455, "outflow_rate_mean": 1180.0920299712118, "cost2_max": -18.82727372582878, "cost1_min": 24.380985665288197}, "policy_reward_mean": {}, "timesteps_this_iter": 47831, "training_iteration": 113, "node_ip": "10.138.0.2", "episode_reward_min": 60.20898181609134, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4755.517367362976, "info": {"num_steps_trained": 6215327, "sample_time_ms": 25101.497, "load_time_ms": 4.162, "grad_time_ms": 12152.45, "update_time_ms": 8.071, "default": {"policy_loss": -0.010264392010867596, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3137688934803009, "total_loss": 70.3062973022461, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 70.31172180175781, "kl": 0.014358301647007465, "entropy": 1.5205503702163696}, "num_steps_sampled": 6215327}, "episodes_total": 3395, "done": false, "date": "2019-05-21_08-22-19", "time_total_s": 4755.517367362976, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc79e8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 683.73, "time_this_iter_s": 37.078566789627075, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558426939}
{"episode_reward_mean": 1090.3653569621035, "timesteps_total": 6263932, "iterations_since_restore": 114, "timesteps_since_restore": 6263932, "num_metric_batches_dropped": 0, "episode_reward_max": 1211.457671474407, "custom_metrics": {"outflow_rate_min": 492.1257582523173, "system_level_velocity_min": 11.469473237437724, "cost1_max": 447.8985945981751, "system_level_velocity_max": 17.98002556524029, "cost2_min": -69.35796832482026, "outflow_rate_max": 1301.0306413072353, "system_level_velocity_mean": 15.54862866722312, "cost1_mean": 396.4111256276916, "cost2_mean": -46.010489787703044, "outflow_rate_mean": 1173.6389903041495, "cost2_max": -18.82727372582878, "cost1_min": 24.380985665288197}, "policy_reward_mean": {}, "timesteps_this_iter": 48605, "training_iteration": 114, "node_ip": "10.138.0.2", "episode_reward_min": 60.20898181609134, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4792.173852920532, "info": {"num_steps_trained": 6263932, "sample_time_ms": 24750.244, "load_time_ms": 4.192, "grad_time_ms": 12321.624, "update_time_ms": 8.07, "default": {"policy_loss": -0.011939003132283688, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.43744102120399475, "total_loss": 63.60383987426758, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 63.61072540283203, "kl": 0.014956989325582981, "entropy": 1.5468121767044067}, "num_steps_sampled": 6263932}, "episodes_total": 3425, "done": false, "date": "2019-05-21_08-22-56", "time_total_s": 4792.173852920532, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc75f8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 683.73, "time_this_iter_s": 36.65648555755615, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558426976}
{"episode_reward_mean": 1095.7566476591687, "timesteps_total": 6311854, "iterations_since_restore": 115, "timesteps_since_restore": 6311854, "num_metric_batches_dropped": 0, "episode_reward_max": 1211.457671474407, "custom_metrics": {"outflow_rate_min": 492.1257582523173, "system_level_velocity_min": 11.505369383449692, "cost1_max": 447.8985945981751, "system_level_velocity_max": 17.98002556524029, "cost2_min": -69.35796832482026, "outflow_rate_max": 1297.300722373594, "system_level_velocity_mean": 15.544897055915612, "cost1_mean": 399.3508863923601, "cost2_mean": -45.32984743636951, "outflow_rate_mean": 1171.319655269761, "cost2_max": -18.82727372582878, "cost1_min": 24.380985665288197}, "policy_reward_mean": {}, "timesteps_this_iter": 47922, "training_iteration": 115, "node_ip": "10.138.0.2", "episode_reward_min": 60.20898181609134, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4830.114591836929, "info": {"num_steps_trained": 6311854, "sample_time_ms": 24863.43, "load_time_ms": 4.082, "grad_time_ms": 12296.629, "update_time_ms": 8.127, "default": {"policy_loss": -0.009402934461832047, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.38140416145324707, "total_loss": 69.82150268554688, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 69.82645416259766, "kl": 0.013190405443310738, "entropy": 1.5330023765563965}, "num_steps_sampled": 6311854}, "episodes_total": 3457, "done": false, "date": "2019-05-21_08-23-34", "time_total_s": 4830.114591836929, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafc88>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.56, "time_this_iter_s": 37.940738916397095, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558427014}
{"episode_reward_mean": 1079.4621215765649, "timesteps_total": 6358559, "iterations_since_restore": 116, "timesteps_since_restore": 6358559, "num_metric_batches_dropped": 0, "episode_reward_max": 1204.1522757312196, "custom_metrics": {"outflow_rate_min": 500.30607541129115, "system_level_velocity_min": 11.505369383449692, "cost1_max": 447.7137976293139, "system_level_velocity_max": 18.394730887279103, "cost2_min": -69.35796832482026, "outflow_rate_max": 1297.300722373594, "system_level_velocity_mean": 15.456725154781166, "cost1_mean": 395.6785308810532, "cost2_mean": -45.65234085569305, "outflow_rate_mean": 1157.9769560782772, "cost2_max": -17.57665462029848, "cost1_min": 23.941327734841753}, "policy_reward_mean": {}, "timesteps_this_iter": 46705, "training_iteration": 116, "node_ip": "10.138.0.2", "episode_reward_min": 58.334496620917285, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4867.9349620342255, "info": {"num_steps_trained": 6358559, "sample_time_ms": 25216.287, "load_time_ms": 4.079, "grad_time_ms": 12108.534, "update_time_ms": 8.377, "default": {"policy_loss": -0.011721150018274784, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3469255864620209, "total_loss": 67.04981231689453, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 67.05680847167969, "kl": 0.014014068990945816, "entropy": 1.520156979560852}, "num_steps_sampled": 6358559}, "episodes_total": 3491, "done": false, "date": "2019-05-21_08-24-12", "time_total_s": 4867.9349620342255, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafe80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc79e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7a20>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 687.22, "time_this_iter_s": 37.82037019729614, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558427052}
{"episode_reward_mean": 1070.7391260568013, "timesteps_total": 6405811, "iterations_since_restore": 117, "timesteps_since_restore": 6405811, "num_metric_batches_dropped": 0, "episode_reward_max": 1180.9955712975868, "custom_metrics": {"outflow_rate_min": 500.30607541129115, "system_level_velocity_min": 11.812612786984495, "cost1_max": 442.745921482394, "system_level_velocity_max": 18.394730887279103, "cost2_min": -66.86245756333291, "outflow_rate_max": 1250.2191745958955, "system_level_velocity_mean": 15.573504926588248, "cost1_mean": 398.0157668341689, "cost2_mean": -44.41624076055948, "outflow_rate_mean": 1149.5568203964683, "cost2_max": -17.57665462029848, "cost1_min": 23.941327734841753}, "policy_reward_mean": {}, "timesteps_this_iter": 47252, "training_iteration": 117, "node_ip": "10.138.0.2", "episode_reward_min": 58.334496620917285, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4903.2042825222015, "info": {"num_steps_trained": 6405811, "sample_time_ms": 25140.198, "load_time_ms": 4.106, "grad_time_ms": 12101.283, "update_time_ms": 8.232, "default": {"policy_loss": -0.008783813565969467, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.27631258964538574, "total_loss": 64.60920715332031, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 64.61325073242188, "kl": 0.014050967060029507, "entropy": 1.5358818769454956}, "num_steps_sampled": 6405811}, "episodes_total": 3522, "done": false, "date": "2019-05-21_08-24-47", "time_total_s": 4903.2042825222015, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba7f0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 687.22, "time_this_iter_s": 35.269320487976074, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558427087}
{"episode_reward_mean": 1057.1154997538083, "timesteps_total": 6452366, "iterations_since_restore": 118, "timesteps_since_restore": 6452366, "num_metric_batches_dropped": 0, "episode_reward_max": 1162.6424352182923, "custom_metrics": {"outflow_rate_min": 500.30607541129115, "system_level_velocity_min": 12.47382451763486, "cost1_max": 442.37590208977724, "system_level_velocity_max": 18.394730887279103, "cost2_min": -64.15515881730681, "outflow_rate_max": 1236.0989429387819, "system_level_velocity_mean": 15.772669770993536, "cost1_mean": 402.30023997098857, "cost2_mean": -42.50361760243206, "outflow_rate_mean": 1136.103196079028, "cost2_max": -17.57665462029848, "cost1_min": 23.941327734841753}, "policy_reward_mean": {}, "timesteps_this_iter": 46555, "training_iteration": 118, "node_ip": "10.138.0.2", "episode_reward_min": 58.334496620917285, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4940.533362150192, "info": {"num_steps_trained": 6452366, "sample_time_ms": 25063.597, "load_time_ms": 3.981, "grad_time_ms": 12154.639, "update_time_ms": 8.118, "default": {"policy_loss": -0.013515484519302845, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3508976697921753, "total_loss": 64.16155242919922, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 64.1695327758789, "kl": 0.016400856897234917, "entropy": 1.5483473539352417}, "num_steps_sampled": 6452366}, "episodes_total": 3554, "done": false, "date": "2019-05-21_08-25-24", "time_total_s": 4940.533362150192, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafa20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf0f0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 687.22, "time_this_iter_s": 37.32907962799072, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558427124}
{"episode_reward_mean": 1057.899550867739, "timesteps_total": 6497971, "iterations_since_restore": 119, "timesteps_since_restore": 6497971, "num_metric_batches_dropped": 0, "episode_reward_max": 1141.4421796193099, "custom_metrics": {"outflow_rate_min": 982.2586639879453, "system_level_velocity_min": 12.47382451763486, "cost1_max": 443.69457204657607, "system_level_velocity_max": 17.058735086551383, "cost2_min": -62.860744364575034, "outflow_rate_max": 1231.818500302358, "system_level_velocity_mean": 15.791741306841907, "cost1_mean": 409.9375647369095, "cost2_mean": -41.019513852399456, "outflow_rate_mean": 1122.6834254081793, "cost2_max": -30.175687263502326, "cost1_min": 327.0021872596295}, "policy_reward_mean": {}, "timesteps_this_iter": 45605, "training_iteration": 119, "node_ip": "10.138.0.2", "episode_reward_min": 930.387166692517, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 4974.748864889145, "info": {"num_steps_trained": 6497971, "sample_time_ms": 25138.097, "load_time_ms": 3.958, "grad_time_ms": 11912.793, "update_time_ms": 8.318, "default": {"policy_loss": -0.011643486097455025, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3334652781486511, "total_loss": 63.946041107177734, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 63.95277404785156, "kl": 0.014542968012392521, "entropy": 1.5526596307754517}, "num_steps_sampled": 6497971}, "episodes_total": 3586, "done": false, "date": "2019-05-21_08-25-59", "time_total_s": 4974.748864889145, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7e48>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 34.21550273895264, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558427159}
{"episode_reward_mean": 1035.17910434988, "timesteps_total": 6543501, "iterations_since_restore": 120, "timesteps_since_restore": 6543501, "num_metric_batches_dropped": 0, "episode_reward_max": 1135.8461735714502, "custom_metrics": {"outflow_rate_min": 981.1477947214074, "system_level_velocity_min": 12.536924410134494, "cost1_max": 443.69457204657607, "system_level_velocity_max": 17.285527042304906, "cost2_min": -62.860744364575034, "outflow_rate_max": 1218.5068564768567, "system_level_velocity_mean": 15.93960947628797, "cost1_mean": 410.4564579152079, "cost2_mean": -38.61944078198903, "outflow_rate_mean": 1100.9388596937026, "cost2_max": -28.520241259568806, "cost1_min": 252.53413347985565}, "policy_reward_mean": {}, "timesteps_this_iter": 45530, "training_iteration": 120, "node_ip": "10.138.0.2", "episode_reward_min": 612.9511185576073, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5010.129967689514, "info": {"num_steps_trained": 6543501, "sample_time_ms": 24952.906, "load_time_ms": 4.142, "grad_time_ms": 11881.129, "update_time_ms": 8.282, "default": {"policy_loss": -0.010034347884356976, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.29867109656333923, "total_loss": 69.70932006835938, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 69.71492767333984, "kl": 0.01312028057873249, "entropy": 1.546593427658081}, "num_steps_sampled": 6543501}, "episodes_total": 3621, "done": false, "date": "2019-05-21_08-26-34", "time_total_s": 5010.129967689514, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbac88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbacf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf198>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 696.97, "time_this_iter_s": 35.38110280036926, "hostname": "flow-main", "episodes_this_iter": 35, "timestamp": 1558427194}
{"episode_reward_mean": 1020.1162710031083, "timesteps_total": 6589389, "iterations_since_restore": 121, "timesteps_since_restore": 6589389, "num_metric_batches_dropped": 0, "episode_reward_max": 1123.1007271438323, "custom_metrics": {"outflow_rate_min": 924.9654844432317, "system_level_velocity_min": 12.097298832223727, "cost1_max": 443.69457204657607, "system_level_velocity_max": 17.285527042304906, "cost2_min": -62.860744364575034, "outflow_rate_max": 1194.3667588932803, "system_level_velocity_mean": 15.977437958346808, "cost1_mean": 408.22915821191964, "cost2_mean": -37.55930176179862, "outflow_rate_mean": 1090.020089547901, "cost2_max": -28.520241259568806, "cost1_min": 241.68384543766265}, "policy_reward_mean": {}, "timesteps_this_iter": 45888, "training_iteration": 121, "node_ip": "10.138.0.2", "episode_reward_min": 577.2508228630462, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5044.3712821006775, "info": {"num_steps_trained": 6589389, "sample_time_ms": 24309.428, "load_time_ms": 4.072, "grad_time_ms": 12071.935, "update_time_ms": 8.142, "default": {"policy_loss": -0.011445676907896996, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.33254536986351013, "total_loss": 66.48915100097656, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 66.49518585205078, "kl": 0.0160431619733572, "entropy": 1.5661120414733887}, "num_steps_sampled": 6589389}, "episodes_total": 3654, "done": false, "date": "2019-05-21_08-27-08", "time_total_s": 5044.3712821006775, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1780>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.41, "time_this_iter_s": 34.24131441116333, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558427228}
{"episode_reward_mean": 1014.6303357152975, "timesteps_total": 6634969, "iterations_since_restore": 122, "timesteps_since_restore": 6634969, "num_metric_batches_dropped": 0, "episode_reward_max": 1134.9651024244267, "custom_metrics": {"outflow_rate_min": 912.5768078541373, "system_level_velocity_min": 11.793866763396348, "cost1_max": 442.5398468168255, "system_level_velocity_max": 17.285527042304906, "cost2_min": -58.46298447984393, "outflow_rate_max": 1208.7465744400529, "system_level_velocity_mean": 15.935335254682059, "cost1_mean": 407.13021300511923, "cost2_mean": -37.96290426813619, "outflow_rate_mean": 1089.3059992659728, "cost2_max": -28.520241259568806, "cost1_min": 241.68384543766265}, "policy_reward_mean": {}, "timesteps_this_iter": 45580, "training_iteration": 122, "node_ip": "10.138.0.2", "episode_reward_min": 577.2508228630462, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5077.792327880859, "info": {"num_steps_trained": 6634969, "sample_time_ms": 23764.119, "load_time_ms": 4.027, "grad_time_ms": 12064.064, "update_time_ms": 8.166, "default": {"policy_loss": -0.012110728770494461, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2851347029209137, "total_loss": 59.91194534301758, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 59.91889572143555, "kl": 0.015283364802598953, "entropy": 1.5791715383529663}, "num_steps_sampled": 6634969}, "episodes_total": 3684, "done": false, "date": "2019-05-21_08-27-42", "time_total_s": 5077.792327880859, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafcf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf780>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 692.98, "time_this_iter_s": 33.421045780181885, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558427262}
{"episode_reward_mean": 1011.5223066816156, "timesteps_total": 6681761, "iterations_since_restore": 123, "timesteps_since_restore": 6681761, "num_metric_batches_dropped": 0, "episode_reward_max": 1134.9651024244267, "custom_metrics": {"outflow_rate_min": 490.5438006232681, "system_level_velocity_min": 11.793866763396348, "cost1_max": 437.6671865470877, "system_level_velocity_max": 18.359985578550134, "cost2_min": -58.46298447984393, "outflow_rate_max": 1208.7465744400529, "system_level_velocity_mean": 15.777723497614847, "cost1_mean": 401.0768703862314, "cost2_mean": -39.15206554148909, "outflow_rate_mean": 1087.1859472981089, "cost2_max": -18.1019186531776, "cost1_min": 24.044571285248463}, "policy_reward_mean": {}, "timesteps_this_iter": 46792, "training_iteration": 123, "node_ip": "10.138.0.2", "episode_reward_min": 58.31355435348558, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5112.857781648636, "info": {"num_steps_trained": 6681761, "sample_time_ms": 23851.795, "load_time_ms": 4.005, "grad_time_ms": 11776.386, "update_time_ms": 8.303, "default": {"policy_loss": -0.010755165480077267, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2767539620399475, "total_loss": 62.26416015625, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 62.270206451416016, "kl": 0.013965973630547523, "entropy": 1.5635433197021484}, "num_steps_sampled": 6681761}, "episodes_total": 3715, "done": false, "date": "2019-05-21_08-28-17", "time_total_s": 5112.857781648636, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7dd8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 689.38, "time_this_iter_s": 35.06545376777649, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558427297}
{"episode_reward_mean": 1021.0161279949289, "timesteps_total": 6729325, "iterations_since_restore": 124, "timesteps_since_restore": 6729325, "num_metric_batches_dropped": 0, "episode_reward_max": 1151.3809232612446, "custom_metrics": {"outflow_rate_min": 490.5438006232681, "system_level_velocity_min": 11.793866763396348, "cost1_max": 437.86650360179124, "system_level_velocity_max": 18.359985578550134, "cost2_min": -54.357925790912425, "outflow_rate_max": 1211.0986728245014, "system_level_velocity_mean": 15.761435371809892, "cost1_mean": 398.9705519643912, "cost2_mean": -39.75212352155775, "outflow_rate_mean": 1099.3758847471865, "cost2_max": -18.1019186531776, "cost1_min": 24.044571285248463}, "policy_reward_mean": {}, "timesteps_this_iter": 47564, "training_iteration": 124, "node_ip": "10.138.0.2", "episode_reward_min": 58.31355435348558, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5148.8718094825745, "info": {"num_steps_trained": 6729325, "sample_time_ms": 23989.75, "load_time_ms": 3.999, "grad_time_ms": 11577.225, "update_time_ms": 8.488, "default": {"policy_loss": -0.010683600790798664, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.25377947092056274, "total_loss": 67.24995422363281, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 67.25546264648438, "kl": 0.01530691608786583, "entropy": 1.5699223279953003}, "num_steps_sampled": 6729325}, "episodes_total": 3749, "done": false, "date": "2019-05-21_08-28-53", "time_total_s": 5148.8718094825745, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc10f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc14e0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 684.88, "time_this_iter_s": 36.0140278339386, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558427333}
{"episode_reward_mean": 1041.001669066421, "timesteps_total": 6776927, "iterations_since_restore": 125, "timesteps_since_restore": 6776927, "num_metric_batches_dropped": 0, "episode_reward_max": 1151.3809232612446, "custom_metrics": {"outflow_rate_min": 490.5438006232681, "system_level_velocity_min": 12.123940575624713, "cost1_max": 437.86650360179124, "system_level_velocity_max": 18.359985578550134, "cost2_min": -62.014571819864315, "outflow_rate_max": 1211.0986728245014, "system_level_velocity_mean": 15.716267686224441, "cost1_mean": 400.81412643610014, "cost2_mean": -39.672587939556976, "outflow_rate_mean": 1111.245620484667, "cost2_max": -18.1019186531776, "cost1_min": 24.044571285248463}, "policy_reward_mean": {}, "timesteps_this_iter": 47602, "training_iteration": 125, "node_ip": "10.138.0.2", "episode_reward_min": 58.31355435348558, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5184.19428896904, "info": {"num_steps_trained": 6776927, "sample_time_ms": 23938.502, "load_time_ms": 3.835, "grad_time_ms": 11369.489, "update_time_ms": 8.351, "default": {"policy_loss": -0.01126949768513441, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2976779043674469, "total_loss": 61.49788284301758, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 61.50421142578125, "kl": 0.014625809155404568, "entropy": 1.5722569227218628}, "num_steps_sampled": 6776927}, "episodes_total": 3781, "done": false, "date": "2019-05-21_08-29-28", "time_total_s": 5184.19428896904, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022d68>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.44, "time_this_iter_s": 35.322479486465454, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558427368}
{"episode_reward_mean": 1056.4919313209905, "timesteps_total": 6824378, "iterations_since_restore": 126, "timesteps_since_restore": 6824378, "num_metric_batches_dropped": 0, "episode_reward_max": 1151.3809232612446, "custom_metrics": {"outflow_rate_min": 945.7234490298064, "system_level_velocity_min": 12.123940575624713, "cost1_max": 440.50141677049396, "system_level_velocity_max": 17.46810906242579, "cost2_min": -62.014571819864315, "outflow_rate_max": 1211.0986728245014, "system_level_velocity_mean": 15.619255446756107, "cost1_mean": 403.56388871912554, "cost2_mean": -39.89580782423519, "outflow_rate_mean": 1123.730181143032, "cost2_max": -26.39479457897126, "cost1_min": 133.61919711869223}, "policy_reward_mean": {}, "timesteps_this_iter": 47451, "training_iteration": 126, "node_ip": "10.138.0.2", "episode_reward_min": 331.1403670099766, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5220.803777694702, "info": {"num_steps_trained": 6824378, "sample_time_ms": 23933.283, "load_time_ms": 3.905, "grad_time_ms": 11254.48, "update_time_ms": 8.163, "default": {"policy_loss": -0.01003984734416008, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2974952757358551, "total_loss": 61.823692321777344, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 61.828948974609375, "kl": 0.014153853990137577, "entropy": 1.582169532775879}, "num_steps_sampled": 6824378}, "episodes_total": 3813, "done": false, "date": "2019-05-21_08-30-05", "time_total_s": 5220.803777694702, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafa58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafe80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf0f0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.07, "time_this_iter_s": 36.60948872566223, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558427405}
{"episode_reward_mean": 1059.2599931247853, "timesteps_total": 6871537, "iterations_since_restore": 127, "timesteps_since_restore": 6871537, "num_metric_batches_dropped": 0, "episode_reward_max": 1143.709445949875, "custom_metrics": {"outflow_rate_min": 1002.1288454757855, "system_level_velocity_min": 12.28397753374102, "cost1_max": 440.50141677049396, "system_level_velocity_max": 16.945245864575277, "cost2_min": -62.014571819864315, "outflow_rate_max": 1206.3033654342094, "system_level_velocity_mean": 15.610406723294538, "cost1_mean": 406.45421327027447, "cost2_mean": -39.408241711304306, "outflow_rate_mean": 1119.2663806405135, "cost2_max": -26.52517475074535, "cost1_min": 320.5829921421978}, "policy_reward_mean": {}, "timesteps_this_iter": 47159, "training_iteration": 127, "node_ip": "10.138.0.2", "episode_reward_min": 919.1016784326196, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5256.582395553589, "info": {"num_steps_trained": 6871537, "sample_time_ms": 24008.142, "load_time_ms": 3.954, "grad_time_ms": 11230.521, "update_time_ms": 7.97, "default": {"policy_loss": -0.012811531312763691, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3324059545993805, "total_loss": 61.08064651489258, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 61.088218688964844, "kl": 0.015526777133345604, "entropy": 1.5968453884124756}, "num_steps_sampled": 6871537}, "episodes_total": 3846, "done": false, "date": "2019-05-21_08-30-41", "time_total_s": 5256.582395553589, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d828>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 35.77861785888672, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558427441}
{"episode_reward_mean": 1048.4501354164975, "timesteps_total": 6919345, "iterations_since_restore": 128, "timesteps_since_restore": 6919345, "num_metric_batches_dropped": 0, "episode_reward_max": 1137.1572599286328, "custom_metrics": {"outflow_rate_min": 1002.1288454757855, "system_level_velocity_min": 12.28397753374102, "cost1_max": 440.50141677049396, "system_level_velocity_max": 16.945245864575277, "cost2_min": -62.014571819864315, "outflow_rate_max": 1206.3033654342094, "system_level_velocity_mean": 15.646250827118113, "cost1_mean": 405.46028025542796, "cost2_mean": -39.04524842474716, "outflow_rate_mean": 1112.9172653556782, "cost2_max": -30.274717865990134, "cost1_min": 232.2230255103608}, "policy_reward_mean": {}, "timesteps_this_iter": 47808, "training_iteration": 128, "node_ip": "10.138.0.2", "episode_reward_min": 588.5537814095459, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5292.641061544418, "info": {"num_steps_trained": 6919345, "sample_time_ms": 23729.464, "load_time_ms": 4.061, "grad_time_ms": 11379.594, "update_time_ms": 8.06, "default": {"policy_loss": -0.010541809722781181, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4327771067619324, "total_loss": 60.059505462646484, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 60.06511688232422, "kl": 0.01459885947406292, "entropy": 1.6042362451553345}, "num_steps_sampled": 6919345}, "episodes_total": 3879, "done": false, "date": "2019-05-21_08-31-17", "time_total_s": 5292.641061544418, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbac50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba278>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 696.95, "time_this_iter_s": 36.05866599082947, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558427477}
{"episode_reward_mean": 1053.1107641727797, "timesteps_total": 6967444, "iterations_since_restore": 129, "timesteps_since_restore": 6967444, "num_metric_batches_dropped": 0, "episode_reward_max": 1137.1572599286328, "custom_metrics": {"outflow_rate_min": 930.9345418060199, "system_level_velocity_min": 11.698658183547769, "cost1_max": 440.25090994343276, "system_level_velocity_max": 16.967768390879886, "cost2_min": -56.79203389585392, "outflow_rate_max": 1208.3060953596216, "system_level_velocity_mean": 15.655870259611156, "cost1_mean": 405.97838754754207, "cost2_mean": -39.369734610328535, "outflow_rate_mean": 1115.5830523636769, "cost2_max": -30.274717865990134, "cost1_min": 232.2230255103608}, "policy_reward_mean": {}, "timesteps_this_iter": 48099, "training_iteration": 129, "node_ip": "10.138.0.2", "episode_reward_min": 588.5537814095459, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5328.363795995712, "info": {"num_steps_trained": 6967444, "sample_time_ms": 23519.751, "load_time_ms": 4.088, "grad_time_ms": 11737.716, "update_time_ms": 8.045, "default": {"policy_loss": -0.010048365220427513, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.36917373538017273, "total_loss": 64.9727783203125, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 64.97842407226562, "kl": 0.013073357753455639, "entropy": 1.6040979623794556}, "num_steps_sampled": 6967444}, "episodes_total": 3911, "done": false, "date": "2019-05-21_08-31-53", "time_total_s": 5328.363795995712, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc77b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7c18>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 696.95, "time_this_iter_s": 35.722734451293945, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558427513}
{"episode_reward_mean": 1057.3516969997575, "timesteps_total": 7015076, "iterations_since_restore": 130, "timesteps_since_restore": 7015076, "num_metric_batches_dropped": 0, "episode_reward_max": 1166.614579284408, "custom_metrics": {"outflow_rate_min": 930.9345418060199, "system_level_velocity_min": 11.698658183547769, "cost1_max": 440.25090994343276, "system_level_velocity_max": 16.969440352638582, "cost2_min": -56.79203389585392, "outflow_rate_max": 1257.69289403318, "system_level_velocity_mean": 15.627123803756886, "cost1_mean": 405.238775214966, "cost2_mean": -40.13993938073141, "outflow_rate_mean": 1121.6540784861727, "cost2_max": -30.763313597909473, "cost1_min": 232.2230255103608}, "policy_reward_mean": {}, "timesteps_this_iter": 47632, "training_iteration": 130, "node_ip": "10.138.0.2", "episode_reward_min": 588.5537814095459, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5364.8419280052185, "info": {"num_steps_trained": 7015076, "sample_time_ms": 23489.467, "load_time_ms": 4.103, "grad_time_ms": 11877.226, "update_time_ms": 8.11, "default": {"policy_loss": -0.012014837935566902, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3624938726425171, "total_loss": 63.709877014160156, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 63.71696853637695, "kl": 0.014594187960028648, "entropy": 1.5961543321609497}, "num_steps_sampled": 7015076}, "episodes_total": 3945, "done": false, "date": "2019-05-21_08-32-29", "time_total_s": 5364.8419280052185, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc10f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc16a0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 696.95, "time_this_iter_s": 36.478132009506226, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558427549}
{"episode_reward_mean": 1055.9060116080464, "timesteps_total": 7062583, "iterations_since_restore": 131, "timesteps_since_restore": 7062583, "num_metric_batches_dropped": 0, "episode_reward_max": 1166.614579284408, "custom_metrics": {"outflow_rate_min": 483.4753028303134, "system_level_velocity_min": 11.698658183547769, "cost1_max": 440.25090994343276, "system_level_velocity_max": 18.516029987264933, "cost2_min": -56.79203389585392, "outflow_rate_max": 1257.69289403318, "system_level_velocity_mean": 15.62228422590997, "cost1_mean": 402.3134782190589, "cost2_mean": -41.02530593936896, "outflow_rate_mean": 1122.0844674716634, "cost2_max": -20.046999631909777, "cost1_min": 24.31153857633319}, "policy_reward_mean": {}, "timesteps_this_iter": 47507, "training_iteration": 131, "node_ip": "10.138.0.2", "episode_reward_min": 59.01665071174144, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5401.022264719009, "info": {"num_steps_trained": 7062583, "sample_time_ms": 23758.959, "load_time_ms": 4.138, "grad_time_ms": 11803.463, "update_time_ms": 8.447, "default": {"policy_loss": -0.01086854562163353, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.24258378148078918, "total_loss": 68.50453186035156, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 68.51016998291016, "kl": 0.015495925210416317, "entropy": 1.5829497575759888}, "num_steps_sampled": 7062583}, "episodes_total": 3976, "done": false, "date": "2019-05-21_08-33-06", "time_total_s": 5401.022264719009, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7a20>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.37, "time_this_iter_s": 36.180336713790894, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558427586}
{"episode_reward_mean": 1053.1185969235123, "timesteps_total": 7109605, "iterations_since_restore": 132, "timesteps_since_restore": 7109605, "num_metric_batches_dropped": 0, "episode_reward_max": 1200.0472025684696, "custom_metrics": {"outflow_rate_min": 483.4753028303134, "system_level_velocity_min": 12.552023850197932, "cost1_max": 443.2167239217175, "system_level_velocity_max": 18.516029987264933, "cost2_min": -61.45642388381871, "outflow_rate_max": 1278.9583010091346, "system_level_velocity_mean": 15.679179307848008, "cost1_mean": 403.2551169922211, "cost2_mean": -40.847061860469104, "outflow_rate_mean": 1122.7477355961494, "cost2_max": -20.046999631909777, "cost1_min": 24.31153857633319}, "policy_reward_mean": {}, "timesteps_this_iter": 47022, "training_iteration": 132, "node_ip": "10.138.0.2", "episode_reward_min": 59.01665071174144, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5437.128289937973, "info": {"num_steps_trained": 7109605, "sample_time_ms": 23879.375, "load_time_ms": 4.237, "grad_time_ms": 11950.615, "update_time_ms": 8.601, "default": {"policy_loss": -0.011199681088328362, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2612732946872711, "total_loss": 64.6611099243164, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 64.66727447509766, "kl": 0.01491594035178423, "entropy": 1.6014800071716309}, "num_steps_sampled": 7109605}, "episodes_total": 4010, "done": false, "date": "2019-05-21_08-33-42", "time_total_s": 5437.128289937973, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbab70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003550>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.37, "time_this_iter_s": 36.10602521896362, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558427622}
{"episode_reward_mean": 1025.6387086424186, "timesteps_total": 7156230, "iterations_since_restore": 133, "timesteps_since_restore": 7156230, "num_metric_batches_dropped": 0, "episode_reward_max": 1200.0472025684696, "custom_metrics": {"outflow_rate_min": 475.9736659830146, "system_level_velocity_min": 12.09532470000604, "cost1_max": 443.2167239217175, "system_level_velocity_max": 18.516029987264933, "cost2_min": -61.45642388381871, "outflow_rate_max": 1278.9583010091346, "system_level_velocity_mean": 15.728489607585708, "cost1_mean": 396.75374164753043, "cost2_mean": -40.06629210594471, "outflow_rate_mean": 1106.14307876739, "cost2_max": -19.56740314255584, "cost1_min": 22.992979230624265}, "policy_reward_mean": {}, "timesteps_this_iter": 46625, "training_iteration": 133, "node_ip": "10.138.0.2", "episode_reward_min": 56.1534125626901, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5474.828234434128, "info": {"num_steps_trained": 7156230, "sample_time_ms": 23891.921, "load_time_ms": 4.256, "grad_time_ms": 12200.655, "update_time_ms": 8.762, "default": {"policy_loss": -0.011131391860544682, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.26745256781578064, "total_loss": 68.36392211914062, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 68.3700942993164, "kl": 0.01468981895595789, "entropy": 1.6074728965759277}, "num_steps_sampled": 7156230}, "episodes_total": 4044, "done": false, "date": "2019-05-21_08-34-19", "time_total_s": 5474.828234434128, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafa20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf6a0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 682.69, "time_this_iter_s": 37.699944496154785, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558427659}
{"episode_reward_mean": 1004.9767631937367, "timesteps_total": 7202975, "iterations_since_restore": 134, "timesteps_since_restore": 7202975, "num_metric_batches_dropped": 0, "episode_reward_max": 1200.0472025684696, "custom_metrics": {"outflow_rate_min": 475.9736659830146, "system_level_velocity_min": 12.09532470000604, "cost1_max": 443.2167239217175, "system_level_velocity_max": 18.48966955359709, "cost2_min": -61.45642388381871, "outflow_rate_max": 1278.9583010091346, "system_level_velocity_mean": 15.55772477384073, "cost1_mean": 391.35785438912586, "cost2_mean": -39.729243211594536, "outflow_rate_mean": 1091.9117065785751, "cost2_max": -19.56740314255584, "cost1_min": 22.992979230624265}, "policy_reward_mean": {}, "timesteps_this_iter": 46745, "training_iteration": 134, "node_ip": "10.138.0.2", "episode_reward_min": 56.1534125626901, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5510.067637205124, "info": {"num_steps_trained": 7202975, "sample_time_ms": 23873.184, "load_time_ms": 4.191, "grad_time_ms": 12141.256, "update_time_ms": 8.664, "default": {"policy_loss": -0.011835919693112373, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2724814713001251, "total_loss": 62.72920608520508, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 62.73588943481445, "kl": 0.015271693468093872, "entropy": 1.6195422410964966}, "num_steps_sampled": 7202975}, "episodes_total": 4076, "done": false, "date": "2019-05-21_08-34-55", "time_total_s": 5510.067637205124, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafa90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafb38>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 681.26, "time_this_iter_s": 35.239402770996094, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558427695}
{"episode_reward_mean": 979.3105906394197, "timesteps_total": 7249643, "iterations_since_restore": 135, "timesteps_since_restore": 7249643, "num_metric_batches_dropped": 0, "episode_reward_max": 1144.6859172576912, "custom_metrics": {"outflow_rate_min": 475.9736659830146, "system_level_velocity_min": 11.669367471096427, "cost1_max": 438.7730305530831, "system_level_velocity_max": 18.48966955359709, "cost2_min": -57.961356703140154, "outflow_rate_max": 1231.7606725037263, "system_level_velocity_mean": 15.459370626493458, "cost1_mean": 383.3605235952628, "cost2_mean": -40.17203652036215, "outflow_rate_mean": 1078.5324860788685, "cost2_max": -19.56740314255584, "cost1_min": 22.992979230624265}, "policy_reward_mean": {}, "timesteps_this_iter": 46668, "training_iteration": 135, "node_ip": "10.138.0.2", "episode_reward_min": 56.1534125626901, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5547.887834310532, "info": {"num_steps_trained": 7249643, "sample_time_ms": 23942.217, "load_time_ms": 4.365, "grad_time_ms": 12320.762, "update_time_ms": 8.745, "default": {"policy_loss": -0.01186879351735115, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3092711865901947, "total_loss": 66.20112609863281, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 66.20787811279297, "kl": 0.015153836458921432, "entropy": 1.6313093900680542}, "num_steps_sampled": 7249643}, "episodes_total": 4110, "done": false, "date": "2019-05-21_08-35-33", "time_total_s": 5547.887834310532, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbab70>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 673.2, "time_this_iter_s": 37.820197105407715, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558427733}
{"episode_reward_mean": 981.1243731730943, "timesteps_total": 7295586, "iterations_since_restore": 136, "timesteps_since_restore": 7295586, "num_metric_batches_dropped": 0, "episode_reward_max": 1144.6859172576912, "custom_metrics": {"outflow_rate_min": 894.6198417056072, "system_level_velocity_min": 11.669367471096427, "cost1_max": 438.7730305530831, "system_level_velocity_max": 17.365773223700693, "cost2_min": -57.961356703140154, "outflow_rate_max": 1231.7606725037263, "system_level_velocity_mean": 15.54362822591296, "cost1_mean": 386.00496264973424, "cost2_mean": -40.314209937245224, "outflow_rate_mean": 1085.4170390650843, "cost2_max": -28.08047902577736, "cost1_min": 132.91692712226782}, "policy_reward_mean": {}, "timesteps_this_iter": 45943, "training_iteration": 136, "node_ip": "10.138.0.2", "episode_reward_min": 329.26333335573366, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5582.607616424561, "info": {"num_steps_trained": 7295586, "sample_time_ms": 23620.626, "load_time_ms": 4.285, "grad_time_ms": 12453.23, "update_time_ms": 8.748, "default": {"policy_loss": -0.011571884155273438, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.24304451048374176, "total_loss": 62.06005096435547, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 62.06635284423828, "kl": 0.015617596916854382, "entropy": 1.6065821647644043}, "num_steps_sampled": 7295586}, "episodes_total": 4141, "done": false, "date": "2019-05-21_08-36-07", "time_total_s": 5582.607616424561, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaffd0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 674.16, "time_this_iter_s": 34.71978211402893, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558427767}
{"episode_reward_mean": 1005.3624967797934, "timesteps_total": 7342246, "iterations_since_restore": 137, "timesteps_since_restore": 7342246, "num_metric_batches_dropped": 0, "episode_reward_max": 1144.6859172576912, "custom_metrics": {"outflow_rate_min": 914.2279161585367, "system_level_velocity_min": 11.669367471096427, "cost1_max": 439.2856784538758, "system_level_velocity_max": 17.24992337277829, "cost2_min": -58.503803191839054, "outflow_rate_max": 1231.7606725037263, "system_level_velocity_mean": 15.59497159660087, "cost1_mean": 394.80372147356235, "cost2_mean": -41.20262483265125, "outflow_rate_mean": 1095.7329129392645, "cost2_max": -28.461641522169746, "cost1_min": 183.21639490236058}, "policy_reward_mean": {}, "timesteps_this_iter": 46660, "training_iteration": 137, "node_ip": "10.138.0.2", "episode_reward_min": 447.20127764532816, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5618.805178403854, "info": {"num_steps_trained": 7342246, "sample_time_ms": 23789.612, "load_time_ms": 4.162, "grad_time_ms": 12327.468, "update_time_ms": 8.771, "default": {"policy_loss": -0.014760803431272507, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.29639264941215515, "total_loss": 57.665523529052734, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 57.67472839355469, "kl": 0.016433797776699066, "entropy": 1.6257224082946777}, "num_steps_sampled": 7342246}, "episodes_total": 4172, "done": false, "date": "2019-05-21_08-36-44", "time_total_s": 5618.805178403854, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc75c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc77f0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 686.25, "time_this_iter_s": 36.19756197929382, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558427804}
{"episode_reward_mean": 1022.0461578355174, "timesteps_total": 7389371, "iterations_since_restore": 138, "timesteps_since_restore": 7389371, "num_metric_batches_dropped": 0, "episode_reward_max": 1154.214225480948, "custom_metrics": {"outflow_rate_min": 914.2279161585367, "system_level_velocity_min": 11.669367471096427, "cost1_max": 442.1882897346963, "system_level_velocity_max": 17.24992337277829, "cost2_min": -58.503803191839054, "outflow_rate_max": 1258.0758372698351, "system_level_velocity_mean": 15.663035306470425, "cost1_mean": 401.6689130288441, "cost2_mean": -41.26461522113327, "outflow_rate_mean": 1100.6928929506464, "cost2_max": -28.79172422807471, "cost1_min": 193.2191226675751}, "policy_reward_mean": {}, "timesteps_this_iter": 47125, "training_iteration": 138, "node_ip": "10.138.0.2", "episode_reward_min": 473.3762036931012, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5654.346143484116, "info": {"num_steps_trained": 7389371, "sample_time_ms": 24053.695, "load_time_ms": 4.101, "grad_time_ms": 12014.349, "update_time_ms": 8.715, "default": {"policy_loss": -0.014256387017667294, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.31642791628837585, "total_loss": 54.4372673034668, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 54.44599151611328, "kl": 0.016373729333281517, "entropy": 1.6268917322158813}, "num_steps_sampled": 7389371}, "episodes_total": 4204, "done": false, "date": "2019-05-21_08-37-19", "time_total_s": 5654.346143484116, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc85c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc82e8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 694.31, "time_this_iter_s": 35.54096508026123, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558427839}
{"episode_reward_mean": 1039.546266785392, "timesteps_total": 7436354, "iterations_since_restore": 139, "timesteps_since_restore": 7436354, "num_metric_batches_dropped": 0, "episode_reward_max": 1154.214225480948, "custom_metrics": {"outflow_rate_min": 861.8816639597208, "system_level_velocity_min": 12.009223742681911, "cost1_max": 442.1882897346963, "system_level_velocity_max": 17.062211492182488, "cost2_min": -60.832594574765466, "outflow_rate_max": 1258.0758372698351, "system_level_velocity_mean": 15.674028482498127, "cost1_mean": 405.995409505085, "cost2_mean": -42.00826608162186, "outflow_rate_mean": 1108.3721555581706, "cost2_max": -31.48581228863099, "cost1_min": 314.62345759618506}, "policy_reward_mean": {}, "timesteps_this_iter": 46983, "training_iteration": 139, "node_ip": "10.138.0.2", "episode_reward_min": 840.0327483393432, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5689.636372566223, "info": {"num_steps_trained": 7436354, "sample_time_ms": 24124.573, "load_time_ms": 4.075, "grad_time_ms": 11902.737, "update_time_ms": 8.546, "default": {"policy_loss": -0.012320340611040592, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2603103518486023, "total_loss": 58.84120559692383, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 58.84820556640625, "kl": 0.01577678695321083, "entropy": 1.651479959487915}, "num_steps_sampled": 7436354}, "episodes_total": 4234, "done": false, "date": "2019-05-21_08-37-55", "time_total_s": 5689.636372566223, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc78d0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 35.290229082107544, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558427875}
{"episode_reward_mean": 1037.3297533589312, "timesteps_total": 7482489, "iterations_since_restore": 140, "timesteps_since_restore": 7482489, "num_metric_batches_dropped": 0, "episode_reward_max": 1161.430820179541, "custom_metrics": {"outflow_rate_min": 861.8816639597208, "system_level_velocity_min": 12.622732624872883, "cost1_max": 442.3671057950012, "system_level_velocity_max": 17.254584444435338, "cost2_min": -60.832594574765466, "outflow_rate_max": 1258.0758372698351, "system_level_velocity_mean": 15.64634319012912, "cost1_mean": 402.52052507290944, "cost2_mean": -42.07388164956225, "outflow_rate_mean": 1110.1672643961588, "cost2_max": -29.062771856772933, "cost1_min": 133.27397767334838}, "policy_reward_mean": {}, "timesteps_this_iter": 46135, "training_iteration": 140, "node_ip": "10.138.0.2", "episode_reward_min": 334.2183073261501, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5724.768653392792, "info": {"num_steps_trained": 7482489, "sample_time_ms": 24106.469, "load_time_ms": 4.106, "grad_time_ms": 11783.886, "update_time_ms": 8.439, "default": {"policy_loss": -0.011833088472485542, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.32847312092781067, "total_loss": 63.46303176879883, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 63.469791412353516, "kl": 0.015038466081023216, "entropy": 1.6112614870071411}, "num_steps_sampled": 7482489}, "episodes_total": 4270, "done": false, "date": "2019-05-21_08-38-30", "time_total_s": 5724.768653392792, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc10f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc12b0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.07, "time_this_iter_s": 35.1322808265686, "hostname": "flow-main", "episodes_this_iter": 36, "timestamp": 1558427910}
{"episode_reward_mean": 1048.687269970061, "timesteps_total": 7529956, "iterations_since_restore": 141, "timesteps_since_restore": 7529956, "num_metric_batches_dropped": 0, "episode_reward_max": 1161.430820179541, "custom_metrics": {"outflow_rate_min": 861.8816639597208, "system_level_velocity_min": 12.885333621712821, "cost1_max": 446.4234113911164, "system_level_velocity_max": 17.254584444435338, "cost2_min": -60.832594574765466, "outflow_rate_max": 1220.6842218636114, "system_level_velocity_mean": 15.71107018471148, "cost1_mean": 404.63538839410256, "cost2_mean": -42.31371318251693, "outflow_rate_mean": 1119.0317976049168, "cost2_max": -29.062771856772933, "cost1_min": 133.27397767334838}, "policy_reward_mean": {}, "timesteps_this_iter": 47467, "training_iteration": 141, "node_ip": "10.138.0.2", "episode_reward_min": 334.2183073261501, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5760.854634046555, "info": {"num_steps_trained": 7529956, "sample_time_ms": 24162.92, "load_time_ms": 4.059, "grad_time_ms": 11717.938, "update_time_ms": 8.191, "default": {"policy_loss": -0.011805251240730286, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.30809056758880615, "total_loss": 58.381439208984375, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 58.38762664794922, "kl": 0.016653532162308693, "entropy": 1.6103386878967285}, "num_steps_sampled": 7529956}, "episodes_total": 4303, "done": false, "date": "2019-05-21_08-39-06", "time_total_s": 5760.854634046555, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00dcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00de80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d240>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.07, "time_this_iter_s": 36.08598065376282, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558427946}
{"episode_reward_mean": 1054.2544848645637, "timesteps_total": 7577762, "iterations_since_restore": 142, "timesteps_since_restore": 7577762, "num_metric_batches_dropped": 0, "episode_reward_max": 1179.9381097918047, "custom_metrics": {"outflow_rate_min": 938.6106737210465, "system_level_velocity_min": 12.885333621712821, "cost1_max": 450.06650445214046, "system_level_velocity_max": 17.48049740420374, "cost2_min": -58.35270945624894, "outflow_rate_max": 1262.3045877949442, "system_level_velocity_mean": 15.82683575819671, "cost1_mean": 405.2254818781915, "cost2_mean": -41.67090910841678, "outflow_rate_mean": 1131.401745361116, "cost2_max": -28.576813986296738, "cost1_min": 133.27397767334838}, "policy_reward_mean": {}, "timesteps_this_iter": 47806, "training_iteration": 142, "node_ip": "10.138.0.2", "episode_reward_min": 334.2183073261501, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5798.504768371582, "info": {"num_steps_trained": 7577762, "sample_time_ms": 24432.432, "load_time_ms": 4.043, "grad_time_ms": 11601.17, "update_time_ms": 8.373, "default": {"policy_loss": -0.01288672722876072, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2905751168727875, "total_loss": 62.78828811645508, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 62.795860290527344, "kl": 0.01576571725308895, "entropy": 1.617709994316101}, "num_steps_sampled": 7577762}, "episodes_total": 4335, "done": false, "date": "2019-05-21_08-39-44", "time_total_s": 5798.504768371582, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8860>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 691.04, "time_this_iter_s": 37.650134325027466, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558427984}
{"episode_reward_mean": 1063.8993158745566, "timesteps_total": 7624399, "iterations_since_restore": 143, "timesteps_since_restore": 7624399, "num_metric_batches_dropped": 0, "episode_reward_max": 1179.9381097918047, "custom_metrics": {"outflow_rate_min": 973.112, "system_level_velocity_min": 12.41649176404596, "cost1_max": 450.06650445214046, "system_level_velocity_max": 17.48049740420374, "cost2_min": -57.673289138884755, "outflow_rate_max": 1262.3045877949442, "system_level_velocity_mean": 15.95722382746139, "cost1_mean": 411.35798978146573, "cost2_mean": -41.12238724164468, "outflow_rate_mean": 1135.2488433897374, "cost2_max": -28.576813986296738, "cost1_min": 187.36256481827098}, "policy_reward_mean": {}, "timesteps_this_iter": 46637, "training_iteration": 143, "node_ip": "10.138.0.2", "episode_reward_min": 463.49266412501936, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5834.954728126526, "info": {"num_steps_trained": 7624399, "sample_time_ms": 24331.161, "load_time_ms": 4.071, "grad_time_ms": 11577.225, "update_time_ms": 8.132, "default": {"policy_loss": -0.013610370457172394, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2776542603969574, "total_loss": 64.48438262939453, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 64.49211120605469, "kl": 0.01743806153535843, "entropy": 1.632161259651184}, "num_steps_sampled": 7624399}, "episodes_total": 4368, "done": false, "date": "2019-05-21_08-40-20", "time_total_s": 5834.954728126526, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003748>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.97, "time_this_iter_s": 36.44995975494385, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558428020}
{"episode_reward_mean": 1050.0886733308355, "timesteps_total": 7671978, "iterations_since_restore": 144, "timesteps_since_restore": 7671978, "num_metric_batches_dropped": 0, "episode_reward_max": 1179.9381097918047, "custom_metrics": {"outflow_rate_min": 941.9932071911261, "system_level_velocity_min": 12.41649176404596, "cost1_max": 450.06650445214046, "system_level_velocity_max": 17.48049740420374, "cost2_min": -57.85031511607887, "outflow_rate_max": 1262.3045877949442, "system_level_velocity_mean": 15.772841673935442, "cost1_mean": 406.05111587928286, "cost2_mean": -41.4547961588829, "outflow_rate_mean": 1125.9343065123446, "cost2_max": -28.576813986296738, "cost1_min": 187.36256481827098}, "policy_reward_mean": {}, "timesteps_this_iter": 47579, "training_iteration": 144, "node_ip": "10.138.0.2", "episode_reward_min": 463.49266412501936, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5871.162286520004, "info": {"num_steps_trained": 7671978, "sample_time_ms": 24193.775, "load_time_ms": 4.281, "grad_time_ms": 11808.82, "update_time_ms": 8.209, "default": {"policy_loss": -0.012050148099660873, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2776409983634949, "total_loss": 62.49884033203125, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 62.5050163269043, "kl": 0.01739000901579857, "entropy": 1.6565866470336914}, "num_steps_sampled": 7671978}, "episodes_total": 4400, "done": false, "date": "2019-05-21_08-40-56", "time_total_s": 5871.162286520004, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf240>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.97, "time_this_iter_s": 36.207558393478394, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558428056}
{"episode_reward_mean": 1040.2781986986, "timesteps_total": 7718836, "iterations_since_restore": 145, "timesteps_since_restore": 7718836, "num_metric_batches_dropped": 0, "episode_reward_max": 1161.7813523420275, "custom_metrics": {"outflow_rate_min": 941.9932071911261, "system_level_velocity_min": 11.850476056086128, "cost1_max": 441.29185455086537, "system_level_velocity_max": 17.15621840211055, "cost2_min": -57.85031511607887, "outflow_rate_max": 1220.6427480952218, "system_level_velocity_mean": 15.596747756436093, "cost1_mean": 403.8694146003573, "cost2_mean": -41.204337784302595, "outflow_rate_mean": 1109.774789574988, "cost2_max": -31.3862346279953, "cost1_min": 304.8908506726346}, "policy_reward_mean": {}, "timesteps_this_iter": 46858, "training_iteration": 145, "node_ip": "10.138.0.2", "episode_reward_min": 857.5259631976203, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5908.863351583481, "info": {"num_steps_trained": 7718836, "sample_time_ms": 24157.338, "load_time_ms": 4.322, "grad_time_ms": 11834.571, "update_time_ms": 8.452, "default": {"policy_loss": -0.013565801084041595, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.33440831303596497, "total_loss": 57.407596588134766, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 57.41573715209961, "kl": 0.01604314148426056, "entropy": 1.667604684829712}, "num_steps_sampled": 7718836}, "episodes_total": 4432, "done": false, "date": "2019-05-21_08-41-34", "time_total_s": 5908.863351583481, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc87b8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 37.70106506347656, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558428094}
{"episode_reward_mean": 1033.3780933160888, "timesteps_total": 7765782, "iterations_since_restore": 146, "timesteps_since_restore": 7765782, "num_metric_batches_dropped": 0, "episode_reward_max": 1151.398577744518, "custom_metrics": {"outflow_rate_min": 897.9851686602873, "system_level_velocity_min": 11.850476056086128, "cost1_max": 443.82498759953273, "system_level_velocity_max": 17.26388960078419, "cost2_min": -57.85031511607887, "outflow_rate_max": 1243.473036383906, "system_level_velocity_mean": 15.442411428850896, "cost1_mean": 399.7176790590319, "cost2_mean": -41.3853346672376, "outflow_rate_mean": 1105.427895300428, "cost2_max": -31.3862346279953, "cost1_min": 304.8908506726346}, "policy_reward_mean": {}, "timesteps_this_iter": 46946, "training_iteration": 146, "node_ip": "10.138.0.2", "episode_reward_min": 857.5259631976203, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5944.382651567459, "info": {"num_steps_trained": 7765782, "sample_time_ms": 24220.741, "load_time_ms": 4.192, "grad_time_ms": 11850.955, "update_time_ms": 8.319, "default": {"policy_loss": -0.014987402595579624, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3937198519706726, "total_loss": 54.10646057128906, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 54.1163215637207, "kl": 0.015196573920547962, "entropy": 1.6408274173736572}, "num_steps_sampled": 7765782}, "episodes_total": 4463, "done": false, "date": "2019-05-21_08-42-10", "time_total_s": 5944.382651567459, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc84a8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 35.51929998397827, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558428130}
{"episode_reward_mean": 1026.7253574264303, "timesteps_total": 7812764, "iterations_since_restore": 147, "timesteps_since_restore": 7812764, "num_metric_batches_dropped": 0, "episode_reward_max": 1151.398577744518, "custom_metrics": {"outflow_rate_min": 897.9851686602873, "system_level_velocity_min": 11.850476056086128, "cost1_max": 443.82498759953273, "system_level_velocity_max": 17.26388960078419, "cost2_min": -57.85031511607887, "outflow_rate_max": 1243.473036383906, "system_level_velocity_mean": 15.472539756280389, "cost1_mean": 398.17734940164934, "cost2_mean": -41.717628061869824, "outflow_rate_mean": 1107.548224489369, "cost2_max": -31.3862346279953, "cost1_min": 173.9731911765159}, "policy_reward_mean": {}, "timesteps_this_iter": 46982, "training_iteration": 147, "node_ip": "10.138.0.2", "episode_reward_min": 436.2811880626953, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 5979.284737110138, "info": {"num_steps_trained": 7812764, "sample_time_ms": 23939.596, "load_time_ms": 4.239, "grad_time_ms": 12001.129, "update_time_ms": 8.421, "default": {"policy_loss": -0.014836402609944344, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.39134469628334045, "total_loss": 58.4371452331543, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 58.44652557373047, "kl": 0.016155315563082695, "entropy": 1.6686434745788574}, "num_steps_sampled": 7812764}, "episodes_total": 4495, "done": false, "date": "2019-05-21_08-42-45", "time_total_s": 5979.284737110138, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d128>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.54, "time_this_iter_s": 34.90208554267883, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558428165}
{"episode_reward_mean": 1024.0675587790442, "timesteps_total": 7860695, "iterations_since_restore": 148, "timesteps_since_restore": 7860695, "num_metric_batches_dropped": 0, "episode_reward_max": 1174.373805305581, "custom_metrics": {"outflow_rate_min": 897.9851686602873, "system_level_velocity_min": 12.595526468434015, "cost1_max": 443.8515946818606, "system_level_velocity_max": 17.26388960078419, "cost2_min": -56.62091226541759, "outflow_rate_max": 1263.7293452142399, "system_level_velocity_mean": 15.459302104888627, "cost1_mean": 397.5386855731654, "cost2_mean": -42.139783356405786, "outflow_rate_mean": 1106.7290869113367, "cost2_max": -32.91916591840187, "cost1_min": 173.9731911765159}, "policy_reward_mean": {}, "timesteps_this_iter": 47931, "training_iteration": 148, "node_ip": "10.138.0.2", "episode_reward_min": 436.2811880626953, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6016.482090473175, "info": {"num_steps_trained": 7860695, "sample_time_ms": 23810.702, "load_time_ms": 4.588, "grad_time_ms": 12292.993, "update_time_ms": 8.322, "default": {"policy_loss": -0.01294422522187233, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4417246878147125, "total_loss": 55.84669494628906, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 55.85457229614258, "kl": 0.015036151744425297, "entropy": 1.7019011974334717}, "num_steps_sampled": 7860695}, "episodes_total": 4526, "done": false, "date": "2019-05-21_08-43-22", "time_total_s": 6016.482090473175, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf240>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.54, "time_this_iter_s": 37.19735336303711, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558428202}
{"episode_reward_mean": 1013.5284210001826, "timesteps_total": 7908196, "iterations_since_restore": 149, "timesteps_since_restore": 7908196, "num_metric_batches_dropped": 0, "episode_reward_max": 1179.5326235505522, "custom_metrics": {"outflow_rate_min": 816.1924469474952, "system_level_velocity_min": 11.347376887802964, "cost1_max": 448.6339434775599, "system_level_velocity_max": 17.38719850896442, "cost2_min": -56.62091226541759, "outflow_rate_max": 1293.817503130208, "system_level_velocity_mean": 15.317858494991803, "cost1_mean": 393.8049690155523, "cost2_mean": -42.86166061651726, "outflow_rate_mean": 1099.7367834264664, "cost2_max": -32.91916591840187, "cost1_min": 173.9731911765159}, "policy_reward_mean": {}, "timesteps_this_iter": 47501, "training_iteration": 149, "node_ip": "10.138.0.2", "episode_reward_min": 436.2811880626953, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6053.900688171387, "info": {"num_steps_trained": 7908196, "sample_time_ms": 24068.794, "load_time_ms": 4.743, "grad_time_ms": 12245.554, "update_time_ms": 8.389, "default": {"policy_loss": -0.012422158382833004, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3465806543827057, "total_loss": 64.64503479003906, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 64.65206909179688, "kl": 0.015969103202223778, "entropy": 1.6816294193267822}, "num_steps_sampled": 7908196}, "episodes_total": 4560, "done": false, "date": "2019-05-21_08-43-59", "time_total_s": 6053.900688171387, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7f60>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.54, "time_this_iter_s": 37.41859769821167, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558428239}
{"episode_reward_mean": 1021.0892049134121, "timesteps_total": 7955321, "iterations_since_restore": 150, "timesteps_since_restore": 7955321, "num_metric_batches_dropped": 0, "episode_reward_max": 1179.5326235505522, "custom_metrics": {"outflow_rate_min": 816.1924469474952, "system_level_velocity_min": 11.347376887802964, "cost1_max": 448.6339434775599, "system_level_velocity_max": 17.38719850896442, "cost2_min": -57.52424445502779, "outflow_rate_max": 1293.817503130208, "system_level_velocity_mean": 15.237251721131079, "cost1_mean": 394.08158228064013, "cost2_mean": -43.63936242717668, "outflow_rate_mean": 1102.7814603552788, "cost2_max": -32.91916591840187, "cost1_min": 289.00518162125627}, "policy_reward_mean": {}, "timesteps_this_iter": 47125, "training_iteration": 150, "node_ip": "10.138.0.2", "episode_reward_min": 782.1724106182849, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6092.109778881073, "info": {"num_steps_trained": 7955321, "sample_time_ms": 24357.638, "load_time_ms": 4.709, "grad_time_ms": 12266.448, "update_time_ms": 8.679, "default": {"policy_loss": -0.014054113999009132, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3570190966129303, "total_loss": 59.992034912109375, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 60.000423431396484, "kl": 0.016773393377661705, "entropy": 1.6643165349960327}, "num_steps_sampled": 7955321}, "episodes_total": 4594, "done": false, "date": "2019-05-21_08-44-38", "time_total_s": 6092.109778881073, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbac18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d128>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 38.20909070968628, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558428278}
{"episode_reward_mean": 1016.827697321536, "timesteps_total": 8002491, "iterations_since_restore": 151, "timesteps_since_restore": 8002491, "num_metric_batches_dropped": 0, "episode_reward_max": 1187.9288873322844, "custom_metrics": {"outflow_rate_min": 816.1924469474952, "system_level_velocity_min": 11.347376887802964, "cost1_max": 448.6339434775599, "system_level_velocity_max": 17.38719850896442, "cost2_min": -58.52418935610399, "outflow_rate_max": 1293.817503130208, "system_level_velocity_mean": 15.292117568145786, "cost1_mean": 393.2002341336317, "cost2_mean": -43.62997107506738, "outflow_rate_mean": 1106.803867338027, "cost2_max": -26.684779958662375, "cost1_min": 241.4523729649497}, "policy_reward_mean": {}, "timesteps_this_iter": 47170, "training_iteration": 151, "node_ip": "10.138.0.2", "episode_reward_min": 621.6825364347994, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6128.340593338013, "info": {"num_steps_trained": 8002491, "sample_time_ms": 24519.178, "load_time_ms": 4.549, "grad_time_ms": 12119.651, "update_time_ms": 8.732, "default": {"policy_loss": -0.011983029544353485, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3852730095386505, "total_loss": 56.94472885131836, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 56.9516487121582, "kl": 0.015001581981778145, "entropy": 1.683966875076294}, "num_steps_sampled": 8002491}, "episodes_total": 4625, "done": false, "date": "2019-05-21_08-45-14", "time_total_s": 6128.340593338013, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4278>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 696.52, "time_this_iter_s": 36.2308144569397, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558428314}
{"episode_reward_mean": 1020.2206235701228, "timesteps_total": 8049279, "iterations_since_restore": 152, "timesteps_since_restore": 8049279, "num_metric_batches_dropped": 0, "episode_reward_max": 1187.9288873322844, "custom_metrics": {"outflow_rate_min": 898.4830610757338, "system_level_velocity_min": 11.945933997124778, "cost1_max": 447.24091965341006, "system_level_velocity_max": 17.32526383597778, "cost2_min": -58.52418935610399, "outflow_rate_max": 1271.6301011537635, "system_level_velocity_mean": 15.452731873436479, "cost1_mean": 397.0467133750463, "cost2_mean": -42.79580500466359, "outflow_rate_mean": 1104.8742572931503, "cost2_max": -26.684779958662375, "cost1_min": 241.4523729649497}, "policy_reward_mean": {}, "timesteps_this_iter": 46788, "training_iteration": 152, "node_ip": "10.138.0.2", "episode_reward_min": 621.6825364347994, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6166.082039356232, "info": {"num_steps_trained": 8049279, "sample_time_ms": 24374.04, "load_time_ms": 4.496, "grad_time_ms": 12274.896, "update_time_ms": 8.419, "default": {"policy_loss": -0.01168021373450756, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.39641281962394714, "total_loss": 58.40226745605469, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 58.40810012817383, "kl": 0.017328152433037758, "entropy": 1.68631911277771}, "num_steps_sampled": 8049279}, "episodes_total": 4657, "done": false, "date": "2019-05-21_08-45-52", "time_total_s": 6166.082039356232, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba8d0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 696.52, "time_this_iter_s": 37.741446018218994, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558428352}
{"episode_reward_mean": 1020.6845307709515, "timesteps_total": 8096308, "iterations_since_restore": 153, "timesteps_since_restore": 8096308, "num_metric_batches_dropped": 0, "episode_reward_max": 1188.420426295663, "custom_metrics": {"outflow_rate_min": 431.30669408632065, "system_level_velocity_min": 11.945933997124778, "cost1_max": 447.24091965341006, "system_level_velocity_max": 17.519799375799078, "cost2_min": -58.52418935610399, "outflow_rate_max": 1274.6755664847972, "system_level_velocity_mean": 15.692995091369294, "cost1_mean": 399.02103476742855, "cost2_mean": -41.12700088881818, "outflow_rate_mean": 1103.185657485926, "cost2_max": -20.866210217313693, "cost1_min": 22.284263890155646}, "policy_reward_mean": {}, "timesteps_this_iter": 47029, "training_iteration": 153, "node_ip": "10.138.0.2", "episode_reward_min": 57.54974804476952, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6200.7815182209015, "info": {"num_steps_trained": 8096308, "sample_time_ms": 24275.305, "load_time_ms": 4.474, "grad_time_ms": 12197.451, "update_time_ms": 8.617, "default": {"policy_loss": -0.012059484608471394, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.364144891500473, "total_loss": 63.11552810668945, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 63.122371673583984, "kl": 0.015437629073858261, "entropy": 1.7031745910644531}, "num_steps_sampled": 8096308}, "episodes_total": 4690, "done": false, "date": "2019-05-21_08-46-26", "time_total_s": 6200.7815182209015, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8a20>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 689.87, "time_this_iter_s": 34.6994788646698, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558428386}
{"episode_reward_mean": 999.65833113219, "timesteps_total": 8142782, "iterations_since_restore": 154, "timesteps_since_restore": 8142782, "num_metric_batches_dropped": 0, "episode_reward_max": 1188.420426295663, "custom_metrics": {"outflow_rate_min": 431.30669408632065, "system_level_velocity_min": 12.69777104579465, "cost1_max": 448.89439048261227, "system_level_velocity_max": 18.134683867112024, "cost2_min": -59.08991244890745, "outflow_rate_max": 1274.6755664847972, "system_level_velocity_mean": 15.68772391589453, "cost1_mean": 392.6023668927127, "cost2_mean": -40.18520060437338, "outflow_rate_mean": 1087.1237289523194, "cost2_max": -18.12965956139897, "cost1_min": 22.284263890155646}, "policy_reward_mean": {}, "timesteps_this_iter": 46474, "training_iteration": 154, "node_ip": "10.138.0.2", "episode_reward_min": 55.043938640021935, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6236.809702157974, "info": {"num_steps_trained": 8142782, "sample_time_ms": 24563.113, "load_time_ms": 4.221, "grad_time_ms": 11894.007, "update_time_ms": 8.837, "default": {"policy_loss": -0.012143067084252834, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3014582693576813, "total_loss": 66.98084259033203, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 66.98734283447266, "kl": 0.016707655042409897, "entropy": 1.7049530744552612}, "num_steps_sampled": 8142782}, "episodes_total": 4725, "done": false, "date": "2019-05-21_08-47-02", "time_total_s": 6236.809702157974, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd44a8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 680.21, "time_this_iter_s": 36.028183937072754, "hostname": "flow-main", "episodes_this_iter": 35, "timestamp": 1558428422}
{"episode_reward_mean": 989.3303536648274, "timesteps_total": 8188223, "iterations_since_restore": 155, "timesteps_since_restore": 8188223, "num_metric_batches_dropped": 0, "episode_reward_max": 1188.420426295663, "custom_metrics": {"outflow_rate_min": 431.30669408632065, "system_level_velocity_min": 12.326278718417074, "cost1_max": 448.89439048261227, "system_level_velocity_max": 18.134683867112024, "cost2_min": -59.08991244890745, "outflow_rate_max": 1274.6755664847972, "system_level_velocity_mean": 15.689514337356954, "cost1_mean": 392.22271252512905, "cost2_mean": -39.957642257990834, "outflow_rate_mean": 1080.9039175493162, "cost2_max": -18.12965956139897, "cost1_min": 22.284263890155646}, "policy_reward_mean": {}, "timesteps_this_iter": 45441, "training_iteration": 155, "node_ip": "10.138.0.2", "episode_reward_min": 55.043938640021935, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6271.178267717361, "info": {"num_steps_trained": 8188223, "sample_time_ms": 24470.333, "load_time_ms": 4.24, "grad_time_ms": 11652.938, "update_time_ms": 8.563, "default": {"policy_loss": -0.013829649426043034, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3672094941139221, "total_loss": 55.77828598022461, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 55.78662109375, "kl": 0.016271580010652542, "entropy": 1.7382924556732178}, "num_steps_sampled": 8188223}, "episodes_total": 4756, "done": false, "date": "2019-05-21_08-47-37", "time_total_s": 6271.178267717361, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbaa58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba828>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 680.21, "time_this_iter_s": 34.36856555938721, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558428457}
{"episode_reward_mean": 990.497825206746, "timesteps_total": 8234647, "iterations_since_restore": 156, "timesteps_since_restore": 8234647, "num_metric_batches_dropped": 0, "episode_reward_max": 1178.5037689718747, "custom_metrics": {"outflow_rate_min": 469.45002216272013, "system_level_velocity_min": 12.326278718417074, "cost1_max": 448.89439048261227, "system_level_velocity_max": 18.134683867112024, "cost2_min": -59.08991244890745, "outflow_rate_max": 1270.6981994345988, "system_level_velocity_mean": 15.649492035922108, "cost1_mean": 394.62732684069533, "cost2_mean": -40.16153003415093, "outflow_rate_mean": 1080.6077022322468, "cost2_max": -18.12965956139897, "cost1_min": 22.444296047388427}, "policy_reward_mean": {}, "timesteps_this_iter": 46424, "training_iteration": 156, "node_ip": "10.138.0.2", "episode_reward_min": 55.043938640021935, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6306.6940269470215, "info": {"num_steps_trained": 8234647, "sample_time_ms": 24440.865, "load_time_ms": 4.42, "grad_time_ms": 11682.098, "update_time_ms": 8.6, "default": {"policy_loss": -0.012184222228825092, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3052537739276886, "total_loss": 60.08797836303711, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 60.095088958740234, "kl": 0.015029181726276875, "entropy": 1.7202037572860718}, "num_steps_sampled": 8234647}, "episodes_total": 4789, "done": false, "date": "2019-05-21_08-48-12", "time_total_s": 6306.6940269470215, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafe80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafdd8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 686.86, "time_this_iter_s": 35.515759229660034, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558428492}
{"episode_reward_mean": 990.6318995365423, "timesteps_total": 8280877, "iterations_since_restore": 157, "timesteps_since_restore": 8280877, "num_metric_batches_dropped": 0, "episode_reward_max": 1178.5037689718747, "custom_metrics": {"outflow_rate_min": 812.74296875, "system_level_velocity_min": 10.684298763096262, "cost1_max": 448.89439048261227, "system_level_velocity_max": 17.391620299473892, "cost2_min": -59.412488743309495, "outflow_rate_max": 1270.6981994345988, "system_level_velocity_mean": 15.523678453736293, "cost1_mean": 395.4505923937177, "cost2_mean": -40.64487924861902, "outflow_rate_mean": 1077.7404729112757, "cost2_max": -24.775116538879782, "cost1_min": 170.71017496278893}, "policy_reward_mean": {}, "timesteps_this_iter": 46230, "training_iteration": 157, "node_ip": "10.138.0.2", "episode_reward_min": 446.1728599719239, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6340.954863548279, "info": {"num_steps_trained": 8280877, "sample_time_ms": 24423.151, "load_time_ms": 4.477, "grad_time_ms": 11635.198, "update_time_ms": 8.679, "default": {"policy_loss": -0.012726105749607086, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.28846991062164307, "total_loss": 61.6486701965332, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 61.655250549316406, "kl": 0.018206989392638206, "entropy": 1.73228919506073}, "num_steps_sampled": 8280877}, "episodes_total": 4820, "done": false, "date": "2019-05-21_08-48-47", "time_total_s": 6340.954863548279, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc76a0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 692.41, "time_this_iter_s": 34.260836601257324, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558428527}
{"episode_reward_mean": 990.8178837615794, "timesteps_total": 8327924, "iterations_since_restore": 158, "timesteps_since_restore": 8327924, "num_metric_batches_dropped": 0, "episode_reward_max": 1171.3431674720996, "custom_metrics": {"outflow_rate_min": 812.74296875, "system_level_velocity_min": 10.684298763096262, "cost1_max": 442.85030029179745, "system_level_velocity_max": 17.696547865394287, "cost2_min": -59.412488743309495, "outflow_rate_max": 1249.2283146067418, "system_level_velocity_mean": 15.549842068239244, "cost1_mean": 392.5229829334343, "cost2_mean": -40.45949805110468, "outflow_rate_mean": 1080.5095242007326, "cost2_max": -24.775116538879782, "cost1_min": 131.06303867438186}, "policy_reward_mean": {}, "timesteps_this_iter": 47047, "training_iteration": 158, "node_ip": "10.138.0.2", "episode_reward_min": 325.93584643907496, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6377.183106184006, "info": {"num_steps_trained": 8327924, "sample_time_ms": 24477.653, "load_time_ms": 4.112, "grad_time_ms": 11485.956, "update_time_ms": 9.086, "default": {"policy_loss": -0.0134420832619071, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.29112306237220764, "total_loss": 55.020572662353516, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 55.02859878540039, "kl": 0.016054200008511543, "entropy": 1.7679942846298218}, "num_steps_sampled": 8327924}, "episodes_total": 4852, "done": false, "date": "2019-05-21_08-49-23", "time_total_s": 6377.183106184006, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba160>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 686.58, "time_this_iter_s": 36.22824263572693, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558428563}
{"episode_reward_mean": 987.6812513196869, "timesteps_total": 8374709, "iterations_since_restore": 159, "timesteps_since_restore": 8374709, "num_metric_batches_dropped": 0, "episode_reward_max": 1170.2963164587754, "custom_metrics": {"outflow_rate_min": 812.74296875, "system_level_velocity_min": 10.684298763096262, "cost1_max": 442.85030029179745, "system_level_velocity_max": 17.696547865394287, "cost2_min": -59.412488743309495, "outflow_rate_max": 1253.5484296243155, "system_level_velocity_mean": 15.41066346833962, "cost1_mean": 387.0544226785548, "cost2_mean": -41.204653385948234, "outflow_rate_mean": 1081.0794179345796, "cost2_max": -25.86921442931314, "cost1_min": 130.95780207352507}, "policy_reward_mean": {}, "timesteps_this_iter": 46785, "training_iteration": 159, "node_ip": "10.138.0.2", "episode_reward_min": 325.93584643907496, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6413.489857196808, "info": {"num_steps_trained": 8374709, "sample_time_ms": 24371.186, "load_time_ms": 3.939, "grad_time_ms": 11483.718, "update_time_ms": 8.896, "default": {"policy_loss": -0.010875013656914234, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.16648532450199127, "total_loss": 68.69113159179688, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 68.69686126708984, "kl": 0.015238437801599503, "entropy": 1.745303750038147}, "num_steps_sampled": 8374709}, "episodes_total": 4888, "done": false, "date": "2019-05-21_08-49-59", "time_total_s": 6413.489857196808, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf240>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 681.65, "time_this_iter_s": 36.306751012802124, "hostname": "flow-main", "episodes_this_iter": 36, "timestamp": 1558428599}
{"episode_reward_mean": 991.6878321893097, "timesteps_total": 8421918, "iterations_since_restore": 160, "timesteps_since_restore": 8421918, "num_metric_batches_dropped": 0, "episode_reward_max": 1170.2963164587754, "custom_metrics": {"outflow_rate_min": 932.6199762950168, "system_level_velocity_min": 12.162193753827866, "cost1_max": 442.85030029179745, "system_level_velocity_max": 17.696547865394287, "cost2_min": -60.26558168302309, "outflow_rate_max": 1253.5484296243155, "system_level_velocity_mean": 15.42275724420063, "cost1_mean": 387.3563362054067, "cost2_mean": -41.73126916716328, "outflow_rate_mean": 1087.9014996078142, "cost2_max": -25.86921442931314, "cost1_min": 130.95780207352507}, "policy_reward_mean": {}, "timesteps_this_iter": 47209, "training_iteration": 160, "node_ip": "10.138.0.2", "episode_reward_min": 325.93584643907496, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6448.48930811882, "info": {"num_steps_trained": 8421918, "sample_time_ms": 23982.304, "load_time_ms": 3.975, "grad_time_ms": 11551.753, "update_time_ms": 8.833, "default": {"policy_loss": -0.012711180374026299, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.25651562213897705, "total_loss": 56.222930908203125, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 56.230255126953125, "kl": 0.015955213457345963, "entropy": 1.7588317394256592}, "num_steps_sampled": 8421918}, "episodes_total": 4920, "done": false, "date": "2019-05-21_08-50-34", "time_total_s": 6448.48930811882, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd46d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4c18>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 681.28, "time_this_iter_s": 34.99945092201233, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558428634}
{"episode_reward_mean": 1000.9539237920693, "timesteps_total": 8468611, "iterations_since_restore": 161, "timesteps_since_restore": 8468611, "num_metric_batches_dropped": 0, "episode_reward_max": 1170.2963164587754, "custom_metrics": {"outflow_rate_min": 883.0413258384148, "system_level_velocity_min": 12.244411527333387, "cost1_max": 439.5211061385935, "system_level_velocity_max": 17.00272207890058, "cost2_min": -60.26558168302309, "outflow_rate_max": 1253.5484296243155, "system_level_velocity_mean": 15.30950447642258, "cost1_mean": 391.11037265629864, "cost2_mean": -42.20099970312332, "outflow_rate_mean": 1088.4070917014542, "cost2_max": -25.86921442931314, "cost1_min": 130.95780207352507}, "policy_reward_mean": {}, "timesteps_this_iter": 46693, "training_iteration": 161, "node_ip": "10.138.0.2", "episode_reward_min": 332.93294929792006, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6484.61926817894, "info": {"num_steps_trained": 8468611, "sample_time_ms": 23580.509, "load_time_ms": 4.15, "grad_time_ms": 11941.542, "update_time_ms": 8.966, "default": {"policy_loss": -0.014646732248365879, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3627268970012665, "total_loss": 48.39957046508789, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 48.40864181518555, "kl": 0.016510989516973495, "entropy": 1.7750825881958008}, "num_steps_sampled": 8468611}, "episodes_total": 4952, "done": false, "date": "2019-05-21_08-51-11", "time_total_s": 6484.61926817894, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7b00>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 691.14, "time_this_iter_s": 36.12996006011963, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558428671}
{"episode_reward_mean": 994.7079724288704, "timesteps_total": 8515749, "iterations_since_restore": 162, "timesteps_since_restore": 8515749, "num_metric_batches_dropped": 0, "episode_reward_max": 1131.2764804879046, "custom_metrics": {"outflow_rate_min": 444.7085564036169, "system_level_velocity_min": 12.244411527333387, "cost1_max": 441.0675484854724, "system_level_velocity_max": 17.127590113322665, "cost2_min": -60.26558168302309, "outflow_rate_max": 1237.3642904656313, "system_level_velocity_mean": 15.33632476712927, "cost1_mean": 390.2242743865986, "cost2_mean": -41.92983265461143, "outflow_rate_mean": 1080.4627447540297, "cost2_max": -19.171393625978506, "cost1_min": 18.47660058242693}, "policy_reward_mean": {}, "timesteps_this_iter": 47138, "training_iteration": 162, "node_ip": "10.138.0.2", "episode_reward_min": 45.92207836262097, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6520.849489688873, "info": {"num_steps_trained": 8515749, "sample_time_ms": 23578.135, "load_time_ms": 4.463, "grad_time_ms": 11790.341, "update_time_ms": 9.135, "default": {"policy_loss": -0.013059196062386036, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3507137596607208, "total_loss": 56.377899169921875, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 56.38542938232422, "kl": 0.01638214848935604, "entropy": 1.7917882204055786}, "num_steps_sampled": 8515749}, "episodes_total": 4986, "done": false, "date": "2019-05-21_08-51-47", "time_total_s": 6520.849489688873, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc83c8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 689.35, "time_this_iter_s": 36.23022150993347, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558428707}
{"episode_reward_mean": 994.4711859354366, "timesteps_total": 8562401, "iterations_since_restore": 163, "timesteps_since_restore": 8562401, "num_metric_batches_dropped": 0, "episode_reward_max": 1141.1985099834965, "custom_metrics": {"outflow_rate_min": 444.7085564036169, "system_level_velocity_min": 11.345016560884721, "cost1_max": 441.0675484854724, "system_level_velocity_max": 17.127590113322665, "cost2_min": -59.88314460531673, "outflow_rate_max": 1209.1296053755746, "system_level_velocity_mean": 15.184599563173267, "cost1_mean": 388.7872394274239, "cost2_mean": -42.31342401824938, "outflow_rate_mean": 1073.2128209021864, "cost2_max": -19.171393625978506, "cost1_min": 18.47660058242693}, "policy_reward_mean": {}, "timesteps_this_iter": 46652, "training_iteration": 163, "node_ip": "10.138.0.2", "episode_reward_min": 45.92207836262097, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6557.168222427368, "info": {"num_steps_trained": 8562401, "sample_time_ms": 23798.285, "load_time_ms": 4.473, "grad_time_ms": 11734.025, "update_time_ms": 8.916, "default": {"policy_loss": -0.014085201546549797, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2782782316207886, "total_loss": 60.69413757324219, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 60.702449798583984, "kl": 0.017124304547905922, "entropy": 1.7698277235031128}, "num_steps_sampled": 8562401}, "episodes_total": 5019, "done": false, "date": "2019-05-21_08-52-23", "time_total_s": 6557.168222427368, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7f60>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.28, "time_this_iter_s": 36.31873273849487, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558428743}
{"episode_reward_mean": 989.2117143319748, "timesteps_total": 8608738, "iterations_since_restore": 164, "timesteps_since_restore": 8608738, "num_metric_batches_dropped": 0, "episode_reward_max": 1141.1985099834965, "custom_metrics": {"outflow_rate_min": 444.7085564036169, "system_level_velocity_min": 11.345016560884721, "cost1_max": 441.0675484854724, "system_level_velocity_max": 17.127590113322665, "cost2_min": -59.88314460531673, "outflow_rate_max": 1209.1296053755746, "system_level_velocity_mean": 15.159070980118052, "cost1_mean": 387.8486168755402, "cost2_mean": -41.92555168308023, "outflow_rate_mean": 1064.5052194878483, "cost2_max": -19.171393625978506, "cost1_min": 18.47660058242693}, "policy_reward_mean": {}, "timesteps_this_iter": 46337, "training_iteration": 164, "node_ip": "10.138.0.2", "episode_reward_min": 45.92207836262097, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6592.264664411545, "info": {"num_steps_trained": 8608738, "sample_time_ms": 23694.601, "load_time_ms": 4.564, "grad_time_ms": 11742.672, "update_time_ms": 8.518, "default": {"policy_loss": -0.015027015469968319, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3376324772834778, "total_loss": 54.51639175415039, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 54.52566146850586, "kl": 0.01705772988498211, "entropy": 1.80922532081604}, "num_steps_sampled": 8608738}, "episodes_total": 5050, "done": false, "date": "2019-05-21_08-52-58", "time_total_s": 6592.264664411545, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c022400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4278>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.28, "time_this_iter_s": 35.096441984176636, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558428778}
{"episode_reward_mean": 992.7362326285415, "timesteps_total": 8655624, "iterations_since_restore": 165, "timesteps_since_restore": 8655624, "num_metric_batches_dropped": 0, "episode_reward_max": 1172.7240096794574, "custom_metrics": {"outflow_rate_min": 474.3699846082663, "system_level_velocity_min": 11.345016560884721, "cost1_max": 440.63255793716905, "system_level_velocity_max": 17.096440816345048, "cost2_min": -57.7578687880627, "outflow_rate_max": 1236.6931080513884, "system_level_velocity_mean": 15.203108472234824, "cost1_mean": 388.8999451953852, "cost2_mean": -41.99407712921822, "outflow_rate_mean": 1068.9363742090768, "cost2_max": -16.45122037234482, "cost1_min": 17.770017244903464}, "policy_reward_mean": {}, "timesteps_this_iter": 46886, "training_iteration": 165, "node_ip": "10.138.0.2", "episode_reward_min": 44.6248150334469, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6628.480359554291, "info": {"num_steps_trained": 8655624, "sample_time_ms": 23775.788, "load_time_ms": 4.567, "grad_time_ms": 11846.083, "update_time_ms": 8.684, "default": {"policy_loss": -0.011730926111340523, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2528449296951294, "total_loss": 64.00218963623047, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 64.00861358642578, "kl": 0.015723075717687607, "entropy": 1.778896689414978}, "num_steps_sampled": 8655624}, "episodes_total": 5084, "done": false, "date": "2019-05-21_08-53-35", "time_total_s": 6628.480359554291, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8390>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 692.96, "time_this_iter_s": 36.21569514274597, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558428815}
{"episode_reward_mean": 1012.0203961999342, "timesteps_total": 8702430, "iterations_since_restore": 166, "timesteps_since_restore": 8702430, "num_metric_batches_dropped": 0, "episode_reward_max": 1172.7240096794574, "custom_metrics": {"outflow_rate_min": 474.3699846082663, "system_level_velocity_min": 12.788164800548161, "cost1_max": 444.18915408728367, "system_level_velocity_max": 17.099278243952526, "cost2_min": -57.314739110989954, "outflow_rate_max": 1254.781990598166, "system_level_velocity_mean": 15.497079808038464, "cost1_mean": 396.5185426625745, "cost2_mean": -41.397423270627115, "outflow_rate_mean": 1088.1447281521487, "cost2_max": -16.45122037234482, "cost1_min": 17.770017244903464}, "policy_reward_mean": {}, "timesteps_this_iter": 46806, "training_iteration": 166, "node_ip": "10.138.0.2", "episode_reward_min": 44.6248150334469, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6662.079370498657, "info": {"num_steps_trained": 8702430, "sample_time_ms": 23686.44, "load_time_ms": 4.617, "grad_time_ms": 11742.679, "update_time_ms": 8.764, "default": {"policy_loss": -0.011863047257065773, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.33438920974731445, "total_loss": 57.7376823425293, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 57.7447624206543, "kl": 0.014166445471346378, "entropy": 1.7774908542633057}, "num_steps_sampled": 8702430}, "episodes_total": 5115, "done": false, "date": "2019-05-21_08-54-08", "time_total_s": 6662.079370498657, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4908>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 692.96, "time_this_iter_s": 33.599010944366455, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558428848}
{"episode_reward_mean": 1005.1473147626854, "timesteps_total": 8748419, "iterations_since_restore": 167, "timesteps_since_restore": 8748419, "num_metric_batches_dropped": 0, "episode_reward_max": 1172.7240096794574, "custom_metrics": {"outflow_rate_min": 474.3699846082663, "system_level_velocity_min": 12.788164800548161, "cost1_max": 444.18915408728367, "system_level_velocity_max": 17.099278243952526, "cost2_min": -64.1654721340933, "outflow_rate_max": 1254.781990598166, "system_level_velocity_mean": 15.505771400809211, "cost1_mean": 394.33924329764443, "cost2_mean": -41.6720050267683, "outflow_rate_mean": 1088.544875971994, "cost2_max": -16.45122037234482, "cost1_min": 17.770017244903464}, "policy_reward_mean": {}, "timesteps_this_iter": 45989, "training_iteration": 167, "node_ip": "10.138.0.2", "episode_reward_min": 44.6248150334469, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6697.85794878006, "info": {"num_steps_trained": 8748419, "sample_time_ms": 23873.762, "load_time_ms": 4.574, "grad_time_ms": 11708.797, "update_time_ms": 8.792, "default": {"policy_loss": -0.011651209555566311, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2659994661808014, "total_loss": 57.459659576416016, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 57.466094970703125, "kl": 0.01544929575175047, "entropy": 1.766849160194397}, "num_steps_sampled": 8748419}, "episodes_total": 5147, "done": false, "date": "2019-05-21_08-54-44", "time_total_s": 6697.85794878006, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc76d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc76a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc71d0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 689.5, "time_this_iter_s": 35.77857828140259, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558428884}
{"episode_reward_mean": 1011.2810587458154, "timesteps_total": 8794511, "iterations_since_restore": 168, "timesteps_since_restore": 8794511, "num_metric_batches_dropped": 0, "episode_reward_max": 1167.6501961116742, "custom_metrics": {"outflow_rate_min": 901.1128202764975, "system_level_velocity_min": 12.788164800548161, "cost1_max": 446.7994166242589, "system_level_velocity_max": 17.495460511205078, "cost2_min": -64.1654721340933, "outflow_rate_max": 1254.781990598166, "system_level_velocity_mean": 15.588763001055685, "cost1_mean": 398.6344181184584, "cost2_mean": -42.06621762019465, "outflow_rate_mean": 1098.504343095581, "cost2_max": -31.659832101389263, "cost1_min": 246.93476399620047}, "policy_reward_mean": {}, "timesteps_this_iter": 46092, "training_iteration": 168, "node_ip": "10.138.0.2", "episode_reward_min": 639.3922626272963, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6733.034287214279, "info": {"num_steps_trained": 8794511, "sample_time_ms": 23765.912, "load_time_ms": 4.601, "grad_time_ms": 11711.025, "update_time_ms": 8.403, "default": {"policy_loss": -0.013874383643269539, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.30379265546798706, "total_loss": 57.01918411254883, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 57.027896881103516, "kl": 0.015298817306756973, "entropy": 1.762144684791565}, "num_steps_sampled": 8794511}, "episodes_total": 5178, "done": false, "date": "2019-05-21_08-55-19", "time_total_s": 6733.034287214279, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8f28>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.49, "time_this_iter_s": 35.17633843421936, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558428919}
{"episode_reward_mean": 1004.3148894695937, "timesteps_total": 8840762, "iterations_since_restore": 169, "timesteps_since_restore": 8840762, "num_metric_batches_dropped": 0, "episode_reward_max": 1160.7626171085615, "custom_metrics": {"outflow_rate_min": 901.1128202764975, "system_level_velocity_min": 13.19768075161113, "cost1_max": 446.7994166242589, "system_level_velocity_max": 17.495460511205078, "cost2_min": -69.90664093738044, "outflow_rate_max": 1252.9720914026275, "system_level_velocity_mean": 15.563421596829697, "cost1_mean": 397.5292043283226, "cost2_mean": -42.54665719253756, "outflow_rate_mean": 1091.8916003458708, "cost2_max": -31.659832101389263, "cost1_min": 246.93476399620047}, "policy_reward_mean": {}, "timesteps_this_iter": 46251, "training_iteration": 169, "node_ip": "10.138.0.2", "episode_reward_min": 639.3922626272963, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6768.311623096466, "info": {"num_steps_trained": 8840762, "sample_time_ms": 23559.837, "load_time_ms": 4.619, "grad_time_ms": 11811.711, "update_time_ms": 8.446, "default": {"policy_loss": -0.012444891966879368, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2910217046737671, "total_loss": 61.140933990478516, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 61.148258209228516, "kl": 0.015181311406195164, "entropy": 1.8047254085540771}, "num_steps_sampled": 8840762}, "episodes_total": 5211, "done": false, "date": "2019-05-21_08-55-55", "time_total_s": 6768.311623096466, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaffd0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.49, "time_this_iter_s": 35.27733588218689, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558428955}
{"episode_reward_mean": 1004.9813915549715, "timesteps_total": 8887350, "iterations_since_restore": 170, "timesteps_since_restore": 8887350, "num_metric_batches_dropped": 0, "episode_reward_max": 1160.7626171085615, "custom_metrics": {"outflow_rate_min": 901.1128202764975, "system_level_velocity_min": 13.103575172432128, "cost1_max": 446.7994166242589, "system_level_velocity_max": 17.495460511205078, "cost2_min": -69.90664093738044, "outflow_rate_max": 1252.9720914026275, "system_level_velocity_mean": 15.569724096999298, "cost1_mean": 397.04687642726503, "cost2_mean": -42.186178182446696, "outflow_rate_mean": 1092.6128118819781, "cost2_max": -26.569904330570818, "cost1_min": 138.13589677015395}, "policy_reward_mean": {}, "timesteps_this_iter": 46588, "training_iteration": 170, "node_ip": "10.138.0.2", "episode_reward_min": 351.7920560327172, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6804.919962644577, "info": {"num_steps_trained": 8887350, "sample_time_ms": 23642.386, "load_time_ms": 4.589, "grad_time_ms": 11887.928, "update_time_ms": 8.271, "default": {"policy_loss": -0.013236531987786293, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.31911811232566833, "total_loss": 59.5952033996582, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 59.603172302246094, "kl": 0.015616461634635925, "entropy": 1.8124728202819824}, "num_steps_sampled": 8887350}, "episodes_total": 5245, "done": false, "date": "2019-05-21_08-56-31", "time_total_s": 6804.919962644577, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4d68>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 692.13, "time_this_iter_s": 36.60833954811096, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558428991}
{"episode_reward_mean": 1004.0297071634251, "timesteps_total": 8933970, "iterations_since_restore": 171, "timesteps_since_restore": 8933970, "num_metric_batches_dropped": 0, "episode_reward_max": 1146.9479751372562, "custom_metrics": {"outflow_rate_min": 912.4312539565699, "system_level_velocity_min": 13.103575172432128, "cost1_max": 443.2187287476322, "system_level_velocity_max": 17.312149133921285, "cost2_min": -69.90664093738044, "outflow_rate_max": 1232.4233187306882, "system_level_velocity_mean": 15.388403247055377, "cost1_mean": 394.74971107161514, "cost2_mean": -42.800455170488114, "outflow_rate_mean": 1086.7843715284412, "cost2_max": -26.569904330570818, "cost1_min": 138.13589677015395}, "policy_reward_mean": {}, "timesteps_this_iter": 46620, "training_iteration": 171, "node_ip": "10.138.0.2", "episode_reward_min": 351.7920560327172, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6840.083206653595, "info": {"num_steps_trained": 8933970, "sample_time_ms": 23717.114, "load_time_ms": 4.678, "grad_time_ms": 11718.282, "update_time_ms": 8.334, "default": {"policy_loss": -0.015366028062999249, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3768045902252197, "total_loss": 52.738250732421875, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 52.748111724853516, "kl": 0.016329463571310043, "entropy": 1.828628659248352}, "num_steps_sampled": 8933970}, "episodes_total": 5277, "done": false, "date": "2019-05-21_08-57-07", "time_total_s": 6840.083206653595, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc84a8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 695.18, "time_this_iter_s": 35.163244009017944, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558429027}
{"episode_reward_mean": 996.9413268472658, "timesteps_total": 8980828, "iterations_since_restore": 172, "timesteps_since_restore": 8980828, "num_metric_batches_dropped": 0, "episode_reward_max": 1173.5108666595138, "custom_metrics": {"outflow_rate_min": 496.88730418131473, "system_level_velocity_min": 12.579865067195307, "cost1_max": 445.8407397540501, "system_level_velocity_max": 18.67421146003175, "cost2_min": -61.40104061781978, "outflow_rate_max": 1278.5292561062126, "system_level_velocity_mean": 15.392138789579997, "cost1_mean": 390.53663100041706, "cost2_mean": -42.60762505507315, "outflow_rate_mean": 1079.46297492793, "cost2_max": -18.697263381279107, "cost1_min": 23.042038688437557}, "policy_reward_mean": {}, "timesteps_this_iter": 46858, "training_iteration": 172, "node_ip": "10.138.0.2", "episode_reward_min": 56.02498980316248, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6876.007100105286, "info": {"num_steps_trained": 8980828, "sample_time_ms": 23721.249, "load_time_ms": 4.453, "grad_time_ms": 11685.86, "update_time_ms": 8.459, "default": {"policy_loss": -0.013749750331044197, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3173154890537262, "total_loss": 56.58540344238281, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 56.593406677246094, "kl": 0.017008844763040543, "entropy": 1.8231316804885864}, "num_steps_sampled": 8980828}, "episodes_total": 5308, "done": false, "date": "2019-05-21_08-57-43", "time_total_s": 6876.007100105286, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd42b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4978>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.53, "time_this_iter_s": 35.923893451690674, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558429063}
{"episode_reward_mean": 996.353344615644, "timesteps_total": 9028370, "iterations_since_restore": 173, "timesteps_since_restore": 9028370, "num_metric_batches_dropped": 0, "episode_reward_max": 1173.5108666595138, "custom_metrics": {"outflow_rate_min": 464.3417965711157, "system_level_velocity_min": 12.02472277182974, "cost1_max": 445.8407397540501, "system_level_velocity_max": 18.67421146003175, "cost2_min": -60.32982948412675, "outflow_rate_max": 1278.5292561062126, "system_level_velocity_mean": 15.453380047888718, "cost1_mean": 391.01335909844533, "cost2_mean": -41.93964735063872, "outflow_rate_mean": 1076.2716823158805, "cost2_max": -18.697263381279107, "cost1_min": 22.722817157934468}, "policy_reward_mean": {}, "timesteps_this_iter": 47542, "training_iteration": 173, "node_ip": "10.138.0.2", "episode_reward_min": 55.77428222227938, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6915.504780769348, "info": {"num_steps_trained": 9028370, "sample_time_ms": 23983.167, "load_time_ms": 4.544, "grad_time_ms": 11741.15, "update_time_ms": 8.452, "default": {"policy_loss": -0.014468470588326454, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3175065219402313, "total_loss": 57.983985900878906, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 57.99269104003906, "kl": 0.017060598358511925, "entropy": 1.8955588340759277}, "num_steps_sampled": 9028370}, "episodes_total": 5342, "done": false, "date": "2019-05-21_08-58-22", "time_total_s": 6915.504780769348, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4e80>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 686.7, "time_this_iter_s": 39.4976806640625, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558429102}
{"episode_reward_mean": 986.2493653750487, "timesteps_total": 9074560, "iterations_since_restore": 174, "timesteps_since_restore": 9074560, "num_metric_batches_dropped": 0, "episode_reward_max": 1173.5108666595138, "custom_metrics": {"outflow_rate_min": 464.3417965711157, "system_level_velocity_min": 12.02472277182974, "cost1_max": 445.8407397540501, "system_level_velocity_max": 18.77239928664882, "cost2_min": -64.73194450133343, "outflow_rate_max": 1278.5292561062126, "system_level_velocity_mean": 15.336898416453849, "cost1_mean": 384.10302394636875, "cost2_mean": -41.956014954251856, "outflow_rate_mean": 1067.3964689172608, "cost2_max": -18.697263381279107, "cost1_min": 22.722817157934468}, "policy_reward_mean": {}, "timesteps_this_iter": 46190, "training_iteration": 174, "node_ip": "10.138.0.2", "episode_reward_min": 55.77428222227938, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6950.5221610069275, "info": {"num_steps_trained": 9074560, "sample_time_ms": 23978.19, "load_time_ms": 4.56, "grad_time_ms": 11739.954, "update_time_ms": 8.473, "default": {"policy_loss": -0.01412944681942463, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.27787041664123535, "total_loss": 60.45848083496094, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 60.467288970947266, "kl": 0.01577039621770382, "entropy": 1.8838329315185547}, "num_steps_sampled": 9074560}, "episodes_total": 5377, "done": false, "date": "2019-05-21_08-58-57", "time_total_s": 6950.5221610069275, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8940>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 680.09, "time_this_iter_s": 35.017380237579346, "hostname": "flow-main", "episodes_this_iter": 35, "timestamp": 1558429137}
{"episode_reward_mean": 994.845579855064, "timesteps_total": 9121480, "iterations_since_restore": 175, "timesteps_since_restore": 9121480, "num_metric_batches_dropped": 0, "episode_reward_max": 1165.3160747424351, "custom_metrics": {"outflow_rate_min": 464.3417965711157, "system_level_velocity_min": 12.02472277182974, "cost1_max": 437.82779126266246, "system_level_velocity_max": 18.77239928664882, "cost2_min": -70.45743471190889, "outflow_rate_max": 1247.9958733412452, "system_level_velocity_mean": 15.094760865166966, "cost1_mean": 382.96338946151843, "cost2_mean": -42.79264974071646, "outflow_rate_mean": 1074.2178654108643, "cost2_max": -20.432617050337864, "cost1_min": 22.722817157934468}, "policy_reward_mean": {}, "timesteps_this_iter": 46920, "training_iteration": 175, "node_ip": "10.138.0.2", "episode_reward_min": 55.77428222227938, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 6985.0609538555145, "info": {"num_steps_trained": 9121480, "sample_time_ms": 23847.192, "load_time_ms": 4.531, "grad_time_ms": 11703.882, "update_time_ms": 8.515, "default": {"policy_loss": -0.015047724358737469, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.33314916491508484, "total_loss": 50.54174041748047, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 50.550899505615234, "kl": 0.01745687983930111, "entropy": 1.9072738885879517}, "num_steps_sampled": 9121480}, "episodes_total": 5407, "done": false, "date": "2019-05-21_08-59-32", "time_total_s": 6985.0609538555145, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf198>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 685.49, "time_this_iter_s": 34.538792848587036, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558429172}
{"episode_reward_mean": 1006.4585316380103, "timesteps_total": 9168982, "iterations_since_restore": 176, "timesteps_since_restore": 9168982, "num_metric_batches_dropped": 0, "episode_reward_max": 1156.8556771840829, "custom_metrics": {"outflow_rate_min": 512.2512945629587, "system_level_velocity_min": 12.509747925637996, "cost1_max": 435.6429515742234, "system_level_velocity_max": 18.77239928664882, "cost2_min": -70.45743471190889, "outflow_rate_max": 1216.335785273769, "system_level_velocity_mean": 15.043458556047346, "cost1_mean": 386.61138976416055, "cost2_mean": -43.04355011814128, "outflow_rate_mean": 1079.5597003838072, "cost2_max": -22.438630936651208, "cost1_min": 25.9384986904156}, "policy_reward_mean": {}, "timesteps_this_iter": 47502, "training_iteration": 176, "node_ip": "10.138.0.2", "episode_reward_min": 58.136914863528716, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7018.910377502441, "info": {"num_steps_trained": 9168982, "sample_time_ms": 23986.418, "load_time_ms": 4.451, "grad_time_ms": 11591.648, "update_time_ms": 8.366, "default": {"policy_loss": -0.015252682380378246, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3231722414493561, "total_loss": 52.677066802978516, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 52.686500549316406, "kl": 0.01721901074051857, "entropy": 1.8894150257110596}, "num_steps_sampled": 9168982}, "episodes_total": 5439, "done": false, "date": "2019-05-21_09-00-06", "time_total_s": 7018.910377502441, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc71d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7e10>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 692.14, "time_this_iter_s": 33.84942364692688, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558429206}
{"episode_reward_mean": 1004.348749749543, "timesteps_total": 9215555, "iterations_since_restore": 177, "timesteps_since_restore": 9215555, "num_metric_batches_dropped": 0, "episode_reward_max": 1157.3922635681147, "custom_metrics": {"outflow_rate_min": 485.8629864444024, "system_level_velocity_min": 12.509747925637996, "cost1_max": 435.6318495434743, "system_level_velocity_max": 18.77239928664882, "cost2_min": -70.45743471190889, "outflow_rate_max": 1225.5152686446288, "system_level_velocity_mean": 15.148373111241874, "cost1_mean": 384.9724117516136, "cost2_mean": -42.24165679251024, "outflow_rate_mean": 1078.291980449225, "cost2_max": -16.613894854199057, "cost1_min": 17.92648631627773}, "policy_reward_mean": {}, "timesteps_this_iter": 46573, "training_iteration": 177, "node_ip": "10.138.0.2", "episode_reward_min": 42.97845197267401, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7055.692406415939, "info": {"num_steps_trained": 9215555, "sample_time_ms": 24108.442, "load_time_ms": 4.492, "grad_time_ms": 11569.368, "update_time_ms": 8.356, "default": {"policy_loss": -0.012196704745292664, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2518285810947418, "total_loss": 61.45091247558594, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 61.4574089050293, "kl": 0.016900265589356422, "entropy": 1.8926812410354614}, "num_steps_sampled": 9215555}, "episodes_total": 5472, "done": false, "date": "2019-05-21_09-00-42", "time_total_s": 7055.692406415939, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc72e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7d68>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 685.41, "time_this_iter_s": 36.782028913497925, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558429242}
{"episode_reward_mean": 1018.1516876182901, "timesteps_total": 9262398, "iterations_since_restore": 178, "timesteps_since_restore": 9262398, "num_metric_batches_dropped": 0, "episode_reward_max": 1157.3922635681147, "custom_metrics": {"outflow_rate_min": 485.8629864444024, "system_level_velocity_min": 12.509747925637996, "cost1_max": 435.6318495434743, "system_level_velocity_max": 17.58012750077194, "cost2_min": -63.3850066449084, "outflow_rate_max": 1225.5152686446288, "system_level_velocity_mean": 15.199259866938405, "cost1_mean": 391.31002443094354, "cost2_mean": -41.60368806413232, "outflow_rate_mean": 1084.5818755604187, "cost2_max": -16.613894854199057, "cost1_min": 17.92648631627773}, "policy_reward_mean": {}, "timesteps_this_iter": 46843, "training_iteration": 178, "node_ip": "10.138.0.2", "episode_reward_min": 42.97845197267401, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7092.161536455154, "info": {"num_steps_trained": 9262398, "sample_time_ms": 24266.106, "load_time_ms": 4.541, "grad_time_ms": 11540.55, "update_time_ms": 8.358, "default": {"policy_loss": -0.014388191513717175, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3637595772743225, "total_loss": 48.58927536010742, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 48.597599029541016, "kl": 0.017976434901356697, "entropy": 1.9166165590286255}, "num_steps_sampled": 9262398}, "episodes_total": 5502, "done": false, "date": "2019-05-21_09-01-19", "time_total_s": 7092.161536455154, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1cf8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.27, "time_this_iter_s": 36.46913003921509, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558429279}
{"episode_reward_mean": 1011.6418199515609, "timesteps_total": 9308960, "iterations_since_restore": 179, "timesteps_since_restore": 9308960, "num_metric_batches_dropped": 0, "episode_reward_max": 1157.3922635681147, "custom_metrics": {"outflow_rate_min": 485.8629864444024, "system_level_velocity_min": 12.522236581666185, "cost1_max": 435.84972577720123, "system_level_velocity_max": 17.58012750077194, "cost2_min": -63.3850066449084, "outflow_rate_max": 1225.5152686446288, "system_level_velocity_mean": 15.02836508049595, "cost1_mean": 387.0212816000543, "cost2_mean": -42.84214515843558, "outflow_rate_mean": 1080.3277549769562, "cost2_max": -16.613894854199057, "cost1_min": 17.92648631627773}, "policy_reward_mean": {}, "timesteps_this_iter": 46562, "training_iteration": 179, "node_ip": "10.138.0.2", "episode_reward_min": 42.97845197267401, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7127.476671457291, "info": {"num_steps_trained": 9308960, "sample_time_ms": 24294.36, "load_time_ms": 4.51, "grad_time_ms": 11518.323, "update_time_ms": 8.485, "default": {"policy_loss": -0.013500888831913471, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.344677597284317, "total_loss": 55.492767333984375, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 55.500396728515625, "kl": 0.017400044947862625, "entropy": 1.9243353605270386}, "num_steps_sampled": 9308960}, "episodes_total": 5533, "done": false, "date": "2019-05-21_09-01-54", "time_total_s": 7127.476671457291, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc77f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc70b8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.27, "time_this_iter_s": 35.31513500213623, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558429314}
{"episode_reward_mean": 1006.1889760144556, "timesteps_total": 9356340, "iterations_since_restore": 180, "timesteps_since_restore": 9356340, "num_metric_batches_dropped": 0, "episode_reward_max": 1157.2088929551417, "custom_metrics": {"outflow_rate_min": 487.81848856077494, "system_level_velocity_min": 12.525269478191872, "cost1_max": 436.0410460195008, "system_level_velocity_max": 18.380259245749997, "cost2_min": -60.75251728118363, "outflow_rate_max": 1220.5474536454408, "system_level_velocity_mean": 15.051438903146938, "cost1_mean": 386.9987144487719, "cost2_mean": -42.61173419990341, "outflow_rate_mean": 1075.1828488783328, "cost2_max": -18.97744667280019, "cost1_min": 22.820279795488666}, "policy_reward_mean": {}, "timesteps_this_iter": 47380, "training_iteration": 180, "node_ip": "10.138.0.2", "episode_reward_min": 55.30030105452406, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7162.558486938477, "info": {"num_steps_trained": 9356340, "sample_time_ms": 24190.858, "load_time_ms": 4.75, "grad_time_ms": 11470.682, "update_time_ms": 8.431, "default": {"policy_loss": -0.013160244561731815, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3338167667388916, "total_loss": 55.838741302490234, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 55.8463249206543, "kl": 0.016528872773051262, "entropy": 1.8953685760498047}, "num_steps_sampled": 9356340}, "episodes_total": 5565, "done": false, "date": "2019-05-21_09-02-29", "time_total_s": 7162.558486938477, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd45c0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 35.08181548118591, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558429349}
{"episode_reward_mean": 1007.0571282902661, "timesteps_total": 9403115, "iterations_since_restore": 181, "timesteps_since_restore": 9403115, "num_metric_batches_dropped": 0, "episode_reward_max": 1152.0260847385323, "custom_metrics": {"outflow_rate_min": 487.81848856077494, "system_level_velocity_min": 11.954976944635492, "cost1_max": 440.67913906801675, "system_level_velocity_max": 18.380259245749997, "cost2_min": -65.54149968629605, "outflow_rate_max": 1228.5576459434656, "system_level_velocity_mean": 15.207981780625465, "cost1_mean": 390.18449388668523, "cost2_mean": -42.600034877609886, "outflow_rate_mean": 1078.839681021288, "cost2_max": -18.97744667280019, "cost1_min": 22.820279795488666}, "policy_reward_mean": {}, "timesteps_this_iter": 46775, "training_iteration": 181, "node_ip": "10.138.0.2", "episode_reward_min": 55.30030105452406, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7198.714506149292, "info": {"num_steps_trained": 9403115, "sample_time_ms": 24243.234, "load_time_ms": 4.723, "grad_time_ms": 11518.489, "update_time_ms": 8.167, "default": {"policy_loss": -0.012785508297383785, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3136001229286194, "total_loss": 55.79024124145508, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 55.79771041870117, "kl": 0.01574704237282276, "entropy": 1.8888016939163208}, "num_steps_sampled": 9403115}, "episodes_total": 5598, "done": false, "date": "2019-05-21_09-03-06", "time_total_s": 7198.714506149292, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc15c0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.35, "time_this_iter_s": 36.15601921081543, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558429386}
{"episode_reward_mean": 1007.7412893877002, "timesteps_total": 9450201, "iterations_since_restore": 182, "timesteps_since_restore": 9450201, "num_metric_batches_dropped": 0, "episode_reward_max": 1141.6716652175237, "custom_metrics": {"outflow_rate_min": 487.81848856077494, "system_level_velocity_min": 11.954976944635492, "cost1_max": 441.9003296639163, "system_level_velocity_max": 18.380259245749997, "cost2_min": -70.14950193368166, "outflow_rate_max": 1228.5576459434656, "system_level_velocity_mean": 15.486352165315964, "cost1_mean": 393.3202809787391, "cost2_mean": -41.68564146305138, "outflow_rate_mean": 1086.185599867125, "cost2_max": -18.97744667280019, "cost1_min": 22.820279795488666}, "policy_reward_mean": {}, "timesteps_this_iter": 47086, "training_iteration": 182, "node_ip": "10.138.0.2", "episode_reward_min": 55.30030105452406, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7235.240525484085, "info": {"num_steps_trained": 9450201, "sample_time_ms": 24195.572, "load_time_ms": 4.729, "grad_time_ms": 11627.84, "update_time_ms": 7.795, "default": {"policy_loss": -0.014488429762423038, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.33938461542129517, "total_loss": 55.418907165527344, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 55.427520751953125, "kl": 0.017398767173290253, "entropy": 1.8911381959915161}, "num_steps_sampled": 9450201}, "episodes_total": 5629, "done": false, "date": "2019-05-21_09-03-42", "time_total_s": 7235.240525484085, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfafc18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf7b8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.42, "time_this_iter_s": 36.52601933479309, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558429422}
{"episode_reward_mean": 1001.2835569556123, "timesteps_total": 9496760, "iterations_since_restore": 183, "timesteps_since_restore": 9496760, "num_metric_batches_dropped": 0, "episode_reward_max": 1141.6716652175237, "custom_metrics": {"outflow_rate_min": 887.225368421053, "system_level_velocity_min": 11.954976944635492, "cost1_max": 441.9003296639163, "system_level_velocity_max": 17.7658279989047, "cost2_min": -70.14950193368166, "outflow_rate_max": 1228.5576459434656, "system_level_velocity_mean": 15.42054545811492, "cost1_mean": 394.62639573955573, "cost2_mean": -42.04843042301867, "outflow_rate_mean": 1081.1143119821445, "cost2_max": -30.691574155082687, "cost1_min": 136.018560766909}, "policy_reward_mean": {}, "timesteps_this_iter": 46559, "training_iteration": 183, "node_ip": "10.138.0.2", "episode_reward_min": 333.6070286236154, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7270.692463159561, "info": {"num_steps_trained": 9496760, "sample_time_ms": 23774.545, "load_time_ms": 4.618, "grad_time_ms": 11640.309, "update_time_ms": 7.915, "default": {"policy_loss": -0.01507442258298397, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.37102872133255005, "total_loss": 55.90385055541992, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 55.91313171386719, "kl": 0.017160071060061455, "entropy": 1.9436333179473877}, "num_steps_sampled": 9496760}, "episodes_total": 5664, "done": false, "date": "2019-05-21_09-04-18", "time_total_s": 7270.692463159561, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8e48>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 692.98, "time_this_iter_s": 35.451937675476074, "hostname": "flow-main", "episodes_this_iter": 35, "timestamp": 1558429458}
{"episode_reward_mean": 992.0002121918872, "timesteps_total": 9544169, "iterations_since_restore": 184, "timesteps_since_restore": 9544169, "num_metric_batches_dropped": 0, "episode_reward_max": 1191.7606846478793, "custom_metrics": {"outflow_rate_min": 887.225368421053, "system_level_velocity_min": 12.626884355611136, "cost1_max": 448.0991155193543, "system_level_velocity_max": 17.7658279989047, "cost2_min": -70.14950193368166, "outflow_rate_max": 1290.1709269753906, "system_level_velocity_mean": 15.276253944896087, "cost1_mean": 388.915138834913, "cost2_mean": -41.83849752519917, "outflow_rate_mean": 1076.6745731755632, "cost2_max": -29.70077600356531, "cost1_min": 136.018560766909}, "policy_reward_mean": {}, "timesteps_this_iter": 47409, "training_iteration": 184, "node_ip": "10.138.0.2", "episode_reward_min": 333.6070286236154, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7306.635756731033, "info": {"num_steps_trained": 9544169, "sample_time_ms": 23693.238, "load_time_ms": 4.603, "grad_time_ms": 11812.265, "update_time_ms": 7.873, "default": {"policy_loss": -0.01212579756975174, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3382750153541565, "total_loss": 57.047794342041016, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 57.05470275878906, "kl": 0.015456725843250751, "entropy": 1.9078656435012817}, "num_steps_sampled": 9544169}, "episodes_total": 5697, "done": false, "date": "2019-05-21_09-04-54", "time_total_s": 7306.635756731033, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbcef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbcba8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.95, "time_this_iter_s": 35.94329357147217, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558429494}
{"episode_reward_mean": 979.0159058137273, "timesteps_total": 9591606, "iterations_since_restore": 185, "timesteps_since_restore": 9591606, "num_metric_batches_dropped": 0, "episode_reward_max": 1191.7606846478793, "custom_metrics": {"outflow_rate_min": 488.1106938443588, "system_level_velocity_min": 12.56924555899865, "cost1_max": 448.0991155193543, "system_level_velocity_max": 18.23790371226494, "cost2_min": -66.77910022740318, "outflow_rate_max": 1290.1709269753906, "system_level_velocity_mean": 15.16724266763765, "cost1_mean": 382.0941985674916, "cost2_mean": -42.19806044454743, "outflow_rate_mean": 1065.5166735011146, "cost2_max": -17.017895741991204, "cost1_min": 22.632381564704346}, "policy_reward_mean": {}, "timesteps_this_iter": 47437, "training_iteration": 185, "node_ip": "10.138.0.2", "episode_reward_min": 55.99024025087736, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7341.851655244827, "info": {"num_steps_trained": 9591606, "sample_time_ms": 23597.696, "load_time_ms": 4.405, "grad_time_ms": 11975.062, "update_time_ms": 7.884, "default": {"policy_loss": -0.015301072970032692, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.37085777521133423, "total_loss": 57.800201416015625, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 57.80942916870117, "kl": 0.01800267957150936, "entropy": 1.9370447397232056}, "num_steps_sampled": 9591606}, "episodes_total": 5731, "done": false, "date": "2019-05-21_09-05-29", "time_total_s": 7341.851655244827, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1cc0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 682.3, "time_this_iter_s": 35.215898513793945, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558429529}
{"episode_reward_mean": 993.1327202282632, "timesteps_total": 9638287, "iterations_since_restore": 186, "timesteps_since_restore": 9638287, "num_metric_batches_dropped": 0, "episode_reward_max": 1191.7606846478793, "custom_metrics": {"outflow_rate_min": 488.1106938443588, "system_level_velocity_min": 12.56924555899865, "cost1_max": 448.0991155193543, "system_level_velocity_max": 18.23790371226494, "cost2_min": -60.61717641352063, "outflow_rate_max": 1290.1709269753906, "system_level_velocity_mean": 15.293522599884858, "cost1_mean": 386.97853762940326, "cost2_mean": -41.82033426895497, "outflow_rate_mean": 1075.7807826147125, "cost2_max": -17.017895741991204, "cost1_min": 22.632381564704346}, "policy_reward_mean": {}, "timesteps_this_iter": 46681, "training_iteration": 186, "node_ip": "10.138.0.2", "episode_reward_min": 55.99024025087736, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7379.447692871094, "info": {"num_steps_trained": 9638287, "sample_time_ms": 23738.877, "load_time_ms": 4.493, "grad_time_ms": 12207.444, "update_time_ms": 8.275, "default": {"policy_loss": -0.01342012733221054, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2871174216270447, "total_loss": 61.83927917480469, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 61.8466796875, "kl": 0.017849763855338097, "entropy": 1.9170680046081543}, "num_steps_sampled": 9638287}, "episodes_total": 5765, "done": false, "date": "2019-05-21_09-06-07", "time_total_s": 7379.447692871094, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d3c8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 684.39, "time_this_iter_s": 37.59603762626648, "hostname": "flow-main", "episodes_this_iter": 34, "timestamp": 1558429567}
{"episode_reward_mean": 986.607171441503, "timesteps_total": 9685778, "iterations_since_restore": 187, "timesteps_since_restore": 9685778, "num_metric_batches_dropped": 0, "episode_reward_max": 1148.543235890684, "custom_metrics": {"outflow_rate_min": 488.1106938443588, "system_level_velocity_min": 11.79455583614083, "cost1_max": 435.613149574728, "system_level_velocity_max": 18.23790371226494, "cost2_min": -68.90938184685103, "outflow_rate_max": 1211.8079293970568, "system_level_velocity_mean": 15.178233071347337, "cost1_mean": 383.6720033290515, "cost2_mean": -42.558461422404974, "outflow_rate_mean": 1070.4204710172273, "cost2_max": -17.017895741991204, "cost1_min": 22.632381564704346}, "policy_reward_mean": {}, "timesteps_this_iter": 47491, "training_iteration": 187, "node_ip": "10.138.0.2", "episode_reward_min": 55.99024025087736, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7418.262118816376, "info": {"num_steps_trained": 9685778, "sample_time_ms": 23829.696, "load_time_ms": 4.468, "grad_time_ms": 12320.635, "update_time_ms": 8.381, "default": {"policy_loss": -0.015213767997920513, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.28514134883880615, "total_loss": 60.55843734741211, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 60.56801223754883, "kl": 0.016704225912690163, "entropy": 1.9666688442230225}, "num_steps_sampled": 9685778}, "episodes_total": 5798, "done": false, "date": "2019-05-21_09-06-46", "time_total_s": 7418.262118816376, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c003b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfaf240>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 683.49, "time_this_iter_s": 38.81442594528198, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558429606}
{"episode_reward_mean": 980.0838702891385, "timesteps_total": 9733030, "iterations_since_restore": 188, "timesteps_since_restore": 9733030, "num_metric_batches_dropped": 0, "episode_reward_max": 1148.543235890684, "custom_metrics": {"outflow_rate_min": 488.1106938443588, "system_level_velocity_min": 11.79455583614083, "cost1_max": 435.613149574728, "system_level_velocity_max": 18.23790371226494, "cost2_min": -68.90938184685103, "outflow_rate_max": 1211.8079293970568, "system_level_velocity_mean": 15.138219617896658, "cost1_mean": 383.8255584825986, "cost2_mean": -41.86360097855175, "outflow_rate_mean": 1063.3201450965944, "cost2_max": -17.017895741991204, "cost1_min": 22.632381564704346}, "policy_reward_mean": {}, "timesteps_this_iter": 47252, "training_iteration": 188, "node_ip": "10.138.0.2", "episode_reward_min": 55.99024025087736, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7454.28183722496, "info": {"num_steps_trained": 9733030, "sample_time_ms": 23847.272, "load_time_ms": 4.454, "grad_time_ms": 12258.485, "update_time_ms": 8.393, "default": {"policy_loss": -0.015444042161107063, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3043632507324219, "total_loss": 51.47541809082031, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 51.48497772216797, "kl": 0.017451152205467224, "entropy": 1.972711443901062}, "num_steps_sampled": 9733030}, "episodes_total": 5829, "done": false, "date": "2019-05-21_09-07-22", "time_total_s": 7454.28183722496, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbcb70>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 684.86, "time_this_iter_s": 36.019718408584595, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558429642}
{"episode_reward_mean": 975.5017987917133, "timesteps_total": 9780786, "iterations_since_restore": 189, "timesteps_since_restore": 9780786, "num_metric_batches_dropped": 0, "episode_reward_max": 1148.543235890684, "custom_metrics": {"outflow_rate_min": 894.1310180786957, "system_level_velocity_min": 11.79455583614083, "cost1_max": 435.613149574728, "system_level_velocity_max": 17.588251800378064, "cost2_min": -68.90938184685103, "outflow_rate_max": 1211.8079293970568, "system_level_velocity_mean": 14.914214302225536, "cost1_mean": 377.5366868490022, "cost2_mean": -42.505398396816055, "outflow_rate_mean": 1064.232788986218, "cost2_max": -27.565696465208053, "cost1_min": 130.62592422917527}, "policy_reward_mean": {}, "timesteps_this_iter": 47756, "training_iteration": 189, "node_ip": "10.138.0.2", "episode_reward_min": 331.82559866836516, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7489.744145154953, "info": {"num_steps_trained": 9780786, "sample_time_ms": 24016.683, "load_time_ms": 4.531, "grad_time_ms": 12103.096, "update_time_ms": 8.275, "default": {"policy_loss": -0.013295117765665054, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3042524755001068, "total_loss": 57.313331604003906, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 57.32111740112305, "kl": 0.01632559858262539, "entropy": 1.966681718826294}, "num_steps_sampled": 9780786}, "episodes_total": 5862, "done": false, "date": "2019-05-21_09-07-57", "time_total_s": 7489.744145154953, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c00d320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1cc0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 682.22, "time_this_iter_s": 35.462307929992676, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558429677}
{"episode_reward_mean": 977.5219532040865, "timesteps_total": 9827975, "iterations_since_restore": 190, "timesteps_since_restore": 9827975, "num_metric_batches_dropped": 0, "episode_reward_max": 1119.5349431009495, "custom_metrics": {"outflow_rate_min": 894.1310180786957, "system_level_velocity_min": 12.239093927435556, "cost1_max": 432.4600752246046, "system_level_velocity_max": 17.588251800378064, "cost2_min": -68.58210328186992, "outflow_rate_max": 1180.3968972332018, "system_level_velocity_mean": 14.922111750306549, "cost1_mean": 379.84043649880505, "cost2_mean": -42.034796797830616, "outflow_rate_mean": 1062.7670493935368, "cost2_max": -28.64623096937141, "cost1_min": 141.02172245491477}, "policy_reward_mean": {}, "timesteps_this_iter": 47189, "training_iteration": 190, "node_ip": "10.138.0.2", "episode_reward_min": 354.3471040790277, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7525.696889877319, "info": {"num_steps_trained": 9827975, "sample_time_ms": 24168.996, "load_time_ms": 4.29, "grad_time_ms": 12038.537, "update_time_ms": 8.216, "default": {"policy_loss": -0.015248723328113556, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3680773079395294, "total_loss": 55.0668830871582, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 55.07621383666992, "kl": 0.017530063167214394, "entropy": 1.9580717086791992}, "num_steps_sampled": 9827975}, "episodes_total": 5893, "done": false, "date": "2019-05-21_09-08-33", "time_total_s": 7525.696889877319, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8ac8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 684.92, "time_this_iter_s": 35.95274472236633, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558429713}
{"episode_reward_mean": 988.7756174758678, "timesteps_total": 9876241, "iterations_since_restore": 191, "timesteps_since_restore": 9876241, "num_metric_batches_dropped": 0, "episode_reward_max": 1119.5349431009495, "custom_metrics": {"outflow_rate_min": 894.1310180786957, "system_level_velocity_min": 12.196447991762756, "cost1_max": 432.4600752246046, "system_level_velocity_max": 17.588251800378064, "cost2_min": -73.31872269178183, "outflow_rate_max": 1180.3968972332018, "system_level_velocity_mean": 14.934271176657624, "cost1_mean": 382.5088187817118, "cost2_mean": -42.8014986551792, "outflow_rate_mean": 1065.2619335444463, "cost2_max": -28.64623096937141, "cost1_min": 141.02172245491477}, "policy_reward_mean": {}, "timesteps_this_iter": 48266, "training_iteration": 191, "node_ip": "10.138.0.2", "episode_reward_min": 354.3471040790277, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7561.059683799744, "info": {"num_steps_trained": 9876241, "sample_time_ms": 24170.369, "load_time_ms": 4.294, "grad_time_ms": 11956.638, "update_time_ms": 8.362, "default": {"policy_loss": -0.016708526760339737, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.38544443249702454, "total_loss": 54.37138366699219, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 54.38210678100586, "kl": 0.01773904077708721, "entropy": 1.9756357669830322}, "num_steps_sampled": 9876241}, "episodes_total": 5924, "done": false, "date": "2019-05-21_09-09-08", "time_total_s": 7561.059683799744, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc15c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc17f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc1eb8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.48, "time_this_iter_s": 35.362793922424316, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558429748}
{"episode_reward_mean": 1009.3297589531918, "timesteps_total": 9922974, "iterations_since_restore": 192, "timesteps_since_restore": 9922974, "num_metric_batches_dropped": 0, "episode_reward_max": 1128.3781952149013, "custom_metrics": {"outflow_rate_min": 939.4236267123287, "system_level_velocity_min": 12.196447991762756, "cost1_max": 428.0529990337395, "system_level_velocity_max": 16.517542792326708, "cost2_min": -73.31872269178183, "outflow_rate_max": 1179.5810831721467, "system_level_velocity_mean": 14.918432194196134, "cost1_mean": 388.21910590085855, "cost2_mean": -42.506869832393186, "outflow_rate_mean": 1072.4543191121606, "cost2_max": -25.69372248628426, "cost1_min": 250.94997909632875}, "policy_reward_mean": {}, "timesteps_this_iter": 46733, "training_iteration": 192, "node_ip": "10.138.0.2", "episode_reward_min": 644.043802180432, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7597.4332802295685, "info": {"num_steps_trained": 9922974, "sample_time_ms": 24281.922, "load_time_ms": 4.2, "grad_time_ms": 11829.941, "update_time_ms": 8.501, "default": {"policy_loss": -0.014314661733806133, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3038591742515564, "total_loss": 58.3807258605957, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 58.38935852050781, "kl": 0.016828106716275215, "entropy": 1.9769890308380127}, "num_steps_sampled": 9922974}, "episodes_total": 5957, "done": false, "date": "2019-05-21_09-09-45", "time_total_s": 7597.4332802295685, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc3c8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 697.77, "time_this_iter_s": 36.37359642982483, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558429785}
{"episode_reward_mean": 1004.0964327073522, "timesteps_total": 9971235, "iterations_since_restore": 193, "timesteps_since_restore": 9971235, "num_metric_batches_dropped": 0, "episode_reward_max": 1128.3781952149013, "custom_metrics": {"outflow_rate_min": 489.89988148920264, "system_level_velocity_min": 12.196447991762756, "cost1_max": 427.95148377483247, "system_level_velocity_max": 18.53619735354487, "cost2_min": -73.31872269178183, "outflow_rate_max": 1179.5810831721467, "system_level_velocity_mean": 14.945094640944758, "cost1_mean": 385.7671686035891, "cost2_mean": -41.886960033263705, "outflow_rate_mean": 1063.5038324739828, "cost2_max": -20.661970152585933, "cost1_min": 24.366051953779973}, "policy_reward_mean": {}, "timesteps_this_iter": 48261, "training_iteration": 193, "node_ip": "10.138.0.2", "episode_reward_min": 59.133530882309024, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7633.404076337814, "info": {"num_steps_trained": 9971235, "sample_time_ms": 24337.208, "load_time_ms": 4.16, "grad_time_ms": 11831.158, "update_time_ms": 8.424, "default": {"policy_loss": -0.013975139707326889, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.35538044571876526, "total_loss": 54.55759048461914, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 54.56589889526367, "kl": 0.016781937330961227, "entropy": 1.99924635887146}, "num_steps_sampled": 9971235}, "episodes_total": 5989, "done": false, "date": "2019-05-21_09-10-21", "time_total_s": 7633.404076337814, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc87b8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.37, "time_this_iter_s": 35.97079610824585, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558429821}
{"episode_reward_mean": 1000.3854222894261, "timesteps_total": 10019211, "iterations_since_restore": 194, "timesteps_since_restore": 10019211, "num_metric_batches_dropped": 0, "episode_reward_max": 1128.3781952149013, "custom_metrics": {"outflow_rate_min": 489.89988148920264, "system_level_velocity_min": 12.770489245854483, "cost1_max": 427.95148377483247, "system_level_velocity_max": 18.53619735354487, "cost2_min": -67.8987212275662, "outflow_rate_max": 1179.5810831721467, "system_level_velocity_mean": 14.888226644128572, "cost1_mean": 384.4012664450839, "cost2_mean": -41.627738714152365, "outflow_rate_mean": 1056.844869927523, "cost2_max": -20.661970152585933, "cost1_min": 24.366051953779973}, "policy_reward_mean": {}, "timesteps_this_iter": 47976, "training_iteration": 194, "node_ip": "10.138.0.2", "episode_reward_min": 59.133530882309024, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7669.093870401382, "info": {"num_steps_trained": 10019211, "sample_time_ms": 24292.174, "load_time_ms": 4.153, "grad_time_ms": 11853.288, "update_time_ms": 8.427, "default": {"policy_loss": -0.016101986169815063, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3619172275066376, "total_loss": 52.01301574707031, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 52.023590087890625, "kl": 0.016390254721045494, "entropy": 2.018458366394043}, "num_steps_sampled": 10019211}, "episodes_total": 6020, "done": false, "date": "2019-05-21_09-10-57", "time_total_s": 7669.093870401382, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc76a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7240>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.02, "time_this_iter_s": 35.689794063568115, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558429857}
{"episode_reward_mean": 984.427105343847, "timesteps_total": 10066404, "iterations_since_restore": 195, "timesteps_since_restore": 10066404, "num_metric_batches_dropped": 0, "episode_reward_max": 1124.531293925014, "custom_metrics": {"outflow_rate_min": 489.89988148920264, "system_level_velocity_min": 12.637327313342274, "cost1_max": 427.95148377483247, "system_level_velocity_max": 18.53619735354487, "cost2_min": -69.08380875439224, "outflow_rate_max": 1172.5702085063872, "system_level_velocity_mean": 14.745155249464021, "cost1_mean": 380.5981401753577, "cost2_mean": -41.60204404969245, "outflow_rate_mean": 1038.9316355259518, "cost2_max": -20.661970152585933, "cost1_min": 24.366051953779973}, "policy_reward_mean": {}, "timesteps_this_iter": 47193, "training_iteration": 195, "node_ip": "10.138.0.2", "episode_reward_min": 59.133530882309024, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7705.666684389114, "info": {"num_steps_trained": 10066404, "sample_time_ms": 24433.716, "load_time_ms": 4.386, "grad_time_ms": 11846.899, "update_time_ms": 8.436, "default": {"policy_loss": -0.015069365501403809, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3022933006286621, "total_loss": 55.44374084472656, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 55.452449798583984, "kl": 0.01885700412094593, "entropy": 2.0380423069000244}, "num_steps_sampled": 10066404}, "episodes_total": 6053, "done": false, "date": "2019-05-21_09-11-33", "time_total_s": 7705.666684389114, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbccc0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.02, "time_this_iter_s": 36.572813987731934, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558429893}
{"episode_reward_mean": 977.7204482308351, "timesteps_total": 10114401, "iterations_since_restore": 196, "timesteps_since_restore": 10114401, "num_metric_batches_dropped": 0, "episode_reward_max": 1112.7265315670934, "custom_metrics": {"outflow_rate_min": 881.1541115276473, "system_level_velocity_min": 12.186121581812056, "cost1_max": 423.1257225880307, "system_level_velocity_max": 16.183672368391306, "cost2_min": -74.52674473007619, "outflow_rate_max": 1152.1404680310964, "system_level_velocity_mean": 14.631381250051083, "cost1_mean": 378.9739128548031, "cost2_mean": -41.28902788507819, "outflow_rate_mean": 1035.4509231776321, "cost2_max": -25.26145645891627, "cost1_min": 163.5283947616831}, "policy_reward_mean": {}, "timesteps_this_iter": 47997, "training_iteration": 196, "node_ip": "10.138.0.2", "episode_reward_min": 395.1661424346941, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7742.660553693771, "info": {"num_steps_trained": 10114401, "sample_time_ms": 24282.623, "load_time_ms": 4.441, "grad_time_ms": 11938.176, "update_time_ms": 8.066, "default": {"policy_loss": -0.015246722847223282, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.33262985944747925, "total_loss": 58.509822845458984, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 58.519527435302734, "kl": 0.016430480405688286, "entropy": 2.0356030464172363}, "num_steps_sampled": 10114401}, "episodes_total": 6089, "done": false, "date": "2019-05-21_09-12-10", "time_total_s": 7742.660553693771, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbcf98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc390>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 694.29, "time_this_iter_s": 36.99386930465698, "hostname": "flow-main", "episodes_this_iter": 36, "timestamp": 1558429930}
{"episode_reward_mean": 970.12626742613, "timesteps_total": 10162092, "iterations_since_restore": 197, "timesteps_since_restore": 10162092, "num_metric_batches_dropped": 0, "episode_reward_max": 1106.6845627224927, "custom_metrics": {"outflow_rate_min": 481.9200681552117, "system_level_velocity_min": 12.186121581812056, "cost1_max": 421.8563353376858, "system_level_velocity_max": 17.429533891842805, "cost2_min": -74.52674473007619, "outflow_rate_max": 1152.1404680310964, "system_level_velocity_mean": 14.660710275797207, "cost1_mean": 375.6749707837607, "cost2_mean": -40.80402399880244, "outflow_rate_mean": 1030.9228159458494, "cost2_max": -16.370704262180773, "cost1_min": 23.953117919148763}, "policy_reward_mean": {}, "timesteps_this_iter": 47691, "training_iteration": 197, "node_ip": "10.138.0.2", "episode_reward_min": 61.64320539778867, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7777.671796321869, "info": {"num_steps_trained": 10162092, "sample_time_ms": 23875.117, "load_time_ms": 4.4, "grad_time_ms": 11963.651, "update_time_ms": 7.894, "default": {"policy_loss": -0.01507185585796833, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3593374192714691, "total_loss": 54.488006591796875, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 54.49692153930664, "kl": 0.01824386604130268, "entropy": 2.031820058822632}, "num_steps_sampled": 10162092}, "episodes_total": 6121, "done": false, "date": "2019-05-21_09-12-45", "time_total_s": 7777.671796321869, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc7940>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 688.02, "time_this_iter_s": 35.011242628097534, "hostname": "flow-main", "episodes_this_iter": 32, "timestamp": 1558429965}
{"episode_reward_mean": 959.4692573518972, "timesteps_total": 10209791, "iterations_since_restore": 198, "timesteps_since_restore": 10209791, "num_metric_batches_dropped": 0, "episode_reward_max": 1106.6845627224927, "custom_metrics": {"outflow_rate_min": 481.9200681552117, "system_level_velocity_min": 12.186121581812056, "cost1_max": 419.7092768484007, "system_level_velocity_max": 17.429533891842805, "cost2_min": -74.52674473007619, "outflow_rate_max": 1152.1404680310964, "system_level_velocity_mean": 14.561636713572476, "cost1_mean": 373.79797472016355, "cost2_mean": -38.95673395325668, "outflow_rate_mean": 1018.4471481512819, "cost2_max": -16.370704262180773, "cost1_min": 23.953117919148763}, "policy_reward_mean": {}, "timesteps_this_iter": 47699, "training_iteration": 198, "node_ip": "10.138.0.2", "episode_reward_min": 61.64320539778867, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7814.931702613831, "info": {"num_steps_trained": 10209791, "sample_time_ms": 23847.293, "load_time_ms": 4.178, "grad_time_ms": 12113.105, "update_time_ms": 8.157, "default": {"policy_loss": -0.013410881161689758, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3559868633747101, "total_loss": 54.36151123046875, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 54.36946487426758, "kl": 0.01616615802049637, "entropy": 2.0673470497131348}, "num_steps_sampled": 10209791}, "episodes_total": 6154, "done": false, "date": "2019-05-21_09-13-23", "time_total_s": 7814.931702613831, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbacc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba0b8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 689.35, "time_this_iter_s": 37.25990629196167, "hostname": "flow-main", "episodes_this_iter": 33, "timestamp": 1558430003}
{"episode_reward_mean": 954.5002000418401, "timesteps_total": 10256879, "iterations_since_restore": 199, "timesteps_since_restore": 10256879, "num_metric_batches_dropped": 0, "episode_reward_max": 1106.6845627224927, "custom_metrics": {"outflow_rate_min": 481.9200681552117, "system_level_velocity_min": 12.075527657574003, "cost1_max": 429.80540798055836, "system_level_velocity_max": 17.429533891842805, "cost2_min": -73.42208840973774, "outflow_rate_max": 1126.15866268577, "system_level_velocity_mean": 14.480801814352628, "cost1_mean": 373.5433141408794, "cost2_mean": -38.55773975073516, "outflow_rate_mean": 1009.2305972318625, "cost2_max": -16.370704262180773, "cost1_min": 23.953117919148763}, "policy_reward_mean": {}, "timesteps_this_iter": 47088, "training_iteration": 199, "node_ip": "10.138.0.2", "episode_reward_min": 61.64320539778867, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7850.217383146286, "info": {"num_steps_trained": 10256879, "sample_time_ms": 23845.972, "load_time_ms": 4.058, "grad_time_ms": 12097.682, "update_time_ms": 8.217, "default": {"policy_loss": -0.016261423006653786, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4255056381225586, "total_loss": 44.31211471557617, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 44.32207489013672, "kl": 0.018668856471776962, "entropy": 2.0850913524627686}, "num_steps_sampled": 10256879}, "episodes_total": 6184, "done": false, "date": "2019-05-21_09-13-58", "time_total_s": 7850.217383146286, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc8d0>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 693.38, "time_this_iter_s": 35.285680532455444, "hostname": "flow-main", "episodes_this_iter": 30, "timestamp": 1558430038}
{"episode_reward_mean": 944.6244430793414, "timesteps_total": 10303645, "iterations_since_restore": 200, "timesteps_since_restore": 10303645, "num_metric_batches_dropped": 0, "episode_reward_max": 1062.0942739559684, "custom_metrics": {"outflow_rate_min": 828.1810549574159, "system_level_velocity_min": 12.075527657574003, "cost1_max": 429.80540798055836, "system_level_velocity_max": 16.55168306867698, "cost2_min": -73.42208840973774, "outflow_rate_max": 1120.4115399189836, "system_level_velocity_mean": 14.375601780816211, "cost1_mean": 375.06429550462667, "cost2_mean": -37.00472703715038, "outflow_rate_mean": 991.8880022531469, "cost2_max": -22.913525975177706, "cost1_min": 316.8030343616928}, "policy_reward_mean": {}, "timesteps_this_iter": 46766, "training_iteration": 200, "node_ip": "10.138.0.2", "episode_reward_min": 806.23652018258, "pid": 351, "experiment_id": "e7f9e2991d5a424487b56a9b3cd2d080", "time_since_restore": 7886.834598064423, "info": {"num_steps_trained": 10303645, "sample_time_ms": 23967.157, "load_time_ms": 4.096, "grad_time_ms": 12042.799, "update_time_ms": 8.322, "default": {"policy_loss": -0.013971004635095596, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3942467272281647, "total_loss": 48.36134338378906, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 48.3698844909668, "kl": 0.016091903671622276, "entropy": 2.1087896823883057}, "num_steps_sampled": 10303645}, "episodes_total": 6215, "done": true, "date": "2019-05-21_09-14-35", "time_total_s": 7886.834598064423, "config": {"output": null, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "grayscale": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "channel_major": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "lambda": 0.97, "output_max_file_size": 67108864, "sample_batch_size": 750, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "monitor": false, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "input": "sampler", "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc88d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8eb8>", "on_sample_end": null, "on_train_result": null}, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null}, "episode_len_mean": 700.0, "time_this_iter_s": 36.6172149181366, "hostname": "flow-main", "episodes_this_iter": 31, "timestamp": 1558430075}

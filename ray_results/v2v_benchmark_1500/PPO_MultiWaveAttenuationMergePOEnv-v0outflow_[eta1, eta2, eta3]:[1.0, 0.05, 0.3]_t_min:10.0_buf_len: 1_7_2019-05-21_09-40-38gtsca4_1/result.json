{"episode_reward_mean": 481.747138702598, "timesteps_total": 66800, "iterations_since_restore": 1, "timesteps_since_restore": 66800, "pid": 59703, "custom_metrics": {"outflow_rate_min": 194.0003983453348, "system_level_velocity_min": 7.187582642661587, "cost1_max": 241.24904219291318, "cost2_max": -40.78370329000852, "cost2_min": -88.67674260412795, "outflow_rate_max": 498.63360957004153, "system_level_velocity_mean": 7.99323181168855, "cost1_mean": 207.50931389339215, "cost2_mean": -60.87793060780019, "outflow_rate_mean": 348.0131237217748, "system_level_velocity_max": 9.132903418299497, "cost1_min": 184.21188437835823}, "policy_reward_mean": {}, "timesteps_this_iter": 66800, "training_iteration": 1, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558431759, "hostname": "flow-main", "episode_reward_max": 709.8013373359297, "episode_reward_min": 329.5814539663383, "episodes_total": 27, "time_since_restore": 51.610490560531616, "date": "2019-05-21_09-42-39", "time_total_s": 51.610490560531616, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb828>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 66800, "sample_time_ms": 31448.499, "load_time_ms": 77.35, "grad_time_ms": 19251.914, "update_time_ms": 680.375, "default": {"policy_loss": -0.0013765066396445036, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8855345845222473, "total_loss": 1.7159796953201294, "cur_kl_coeff": 0.20000001788139343, "vf_loss": 1.7167116403579712, "kl": 0.0032225779723376036, "entropy": 1.4145903587341309}, "num_steps_sampled": 66800}, "episodes_this_iter": 27, "time_this_iter_s": 51.610490560531616}
{"episode_reward_mean": 507.5983310455701, "timesteps_total": 129363, "iterations_since_restore": 2, "timesteps_since_restore": 129363, "pid": 59703, "custom_metrics": {"outflow_rate_min": 194.0003983453348, "system_level_velocity_min": 6.369116804294259, "cost1_max": 256.6858995201375, "cost2_max": -32.45779870744403, "cost2_min": -88.67674260412795, "outflow_rate_max": 723.0179109041062, "system_level_velocity_mean": 8.163749248189529, "cost1_mean": 212.0536858480694, "cost2_mean": -59.00499672444394, "outflow_rate_mean": 405.6861479272546, "system_level_velocity_max": 9.576609813895555, "cost1_min": 166.19837382043943}, "policy_reward_mean": {}, "timesteps_this_iter": 62563, "training_iteration": 2, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558431805, "hostname": "flow-main", "episode_reward_max": 709.8013373359297, "episode_reward_min": 329.5814539663383, "episodes_total": 55, "time_since_restore": 97.88578581809998, "date": "2019-05-21_09-43-25", "time_total_s": 97.88578581809998, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb0b8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 129363, "sample_time_ms": 29946.012, "load_time_ms": 44.446, "grad_time_ms": 18476.788, "update_time_ms": 344.74, "default": {"policy_loss": -0.003797384211793542, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9207723736763, "total_loss": 2.4879157543182373, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 2.4907376766204834, "kl": 0.009752736426889896, "entropy": 1.4052574634552002}, "num_steps_sampled": 129363}, "episodes_this_iter": 28, "time_this_iter_s": 46.27529525756836}
{"episode_reward_mean": 605.4123944845353, "timesteps_total": 194932, "iterations_since_restore": 3, "timesteps_since_restore": 194932, "pid": 59703, "custom_metrics": {"outflow_rate_min": 194.0003983453348, "system_level_velocity_min": 6.369116804294259, "cost1_max": 303.1194077851701, "cost2_max": -32.45779870744403, "cost2_min": -133.2241044161816, "outflow_rate_max": 1009.667282514403, "system_level_velocity_mean": 8.81259134129292, "cost1_mean": 229.74431688912867, "cost2_mean": -67.21891058730034, "outflow_rate_mean": 509.9452477972332, "system_level_velocity_max": 11.512866892562855, "cost1_min": 166.19837382043943}, "policy_reward_mean": {}, "timesteps_this_iter": 65569, "training_iteration": 3, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558431853, "hostname": "flow-main", "episode_reward_max": 1121.6490079553294, "episode_reward_min": 329.5814539663383, "episodes_total": 83, "time_since_restore": 145.46332049369812, "date": "2019-05-21_09-44-13", "time_total_s": 145.46332049369812, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdee48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde320>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 194932, "sample_time_ms": 29493.132, "load_time_ms": 33.338, "grad_time_ms": 18602.961, "update_time_ms": 233.336, "default": {"policy_loss": -0.004542890004813671, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9068969488143921, "total_loss": 5.682651519775391, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 5.686291694641113, "kl": 0.009031141176819801, "entropy": 1.3827158212661743}, "num_steps_sampled": 194932}, "episodes_this_iter": 28, "time_this_iter_s": 47.577534675598145}
{"episode_reward_mean": 712.6613129624957, "timesteps_total": 270464, "iterations_since_restore": 4, "timesteps_since_restore": 270464, "pid": 59703, "custom_metrics": {"outflow_rate_min": 194.0003983453348, "system_level_velocity_min": 6.369116804294259, "cost1_max": 322.14640039304516, "cost2_max": -32.45779870744403, "cost2_min": -133.2241044161816, "outflow_rate_max": 1101.336965989724, "system_level_velocity_mean": 9.220083543736212, "cost1_mean": 241.29467299159785, "cost2_mean": -79.13818685346173, "outflow_rate_mean": 610.8000877384756, "system_level_velocity_max": 12.094495717188266, "cost1_min": 166.19837382043943}, "policy_reward_mean": {}, "timesteps_this_iter": 75532, "training_iteration": 4, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558431909, "hostname": "flow-main", "episode_reward_max": 1227.4011868090208, "episode_reward_min": 330.2774105874387, "episodes_total": 109, "time_since_restore": 201.2097043991089, "date": "2019-05-21_09-45-09", "time_total_s": 201.2097043991089, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb668>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 270464, "sample_time_ms": 30860.05, "load_time_ms": 27.882, "grad_time_ms": 19113.214, "update_time_ms": 177.453, "default": {"policy_loss": -0.0018019122071564198, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9304961562156677, "total_loss": 6.48502779006958, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 6.486316680908203, "kl": 0.0051307762041687965, "entropy": 1.4080969095230103}, "num_steps_sampled": 270464}, "episodes_this_iter": 26, "time_this_iter_s": 55.74638390541077}
{"episode_reward_mean": 842.690054224987, "timesteps_total": 344844, "iterations_since_restore": 5, "timesteps_since_restore": 344844, "pid": 59703, "custom_metrics": {"outflow_rate_min": 248.6753488372093, "system_level_velocity_min": 6.369116804294259, "cost1_max": 322.14640039304516, "cost2_max": -32.45779870744403, "cost2_min": -142.01308719790552, "outflow_rate_max": 1101.336965989724, "system_level_velocity_mean": 9.782651456900204, "cost1_mean": 257.09726854237795, "cost2_mean": -92.77427912066787, "outflow_rate_mean": 736.5725643209694, "system_level_velocity_max": 12.094495717188266, "cost1_min": 166.19837382043943}, "policy_reward_mean": {}, "timesteps_this_iter": 74380, "training_iteration": 5, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558431966, "hostname": "flow-main", "episode_reward_max": 1227.4011868090208, "episode_reward_min": 330.2774105874387, "episodes_total": 134, "time_since_restore": 258.11834383010864, "date": "2019-05-21_09-46-06", "time_total_s": 258.11834383010864, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdedd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8e48>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 344844, "sample_time_ms": 31926.377, "load_time_ms": 24.855, "grad_time_ms": 19399.985, "update_time_ms": 143.328, "default": {"policy_loss": -0.003482826752588153, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9205554723739624, "total_loss": 8.204970359802246, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 8.207737922668457, "kl": 0.007154759950935841, "entropy": 1.400203824043274}, "num_steps_sampled": 344844}, "episodes_this_iter": 25, "time_this_iter_s": 56.908639430999756}
{"episode_reward_mean": 975.6432518554424, "timesteps_total": 415116, "iterations_since_restore": 6, "timesteps_since_restore": 415116, "pid": 59703, "custom_metrics": {"outflow_rate_min": 438.75658680480615, "system_level_velocity_min": 6.718300675837872, "cost1_max": 342.3249298043611, "cost2_max": -36.4333945714574, "cost2_min": -147.11767635845598, "outflow_rate_max": 1213.5485560928264, "system_level_velocity_mean": 10.357372535755887, "cost1_mean": 273.39503611092726, "cost2_mean": -110.41699991084214, "outflow_rate_mean": 857.7423742151304, "system_level_velocity_max": 12.756567749824619, "cost1_min": 174.67958459770318}, "policy_reward_mean": {}, "timesteps_this_iter": 70272, "training_iteration": 6, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432019, "hostname": "flow-main", "episode_reward_max": 1312.9563779740727, "episode_reward_min": 515.4413695398156, "episodes_total": 160, "time_since_restore": 311.093168258667, "date": "2019-05-21_09-46-59", "time_total_s": 311.093168258667, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdeb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfded30>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 415116, "sample_time_ms": 32230.098, "load_time_ms": 22.236, "grad_time_ms": 19349.219, "update_time_ms": 120.843, "default": {"policy_loss": -0.004620797000825405, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9124501347541809, "total_loss": 8.983925819396973, "cur_kl_coeff": 0.10000000149011612, "vf_loss": 8.987587928771973, "kl": 0.009595014154911041, "entropy": 1.3674445152282715}, "num_steps_sampled": 415116}, "episodes_this_iter": 26, "time_this_iter_s": 52.97482442855835}
{"episode_reward_mean": 1062.8373158148238, "timesteps_total": 484985, "iterations_since_restore": 7, "timesteps_since_restore": 484985, "pid": 59703, "custom_metrics": {"outflow_rate_min": 491.7093617021277, "system_level_velocity_min": 6.718300675837872, "cost1_max": 356.90381434340486, "cost2_max": -85.76207553469901, "cost2_min": -172.18355930701708, "outflow_rate_max": 1220.6945812807885, "system_level_velocity_mean": 10.696671881945287, "cost1_mean": 283.6551488018009, "cost2_mean": -123.28781524676788, "outflow_rate_mean": 952.7843399443933, "system_level_velocity_max": 13.230379708192798, "cost1_min": 174.67958459770318}, "policy_reward_mean": {}, "timesteps_this_iter": 69869, "training_iteration": 7, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432070, "hostname": "flow-main", "episode_reward_max": 1324.371203759899, "episode_reward_min": 677.1470629500718, "episodes_total": 186, "time_since_restore": 362.88672399520874, "date": "2019-05-21_09-47-50", "time_total_s": 362.88672399520874, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbba8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 484985, "sample_time_ms": 32392.873, "load_time_ms": 20.367, "grad_time_ms": 19199.092, "update_time_ms": 104.841, "default": {"policy_loss": -0.004288754891604185, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8751289248466492, "total_loss": 12.274195671081543, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 12.277547836303711, "kl": 0.00935349240899086, "entropy": 1.3585973978042603}, "num_steps_sampled": 484985}, "episodes_this_iter": 26, "time_this_iter_s": 51.79355573654175}
{"episode_reward_mean": 1116.4389795116929, "timesteps_total": 552806, "iterations_since_restore": 8, "timesteps_since_restore": 552806, "pid": 59703, "custom_metrics": {"outflow_rate_min": 499.3045271204951, "system_level_velocity_min": 7.809144123874965, "cost1_max": 356.90381434340486, "cost2_max": -99.86133409278843, "cost2_min": -177.93640143155443, "outflow_rate_max": 1252.0749643253112, "system_level_velocity_mean": 11.088064817708617, "cost1_mean": 294.63342543759495, "cost2_mean": -133.15242502476312, "outflow_rate_mean": 1022.7502152794883, "system_level_velocity_max": 13.230379708192798, "cost1_min": 201.3995899958224}, "policy_reward_mean": {}, "timesteps_this_iter": 67821, "training_iteration": 8, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432123, "hostname": "flow-main", "episode_reward_max": 1324.371203759899, "episode_reward_min": 819.2608915236729, "episodes_total": 214, "time_since_restore": 415.23939299583435, "date": "2019-05-21_09-48-43", "time_total_s": 415.23939299583435, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdef28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde4a8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 552806, "sample_time_ms": 32686.276, "load_time_ms": 18.941, "grad_time_ms": 18983.32, "update_time_ms": 92.856, "default": {"policy_loss": -0.004128174856305122, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.834658682346344, "total_loss": 14.739157676696777, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 14.742355346679688, "kl": 0.009303642436861992, "entropy": 1.3364343643188477}, "num_steps_sampled": 552806}, "episodes_this_iter": 28, "time_this_iter_s": 52.35266900062561}
{"episode_reward_mean": 1162.8075265783589, "timesteps_total": 619381, "iterations_since_restore": 9, "timesteps_since_restore": 619381, "pid": 59703, "custom_metrics": {"outflow_rate_min": 858.759642047344, "system_level_velocity_min": 8.783080219014442, "cost1_max": 356.90381434340486, "cost2_max": -107.69802039682732, "cost2_min": -178.29502722320854, "outflow_rate_max": 1283.5555970368916, "system_level_velocity_mean": 11.53167867980235, "cost1_mean": 306.97952940612754, "cost2_mean": -140.82953017793568, "outflow_rate_mean": 1087.2095030769729, "system_level_velocity_max": 13.230379708192798, "cost1_min": 231.5042383377385}, "policy_reward_mean": {}, "timesteps_this_iter": 66575, "training_iteration": 9, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432171, "hostname": "flow-main", "episode_reward_max": 1339.3702708478515, "episode_reward_min": 949.8708969931549, "episodes_total": 240, "time_since_restore": 463.6392197608948, "date": "2019-05-21_09-49-31", "time_total_s": 463.6392197608948, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde6d8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 619381, "sample_time_ms": 32789.631, "load_time_ms": 18.147, "grad_time_ms": 18500.977, "update_time_ms": 83.392, "default": {"policy_loss": -0.005137667991220951, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.809935450553894, "total_loss": 16.567028045654297, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 16.571134567260742, "kl": 0.01031248364597559, "entropy": 1.333738088607788}, "num_steps_sampled": 619381}, "episodes_this_iter": 26, "time_this_iter_s": 48.399826765060425}
{"episode_reward_mean": 1201.383432051364, "timesteps_total": 682620, "iterations_since_restore": 10, "timesteps_since_restore": 682620, "pid": 59703, "custom_metrics": {"outflow_rate_min": 922.2781998199819, "system_level_velocity_min": 8.984763038973382, "cost1_max": 396.6120096739688, "cost2_max": -120.69302622861886, "cost2_min": -185.31744681335232, "outflow_rate_max": 1374.1197811183647, "system_level_velocity_mean": 11.908513289988486, "cost1_mean": 316.957519904146, "cost2_mean": -146.98933940287571, "outflow_rate_mean": 1137.4162771770957, "system_level_velocity_max": 14.712509204810607, "cost1_min": 234.0417156571866}, "policy_reward_mean": {}, "timesteps_this_iter": 63239, "training_iteration": 10, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432220, "hostname": "flow-main", "episode_reward_max": 1430.5032009375523, "episode_reward_min": 985.4371084240385, "episodes_total": 273, "time_since_restore": 512.4083921909332, "date": "2019-05-21_09-50-20", "time_total_s": 512.4083921909332, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdee48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde2b0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 682620, "sample_time_ms": 32853.466, "load_time_ms": 17.27, "grad_time_ms": 18170.664, "update_time_ms": 75.899, "default": {"policy_loss": -0.0043436698615550995, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7467041015625, "total_loss": 24.549571990966797, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 24.553083419799805, "kl": 0.008322495967149734, "entropy": 1.3073687553405762}, "num_steps_sampled": 682620}, "episodes_this_iter": 33, "time_this_iter_s": 48.76917243003845}
{"episode_reward_mean": 1232.8669922213364, "timesteps_total": 747810, "iterations_since_restore": 11, "timesteps_since_restore": 747810, "pid": 59703, "custom_metrics": {"outflow_rate_min": 922.2781998199819, "system_level_velocity_min": 9.587317262182776, "cost1_max": 399.90926834415444, "cost2_max": -120.69302622861886, "cost2_min": -185.31744681335232, "outflow_rate_max": 1388.3607759562844, "system_level_velocity_mean": 12.407272389107089, "cost1_mean": 330.33061139408676, "cost2_mean": -149.40825106064526, "outflow_rate_mean": 1179.80817927717, "system_level_velocity_max": 14.924944154799169, "cost1_min": 253.8077311911523}, "policy_reward_mean": {}, "timesteps_this_iter": 65190, "training_iteration": 11, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432269, "hostname": "flow-main", "episode_reward_max": 1430.5032009375523, "episode_reward_min": 1037.5052565020685, "episodes_total": 306, "time_since_restore": 561.2297596931458, "date": "2019-05-21_09-51-09", "time_total_s": 561.2297596931458, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdeb38>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 747810, "sample_time_ms": 32925.712, "load_time_ms": 10.351, "grad_time_ms": 17897.321, "update_time_ms": 8.52, "default": {"policy_loss": -0.005612106528133154, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7653302550315857, "total_loss": 26.114831924438477, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 26.119434356689453, "kl": 0.010118373669683933, "entropy": 1.3124785423278809}, "num_steps_sampled": 747810}, "episodes_this_iter": 33, "time_this_iter_s": 48.821367502212524}
{"episode_reward_mean": 1239.3063366088152, "timesteps_total": 811066, "iterations_since_restore": 12, "timesteps_since_restore": 811066, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1046.5441837008686, "system_level_velocity_min": 9.098910892344033, "cost1_max": 402.8502678026159, "cost2_max": -127.80998601209762, "cost2_min": -185.31744681335232, "outflow_rate_max": 1388.3607759562844, "system_level_velocity_mean": 12.583761139908853, "cost1_mean": 334.4266557597954, "cost2_mean": -150.29057422369723, "outflow_rate_mean": 1201.3778715535536, "system_level_velocity_max": 15.148960647082966, "cost1_min": 235.73327538076856}, "policy_reward_mean": {}, "timesteps_this_iter": 63256, "training_iteration": 12, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432319, "hostname": "flow-main", "episode_reward_max": 1430.5032009375523, "episode_reward_min": 1036.6391676996334, "episodes_total": 335, "time_since_restore": 610.7272284030914, "date": "2019-05-21_09-51-59", "time_total_s": 610.7272284030914, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfded68>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 811066, "sample_time_ms": 33239.007, "load_time_ms": 10.133, "grad_time_ms": 17903.227, "update_time_ms": 8.331, "default": {"policy_loss": -0.004973909817636013, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.758942186832428, "total_loss": 23.376976013183594, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 23.380970001220703, "kl": 0.00978699978441, "entropy": 1.3117903470993042}, "num_steps_sampled": 811066}, "episodes_this_iter": 29, "time_this_iter_s": 49.49746870994568}
{"episode_reward_mean": 1226.0865394662562, "timesteps_total": 874375, "iterations_since_restore": 13, "timesteps_since_restore": 874375, "pid": 59703, "custom_metrics": {"outflow_rate_min": 480.7985364308436, "system_level_velocity_min": 9.098910892344033, "cost1_max": 402.8502678026159, "cost2_max": -26.1542679501951, "cost2_min": -183.30747794563308, "outflow_rate_max": 1388.3607759562844, "system_level_velocity_mean": 12.806177926415428, "cost1_mean": 335.2678520464003, "cost2_mean": -148.82174387357108, "outflow_rate_mean": 1196.7466854760596, "system_level_velocity_max": 18.411112513231416, "cost1_min": 26.322769720848235}, "policy_reward_mean": {}, "timesteps_this_iter": 63309, "training_iteration": 13, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432368, "hostname": "flow-main", "episode_reward_max": 1398.8402542661843, "episode_reward_min": 65.75300510613984, "episodes_total": 364, "time_since_restore": 660.2856299877167, "date": "2019-05-21_09-52-48", "time_total_s": 660.2856299877167, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdecf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde550>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.4, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 874375, "sample_time_ms": 33545.569, "load_time_ms": 9.621, "grad_time_ms": 17795.987, "update_time_ms": 8.201, "default": {"policy_loss": -0.006046872586011887, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7510718703269958, "total_loss": 23.75336456298828, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 23.75823402404785, "kl": 0.011792567558586597, "entropy": 1.3041505813598633}, "num_steps_sampled": 874375}, "episodes_this_iter": 29, "time_this_iter_s": 49.558401584625244}
{"episode_reward_mean": 1217.2227739450577, "timesteps_total": 938487, "iterations_since_restore": 14, "timesteps_since_restore": 938487, "pid": 59703, "custom_metrics": {"outflow_rate_min": 480.7985364308436, "system_level_velocity_min": 9.098910892344033, "cost1_max": 402.8502678026159, "cost2_max": -26.1542679501951, "cost2_min": -191.25056645360382, "outflow_rate_max": 1388.3607759562844, "system_level_velocity_mean": 12.711026542790792, "cost1_mean": 332.05657098588307, "cost2_mean": -149.96647740433266, "outflow_rate_mean": 1198.5293782979948, "system_level_velocity_max": 18.411112513231416, "cost1_min": 26.322769720848235}, "policy_reward_mean": {}, "timesteps_this_iter": 64112, "training_iteration": 14, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432417, "hostname": "flow-main", "episode_reward_max": 1398.8402542661843, "episode_reward_min": 65.75300510613984, "episodes_total": 391, "time_since_restore": 709.0759837627411, "date": "2019-05-21_09-53-37", "time_total_s": 709.0759837627411, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde6d8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.4, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 938487, "sample_time_ms": 33132.231, "load_time_ms": 9.365, "grad_time_ms": 17514.716, "update_time_ms": 8.161, "default": {"policy_loss": -0.005990669596940279, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7444936037063599, "total_loss": 24.196624755859375, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 24.201461791992188, "kl": 0.011546584777534008, "entropy": 1.3030864000320435}, "num_steps_sampled": 938487}, "episodes_this_iter": 27, "time_this_iter_s": 48.790353775024414}
{"episode_reward_mean": 1217.2061859687312, "timesteps_total": 1002388, "iterations_since_restore": 15, "timesteps_since_restore": 1002388, "pid": 59703, "custom_metrics": {"outflow_rate_min": 480.7985364308436, "system_level_velocity_min": 9.098910892344033, "cost1_max": 405.7726185455597, "cost2_max": -26.1542679501951, "cost2_min": -191.25056645360382, "outflow_rate_max": 1402.4758124307107, "system_level_velocity_mean": 12.786447871483372, "cost1_mean": 333.5065683112207, "cost2_mean": -151.82473218184248, "outflow_rate_mean": 1201.6922439961281, "system_level_velocity_max": 18.411112513231416, "cost1_min": 26.322769720848235}, "policy_reward_mean": {}, "timesteps_this_iter": 63901, "training_iteration": 15, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432465, "hostname": "flow-main", "episode_reward_max": 1401.5569385614078, "episode_reward_min": 65.75300510613984, "episodes_total": 417, "time_since_restore": 757.367672920227, "date": "2019-05-21_09-54-25", "time_total_s": 757.367672920227, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdecc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdeeb8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.4, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1002388, "sample_time_ms": 32585.219, "load_time_ms": 8.971, "grad_time_ms": 17204.289, "update_time_ms": 8.414, "default": {"policy_loss": -0.0063971951603889465, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7865777015686035, "total_loss": 23.864152908325195, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 23.86943244934082, "kl": 0.01117571722716093, "entropy": 1.2969307899475098}, "num_steps_sampled": 1002388}, "episodes_this_iter": 26, "time_this_iter_s": 48.29168915748596}
{"episode_reward_mean": 1241.6262799920335, "timesteps_total": 1066151, "iterations_since_restore": 16, "timesteps_since_restore": 1066151, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1014.5179561087452, "system_level_velocity_min": 9.894705936101225, "cost1_max": 414.55164234215226, "cost2_max": -123.40681617770198, "cost2_min": -191.25056645360382, "outflow_rate_max": 1402.4758124307107, "system_level_velocity_mean": 13.002687745839586, "cost1_mean": 343.5922908244081, "cost2_mean": -156.50304695540612, "outflow_rate_mean": 1220.9668126282052, "system_level_velocity_max": 15.575662492049037, "cost1_min": 257.8228212899859}, "policy_reward_mean": {}, "timesteps_this_iter": 63763, "training_iteration": 16, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432516, "hostname": "flow-main", "episode_reward_max": 1419.8572638494566, "episode_reward_min": 1051.3370088326396, "episodes_total": 443, "time_since_restore": 807.5776743888855, "date": "2019-05-21_09-55-16", "time_total_s": 807.5776743888855, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde0b8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1066151, "sample_time_ms": 32438.331, "load_time_ms": 8.922, "grad_time_ms": 17074.355, "update_time_ms": 8.377, "default": {"policy_loss": -0.007309611886739731, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8191437721252441, "total_loss": 23.434926986694336, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 23.440805435180664, "kl": 0.014318284578621387, "entropy": 1.298186182975769}, "num_steps_sampled": 1066151}, "episodes_this_iter": 26, "time_this_iter_s": 50.21000146865845}
{"episode_reward_mean": 1256.5487707649781, "timesteps_total": 1130887, "iterations_since_restore": 17, "timesteps_since_restore": 1130887, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1014.5179561087452, "system_level_velocity_min": 10.193585525925961, "cost1_max": 441.6408817943268, "cost2_max": -123.40681617770198, "cost2_min": -198.28625081182383, "outflow_rate_max": 1529.714327539122, "system_level_velocity_mean": 13.258211265165587, "cost1_mean": 349.9169763600065, "cost2_mean": -160.05954518399076, "outflow_rate_mean": 1238.4273088961613, "system_level_velocity_max": 16.63094508746826, "cost1_min": 263.7832440707644}, "policy_reward_mean": {}, "timesteps_this_iter": 64736, "training_iteration": 17, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432568, "hostname": "flow-main", "episode_reward_max": 1454.4055402115885, "episode_reward_min": 1051.3370088326396, "episodes_total": 470, "time_since_restore": 859.7270400524139, "date": "2019-05-21_09-56-08", "time_total_s": 859.7270400524139, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbccc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbce80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbcf28>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1130887, "sample_time_ms": 32472.451, "load_time_ms": 8.847, "grad_time_ms": 17071.825, "update_time_ms": 8.436, "default": {"policy_loss": -0.007541576400399208, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7825959324836731, "total_loss": 27.49992561340332, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 27.50613784790039, "kl": 0.01329006813466549, "entropy": 1.309231162071228}, "num_steps_sampled": 1130887}, "episodes_this_iter": 27, "time_this_iter_s": 52.14936566352844}
{"episode_reward_mean": 1273.28206544874, "timesteps_total": 1195140, "iterations_since_restore": 18, "timesteps_since_restore": 1195140, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1014.5179561087452, "system_level_velocity_min": 9.500235690346898, "cost1_max": 441.6408817943268, "cost2_max": -132.90270031179065, "cost2_min": -206.454050788264, "outflow_rate_max": 1529.714327539122, "system_level_velocity_mean": 13.40591825920652, "cost1_mean": 353.39213135342305, "cost2_mean": -165.14744550982545, "outflow_rate_mean": 1252.7691749018109, "system_level_velocity_max": 16.63094508746826, "cost1_min": 246.8875828859389}, "policy_reward_mean": {}, "timesteps_this_iter": 64253, "training_iteration": 18, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432619, "hostname": "flow-main", "episode_reward_max": 1454.4055402115885, "episode_reward_min": 1051.3370088326396, "episodes_total": 497, "time_since_restore": 911.3363039493561, "date": "2019-05-21_09-56-59", "time_total_s": 911.3363039493561, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc898>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1195140, "sample_time_ms": 32350.951, "load_time_ms": 8.815, "grad_time_ms": 17117.104, "update_time_ms": 8.593, "default": {"policy_loss": -0.00644253334030509, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7900040745735168, "total_loss": 30.532670974731445, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 30.537826538085938, "kl": 0.012837967835366726, "entropy": 1.3147600889205933}, "num_steps_sampled": 1195140}, "episodes_this_iter": 27, "time_this_iter_s": 51.60926389694214}
{"episode_reward_mean": 1275.0067784789599, "timesteps_total": 1259810, "iterations_since_restore": 19, "timesteps_since_restore": 1259810, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1059.9826775240892, "system_level_velocity_min": 8.516821174519066, "cost1_max": 441.6408817943268, "cost2_max": -137.81810063543844, "cost2_min": -206.454050788264, "outflow_rate_max": 1529.714327539122, "system_level_velocity_mean": 13.459499211361997, "cost1_mean": 354.51102129110785, "cost2_mean": -167.2065032864466, "outflow_rate_mean": 1259.1429042101327, "system_level_velocity_max": 16.63094508746826, "cost1_min": 222.07864546555714}, "policy_reward_mean": {}, "timesteps_this_iter": 64670, "training_iteration": 19, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432671, "hostname": "flow-main", "episode_reward_max": 1454.4055402115885, "episode_reward_min": 1086.2577172280223, "episodes_total": 524, "time_since_restore": 962.6495816707611, "date": "2019-05-21_09-57-51", "time_total_s": 962.6495816707611, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdeba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfded30>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1259810, "sample_time_ms": 32243.449, "load_time_ms": 8.432, "grad_time_ms": 17517.747, "update_time_ms": 8.67, "default": {"policy_loss": -0.0072243791073560715, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8151631951332092, "total_loss": 26.732330322265625, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 26.738174438476562, "kl": 0.013822841458022594, "entropy": 1.3288919925689697}, "num_steps_sampled": 1259810}, "episodes_this_iter": 27, "time_this_iter_s": 51.31327772140503}
{"episode_reward_mean": 1265.9003819344039, "timesteps_total": 1323588, "iterations_since_restore": 20, "timesteps_since_restore": 1323588, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1036.8474003052959, "system_level_velocity_min": 8.516821174519066, "cost1_max": 441.6408817943268, "cost2_max": -142.408272559512, "cost2_min": -206.454050788264, "outflow_rate_max": 1529.714327539122, "system_level_velocity_mean": 13.283528528909756, "cost1_mean": 349.23297106544965, "cost2_mean": -169.19996811321326, "outflow_rate_mean": 1250.1948802131287, "system_level_velocity_max": 16.63094508746826, "cost1_min": 222.07864546555714}, "policy_reward_mean": {}, "timesteps_this_iter": 63778, "training_iteration": 20, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432722, "hostname": "flow-main", "episode_reward_max": 1454.4055402115885, "episode_reward_min": 1086.2577172280223, "episodes_total": 553, "time_since_restore": 1013.9117906093597, "date": "2019-05-21_09-58-42", "time_total_s": 1013.9117906093597, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0008d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0004e0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1323588, "sample_time_ms": 32344.831, "load_time_ms": 8.394, "grad_time_ms": 17667.775, "update_time_ms": 8.637, "default": {"policy_loss": -0.006231738720089197, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8050172924995422, "total_loss": 31.860614776611328, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 31.865476608276367, "kl": 0.013706064783036709, "entropy": 1.3113229274749756}, "num_steps_sampled": 1323588}, "episodes_this_iter": 29, "time_this_iter_s": 51.26220893859863}
{"episode_reward_mean": 1261.2358795777295, "timesteps_total": 1389238, "iterations_since_restore": 21, "timesteps_since_restore": 1389238, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1036.8474003052959, "system_level_velocity_min": 8.516821174519066, "cost1_max": 428.23788352693725, "cost2_max": -133.58821104196812, "cost2_min": -204.275879574969, "outflow_rate_max": 1466.0394913138339, "system_level_velocity_mean": 13.344041614553271, "cost1_mean": 350.7952984801637, "cost2_mean": -167.51317098821633, "outflow_rate_mean": 1240.9971313010878, "system_level_velocity_max": 16.160403396095585, "cost1_min": 222.07864546555714}, "policy_reward_mean": {}, "timesteps_this_iter": 65650, "training_iteration": 21, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432770, "hostname": "flow-main", "episode_reward_max": 1415.9789202335603, "episode_reward_min": 1086.2577172280223, "episodes_total": 581, "time_since_restore": 1061.353803396225, "date": "2019-05-21_09-59-30", "time_total_s": 1061.353803396225, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdedd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdeba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdebe0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1389238, "sample_time_ms": 32153.721, "load_time_ms": 8.522, "grad_time_ms": 17721.767, "update_time_ms": 8.948, "default": {"policy_loss": -0.007322085555642843, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8213452696800232, "total_loss": 30.571075439453125, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 30.576791763305664, "kl": 0.01605779491364956, "entropy": 1.3242871761322021}, "num_steps_sampled": 1389238}, "episodes_this_iter": 28, "time_this_iter_s": 47.442012786865234}
{"episode_reward_mean": 1259.067404343743, "timesteps_total": 1453057, "iterations_since_restore": 22, "timesteps_since_restore": 1453057, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1036.8474003052959, "system_level_velocity_min": 8.516821174519066, "cost1_max": 437.0474832039968, "cost2_max": -133.58821104196812, "cost2_min": -205.73167173116184, "outflow_rate_max": 1457.669240378758, "system_level_velocity_mean": 13.443946691976235, "cost1_mean": 353.26639130339885, "cost2_mean": -166.06308474515535, "outflow_rate_mean": 1237.9997690133982, "system_level_velocity_max": 16.52368294462376, "cost1_min": 222.07864546555714}, "policy_reward_mean": {}, "timesteps_this_iter": 63819, "training_iteration": 22, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432818, "hostname": "flow-main", "episode_reward_max": 1415.9789202335603, "episode_reward_min": 1104.6631769866153, "episodes_total": 616, "time_since_restore": 1109.4896206855774, "date": "2019-05-21_10-00-18", "time_total_s": 1109.4896206855774, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc80b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8208>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1453057, "sample_time_ms": 32075.582, "load_time_ms": 8.567, "grad_time_ms": 17667.41, "update_time_ms": 9.017, "default": {"policy_loss": -0.0075796316377818584, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8034124970436096, "total_loss": 36.473636627197266, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 36.47966003417969, "kl": 0.015572567470371723, "entropy": 1.3157801628112793}, "num_steps_sampled": 1453057}, "episodes_this_iter": 35, "time_this_iter_s": 48.13581728935242}
{"episode_reward_mean": 1260.0521780489123, "timesteps_total": 1518944, "iterations_since_restore": 23, "timesteps_since_restore": 1518944, "pid": 59703, "custom_metrics": {"outflow_rate_min": 994.7432763669317, "system_level_velocity_min": 9.483595000417377, "cost1_max": 455.7606483498299, "cost2_max": -123.27494294506462, "cost2_min": -206.74380965520473, "outflow_rate_max": 1605.858835543533, "system_level_velocity_mean": 13.55747726424812, "cost1_mean": 356.12673545934354, "cost2_mean": -164.54700717279738, "outflow_rate_mean": 1237.911429186927, "system_level_velocity_max": 17.194858987159687, "cost1_min": 247.80471100450256}, "policy_reward_mean": {}, "timesteps_this_iter": 65887, "training_iteration": 23, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432865, "hostname": "flow-main", "episode_reward_max": 1470.5308908444476, "episode_reward_min": 1072.984946330067, "episodes_total": 644, "time_since_restore": 1156.848538160324, "date": "2019-05-21_10-01-05", "time_total_s": 1156.848538160324, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdeef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c031b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfba0b8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1518944, "sample_time_ms": 31888.86, "load_time_ms": 9.034, "grad_time_ms": 17634.19, "update_time_ms": 8.8, "default": {"policy_loss": -0.007949093356728554, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8328505158424377, "total_loss": 35.169891357421875, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 35.17620086669922, "kl": 0.016457952558994293, "entropy": 1.3057531118392944}, "num_steps_sampled": 1518944}, "episodes_this_iter": 28, "time_this_iter_s": 47.358917474746704}
{"episode_reward_mean": 1263.0654806343503, "timesteps_total": 1583119, "iterations_since_restore": 24, "timesteps_since_restore": 1583119, "pid": 59703, "custom_metrics": {"outflow_rate_min": 994.7432763669317, "system_level_velocity_min": 9.483595000417377, "cost1_max": 455.7606483498299, "cost2_max": -116.23667572267598, "cost2_min": -206.74380965520473, "outflow_rate_max": 1605.858835543533, "system_level_velocity_mean": 13.658372014397152, "cost1_mean": 358.66379061871424, "cost2_mean": -163.9345678681645, "outflow_rate_mean": 1242.3946480335467, "system_level_velocity_max": 17.194858987159687, "cost1_min": 247.80471100450256}, "policy_reward_mean": {}, "timesteps_this_iter": 64175, "training_iteration": 24, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432912, "hostname": "flow-main", "episode_reward_max": 1470.5308908444476, "episode_reward_min": 1072.984946330067, "episodes_total": 672, "time_since_restore": 1203.155115365982, "date": "2019-05-21_10-01-52", "time_total_s": 1203.155115365982, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff8214ea438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016278>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1583119, "sample_time_ms": 31675.071, "load_time_ms": 9.05, "grad_time_ms": 17599.234, "update_time_ms": 8.579, "default": {"policy_loss": -0.008401739411056042, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8323118090629578, "total_loss": 34.27001953125, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 34.27674865722656, "kl": 0.01673450507223606, "entropy": 1.2983510494232178}, "num_steps_sampled": 1583119}, "episodes_this_iter": 28, "time_this_iter_s": 46.30657720565796}
{"episode_reward_mean": 1265.080036476205, "timesteps_total": 1645967, "iterations_since_restore": 25, "timesteps_since_restore": 1645967, "pid": 59703, "custom_metrics": {"outflow_rate_min": 994.7432763669317, "system_level_velocity_min": 9.483595000417377, "cost1_max": 455.7606483498299, "cost2_max": -116.23667572267598, "cost2_min": -206.74380965520473, "outflow_rate_max": 1605.858835543533, "system_level_velocity_mean": 13.722741261614, "cost1_mean": 360.1790799890844, "cost2_mean": -163.9136374253416, "outflow_rate_mean": 1247.8742199158596, "system_level_velocity_max": 17.194858987159687, "cost1_min": 247.80471100450256}, "policy_reward_mean": {}, "timesteps_this_iter": 62848, "training_iteration": 25, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558432957, "hostname": "flow-main", "episode_reward_max": 1470.5308908444476, "episode_reward_min": 1072.984946330067, "episodes_total": 699, "time_since_restore": 1248.0778138637543, "date": "2019-05-21_10-02-37", "time_total_s": 1248.0778138637543, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc80b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8e80>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1645967, "sample_time_ms": 31443.945, "load_time_ms": 9.044, "grad_time_ms": 17494.246, "update_time_ms": 8.427, "default": {"policy_loss": -0.0078021809458732605, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8404619097709656, "total_loss": 33.2370491027832, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 33.24323654174805, "kl": 0.016172857955098152, "entropy": 1.312508463859558}, "num_steps_sampled": 1645967}, "episodes_this_iter": 27, "time_this_iter_s": 44.92269849777222}
{"episode_reward_mean": 1271.1737983456724, "timesteps_total": 1709173, "iterations_since_restore": 26, "timesteps_since_restore": 1709173, "pid": 59703, "custom_metrics": {"outflow_rate_min": 994.7432763669317, "system_level_velocity_min": 10.318727604412926, "cost1_max": 458.0519297429017, "cost2_max": -116.23667572267598, "cost2_min": -206.74380965520473, "outflow_rate_max": 1605.858835543533, "system_level_velocity_mean": 13.942726115600898, "cost1_mean": 366.3253542928383, "cost2_mean": -162.16482636075486, "outflow_rate_mean": 1261.3677839024022, "system_level_velocity_max": 17.198457380458493, "cost1_min": 265.49184432628243}, "policy_reward_mean": {}, "timesteps_this_iter": 63206, "training_iteration": 26, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433002, "hostname": "flow-main", "episode_reward_max": 1470.5308908444476, "episode_reward_min": 1072.984946330067, "episodes_total": 728, "time_since_restore": 1293.2417886257172, "date": "2019-05-21_10-03-22", "time_total_s": 1293.2417886257172, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c031f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016e80>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1709173, "sample_time_ms": 31084.299, "load_time_ms": 9.099, "grad_time_ms": 17350.753, "update_time_ms": 8.595, "default": {"policy_loss": -0.006940532010048628, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8279849886894226, "total_loss": 35.2861213684082, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 35.291629791259766, "kl": 0.014344528317451477, "entropy": 1.2903941869735718}, "num_steps_sampled": 1709173}, "episodes_this_iter": 29, "time_this_iter_s": 45.16397476196289}
{"episode_reward_mean": 1251.5643297167035, "timesteps_total": 1773340, "iterations_since_restore": 27, "timesteps_since_restore": 1773340, "pid": 59703, "custom_metrics": {"outflow_rate_min": 483.59628932995435, "system_level_velocity_min": 10.652261954684958, "cost1_max": 458.0519297429017, "cost2_max": -22.202142431593966, "cost2_min": -206.1499385024578, "outflow_rate_max": 1564.49985257776, "system_level_velocity_mean": 13.837265870201433, "cost1_mean": 358.68595671111063, "cost2_mean": -163.67282813249236, "outflow_rate_mean": 1247.0136725734446, "system_level_velocity_max": 18.424979924567243, "cost1_min": 22.971024931019826}, "policy_reward_mean": {}, "timesteps_this_iter": 64167, "training_iteration": 27, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433049, "hostname": "flow-main", "episode_reward_max": 1433.5048530575004, "episode_reward_min": 58.17571344103906, "episodes_total": 755, "time_since_restore": 1340.3418214321136, "date": "2019-05-21_10-04-09", "time_total_s": 1340.3418214321136, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf329e8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.35, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1773340, "sample_time_ms": 30754.415, "load_time_ms": 9.208, "grad_time_ms": 17179.469, "update_time_ms": 8.538, "default": {"policy_loss": -0.007469226606190205, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8107079267501831, "total_loss": 35.92863464355469, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 35.934234619140625, "kl": 0.018726129084825516, "entropy": 1.3030682802200317}, "num_steps_sampled": 1773340}, "episodes_this_iter": 27, "time_this_iter_s": 47.100032806396484}
{"episode_reward_mean": 1249.7897526061738, "timesteps_total": 1838243, "iterations_since_restore": 28, "timesteps_since_restore": 1838243, "pid": 59703, "custom_metrics": {"outflow_rate_min": 483.59628932995435, "system_level_velocity_min": 10.060362287689145, "cost1_max": 458.0519297429017, "cost2_max": -22.202142431593966, "cost2_min": -208.65640196447222, "outflow_rate_max": 1564.49985257776, "system_level_velocity_mean": 13.749866813058985, "cost1_mean": 356.4560883753472, "cost2_mean": -166.1124521290337, "outflow_rate_mean": 1249.030044634036, "system_level_velocity_max": 18.424979924567243, "cost1_min": 22.971024931019826}, "policy_reward_mean": {}, "timesteps_this_iter": 64903, "training_iteration": 28, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433096, "hostname": "flow-main", "episode_reward_max": 1433.5048530575004, "episode_reward_min": 58.17571344103906, "episodes_total": 784, "time_since_restore": 1387.728798866272, "date": "2019-05-21_10-04-56", "time_total_s": 1387.728798866272, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdeef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c031c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c031f28>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.35, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1838243, "sample_time_ms": 30454.474, "load_time_ms": 9.276, "grad_time_ms": 17061.485, "update_time_ms": 8.211, "default": {"policy_loss": -0.00845503993332386, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8137967586517334, "total_loss": 36.08042907714844, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 36.0870361328125, "kl": 0.018451789394021034, "entropy": 1.2935084104537964}, "num_steps_sampled": 1838243}, "episodes_this_iter": 29, "time_this_iter_s": 47.386977434158325}
{"episode_reward_mean": 1243.816772116097, "timesteps_total": 1899027, "iterations_since_restore": 29, "timesteps_since_restore": 1899027, "pid": 59703, "custom_metrics": {"outflow_rate_min": 483.59628932995435, "system_level_velocity_min": 10.060362287689145, "cost1_max": 460.05985724268123, "cost2_max": -22.202142431593966, "cost2_min": -208.65640196447222, "outflow_rate_max": 1480.2568570072658, "system_level_velocity_mean": 13.762267151817486, "cost1_mean": 356.3892052198786, "cost2_mean": -163.7145934484001, "outflow_rate_mean": 1246.7400830711617, "system_level_velocity_max": 18.424979924567243, "cost1_min": 22.971024931019826}, "policy_reward_mean": {}, "timesteps_this_iter": 60784, "training_iteration": 29, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433140, "hostname": "flow-main", "episode_reward_max": 1404.8159296431847, "episode_reward_min": 58.17571344103906, "episodes_total": 811, "time_since_restore": 1431.7981066703796, "date": "2019-05-21_10-05-40", "time_total_s": 1431.7981066703796, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc5c0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.35, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1899027, "sample_time_ms": 30020.714, "load_time_ms": 9.52, "grad_time_ms": 16770.965, "update_time_ms": 8.161, "default": {"policy_loss": -0.010297670029103756, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8175523281097412, "total_loss": 40.47924041748047, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 40.48755645751953, "kl": 0.019885793328285217, "entropy": 1.2770774364471436}, "num_steps_sampled": 1899027}, "episodes_this_iter": 27, "time_this_iter_s": 44.069307804107666}
{"episode_reward_mean": 1245.359895466216, "timesteps_total": 1962069, "iterations_since_restore": 30, "timesteps_since_restore": 1962069, "pid": 59703, "custom_metrics": {"outflow_rate_min": 466.57782141583624, "system_level_velocity_min": 10.060362287689145, "cost1_max": 460.05985724268123, "cost2_max": -22.945663310694982, "cost2_min": -208.65640196447222, "outflow_rate_max": 1526.2967592738753, "system_level_velocity_mean": 13.8867153778937, "cost1_mean": 359.7384472609705, "cost2_mean": -161.7009195897568, "outflow_rate_mean": 1251.6461878460855, "system_level_velocity_max": 18.36386928069056, "cost1_min": 22.95154103147559}, "policy_reward_mean": {}, "timesteps_this_iter": 63042, "training_iteration": 30, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433185, "hostname": "flow-main", "episode_reward_max": 1405.7932804832492, "episode_reward_min": 58.5013787049498, "episodes_total": 841, "time_since_restore": 1476.5856289863586, "date": "2019-05-21_10-06-25", "time_total_s": 1476.5856289863586, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32208>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.35, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 1962069, "sample_time_ms": 29446.281, "load_time_ms": 9.481, "grad_time_ms": 16697.615, "update_time_ms": 8.24, "default": {"policy_loss": -0.009246778674423695, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7986378073692322, "total_loss": 41.15537643432617, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 41.162811279296875, "kl": 0.01810537651181221, "entropy": 1.2813555002212524}, "num_steps_sampled": 1962069}, "episodes_this_iter": 30, "time_this_iter_s": 44.787522315979004}
{"episode_reward_mean": 1236.772646049911, "timesteps_total": 2023033, "iterations_since_restore": 31, "timesteps_since_restore": 2023033, "pid": 59703, "custom_metrics": {"outflow_rate_min": 466.57782141583624, "system_level_velocity_min": 10.060362287689145, "cost1_max": 460.05985724268123, "cost2_max": -18.07615549368946, "cost2_min": -208.00140802323028, "outflow_rate_max": 1526.2967592738753, "system_level_velocity_mean": 14.178711198042077, "cost1_mean": 362.7026418763055, "cost2_mean": -155.31202447228273, "outflow_rate_mean": 1259.4055771929097, "system_level_velocity_max": 18.36386928069056, "cost1_min": 18.113716120170462}, "policy_reward_mean": {}, "timesteps_this_iter": 60964, "training_iteration": 31, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433229, "hostname": "flow-main", "episode_reward_max": 1405.7932804832492, "episode_reward_min": 44.36729023650768, "episodes_total": 871, "time_since_restore": 1520.5917201042175, "date": "2019-05-21_10-07-09", "time_total_s": 1520.5917201042175, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdeef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdecc0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 686.62, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2023033, "sample_time_ms": 29361.669, "load_time_ms": 9.377, "grad_time_ms": 16439.049, "update_time_ms": 8.02, "default": {"policy_loss": -0.010325849987566471, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7990942001342773, "total_loss": 43.431243896484375, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 43.439613342285156, "kl": 0.01955430582165718, "entropy": 1.2812639474868774}, "num_steps_sampled": 2023033}, "episodes_this_iter": 30, "time_this_iter_s": 44.00609111785889}
{"episode_reward_mean": 1228.3411856635894, "timesteps_total": 2085762, "iterations_since_restore": 32, "timesteps_since_restore": 2085762, "pid": 59703, "custom_metrics": {"outflow_rate_min": 466.57782141583624, "system_level_velocity_min": 10.78985435794258, "cost1_max": 456.66371984115506, "cost2_max": -18.07615549368946, "cost2_min": -210.23528068404127, "outflow_rate_max": 1526.2967592738753, "system_level_velocity_mean": 14.094813246558585, "cost1_mean": 360.0846911881682, "cost2_mean": -154.47586065002895, "outflow_rate_mean": 1254.3785752089454, "system_level_velocity_max": 18.36386928069056, "cost1_min": 18.113716120170462}, "policy_reward_mean": {}, "timesteps_this_iter": 62729, "training_iteration": 32, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433275, "hostname": "flow-main", "episode_reward_max": 1405.7932804832492, "episode_reward_min": 44.36729023650768, "episodes_total": 902, "time_since_restore": 1565.8264565467834, "date": "2019-05-21_10-07-55", "time_total_s": 1565.8264565467834, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf322b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf329e8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 686.62, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2085762, "sample_time_ms": 29261.447, "load_time_ms": 9.234, "grad_time_ms": 16249.417, "update_time_ms": 7.971, "default": {"policy_loss": -0.009011777117848396, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8086303472518921, "total_loss": 44.224708557128906, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 44.23201370239258, "kl": 0.017108594998717308, "entropy": 1.290475845336914}, "num_steps_sampled": 2085762}, "episodes_this_iter": 31, "time_this_iter_s": 45.23473644256592}
{"episode_reward_mean": 1232.2942867094825, "timesteps_total": 2145500, "iterations_since_restore": 33, "timesteps_since_restore": 2145500, "pid": 59703, "custom_metrics": {"outflow_rate_min": 481.955215425478, "system_level_velocity_min": 10.399471684608933, "cost1_max": 455.6612778322608, "cost2_max": -18.07615549368946, "cost2_min": -210.23528068404127, "outflow_rate_max": 1524.371093070195, "system_level_velocity_mean": 14.112204058310436, "cost1_mean": 364.70480573163076, "cost2_mean": -152.1010621083371, "outflow_rate_mean": 1253.870482032068, "system_level_velocity_max": 17.869253518252783, "cost1_min": 18.113716120170462}, "policy_reward_mean": {}, "timesteps_this_iter": 59738, "training_iteration": 33, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433319, "hostname": "flow-main", "episode_reward_max": 1395.3795829383753, "episode_reward_min": 44.36729023650768, "episodes_total": 934, "time_since_restore": 1610.434114933014, "date": "2019-05-21_10-08-39", "time_total_s": 1610.434114933014, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc048>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.27, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2145500, "sample_time_ms": 29255.059, "load_time_ms": 9.001, "grad_time_ms": 15981.833, "update_time_ms": 7.945, "default": {"policy_loss": -0.010461275465786457, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8040000796318054, "total_loss": 47.76133346557617, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 47.769752502441406, "kl": 0.020426398143172264, "entropy": 1.2774951457977295}, "num_steps_sampled": 2145500}, "episodes_this_iter": 32, "time_this_iter_s": 44.60765838623047}
{"episode_reward_mean": 1233.7242146182011, "timesteps_total": 2205071, "iterations_since_restore": 34, "timesteps_since_restore": 2205071, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1025.8557607795817, "system_level_velocity_min": 10.399471684608933, "cost1_max": 456.6452590336178, "cost2_max": -93.63046670250316, "cost2_min": -210.23528068404127, "outflow_rate_max": 1482.889386261715, "system_level_velocity_mean": 14.213718825867804, "cost1_mean": 371.7514638079663, "cost2_mean": -148.4336159514376, "outflow_rate_mean": 1256.308881709538, "system_level_velocity_max": 17.3414497805821, "cost1_min": 265.79819222082546}, "policy_reward_mean": {}, "timesteps_this_iter": 59571, "training_iteration": 34, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433362, "hostname": "flow-main", "episode_reward_max": 1384.9563448308554, "episode_reward_min": 1034.2805227087633, "episodes_total": 963, "time_since_restore": 1653.2636077404022, "date": "2019-05-21_10-09-22", "time_total_s": 1653.2636077404022, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0008d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb908>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2205071, "sample_time_ms": 29213.135, "load_time_ms": 8.885, "grad_time_ms": 15678.049, "update_time_ms": 8.035, "default": {"policy_loss": -0.01045327540487051, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.82049560546875, "total_loss": 42.3587760925293, "cur_kl_coeff": 0.15000000596046448, "vf_loss": 42.36664962768555, "kl": 0.017180409282445908, "entropy": 1.2671529054641724}, "num_steps_sampled": 2205071}, "episodes_this_iter": 29, "time_this_iter_s": 42.829492807388306}
{"episode_reward_mean": 1232.2066517619412, "timesteps_total": 2264077, "iterations_since_restore": 35, "timesteps_since_restore": 2264077, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1025.8557607795817, "system_level_velocity_min": 10.399471684608933, "cost1_max": 456.6452590336178, "cost2_max": -93.63046670250316, "cost2_min": -210.23528068404127, "outflow_rate_max": 1482.889386261715, "system_level_velocity_mean": 14.325287749550089, "cost1_mean": 374.7606796217525, "cost2_mean": -146.95314068466197, "outflow_rate_mean": 1257.1144921605655, "system_level_velocity_max": 17.3414497805821, "cost1_min": 265.79819222082546}, "policy_reward_mean": {}, "timesteps_this_iter": 59006, "training_iteration": 35, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433405, "hostname": "flow-main", "episode_reward_max": 1374.6905094868248, "episode_reward_min": 1034.2805227087633, "episodes_total": 992, "time_since_restore": 1696.5387206077576, "date": "2019-05-21_10-10-05", "time_total_s": 1696.5387206077576, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf325f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32898>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2264077, "sample_time_ms": 29224.299, "load_time_ms": 8.83, "grad_time_ms": 15501.89, "update_time_ms": 7.967, "default": {"policy_loss": -0.007813997566699982, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8143115043640137, "total_loss": 43.65217971801758, "cur_kl_coeff": 0.15000000596046448, "vf_loss": 43.65744400024414, "kl": 0.0169797595590353, "entropy": 1.255769968032837}, "num_steps_sampled": 2264077}, "episodes_this_iter": 29, "time_this_iter_s": 43.27511286735535}
{"episode_reward_mean": 1235.8273914682131, "timesteps_total": 2321484, "iterations_since_restore": 36, "timesteps_since_restore": 2321484, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1099.495329526727, "system_level_velocity_min": 10.819984987370756, "cost1_max": 461.46660300857184, "cost2_max": -82.12313782405877, "cost2_min": -191.03853956054877, "outflow_rate_max": 1519.758994665086, "system_level_velocity_mean": 14.582272245568426, "cost1_mean": 381.60963575094036, "cost2_mean": -141.99107578355415, "outflow_rate_mean": 1268.4100618734578, "system_level_velocity_max": 17.529971969336938, "cost1_min": 275.4650606723191}, "policy_reward_mean": {}, "timesteps_this_iter": 57407, "training_iteration": 36, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433448, "hostname": "flow-main", "episode_reward_max": 1395.3905242308285, "episode_reward_min": 1034.2805227087633, "episodes_total": 1019, "time_since_restore": 1738.5204708576202, "date": "2019-05-21_10-10-48", "time_total_s": 1738.5204708576202, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc5f8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2321484, "sample_time_ms": 29107.556, "load_time_ms": 8.675, "grad_time_ms": 15301.906, "update_time_ms": 7.884, "default": {"policy_loss": -0.008016488514840603, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8100988268852234, "total_loss": 45.043365478515625, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 45.04880905151367, "kl": 0.01715082675218582, "entropy": 1.244130253791809}, "num_steps_sampled": 2321484}, "episodes_this_iter": 27, "time_this_iter_s": 41.98175024986267}
{"episode_reward_mean": 1228.8719117563655, "timesteps_total": 2379002, "iterations_since_restore": 37, "timesteps_since_restore": 2379002, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1099.495329526727, "system_level_velocity_min": 10.819984987370756, "cost1_max": 461.46660300857184, "cost2_max": -82.12313782405877, "cost2_min": -191.03853956054877, "outflow_rate_max": 1519.758994665086, "system_level_velocity_mean": 14.561569742705053, "cost1_mean": 380.84054204271234, "cost2_mean": -140.58752939531107, "outflow_rate_mean": 1266.0870986955047, "system_level_velocity_max": 17.529971969336938, "cost1_min": 275.4650606723191}, "policy_reward_mean": {}, "timesteps_this_iter": 57518, "training_iteration": 37, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433488, "hostname": "flow-main", "episode_reward_max": 1395.3905242308285, "episode_reward_min": 1034.2805227087633, "episodes_total": 1048, "time_since_restore": 1779.2651789188385, "date": "2019-05-21_10-11-28", "time_total_s": 1779.2651789188385, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde8d0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2379002, "sample_time_ms": 28641.216, "load_time_ms": 8.632, "grad_time_ms": 15133.52, "update_time_ms": 7.797, "default": {"policy_loss": -0.00940699689090252, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8085545897483826, "total_loss": 45.94752502441406, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 45.95451736450195, "kl": 0.016079096123576164, "entropy": 1.2428405284881592}, "num_steps_sampled": 2379002}, "episodes_this_iter": 29, "time_this_iter_s": 40.74470806121826}
{"episode_reward_mean": 1232.8078947357535, "timesteps_total": 2435115, "iterations_since_restore": 38, "timesteps_since_restore": 2435115, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1099.495329526727, "system_level_velocity_min": 10.819984987370756, "cost1_max": 461.46660300857184, "cost2_max": -82.12313782405877, "cost2_min": -187.75098907056974, "outflow_rate_max": 1519.758994665086, "system_level_velocity_mean": 14.782820142923658, "cost1_mean": 386.5543092549539, "cost2_mean": -135.02594083554345, "outflow_rate_mean": 1277.2772857749096, "system_level_velocity_max": 17.529971969336938, "cost1_min": 275.4650606723191}, "policy_reward_mean": {}, "timesteps_this_iter": 56113, "training_iteration": 38, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433530, "hostname": "flow-main", "episode_reward_max": 1395.3905242308285, "episode_reward_min": 1040.4420194738505, "episodes_total": 1077, "time_since_restore": 1820.8381161689758, "date": "2019-05-21_10-12-10", "time_total_s": 1820.8381161689758, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0004e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0008d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000b00>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2435115, "sample_time_ms": 28183.275, "load_time_ms": 8.684, "grad_time_ms": 15007.576, "update_time_ms": 8.097, "default": {"policy_loss": -0.008491582237184048, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7807221412658691, "total_loss": 47.88393783569336, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 47.8899040222168, "kl": 0.01680176891386509, "entropy": 1.2241727113723755}, "num_steps_sampled": 2435115}, "episodes_this_iter": 29, "time_this_iter_s": 41.57293725013733}
{"episode_reward_mean": 1219.932879617086, "timesteps_total": 2491169, "iterations_since_restore": 39, "timesteps_since_restore": 2491169, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1099.495329526727, "system_level_velocity_min": 10.68001778062651, "cost1_max": 459.374398550366, "cost2_max": -74.8148055309847, "cost2_min": -187.75098907056974, "outflow_rate_max": 1468.1990256903678, "system_level_velocity_mean": 14.777647857915316, "cost1_mean": 385.93450105385745, "cost2_mean": -129.85497273231636, "outflow_rate_mean": 1269.8181671604495, "system_level_velocity_max": 17.52312749312054, "cost1_min": 275.4650606723191}, "policy_reward_mean": {}, "timesteps_this_iter": 56054, "training_iteration": 39, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433571, "hostname": "flow-main", "episode_reward_max": 1356.907136871144, "episode_reward_min": 1040.4420194738505, "episodes_total": 1107, "time_since_restore": 1862.3031902313232, "date": "2019-05-21_10-12-51", "time_total_s": 1862.3031902313232, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c031c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde4e0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2491169, "sample_time_ms": 28018.78, "load_time_ms": 8.528, "grad_time_ms": 14912.351, "update_time_ms": 8.015, "default": {"policy_loss": -0.00940581876784563, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7558104991912842, "total_loss": 56.69791793823242, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 56.704349517822266, "kl": 0.01981399767100811, "entropy": 1.2480756044387817}, "num_steps_sampled": 2491169}, "episodes_this_iter": 30, "time_this_iter_s": 41.46507406234741}
{"episode_reward_mean": 1214.1673089399926, "timesteps_total": 2549469, "iterations_since_restore": 40, "timesteps_since_restore": 2549469, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1116.9429343494182, "system_level_velocity_min": 10.68001778062651, "cost1_max": 459.374398550366, "cost2_max": -74.8148055309847, "cost2_min": -186.9077364310067, "outflow_rate_max": 1439.016443897659, "system_level_velocity_mean": 14.716950468823036, "cost1_mean": 384.13627124801263, "cost2_mean": -128.1697782258378, "outflow_rate_mean": 1271.5350012530425, "system_level_velocity_max": 17.52312749312054, "cost1_min": 276.3531164710461}, "policy_reward_mean": {}, "timesteps_this_iter": 58300, "training_iteration": 40, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433613, "hostname": "flow-main", "episode_reward_max": 1341.8056751248737, "episode_reward_min": 1040.4420194738505, "episodes_total": 1136, "time_since_restore": 1903.624519109726, "date": "2019-05-21_10-13-33", "time_total_s": 1903.624519109726, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde0f0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2549469, "sample_time_ms": 27790.43, "load_time_ms": 8.591, "grad_time_ms": 14795.757, "update_time_ms": 7.85, "default": {"policy_loss": -0.010072154924273491, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7875211834907532, "total_loss": 46.65599060058594, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 46.663387298583984, "kl": 0.01784992776811123, "entropy": 1.25028657913208}, "num_steps_sampled": 2549469}, "episodes_this_iter": 29, "time_this_iter_s": 41.32132887840271}
{"episode_reward_mean": 1216.2890619522589, "timesteps_total": 2605735, "iterations_since_restore": 41, "timesteps_since_restore": 2605735, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1141.3571129014456, "system_level_velocity_min": 10.68001778062651, "cost1_max": 458.27087418679537, "cost2_max": -73.7633992922018, "cost2_min": -177.37144285071935, "outflow_rate_max": 1439.016443897659, "system_level_velocity_mean": 14.732026349390345, "cost1_mean": 384.6285009588927, "cost2_mean": -125.73806495420803, "outflow_rate_mean": 1276.0261965615869, "system_level_velocity_max": 17.52312749312054, "cost1_min": 276.3531164710461}, "policy_reward_mean": {}, "timesteps_this_iter": 56266, "training_iteration": 41, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433654, "hostname": "flow-main", "episode_reward_max": 1341.741633917194, "episode_reward_min": 1087.0137323554982, "episodes_total": 1167, "time_since_restore": 1944.766723394394, "date": "2019-05-21_10-14-14", "time_total_s": 1944.766723394394, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf329e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32128>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2605735, "sample_time_ms": 27579.672, "load_time_ms": 8.547, "grad_time_ms": 14722.009, "update_time_ms": 7.85, "default": {"policy_loss": -0.009308232925832272, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7776634693145752, "total_loss": 53.53724670410156, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 53.54379653930664, "kl": 0.018410034477710724, "entropy": 1.2527109384536743}, "num_steps_sampled": 2605735}, "episodes_this_iter": 31, "time_this_iter_s": 41.14220428466797}
{"episode_reward_mean": 1209.3512845561463, "timesteps_total": 2661241, "iterations_since_restore": 42, "timesteps_since_restore": 2661241, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1105.8745156905402, "system_level_velocity_min": 10.74365823873906, "cost1_max": 452.62573342993016, "cost2_max": -72.16457224444562, "cost2_min": -177.37144285071935, "outflow_rate_max": 1439.016443897659, "system_level_velocity_mean": 14.629105691071732, "cost1_mean": 381.927011146484, "cost2_mean": -124.75583765909236, "outflow_rate_mean": 1271.756819547192, "system_level_velocity_max": 17.444844554576616, "cost1_min": 281.21799755332484}, "policy_reward_mean": {}, "timesteps_this_iter": 55506, "training_iteration": 42, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433694, "hostname": "flow-main", "episode_reward_max": 1314.063205436908, "episode_reward_min": 1061.2376163471315, "episodes_total": 1198, "time_since_restore": 1985.1335706710815, "date": "2019-05-21_10-14-54", "time_total_s": 1985.1335706710815, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf329b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32860>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2661241, "sample_time_ms": 27327.956, "load_time_ms": 8.494, "grad_time_ms": 14488.222, "update_time_ms": 7.797, "default": {"policy_loss": -0.008845292963087559, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7664502859115601, "total_loss": 52.08760070800781, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 52.09369659423828, "kl": 0.01836193911731243, "entropy": 1.2457389831542969}, "num_steps_sampled": 2661241}, "episodes_this_iter": 31, "time_this_iter_s": 40.36684727668762}
{"episode_reward_mean": 1186.6124449096458, "timesteps_total": 2716964, "iterations_since_restore": 43, "timesteps_since_restore": 2716964, "pid": 59703, "custom_metrics": {"outflow_rate_min": 500.85710898880353, "system_level_velocity_min": 10.74365823873906, "cost1_max": 452.62573342993016, "cost2_max": -19.997150045451942, "cost2_min": -176.4102114081287, "outflow_rate_max": 1424.293916968792, "system_level_velocity_mean": 14.751262783233615, "cost1_mean": 377.63888956845005, "cost2_mean": -119.79253630795023, "outflow_rate_mean": 1259.138238160775, "system_level_velocity_max": 18.32781617684153, "cost1_min": 22.888364467172156}, "policy_reward_mean": {}, "timesteps_this_iter": 55723, "training_iteration": 43, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433737, "hostname": "flow-main", "episode_reward_max": 1314.063205436908, "episode_reward_min": 55.14192080725869, "episodes_total": 1232, "time_since_restore": 2027.1881613731384, "date": "2019-05-21_10-15-37", "time_total_s": 2027.1881613731384, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf320f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32b70>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 688.53, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2716964, "sample_time_ms": 27174.998, "load_time_ms": 8.458, "grad_time_ms": 14386.123, "update_time_ms": 7.854, "default": {"policy_loss": -0.009822961874306202, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7325047254562378, "total_loss": 60.9526481628418, "cur_kl_coeff": 0.15000000596046448, "vf_loss": 60.95954513549805, "kl": 0.019503077492117882, "entropy": 1.26004958152771}, "num_steps_sampled": 2716964}, "episodes_this_iter": 34, "time_this_iter_s": 42.054590702056885}
{"episode_reward_mean": 1181.2640291754956, "timesteps_total": 2772942, "iterations_since_restore": 44, "timesteps_since_restore": 2772942, "pid": 59703, "custom_metrics": {"outflow_rate_min": 500.85710898880353, "system_level_velocity_min": 10.74365823873906, "cost1_max": 452.62573342993016, "cost2_max": -19.997150045451942, "cost2_min": -167.18371900407377, "outflow_rate_max": 1420.8690840257304, "system_level_velocity_mean": 14.84271841478769, "cost1_mean": 379.49269785263635, "cost2_mean": -117.01102487189452, "outflow_rate_mean": 1255.1123606375413, "system_level_velocity_max": 18.32781617684153, "cost1_min": 22.888364467172156}, "policy_reward_mean": {}, "timesteps_this_iter": 55978, "training_iteration": 44, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433776, "hostname": "flow-main", "episode_reward_max": 1314.063205436908, "episode_reward_min": 55.14192080725869, "episodes_total": 1261, "time_since_restore": 2066.197480916977, "date": "2019-05-21_10-16-16", "time_total_s": 2066.197480916977, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf321d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32e48>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 688.53, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2772942, "sample_time_ms": 26866.168, "load_time_ms": 8.458, "grad_time_ms": 14313.239, "update_time_ms": 7.805, "default": {"policy_loss": -0.009870145469903946, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7542048096656799, "total_loss": 51.18109893798828, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 51.18827819824219, "kl": 0.017987361177802086, "entropy": 1.2617048025131226}, "num_steps_sampled": 2772942}, "episodes_this_iter": 29, "time_this_iter_s": 39.0093195438385}
{"episode_reward_mean": 1183.985200136049, "timesteps_total": 2828546, "iterations_since_restore": 45, "timesteps_since_restore": 2828546, "pid": 59703, "custom_metrics": {"outflow_rate_min": 500.85710898880353, "system_level_velocity_min": 11.251982797950156, "cost1_max": 450.1342917394583, "cost2_max": -19.997150045451942, "cost2_min": -161.79177124618047, "outflow_rate_max": 1420.8690840257304, "system_level_velocity_mean": 14.912625597774436, "cost1_mean": 381.2676215321966, "cost2_mean": -115.02198876390706, "outflow_rate_mean": 1256.0217232635339, "system_level_velocity_max": 18.32781617684153, "cost1_min": 22.888364467172156}, "policy_reward_mean": {}, "timesteps_this_iter": 55604, "training_iteration": 45, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433815, "hostname": "flow-main", "episode_reward_max": 1314.063205436908, "episode_reward_min": 55.14192080725869, "episodes_total": 1289, "time_since_restore": 2105.6854469776154, "date": "2019-05-21_10-16-55", "time_total_s": 2105.6854469776154, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32780>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 688.53, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2828546, "sample_time_ms": 26470.735, "load_time_ms": 8.533, "grad_time_ms": 14330.684, "update_time_ms": 7.808, "default": {"policy_loss": -0.010585575364530087, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7510915398597717, "total_loss": 52.8192253112793, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 52.82670211791992, "kl": 0.020730046555399895, "entropy": 1.283745527267456}, "num_steps_sampled": 2828546}, "episodes_this_iter": 28, "time_this_iter_s": 39.48796606063843}
{"episode_reward_mean": 1203.140840611823, "timesteps_total": 2886245, "iterations_since_restore": 46, "timesteps_since_restore": 2886245, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1112.4641406084263, "system_level_velocity_min": 10.368096923687482, "cost1_max": 447.78732987160777, "cost2_max": -71.56571497410482, "cost2_min": -170.69076126599936, "outflow_rate_max": 1409.2826280983918, "system_level_velocity_mean": 14.666385531181607, "cost1_mean": 382.87655577760955, "cost2_mean": -119.57459239542212, "outflow_rate_mean": 1256.862388813514, "system_level_velocity_max": 17.209804594513333, "cost1_min": 277.2936110762231}, "policy_reward_mean": {}, "timesteps_this_iter": 57699, "training_iteration": 46, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433856, "hostname": "flow-main", "episode_reward_max": 1310.4222291753795, "episode_reward_min": 1074.2807137522875, "episodes_total": 1317, "time_since_restore": 2146.176342487335, "date": "2019-05-21_10-17-36", "time_total_s": 2146.176342487335, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf324a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32e48>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2886245, "sample_time_ms": 26214.015, "load_time_ms": 8.693, "grad_time_ms": 14437.793, "update_time_ms": 7.734, "default": {"policy_loss": -0.009797034785151482, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7759544253349304, "total_loss": 48.87726974487305, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 48.883697509765625, "kl": 0.01500319130718708, "entropy": 1.2871159315109253}, "num_steps_sampled": 2886245}, "episodes_this_iter": 28, "time_this_iter_s": 40.49089550971985}
{"episode_reward_mean": 1212.3227843008722, "timesteps_total": 2941415, "iterations_since_restore": 47, "timesteps_since_restore": 2941415, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1112.4641406084263, "system_level_velocity_min": 10.368096923687482, "cost1_max": 447.78732987160777, "cost2_max": -70.67380367473194, "cost2_min": -170.69076126599936, "outflow_rate_max": 1441.3801050112065, "system_level_velocity_mean": 14.87127947134572, "cost1_mean": 388.75074064346796, "cost2_mean": -116.45431198171562, "outflow_rate_mean": 1265.5095580216575, "system_level_velocity_max": 17.209804594513333, "cost1_min": 277.2936110762231}, "policy_reward_mean": {}, "timesteps_this_iter": 55170, "training_iteration": 47, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433897, "hostname": "flow-main", "episode_reward_max": 1319.5934294659774, "episode_reward_min": 1074.2807137522875, "episodes_total": 1350, "time_since_restore": 2187.217602968216, "date": "2019-05-21_10-18-17", "time_total_s": 2187.217602968216, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e4e6f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e4e6320>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2941415, "sample_time_ms": 26297.993, "load_time_ms": 8.592, "grad_time_ms": 14383.78, "update_time_ms": 7.631, "default": {"policy_loss": -0.008964769542217255, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7717838287353516, "total_loss": 51.62571334838867, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 51.63154983520508, "kl": 0.01390854548662901, "entropy": 1.2783479690551758}, "num_steps_sampled": 2941415}, "episodes_this_iter": 33, "time_this_iter_s": 41.04126048088074}
{"episode_reward_mean": 1214.0378229794346, "timesteps_total": 2996449, "iterations_since_restore": 48, "timesteps_since_restore": 2996449, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1086.3461316982134, "system_level_velocity_min": 10.368096923687482, "cost1_max": 447.78732987160777, "cost2_max": -70.67380367473194, "cost2_min": -170.69076126599936, "outflow_rate_max": 1441.3801050112065, "system_level_velocity_mean": 14.916164654069586, "cost1_mean": 390.3003218691359, "cost2_mean": -115.39734567466883, "outflow_rate_mean": 1267.730453041253, "system_level_velocity_max": 17.209804594513333, "cost1_min": 277.2936110762231}, "policy_reward_mean": {}, "timesteps_this_iter": 55034, "training_iteration": 48, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433938, "hostname": "flow-main", "episode_reward_max": 1319.5934294659774, "episode_reward_min": 1075.1950988772046, "episodes_total": 1380, "time_since_restore": 2228.858060359955, "date": "2019-05-21_10-18-58", "time_total_s": 2228.858060359955, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbcc88>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 2996449, "sample_time_ms": 26421.428, "load_time_ms": 8.457, "grad_time_ms": 14269.063, "update_time_ms": 7.36, "default": {"policy_loss": -0.00891504343599081, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7485309839248657, "total_loss": 54.74188232421875, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 54.747703552246094, "kl": 0.013752632774412632, "entropy": 1.2799521684646606}, "num_steps_sampled": 2996449}, "episodes_this_iter": 30, "time_this_iter_s": 41.64045739173889}
{"episode_reward_mean": 1210.971261294488, "timesteps_total": 3053022, "iterations_since_restore": 49, "timesteps_since_restore": 3053022, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1086.3461316982134, "system_level_velocity_min": 11.168709979308831, "cost1_max": 446.0263798801136, "cost2_max": -70.67380367473194, "cost2_min": -159.03976680162043, "outflow_rate_max": 1441.3801050112065, "system_level_velocity_mean": 14.97241484488322, "cost1_mean": 391.70022246861606, "cost2_mean": -112.61968567207273, "outflow_rate_mean": 1269.025793987322, "system_level_velocity_max": 17.038419304902114, "cost1_min": 289.7529719790171}, "policy_reward_mean": {}, "timesteps_this_iter": 56573, "training_iteration": 49, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558433980, "hostname": "flow-main", "episode_reward_max": 1319.5934294659774, "episode_reward_min": 1052.9342982342105, "episodes_total": 1410, "time_since_restore": 2270.6708583831787, "date": "2019-05-21_10-19-40", "time_total_s": 2270.6708583831787, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbcda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc668>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3053022, "sample_time_ms": 26580.92, "load_time_ms": 8.287, "grad_time_ms": 14144.495, "update_time_ms": 7.744, "default": {"policy_loss": -0.009856577962636948, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7481836080551147, "total_loss": 55.57699203491211, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 55.58356475830078, "kl": 0.014581682160496712, "entropy": 1.2823574542999268}, "num_steps_sampled": 3053022}, "episodes_this_iter": 30, "time_this_iter_s": 41.81279802322388}
{"episode_reward_mean": 1201.8210627428762, "timesteps_total": 3108004, "iterations_since_restore": 50, "timesteps_since_restore": 3108004, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1086.3461316982134, "system_level_velocity_min": 11.168709979308831, "cost1_max": 446.0263798801136, "cost2_max": -73.51325002823583, "cost2_min": -170.88419448747388, "outflow_rate_max": 1409.976335797674, "system_level_velocity_mean": 14.81005692661515, "cost1_mean": 387.03887580296737, "cost2_mean": -113.35328382926238, "outflow_rate_mean": 1258.5398868526238, "system_level_velocity_max": 17.017557792195888, "cost1_min": 289.7529719790171}, "policy_reward_mean": {}, "timesteps_this_iter": 54982, "training_iteration": 50, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434021, "hostname": "flow-main", "episode_reward_max": 1313.115152070342, "episode_reward_min": 1052.9342982342105, "episodes_total": 1438, "time_since_restore": 2311.377550125122, "date": "2019-05-21_10-20-21", "time_total_s": 2311.377550125122, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e4d9d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc400>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3108004, "sample_time_ms": 26692.836, "load_time_ms": 8.185, "grad_time_ms": 13971.1, "update_time_ms": 7.695, "default": {"policy_loss": -0.00862904079258442, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7869998216629028, "total_loss": 49.83156204223633, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 49.836769104003906, "kl": 0.015208457596600056, "entropy": 1.2882654666900635}, "num_steps_sampled": 3108004}, "episodes_this_iter": 28, "time_this_iter_s": 40.70669174194336}
{"episode_reward_mean": 1201.5508398356385, "timesteps_total": 3162352, "iterations_since_restore": 51, "timesteps_since_restore": 3162352, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1116.2746889137227, "system_level_velocity_min": 11.6163764343427, "cost1_max": 442.0113317153571, "cost2_max": -74.19814234312096, "cost2_min": -170.88419448747388, "outflow_rate_max": 1411.8016483516478, "system_level_velocity_mean": 14.942657990324292, "cost1_mean": 390.20570143616476, "cost2_mean": -109.86994205500828, "outflow_rate_mean": 1257.7150676142096, "system_level_velocity_max": 16.938418465488464, "cost1_min": 302.7759106255336}, "policy_reward_mean": {}, "timesteps_this_iter": 54348, "training_iteration": 51, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434061, "hostname": "flow-main", "episode_reward_max": 1313.115152070342, "episode_reward_min": 1052.9342982342105, "episodes_total": 1470, "time_since_restore": 2351.0978276729584, "date": "2019-05-21_10-21-01", "time_total_s": 2351.0978276729584, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0186d8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3162352, "sample_time_ms": 26607.801, "load_time_ms": 8.175, "grad_time_ms": 13913.237, "update_time_ms": 7.641, "default": {"policy_loss": -0.01080865878611803, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7519424557685852, "total_loss": 59.62820053100586, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 59.63545608520508, "kl": 0.015802450478076935, "entropy": 1.2999929189682007}, "num_steps_sampled": 3162352}, "episodes_this_iter": 32, "time_this_iter_s": 39.720277547836304}
{"episode_reward_mean": 1200.7896046448702, "timesteps_total": 3219563, "iterations_since_restore": 52, "timesteps_since_restore": 3219563, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1087.8962492079165, "system_level_velocity_min": 11.52668680723003, "cost1_max": 443.4286187604551, "cost2_max": -71.71601954281287, "cost2_min": -170.88419448747388, "outflow_rate_max": 1411.8016483516478, "system_level_velocity_mean": 14.925424021685176, "cost1_mean": 389.54467966370316, "cost2_mean": -109.65699441276747, "outflow_rate_mean": 1255.0082631718121, "system_level_velocity_max": 16.95656125816073, "cost1_min": 297.2103190444384}, "policy_reward_mean": {}, "timesteps_this_iter": 57211, "training_iteration": 52, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434103, "hostname": "flow-main", "episode_reward_max": 1313.115152070342, "episode_reward_min": 1052.9342982342105, "episodes_total": 1500, "time_since_restore": 2393.3386030197144, "date": "2019-05-21_10-21-43", "time_total_s": 2393.3386030197144, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000048>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3219563, "sample_time_ms": 26673.737, "load_time_ms": 8.276, "grad_time_ms": 14034.633, "update_time_ms": 7.66, "default": {"policy_loss": -0.009730392135679722, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7925549149513245, "total_loss": 49.54966354370117, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 49.55586242675781, "kl": 0.015726784244179726, "entropy": 1.3009015321731567}, "num_steps_sampled": 3219563}, "episodes_this_iter": 30, "time_this_iter_s": 42.24077534675598}
{"episode_reward_mean": 1191.2191389412278, "timesteps_total": 3275007, "iterations_since_restore": 53, "timesteps_since_restore": 3275007, "pid": 59703, "custom_metrics": {"outflow_rate_min": 961.4618036919105, "system_level_velocity_min": 10.838056260323443, "cost1_max": 443.4286187604551, "cost2_max": -38.73094133359111, "cost2_min": -172.89963732842386, "outflow_rate_max": 1411.8016483516478, "system_level_velocity_mean": 14.944900990637448, "cost1_mean": 386.91475787376606, "cost2_mean": -108.78661427065747, "outflow_rate_mean": 1255.0958292297828, "system_level_velocity_max": 16.95656125816073, "cost1_min": 135.18397998508732}, "policy_reward_mean": {}, "timesteps_this_iter": 55444, "training_iteration": 53, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434143, "hostname": "flow-main", "episode_reward_max": 1313.115152070342, "episode_reward_min": 351.6646640792225, "episodes_total": 1532, "time_since_restore": 2433.612259864807, "date": "2019-05-21_10-22-23", "time_total_s": 2433.612259864807, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32b00>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.17, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3275007, "sample_time_ms": 26454.265, "load_time_ms": 8.366, "grad_time_ms": 14075.343, "update_time_ms": 7.698, "default": {"policy_loss": -0.009000549092888832, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7482591867446899, "total_loss": 59.876773834228516, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 59.882362365722656, "kl": 0.015158450230956078, "entropy": 1.3086844682693481}, "num_steps_sampled": 3275007}, "episodes_this_iter": 32, "time_this_iter_s": 40.27365684509277}
{"episode_reward_mean": 1175.9105186137917, "timesteps_total": 3329876, "iterations_since_restore": 54, "timesteps_since_restore": 3329876, "pid": 59703, "custom_metrics": {"outflow_rate_min": 961.4618036919105, "system_level_velocity_min": 10.147742167527593, "cost1_max": 443.4286187604551, "cost2_max": -38.73094133359111, "cost2_min": -172.89963732842386, "outflow_rate_max": 1392.467508742647, "system_level_velocity_mean": 14.629504356328741, "cost1_mean": 378.53274091916484, "cost2_mean": -111.21478878118464, "outflow_rate_mean": 1238.823339702449, "system_level_velocity_max": 16.95656125816073, "cost1_min": 135.18397998508732}, "policy_reward_mean": {}, "timesteps_this_iter": 54869, "training_iteration": 54, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434183, "hostname": "flow-main", "episode_reward_max": 1295.6764953978234, "episode_reward_min": 351.6646640792225, "episodes_total": 1561, "time_since_restore": 2473.08713388443, "date": "2019-05-21_10-23-03", "time_total_s": 2473.08713388443, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0009e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0004a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000470>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.17, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3329876, "sample_time_ms": 26386.839, "load_time_ms": 8.563, "grad_time_ms": 14189.188, "update_time_ms": 7.694, "default": {"policy_loss": -0.009636346250772476, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7520192861557007, "total_loss": 53.75977325439453, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 53.76591873168945, "kl": 0.01551410835236311, "entropy": 1.3091431856155396}, "num_steps_sampled": 3329876}, "episodes_this_iter": 29, "time_this_iter_s": 39.4748740196228}
{"episode_reward_mean": 1177.021862360476, "timesteps_total": 3383525, "iterations_since_restore": 55, "timesteps_since_restore": 3383525, "pid": 59703, "custom_metrics": {"outflow_rate_min": 961.4618036919105, "system_level_velocity_min": 10.147742167527593, "cost1_max": 441.1021920789316, "cost2_max": -38.73094133359111, "cost2_min": -172.89963732842386, "outflow_rate_max": 1389.2735049482505, "system_level_velocity_mean": 14.82990982589557, "cost1_mean": 383.8027769853984, "cost2_mean": -105.30698600599955, "outflow_rate_mean": 1245.2942698142997, "system_level_velocity_max": 16.97065640628758, "cost1_min": 135.18397998508732}, "policy_reward_mean": {}, "timesteps_this_iter": 53649, "training_iteration": 55, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434221, "hostname": "flow-main", "episode_reward_max": 1295.6764953978234, "episode_reward_min": 351.6646640792225, "episodes_total": 1591, "time_since_restore": 2510.8828728199005, "date": "2019-05-21_10-23-41", "time_total_s": 2510.8828728199005, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e4e6978>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.17, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3383525, "sample_time_ms": 26285.672, "load_time_ms": 8.435, "grad_time_ms": 14122.263, "update_time_ms": 7.7, "default": {"policy_loss": -0.00953497551381588, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7173993587493896, "total_loss": 55.113121032714844, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 55.1192626953125, "kl": 0.015090839006006718, "entropy": 1.2955193519592285}, "num_steps_sampled": 3383525}, "episodes_this_iter": 30, "time_this_iter_s": 37.79573893547058}
{"episode_reward_mean": 1176.7977817791343, "timesteps_total": 3437300, "iterations_since_restore": 56, "timesteps_since_restore": 3437300, "pid": 59703, "custom_metrics": {"outflow_rate_min": 961.4618036919105, "system_level_velocity_min": 10.147742167527593, "cost1_max": 445.1347482499915, "cost2_max": -38.73094133359111, "cost2_min": -172.89963732842386, "outflow_rate_max": 1380.2866356596878, "system_level_velocity_mean": 14.9766766981448, "cost1_mean": 387.8391741794514, "cost2_mean": -101.14227548133137, "outflow_rate_mean": 1248.482906281766, "system_level_velocity_max": 17.13423801043188, "cost1_min": 135.18397998508732}, "policy_reward_mean": {}, "timesteps_this_iter": 53775, "training_iteration": 56, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434261, "hostname": "flow-main", "episode_reward_max": 1282.6304275388366, "episode_reward_min": 351.6646640792225, "episodes_total": 1620, "time_since_restore": 2550.748327255249, "date": "2019-05-21_10-24-21", "time_total_s": 2550.748327255249, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0009e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32b00>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.17, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3437300, "sample_time_ms": 26314.22, "load_time_ms": 8.4, "grad_time_ms": 14030.068, "update_time_ms": 7.613, "default": {"policy_loss": -0.009813817217946053, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7155702710151672, "total_loss": 59.60783004760742, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 59.61406326293945, "kl": 0.015943726524710655, "entropy": 1.2978606224060059}, "num_steps_sampled": 3437300}, "episodes_this_iter": 29, "time_this_iter_s": 39.86545443534851}
{"episode_reward_mean": 1170.8324965599825, "timesteps_total": 3490601, "iterations_since_restore": 57, "timesteps_since_restore": 3490601, "pid": 59703, "custom_metrics": {"outflow_rate_min": 961.1566375488255, "system_level_velocity_min": 11.527952553888179, "cost1_max": 445.1347482499915, "cost2_max": -43.55994146370489, "cost2_min": -157.27440357755125, "outflow_rate_max": 1377.1052085950446, "system_level_velocity_mean": 15.03133549734099, "cost1_mean": 388.85020738957945, "cost2_mean": -98.38786482202146, "outflow_rate_mean": 1243.5306910812715, "system_level_velocity_max": 17.13423801043188, "cost1_min": 135.99165268901604}, "policy_reward_mean": {}, "timesteps_this_iter": 53301, "training_iteration": 57, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434300, "hostname": "flow-main", "episode_reward_max": 1282.6304275388366, "episode_reward_min": 348.05970037031017, "episodes_total": 1651, "time_since_restore": 2590.45388507843, "date": "2019-05-21_10-25-00", "time_total_s": 2590.45388507843, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfe8a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32dd8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.18, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3490601, "sample_time_ms": 26335.242, "load_time_ms": 8.446, "grad_time_ms": 13877.242, "update_time_ms": 7.729, "default": {"policy_loss": -0.008965564891695976, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7000741362571716, "total_loss": 59.34431457519531, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 59.349853515625, "kl": 0.015244077891111374, "entropy": 1.305309772491455}, "num_steps_sampled": 3490601}, "episodes_this_iter": 31, "time_this_iter_s": 39.70555782318115}
{"episode_reward_mean": 1159.2011503161316, "timesteps_total": 3543291, "iterations_since_restore": 58, "timesteps_since_restore": 3543291, "pid": 59703, "custom_metrics": {"outflow_rate_min": 961.1566375488255, "system_level_velocity_min": 11.613215069776455, "cost1_max": 445.1347482499915, "cost2_max": -32.90728631835849, "cost2_min": -157.27440357755125, "outflow_rate_max": 1375.99572839308, "system_level_velocity_mean": 15.010316650150317, "cost1_mean": 385.2424851814059, "cost2_mean": -96.9959535135483, "outflow_rate_mean": 1241.050472174349, "system_level_velocity_max": 17.329518913082126, "cost1_min": 135.99165268901604}, "policy_reward_mean": {}, "timesteps_this_iter": 52690, "training_iteration": 58, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434339, "hostname": "flow-main", "episode_reward_max": 1281.8987570375702, "episode_reward_min": 338.22424269528005, "episodes_total": 1684, "time_since_restore": 2628.903734445572, "date": "2019-05-21_10-25-39", "time_total_s": 2628.903734445572, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32ac8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 690.38, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3543291, "sample_time_ms": 26209.534, "load_time_ms": 8.324, "grad_time_ms": 13686.26, "update_time_ms": 7.658, "default": {"policy_loss": -0.009556061588227749, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6768222451210022, "total_loss": 64.54457092285156, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 64.55036163330078, "kl": 0.016741041094064713, "entropy": 1.296512484550476}, "num_steps_sampled": 3543291}, "episodes_this_iter": 33, "time_this_iter_s": 38.449849367141724}
{"episode_reward_mean": 1150.6076858327685, "timesteps_total": 3596933, "iterations_since_restore": 59, "timesteps_since_restore": 3596933, "pid": 59703, "custom_metrics": {"outflow_rate_min": 961.1566375488255, "system_level_velocity_min": 11.613215069776455, "cost1_max": 434.44264457346424, "cost2_max": -32.90728631835849, "cost2_min": -157.27440357755125, "outflow_rate_max": 1368.5746552381308, "system_level_velocity_mean": 14.909315309288145, "cost1_mean": 382.53062187339805, "cost2_mean": -97.12504838747937, "outflow_rate_mean": 1235.81212785998, "system_level_velocity_max": 17.329518913082126, "cost1_min": 135.99165268901604}, "policy_reward_mean": {}, "timesteps_this_iter": 53642, "training_iteration": 59, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434378, "hostname": "flow-main", "episode_reward_max": 1259.1930802078602, "episode_reward_min": 338.22424269528005, "episodes_total": 1713, "time_since_restore": 2667.472832918167, "date": "2019-05-21_10-26-18", "time_total_s": 2667.472832918167, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32128>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 690.38, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3596933, "sample_time_ms": 25855.17, "load_time_ms": 8.583, "grad_time_ms": 13716.539, "update_time_ms": 7.242, "default": {"policy_loss": -0.010975432582199574, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7105293869972229, "total_loss": 54.516334533691406, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 54.52354049682617, "kl": 0.016741083934903145, "entropy": 1.3088492155075073}, "num_steps_sampled": 3596933}, "episodes_this_iter": 29, "time_this_iter_s": 38.569098472595215}
{"episode_reward_mean": 1158.7401695356418, "timesteps_total": 3648974, "iterations_since_restore": 60, "timesteps_since_restore": 3648974, "pid": 59703, "custom_metrics": {"outflow_rate_min": 966.1825567788695, "system_level_velocity_min": 11.822831772775455, "cost1_max": 438.7670777233928, "cost2_max": -32.90728631835849, "cost2_min": -152.47041628020182, "outflow_rate_max": 1363.6511048801106, "system_level_velocity_mean": 15.126977603563756, "cost1_mean": 391.1100933024039, "cost2_mean": -91.6568477840129, "outflow_rate_mean": 1245.3033907629742, "system_level_velocity_max": 17.329518913082126, "cost1_min": 138.82335156734098}, "policy_reward_mean": {}, "timesteps_this_iter": 52041, "training_iteration": 60, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434415, "hostname": "flow-main", "episode_reward_max": 1289.3416252730328, "episode_reward_min": 338.22424269528005, "episodes_total": 1743, "time_since_restore": 2704.836024045944, "date": "2019-05-21_10-26-55", "time_total_s": 2704.836024045944, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a90>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.2, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3648974, "sample_time_ms": 25438.544, "load_time_ms": 8.446, "grad_time_ms": 13798.805, "update_time_ms": 7.339, "default": {"policy_loss": -0.010599913075566292, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6407850980758667, "total_loss": 58.28469467163086, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 58.2916259765625, "kl": 0.016286460682749748, "entropy": 1.304721474647522}, "num_steps_sampled": 3648974}, "episodes_this_iter": 30, "time_this_iter_s": 37.3631911277771}
{"episode_reward_mean": 1153.5438762796186, "timesteps_total": 3702390, "iterations_since_restore": 61, "timesteps_since_restore": 3702390, "pid": 59703, "custom_metrics": {"outflow_rate_min": 966.1825567788695, "system_level_velocity_min": 11.822831772775455, "cost1_max": 438.7670777233928, "cost2_max": -32.90728631835849, "cost2_min": -152.47041628020182, "outflow_rate_max": 1365.512479294899, "system_level_velocity_mean": 15.156872910962072, "cost1_mean": 391.1271804736332, "cost2_mean": -90.46027522799231, "outflow_rate_mean": 1241.3662666608311, "system_level_velocity_max": 17.329518913082126, "cost1_min": 138.82335156734098}, "policy_reward_mean": {}, "timesteps_this_iter": 53416, "training_iteration": 61, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434455, "hostname": "flow-main", "episode_reward_max": 1289.3416252730328, "episode_reward_min": 338.22424269528005, "episodes_total": 1775, "time_since_restore": 2744.5605182647705, "date": "2019-05-21_10-27-35", "time_total_s": 2744.5605182647705, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdeac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdee10>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.2, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3702390, "sample_time_ms": 25338.047, "load_time_ms": 8.501, "grad_time_ms": 13898.563, "update_time_ms": 7.343, "default": {"policy_loss": -0.009084431454539299, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5907917022705078, "total_loss": 69.57640838623047, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 69.58203887939453, "kl": 0.015347663313150406, "entropy": 1.2991352081298828}, "num_steps_sampled": 3702390}, "episodes_this_iter": 32, "time_this_iter_s": 39.724494218826294}
{"episode_reward_mean": 1159.970325380264, "timesteps_total": 3755187, "iterations_since_restore": 62, "timesteps_since_restore": 3755187, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1077.2701866089712, "system_level_velocity_min": 12.223822424289317, "cost1_max": 438.7670777233928, "cost2_max": -54.50957162687305, "cost2_min": -152.47041628020182, "outflow_rate_max": 1376.988549011963, "system_level_velocity_mean": 15.18498440331205, "cost1_mean": 395.00979340826956, "cost2_mean": -89.48621156627189, "outflow_rate_mean": 1243.5668372697917, "system_level_velocity_max": 16.815090422893977, "cost1_min": 316.30320501231}, "policy_reward_mean": {}, "timesteps_this_iter": 52797, "training_iteration": 62, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434495, "hostname": "flow-main", "episode_reward_max": 1289.3416252730328, "episode_reward_min": 1048.1191002176201, "episodes_total": 1808, "time_since_restore": 2784.6356303691864, "date": "2019-05-21_10-28-15", "time_total_s": 2784.6356303691864, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32b00>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3755187, "sample_time_ms": 25189.873, "load_time_ms": 8.442, "grad_time_ms": 13830.714, "update_time_ms": 7.36, "default": {"policy_loss": -0.010895675979554653, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6446254849433899, "total_loss": 65.18657684326172, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 65.19404602050781, "kl": 0.015239594504237175, "entropy": 1.3122516870498657}, "num_steps_sampled": 3755187}, "episodes_this_iter": 33, "time_this_iter_s": 40.075112104415894}
{"episode_reward_mean": 1163.2843643548385, "timesteps_total": 3809083, "iterations_since_restore": 63, "timesteps_since_restore": 3809083, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1077.2701866089712, "system_level_velocity_min": 11.525780247536169, "cost1_max": 438.7670777233928, "cost2_max": -62.10818630597451, "cost2_min": -152.4729006745241, "outflow_rate_max": 1376.988549011963, "system_level_velocity_mean": 15.177667048037042, "cost1_mean": 394.7740517681865, "cost2_mean": -89.80882349144045, "outflow_rate_mean": 1247.6101973889329, "system_level_velocity_max": 16.768948817614287, "cost1_min": 302.2014658965823}, "policy_reward_mean": {}, "timesteps_this_iter": 53896, "training_iteration": 63, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434534, "hostname": "flow-main", "episode_reward_max": 1289.3416252730328, "episode_reward_min": 1048.1191002176201, "episodes_total": 1839, "time_since_restore": 2823.604477405548, "date": "2019-05-21_10-28-54", "time_total_s": 2823.604477405548, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c018da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32d68>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3809083, "sample_time_ms": 25159.287, "load_time_ms": 8.303, "grad_time_ms": 13732.073, "update_time_ms": 7.499, "default": {"policy_loss": -0.010639521293342113, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.678083598613739, "total_loss": 59.31842041015625, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 59.32526779174805, "kl": 0.01684531383216381, "entropy": 1.3152035474777222}, "num_steps_sampled": 3809083}, "episodes_this_iter": 31, "time_this_iter_s": 38.968847036361694}
{"episode_reward_mean": 1149.8478429502375, "timesteps_total": 3861377, "iterations_since_restore": 64, "timesteps_since_restore": 3861377, "pid": 59703, "custom_metrics": {"outflow_rate_min": 478.4708842399062, "system_level_velocity_min": 11.525780247536169, "cost1_max": 432.6591895649442, "cost2_max": -22.311766529457834, "cost2_min": -152.4729006745241, "outflow_rate_max": 1376.988549011963, "system_level_velocity_mean": 15.10715374459782, "cost1_mean": 388.4016807548791, "cost2_mean": -91.95639618813318, "outflow_rate_mean": 1230.5333957117932, "system_level_velocity_max": 18.80629945748022, "cost1_min": 24.659760429365672}, "policy_reward_mean": {}, "timesteps_this_iter": 52294, "training_iteration": 64, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434575, "hostname": "flow-main", "episode_reward_max": 1253.591160726182, "episode_reward_min": 61.94807931553302, "episodes_total": 1870, "time_since_restore": 2864.5351123809814, "date": "2019-05-21_10-29-35", "time_total_s": 2864.5351123809814, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a90>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.37, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3861377, "sample_time_ms": 25469.651, "load_time_ms": 8.175, "grad_time_ms": 13568.476, "update_time_ms": 7.444, "default": {"policy_loss": -0.010581163689494133, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7218097448348999, "total_loss": 54.53845977783203, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 54.54561996459961, "kl": 0.015176179818809032, "entropy": 1.3194103240966797}, "num_steps_sampled": 3861377}, "episodes_this_iter": 31, "time_this_iter_s": 40.93063497543335}
{"episode_reward_mean": 1147.373595823853, "timesteps_total": 3914843, "iterations_since_restore": 65, "timesteps_since_restore": 3914843, "pid": 59703, "custom_metrics": {"outflow_rate_min": 478.4708842399062, "system_level_velocity_min": 11.525780247536169, "cost1_max": 432.6591895649442, "cost2_max": -22.311766529457834, "cost2_min": -152.4729006745241, "outflow_rate_max": 1355.726260440807, "system_level_velocity_mean": 15.10164494334162, "cost1_mean": 387.8459827140471, "cost2_mean": -92.60908488146241, "outflow_rate_mean": 1228.6989560567574, "system_level_velocity_max": 18.80629945748022, "cost1_min": 24.659760429365672}, "policy_reward_mean": {}, "timesteps_this_iter": 53466, "training_iteration": 65, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434614, "hostname": "flow-main", "episode_reward_max": 1257.7631156357786, "episode_reward_min": 61.94807931553302, "episodes_total": 1900, "time_since_restore": 2903.6202671527863, "date": "2019-05-21_10-30-14", "time_total_s": 2903.6202671527863, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32080>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.37, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3914843, "sample_time_ms": 25688.458, "load_time_ms": 8.293, "grad_time_ms": 13477.038, "update_time_ms": 7.462, "default": {"policy_loss": -0.010601406916975975, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6568935513496399, "total_loss": 58.133216857910156, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 58.13978958129883, "kl": 0.0178789384663105, "entropy": 1.3363178968429565}, "num_steps_sampled": 3914843}, "episodes_this_iter": 30, "time_this_iter_s": 39.08515477180481}
{"episode_reward_mean": 1134.250510989909, "timesteps_total": 3967061, "iterations_since_restore": 66, "timesteps_since_restore": 3967061, "pid": 59703, "custom_metrics": {"outflow_rate_min": 478.4708842399062, "system_level_velocity_min": 11.525780247536169, "cost1_max": 431.7557322321226, "cost2_max": -22.311766529457834, "cost2_min": -152.4729006745241, "outflow_rate_max": 1350.8648316199929, "system_level_velocity_mean": 14.967284247558041, "cost1_mean": 384.3001138117148, "cost2_mean": -93.02242635525234, "outflow_rate_mean": 1217.2351303997586, "system_level_velocity_max": 18.80629945748022, "cost1_min": 24.659760429365672}, "policy_reward_mean": {}, "timesteps_this_iter": 52218, "training_iteration": 66, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434651, "hostname": "flow-main", "episode_reward_max": 1257.7631156357786, "episode_reward_min": 61.94807931553302, "episodes_total": 1929, "time_since_restore": 2940.4263916015625, "date": "2019-05-21_10-30-51", "time_total_s": 2940.4263916015625, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf320b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf324a8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.37, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 3967061, "sample_time_ms": 25485.716, "load_time_ms": 8.127, "grad_time_ms": 13375.581, "update_time_ms": 7.464, "default": {"policy_loss": -0.011833135038614273, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5886446237564087, "total_loss": 61.970218658447266, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 61.977561950683594, "kl": 0.019982213154435158, "entropy": 1.3243746757507324}, "num_steps_sampled": 3967061}, "episodes_this_iter": 29, "time_this_iter_s": 36.806124448776245}
{"episode_reward_mean": 1122.636031011804, "timesteps_total": 4017897, "iterations_since_restore": 67, "timesteps_since_restore": 4017897, "pid": 59703, "custom_metrics": {"outflow_rate_min": 478.4708842399062, "system_level_velocity_min": 11.593235525353954, "cost1_max": 431.7557322321226, "cost2_max": -22.311766529457834, "cost2_min": -144.01629376979878, "outflow_rate_max": 1346.8470292658426, "system_level_velocity_mean": 15.052084561183893, "cost1_mean": 386.21881175095837, "cost2_mean": -87.90851937131256, "outflow_rate_mean": 1213.1048341412038, "system_level_velocity_max": 18.80629945748022, "cost1_min": 24.659760429365672}, "policy_reward_mean": {}, "timesteps_this_iter": 50836, "training_iteration": 67, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434688, "hostname": "flow-main", "episode_reward_max": 1257.7631156357786, "episode_reward_min": 61.94807931553302, "episodes_total": 1960, "time_since_restore": 2977.5733065605164, "date": "2019-05-21_10-31-28", "time_total_s": 2977.5733065605164, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a90>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.37, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4017897, "sample_time_ms": 25134.95, "load_time_ms": 8.015, "grad_time_ms": 13467.619, "update_time_ms": 7.447, "default": {"policy_loss": -0.010330402292311192, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5340894460678101, "total_loss": 61.59315872192383, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 61.599613189697266, "kl": 0.017245294526219368, "entropy": 1.3241050243377686}, "num_steps_sampled": 4017897}, "episodes_this_iter": 31, "time_this_iter_s": 37.14691495895386}
{"episode_reward_mean": 1126.338413196618, "timesteps_total": 4068972, "iterations_since_restore": 68, "timesteps_since_restore": 4068972, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1070.8890439882698, "system_level_velocity_min": 11.543495636389661, "cost1_max": 431.7557322321226, "cost2_max": -49.09920140143632, "cost2_min": -144.01629376979878, "outflow_rate_max": 1354.0895818157483, "system_level_velocity_mean": 15.084232807635301, "cost1_mean": 391.64333168500394, "cost2_mean": -83.10266325132734, "outflow_rate_mean": 1218.1302266888558, "system_level_velocity_max": 16.66585672009141, "cost1_min": 299.1248265365832}, "policy_reward_mean": {}, "timesteps_this_iter": 51075, "training_iteration": 68, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434725, "hostname": "flow-main", "episode_reward_max": 1243.6566750398383, "episode_reward_min": 974.3113053721886, "episodes_total": 1992, "time_since_restore": 3014.0926213264465, "date": "2019-05-21_10-32-05", "time_total_s": 3014.0926213264465, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32240>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4068972, "sample_time_ms": 24875.751, "load_time_ms": 8.098, "grad_time_ms": 13532.026, "update_time_ms": 7.522, "default": {"policy_loss": -0.010043489746749401, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5887933373451233, "total_loss": 64.898193359375, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 64.90461730957031, "kl": 0.016077203676104546, "entropy": 1.3511385917663574}, "num_steps_sampled": 4068972}, "episodes_this_iter": 32, "time_this_iter_s": 36.519314765930176}
{"episode_reward_mean": 1113.9903848102053, "timesteps_total": 4118949, "iterations_since_restore": 69, "timesteps_since_restore": 4118949, "pid": 59703, "custom_metrics": {"outflow_rate_min": 1000.3625454545455, "system_level_velocity_min": 11.351479867914833, "cost1_max": 425.56081871160114, "cost2_max": -49.69885555060286, "cost2_min": -147.71964465322674, "outflow_rate_max": 1354.0895818157483, "system_level_velocity_mean": 15.091179692216608, "cost1_mean": 391.4754181891642, "cost2_mean": -78.52313461170611, "outflow_rate_mean": 1204.402966904744, "system_level_velocity_max": 16.66585672009141, "cost1_min": 299.1248265365832}, "policy_reward_mean": {}, "timesteps_this_iter": 49977, "training_iteration": 69, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434761, "hostname": "flow-main", "episode_reward_max": 1243.6566750398383, "episode_reward_min": 960.7209172462786, "episodes_total": 2024, "time_since_restore": 3050.258333683014, "date": "2019-05-21_10-32-41", "time_total_s": 3050.258333683014, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf322b0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4118949, "sample_time_ms": 24811.56, "load_time_ms": 7.826, "grad_time_ms": 13357.238, "update_time_ms": 7.845, "default": {"policy_loss": -0.010945591144263744, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.45862939953804016, "total_loss": 67.5911865234375, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 67.5982666015625, "kl": 0.017154673114418983, "entropy": 1.3573423624038696}, "num_steps_sampled": 4118949}, "episodes_this_iter": 32, "time_this_iter_s": 36.16571235656738}
{"episode_reward_mean": 1105.9402874814105, "timesteps_total": 4168345, "iterations_since_restore": 70, "timesteps_since_restore": 4168345, "pid": 59703, "custom_metrics": {"outflow_rate_min": 891.8459236638091, "system_level_velocity_min": 11.351479867914833, "cost1_max": 431.65358990732386, "cost2_max": -44.17874014278543, "cost2_min": -147.71964465322674, "outflow_rate_max": 1354.0895818157483, "system_level_velocity_mean": 15.171964289824613, "cost1_mean": 390.4578279435079, "cost2_mean": -75.07196685090256, "outflow_rate_mean": 1199.358369766641, "system_level_velocity_max": 17.321365011338205, "cost1_min": 134.86598352932378}, "policy_reward_mean": {}, "timesteps_this_iter": 49396, "training_iteration": 70, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434798, "hostname": "flow-main", "episode_reward_max": 1243.6566750398383, "episode_reward_min": 305.58835138911707, "episodes_total": 2054, "time_since_restore": 3087.291323661804, "date": "2019-05-21_10-33-18", "time_total_s": 3087.291323661804, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde4e0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.15, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4168345, "sample_time_ms": 24941.067, "load_time_ms": 7.803, "grad_time_ms": 13195.377, "update_time_ms": 7.769, "default": {"policy_loss": -0.012127812951803207, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.43119344115257263, "total_loss": 63.095211029052734, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 63.10366439819336, "kl": 0.016338996589183807, "entropy": 1.3765019178390503}, "num_steps_sampled": 4168345}, "episodes_this_iter": 30, "time_this_iter_s": 37.03298997879028}
{"episode_reward_mean": 1109.314954328839, "timesteps_total": 4220109, "iterations_since_restore": 71, "timesteps_since_restore": 4220109, "pid": 59703, "custom_metrics": {"outflow_rate_min": 891.8459236638091, "system_level_velocity_min": 11.351479867914833, "cost1_max": 431.65358990732386, "cost2_max": -44.17874014278543, "cost2_min": -147.71964465322674, "outflow_rate_max": 1358.4803597725963, "system_level_velocity_mean": 15.250261987624414, "cost1_mean": 392.75068732409983, "cost2_mean": -72.94085141971205, "outflow_rate_mean": 1196.3133667426928, "system_level_velocity_max": 17.321365011338205, "cost1_min": 134.86598352932378}, "policy_reward_mean": {}, "timesteps_this_iter": 51764, "training_iteration": 71, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434834, "hostname": "flow-main", "episode_reward_max": 1219.6155471316938, "episode_reward_min": 305.58835138911707, "episodes_total": 2087, "time_since_restore": 3123.877908229828, "date": "2019-05-21_10-33-54", "time_total_s": 3123.877908229828, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf321d0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.15, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4220109, "sample_time_ms": 24751.457, "load_time_ms": 7.829, "grad_time_ms": 13072.848, "update_time_ms": 7.77, "default": {"policy_loss": -0.011485730297863483, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.47043463587760925, "total_loss": 66.15483093261719, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 66.16221618652344, "kl": 0.018223028630018234, "entropy": 1.3818812370300293}, "num_steps_sampled": 4220109}, "episodes_this_iter": 33, "time_this_iter_s": 36.58658456802368}
{"episode_reward_mean": 1119.1352334470341, "timesteps_total": 4270020, "iterations_since_restore": 72, "timesteps_since_restore": 4270020, "pid": 59703, "custom_metrics": {"outflow_rate_min": 891.8459236638091, "system_level_velocity_min": 12.133084357039966, "cost1_max": 431.65358990732386, "cost2_max": -44.17874014278543, "cost2_min": -132.12274731984357, "outflow_rate_max": 1405.6807890470182, "system_level_velocity_mean": 15.202287086777979, "cost1_mean": 392.16745545525066, "cost2_mean": -75.7624381949394, "outflow_rate_mean": 1209.0739539487686, "system_level_velocity_max": 17.321365011338205, "cost1_min": 134.86598352932378}, "policy_reward_mean": {}, "timesteps_this_iter": 49911, "training_iteration": 72, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434872, "hostname": "flow-main", "episode_reward_max": 1260.0754291628275, "episode_reward_min": 305.58835138911707, "episodes_total": 2121, "time_since_restore": 3161.6044075489044, "date": "2019-05-21_10-34-32", "time_total_s": 3161.6044075489044, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32208>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.15, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4270020, "sample_time_ms": 24454.841, "load_time_ms": 7.727, "grad_time_ms": 13133.997, "update_time_ms": 7.71, "default": {"policy_loss": -0.012321566231548786, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.47447866201400757, "total_loss": 64.26984405517578, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 64.27806854248047, "kl": 0.018216818571090698, "entropy": 1.3739618062973022}, "num_steps_sampled": 4270020}, "episodes_this_iter": 34, "time_this_iter_s": 37.72649931907654}
{"episode_reward_mean": 1108.640686477352, "timesteps_total": 4318748, "iterations_since_restore": 73, "timesteps_since_restore": 4318748, "pid": 59703, "custom_metrics": {"outflow_rate_min": 509.16419877491666, "system_level_velocity_min": 12.143494385013696, "cost1_max": 436.61543113395146, "cost2_max": -21.480875435661712, "cost2_min": -121.15055483423134, "outflow_rate_max": 1405.6807890470182, "system_level_velocity_mean": 15.291940025256507, "cost1_mean": 392.27741399971825, "cost2_mean": -73.90054436638312, "outflow_rate_mean": 1194.0010181903183, "system_level_velocity_max": 18.733828573153364, "cost1_min": 23.133023895127746}, "policy_reward_mean": {}, "timesteps_this_iter": 48728, "training_iteration": 73, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434908, "hostname": "flow-main", "episode_reward_max": 1260.0754291628275, "episode_reward_min": 53.25025119251405, "episodes_total": 2152, "time_since_restore": 3197.7943675518036, "date": "2019-05-21_10-35-08", "time_total_s": 3197.7943675518036, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf325c0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4318748, "sample_time_ms": 24267.713, "load_time_ms": 7.737, "grad_time_ms": 13043.091, "update_time_ms": 7.622, "default": {"policy_loss": -0.012355674058198929, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5090935230255127, "total_loss": 60.25401306152344, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 60.26219177246094, "kl": 0.018572980538010597, "entropy": 1.3914220333099365}, "num_steps_sampled": 4318748}, "episodes_this_iter": 31, "time_this_iter_s": 36.18996000289917}
{"episode_reward_mean": 1070.2570410371666, "timesteps_total": 4365496, "iterations_since_restore": 74, "timesteps_since_restore": 4365496, "pid": 59703, "custom_metrics": {"outflow_rate_min": 509.16419877491666, "system_level_velocity_min": 11.680625872796492, "cost1_max": 438.0698125948412, "cost2_max": -21.480875435661712, "cost2_min": -121.15055483423134, "outflow_rate_max": 1405.6807890470182, "system_level_velocity_mean": 15.369650364803803, "cost1_mean": 390.9268351890486, "cost2_mean": -68.18634282075533, "outflow_rate_mean": 1159.8746447257552, "system_level_velocity_max": 18.733828573153364, "cost1_min": 23.133023895127746}, "policy_reward_mean": {}, "timesteps_this_iter": 46748, "training_iteration": 74, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434943, "hostname": "flow-main", "episode_reward_max": 1260.0754291628275, "episode_reward_min": 53.25025119251405, "episodes_total": 2183, "time_since_restore": 3232.2050137519836, "date": "2019-05-21_10-35-43", "time_total_s": 3232.2050137519836, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf322b0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 688.97, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4365496, "sample_time_ms": 23807.609, "load_time_ms": 7.552, "grad_time_ms": 12852.329, "update_time_ms": 7.688, "default": {"policy_loss": -0.012617202475667, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.39303088188171387, "total_loss": 61.663089752197266, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 61.67154312133789, "kl": 0.01848781108856201, "entropy": 1.3842850923538208}, "num_steps_sampled": 4365496}, "episodes_this_iter": 31, "time_this_iter_s": 34.410646200180054}
{"episode_reward_mean": 1039.4636660288506, "timesteps_total": 4412087, "iterations_since_restore": 75, "timesteps_since_restore": 4412087, "pid": 59703, "custom_metrics": {"outflow_rate_min": 509.16419877491666, "system_level_velocity_min": 11.680625872796492, "cost1_max": 438.5586428488654, "cost2_max": -21.480875435661712, "cost2_min": -115.78704101738987, "outflow_rate_max": 1315.5991684501305, "system_level_velocity_mean": 15.650995566543275, "cost1_mean": 394.64776091834824, "cost2_mean": -60.345644610493146, "outflow_rate_mean": 1131.7497119040156, "system_level_velocity_max": 18.733828573153364, "cost1_min": 23.133023895127746}, "policy_reward_mean": {}, "timesteps_this_iter": 46591, "training_iteration": 75, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558434977, "hostname": "flow-main", "episode_reward_max": 1190.9874835994312, "episode_reward_min": 53.25025119251405, "episodes_total": 2214, "time_since_restore": 3266.425132036209, "date": "2019-05-21_10-36-17", "time_total_s": 3266.425132036209, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32e10>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 684.94, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4412087, "sample_time_ms": 23488.045, "load_time_ms": 7.474, "grad_time_ms": 12687.498, "update_time_ms": 7.631, "default": {"policy_loss": -0.01328316330909729, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3781757652759552, "total_loss": 62.51749801635742, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 62.52656173706055, "kl": 0.018724044784903526, "entropy": 1.3957176208496094}, "num_steps_sampled": 4412087}, "episodes_this_iter": 31, "time_this_iter_s": 34.220118284225464}
{"episode_reward_mean": 1028.653458722545, "timesteps_total": 4458196, "iterations_since_restore": 76, "timesteps_since_restore": 4458196, "pid": 59703, "custom_metrics": {"outflow_rate_min": 929.3488733805945, "system_level_velocity_min": 11.680625872796492, "cost1_max": 440.40927082657385, "cost2_max": -35.756170336595076, "cost2_min": -107.7222706612589, "outflow_rate_max": 1280.9329221287644, "system_level_velocity_mean": 15.793141384648914, "cost1_mean": 402.02628209206813, "cost2_mean": -54.49628734338275, "outflow_rate_mean": 1112.4260825449232, "system_level_velocity_max": 17.402149986731782, "cost1_min": 176.10838951923623}, "policy_reward_mean": {}, "timesteps_this_iter": 46109, "training_iteration": 76, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435010, "hostname": "flow-main", "episode_reward_max": 1160.2199129574037, "episode_reward_min": 458.32304170404416, "episodes_total": 2245, "time_since_restore": 3299.2669167518616, "date": "2019-05-21_10-36-50", "time_total_s": 3299.2669167518616, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32c88>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 691.94, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4458196, "sample_time_ms": 23198.133, "load_time_ms": 7.457, "grad_time_ms": 12581.13, "update_time_ms": 7.664, "default": {"policy_loss": -0.011206298135221004, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.38105323910713196, "total_loss": 59.31367874145508, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 59.320518493652344, "kl": 0.019391529262065887, "entropy": 1.3995000123977661}, "num_steps_sampled": 4458196}, "episodes_this_iter": 31, "time_this_iter_s": 32.841784715652466}
{"episode_reward_mean": 1022.6002588259892, "timesteps_total": 4503490, "iterations_since_restore": 77, "timesteps_since_restore": 4503490, "pid": 59703, "custom_metrics": {"outflow_rate_min": 929.3488733805945, "system_level_velocity_min": 12.856843720024111, "cost1_max": 440.40927082657385, "cost2_max": -35.756170336595076, "cost2_min": -89.2625421567491, "outflow_rate_max": 1235.129234381114, "system_level_velocity_mean": 15.910077297086776, "cost1_mean": 406.9526360886182, "cost2_mean": -50.86682666184909, "outflow_rate_mean": 1096.3699697828863, "system_level_velocity_max": 17.402149986731782, "cost1_min": 176.10838951923623}, "policy_reward_mean": {}, "timesteps_this_iter": 45294, "training_iteration": 77, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435042, "hostname": "flow-main", "episode_reward_max": 1126.0986460688282, "episode_reward_min": 465.5027557421174, "episodes_total": 2278, "time_since_restore": 3331.3518764972687, "date": "2019-05-21_10-37-22", "time_total_s": 3331.3518764972687, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbe10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbf60>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.97, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4503490, "sample_time_ms": 22933.607, "load_time_ms": 7.416, "grad_time_ms": 12343.185, "update_time_ms": 7.623, "default": {"policy_loss": -0.011819742619991302, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4154137074947357, "total_loss": 60.21303939819336, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 60.2208251953125, "kl": 0.01793683134019375, "entropy": 1.4052366018295288}, "num_steps_sampled": 4503490}, "episodes_this_iter": 33, "time_this_iter_s": 32.084959745407104}
{"episode_reward_mean": 1010.8099700684157, "timesteps_total": 4549199, "iterations_since_restore": 78, "timesteps_since_restore": 4549199, "pid": 59703, "custom_metrics": {"outflow_rate_min": 929.3488733805945, "system_level_velocity_min": 12.864084786485686, "cost1_max": 440.40927082657385, "cost2_max": -34.93639259855513, "cost2_min": -103.19512522495151, "outflow_rate_max": 1213.196929994755, "system_level_velocity_mean": 15.93209424255689, "cost1_mean": 407.2094236211223, "cost2_mean": -48.765921218234006, "outflow_rate_mean": 1082.7975045849191, "system_level_velocity_max": 17.402149986731782, "cost1_min": 164.4857943511626}, "policy_reward_mean": {}, "timesteps_this_iter": 45709, "training_iteration": 78, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435077, "hostname": "flow-main", "episode_reward_max": 1119.5363699693812, "episode_reward_min": 382.4652723179911, "episodes_total": 2313, "time_since_restore": 3365.780401468277, "date": "2019-05-21_10-37-57", "time_total_s": 3365.780401468277, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde400>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.65, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4549199, "sample_time_ms": 22929.458, "load_time_ms": 7.414, "grad_time_ms": 12140.384, "update_time_ms": 7.519, "default": {"policy_loss": -0.012519433163106441, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4104614555835724, "total_loss": 63.47322463989258, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 63.48148727416992, "kl": 0.018914178013801575, "entropy": 1.4109450578689575}, "num_steps_sampled": 4549199}, "episodes_this_iter": 35, "time_this_iter_s": 34.4285249710083}
{"episode_reward_mean": 991.877042753719, "timesteps_total": 4594117, "iterations_since_restore": 79, "timesteps_since_restore": 4594117, "pid": 59703, "custom_metrics": {"outflow_rate_min": 903.3960232681122, "system_level_velocity_min": 12.71268394557547, "cost1_max": 438.3017181299427, "cost2_max": -34.560480112193474, "cost2_min": -103.19512522495151, "outflow_rate_max": 1211.4044369063774, "system_level_velocity_mean": 15.825845303969627, "cost1_mean": 403.5210604714023, "cost2_mean": -48.10139473141697, "outflow_rate_mean": 1066.0912285262878, "system_level_velocity_max": 17.368244079300414, "cost1_min": 164.4857943511626}, "policy_reward_mean": {}, "timesteps_this_iter": 44918, "training_iteration": 79, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435110, "hostname": "flow-main", "episode_reward_max": 1097.9848333882176, "episode_reward_min": 382.4652723179911, "episodes_total": 2346, "time_since_restore": 3399.4889981746674, "date": "2019-05-21_10-38-30", "time_total_s": 3399.4889981746674, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbd30>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 692.63, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4594117, "sample_time_ms": 22737.382, "load_time_ms": 7.38, "grad_time_ms": 12086.715, "update_time_ms": 7.176, "default": {"policy_loss": -0.012396209873259068, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4401894807815552, "total_loss": 59.14728927612305, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 59.15533447265625, "kl": 0.019327402114868164, "entropy": 1.4074300527572632}, "num_steps_sampled": 4594117}, "episodes_this_iter": 33, "time_this_iter_s": 33.70859670639038}
{"episode_reward_mean": 983.9994024091741, "timesteps_total": 4640025, "iterations_since_restore": 80, "timesteps_since_restore": 4640025, "pid": 59703, "custom_metrics": {"outflow_rate_min": 903.3960232681122, "system_level_velocity_min": 12.71268394557547, "cost1_max": 437.1124588267895, "cost2_max": -31.327239704031893, "cost2_min": -103.19512522495151, "outflow_rate_max": 1184.3886742666093, "system_level_velocity_mean": 15.803052094479677, "cost1_mean": 401.1189135375846, "cost2_mean": -47.83192447003674, "outflow_rate_mean": 1061.4065047717331, "system_level_velocity_max": 17.342946154929678, "cost1_min": 164.4857943511626}, "policy_reward_mean": {}, "timesteps_this_iter": 45908, "training_iteration": 80, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435143, "hostname": "flow-main", "episode_reward_max": 1095.685621246668, "episode_reward_min": 382.4652723179911, "episodes_total": 2379, "time_since_restore": 3431.8082897663116, "date": "2019-05-21_10-39-03", "time_total_s": 3431.8082897663116, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e4e6278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e5026a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502c18>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 688.71, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4640025, "sample_time_ms": 22318.211, "load_time_ms": 7.355, "grad_time_ms": 12035.164, "update_time_ms": 7.224, "default": {"policy_loss": -0.012138746678829193, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4191003441810608, "total_loss": 59.22109603881836, "cur_kl_coeff": 0.22500000894069672, "vf_loss": 59.2291374206543, "kl": 0.01820594072341919, "entropy": 1.4249320030212402}, "num_steps_sampled": 4640025}, "episodes_this_iter": 33, "time_this_iter_s": 32.31929159164429}
{"episode_reward_mean": 993.7214017607963, "timesteps_total": 4685054, "iterations_since_restore": 81, "timesteps_since_restore": 4685054, "pid": 59703, "custom_metrics": {"outflow_rate_min": 903.3960232681122, "system_level_velocity_min": 12.71268394557547, "cost1_max": 436.43787855936256, "cost2_max": -31.327239704031893, "cost2_min": -89.93468194855566, "outflow_rate_max": 1184.3886742666093, "system_level_velocity_mean": 15.801494293984286, "cost1_mean": 404.0870822879094, "cost2_mean": -48.03698380713821, "outflow_rate_mean": 1058.6044199077085, "system_level_velocity_max": 17.23430436476283, "cost1_min": 194.93540827456957}, "policy_reward_mean": {}, "timesteps_this_iter": 45029, "training_iteration": 81, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435175, "hostname": "flow-main", "episode_reward_max": 1106.5118903164116, "episode_reward_min": 477.3279906793665, "episodes_total": 2411, "time_since_restore": 3463.9314498901367, "date": "2019-05-21_10-39-35", "time_total_s": 3463.9314498901367, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb438>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.06, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4685054, "sample_time_ms": 22057.201, "load_time_ms": 7.181, "grad_time_ms": 11850.239, "update_time_ms": 7.247, "default": {"policy_loss": -0.013089984655380249, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.43256640434265137, "total_loss": 55.35163879394531, "cur_kl_coeff": 0.2250000238418579, "vf_loss": 55.36055374145508, "kl": 0.018578702583909035, "entropy": 1.4222196340560913}, "num_steps_sampled": 4685054}, "episodes_this_iter": 32, "time_this_iter_s": 32.12316012382507}
{"episode_reward_mean": 997.5821537789892, "timesteps_total": 4730384, "iterations_since_restore": 82, "timesteps_since_restore": 4730384, "pid": 59703, "custom_metrics": {"outflow_rate_min": 917.0650228310504, "system_level_velocity_min": 13.580462676623927, "cost1_max": 435.99039911220575, "cost2_max": -31.327239704031893, "cost2_min": -81.77912156170399, "outflow_rate_max": 1191.3650859950862, "system_level_velocity_mean": 15.837139858737103, "cost1_mean": 406.4229196387074, "cost2_mean": -48.31647842774448, "outflow_rate_mean": 1056.2219797243113, "system_level_velocity_max": 17.23430436476283, "cost1_min": 194.93540827456957}, "policy_reward_mean": {}, "timesteps_this_iter": 45330, "training_iteration": 82, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435209, "hostname": "flow-main", "episode_reward_max": 1119.3112107454126, "episode_reward_min": 477.3279906793665, "episodes_total": 2444, "time_since_restore": 3497.8215506076813, "date": "2019-05-21_10-40-09", "time_total_s": 3497.8215506076813, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e5026a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e4e6278>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 696.08, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4730384, "sample_time_ms": 21966.904, "load_time_ms": 7.123, "grad_time_ms": 11558.501, "update_time_ms": 7.35, "default": {"policy_loss": -0.01247444935142994, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4243990480899811, "total_loss": 63.06036376953125, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 63.06904220581055, "kl": 0.016855616122484207, "entropy": 1.4300286769866943}, "num_steps_sampled": 4730384}, "episodes_this_iter": 33, "time_this_iter_s": 33.890100717544556}
{"episode_reward_mean": 1003.8204382837228, "timesteps_total": 4775565, "iterations_since_restore": 83, "timesteps_since_restore": 4775565, "pid": 59703, "custom_metrics": {"outflow_rate_min": 911.4296216216218, "system_level_velocity_min": 13.580462676623927, "cost1_max": 435.99039911220575, "cost2_max": -33.13674416004446, "cost2_min": -81.77912156170399, "outflow_rate_max": 1191.3650859950862, "system_level_velocity_mean": 15.840084221307126, "cost1_mean": 409.1404072468408, "cost2_mean": -47.83989777712837, "outflow_rate_mean": 1054.4232844314536, "system_level_velocity_max": 17.16012409778634, "cost1_min": 352.1140771431335}, "policy_reward_mean": {}, "timesteps_this_iter": 45181, "training_iteration": 83, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435241, "hostname": "flow-main", "episode_reward_max": 1119.3112107454126, "episode_reward_min": 851.0596856904405, "episodes_total": 2474, "time_since_restore": 3529.501886367798, "date": "2019-05-21_10-40-41", "time_total_s": 3529.501886367798, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb320>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4775565, "sample_time_ms": 21535.006, "load_time_ms": 7.145, "grad_time_ms": 11536.891, "update_time_ms": 7.522, "default": {"policy_loss": -0.010088310576975346, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4002857208251953, "total_loss": 54.28921890258789, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 54.29570007324219, "kl": 0.016047649085521698, "entropy": 1.4383113384246826}, "num_steps_sampled": 4775565}, "episodes_this_iter": 30, "time_this_iter_s": 31.680335760116577}
{"episode_reward_mean": 988.8263960578839, "timesteps_total": 4821283, "iterations_since_restore": 84, "timesteps_since_restore": 4821283, "pid": 59703, "custom_metrics": {"outflow_rate_min": 899.950835413866, "system_level_velocity_min": 13.844190068227004, "cost1_max": 440.3603080024434, "cost2_max": -33.13674416004446, "cost2_min": -81.46168970142196, "outflow_rate_max": 1191.3650859950862, "system_level_velocity_mean": 15.784846494877383, "cost1_mean": 404.3647193162388, "cost2_mean": -47.67010086124463, "outflow_rate_mean": 1048.5462714882515, "system_level_velocity_max": 17.273363090453355, "cost1_min": 191.1541464980774}, "policy_reward_mean": {}, "timesteps_this_iter": 45718, "training_iteration": 84, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435273, "hostname": "flow-main", "episode_reward_max": 1119.3112107454126, "episode_reward_min": 482.5602271592912, "episodes_total": 2506, "time_since_restore": 3561.3376212120056, "date": "2019-05-21_10-41-13", "time_total_s": 3561.3376212120056, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb588>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 694.83, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4821283, "sample_time_ms": 21288.687, "load_time_ms": 7.176, "grad_time_ms": 11525.31, "update_time_ms": 7.502, "default": {"policy_loss": -0.012539527378976345, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.43423786759376526, "total_loss": 59.5133056640625, "cur_kl_coeff": 0.22499999403953552, "vf_loss": 59.52142333984375, "kl": 0.019654501229524612, "entropy": 1.4580758810043335}, "num_steps_sampled": 4821283}, "episodes_this_iter": 32, "time_this_iter_s": 31.835734844207764}
{"episode_reward_mean": 986.2362339922831, "timesteps_total": 4866672, "iterations_since_restore": 85, "timesteps_since_restore": 4866672, "pid": 59703, "custom_metrics": {"outflow_rate_min": 854.5506225393699, "system_level_velocity_min": 13.139685375980752, "cost1_max": 440.3603080024434, "cost2_max": -32.065226776175194, "cost2_min": -81.46168970142196, "outflow_rate_max": 1171.0012774510749, "system_level_velocity_mean": 15.774995998450438, "cost1_mean": 404.3114108172644, "cost2_mean": -47.67073310465347, "outflow_rate_mean": 1042.326112344092, "system_level_velocity_max": 17.273363090453355, "cost1_min": 191.1541464980774}, "policy_reward_mean": {}, "timesteps_this_iter": 45389, "training_iteration": 85, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435305, "hostname": "flow-main", "episode_reward_max": 1108.3170374749739, "episode_reward_min": 482.5602271592912, "episodes_total": 2536, "time_since_restore": 3593.956280708313, "date": "2019-05-21_10-41-45", "time_total_s": 3593.956280708313, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbe10>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 694.83, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4866672, "sample_time_ms": 21181.886, "load_time_ms": 7.084, "grad_time_ms": 11472.063, "update_time_ms": 7.455, "default": {"policy_loss": -0.014664913527667522, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.42368966341018677, "total_loss": 57.88677215576172, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 57.89653778076172, "kl": 0.02178659290075302, "entropy": 1.4540842771530151}, "num_steps_sampled": 4866672}, "episodes_this_iter": 30, "time_this_iter_s": 32.61865949630737}
{"episode_reward_mean": 986.9307643699808, "timesteps_total": 4913875, "iterations_since_restore": 86, "timesteps_since_restore": 4913875, "pid": 59703, "custom_metrics": {"outflow_rate_min": 854.5506225393699, "system_level_velocity_min": 13.139685375980752, "cost1_max": 440.3603080024434, "cost2_max": -31.04222413750676, "cost2_min": -81.46168970142196, "outflow_rate_max": 1171.0012774510749, "system_level_velocity_mean": 15.564118817704978, "cost1_mean": 399.6627729007305, "cost2_mean": -48.677219488434915, "outflow_rate_mean": 1041.2784334441562, "system_level_velocity_max": 17.273363090453355, "cost1_min": 191.1541464980774}, "policy_reward_mean": {}, "timesteps_this_iter": 47203, "training_iteration": 86, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435340, "hostname": "flow-main", "episode_reward_max": 1108.3170374749739, "episode_reward_min": 482.5602271592912, "episodes_total": 2570, "time_since_restore": 3628.4456446170807, "date": "2019-05-21_10-42-20", "time_total_s": 3628.4456446170807, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbcf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbb70>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 694.83, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4913875, "sample_time_ms": 21329.056, "load_time_ms": 7.101, "grad_time_ms": 11489.451, "update_time_ms": 7.426, "default": {"policy_loss": -0.01037613581866026, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4080161154270172, "total_loss": 60.184600830078125, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 60.19025802612305, "kl": 0.013985434547066689, "entropy": 1.453335165977478}, "num_steps_sampled": 4913875}, "episodes_this_iter": 34, "time_this_iter_s": 34.4893639087677}
{"episode_reward_mean": 984.373374958188, "timesteps_total": 4960655, "iterations_since_restore": 87, "timesteps_since_restore": 4960655, "pid": 59703, "custom_metrics": {"outflow_rate_min": 479.27864688977405, "system_level_velocity_min": 13.139685375980752, "cost1_max": 435.4041351208266, "cost2_max": -20.49802999362228, "cost2_min": -79.49491403367702, "outflow_rate_max": 1256.3021141182635, "system_level_velocity_mean": 15.432288939232537, "cost1_mean": 394.44979141069666, "cost2_mean": -50.304250493248375, "outflow_rate_mean": 1037.6351107977741, "system_level_velocity_max": 18.221705083254797, "cost1_min": 24.07407778460813}, "policy_reward_mean": {}, "timesteps_this_iter": 46780, "training_iteration": 87, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435374, "hostname": "flow-main", "episode_reward_max": 1147.4895142017183, "episode_reward_min": 60.7990870149664, "episodes_total": 2605, "time_since_restore": 3662.941738128662, "date": "2019-05-21_10-42-54", "time_total_s": 3662.941738128662, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32470>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 691.25, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 4960655, "sample_time_ms": 21471.715, "load_time_ms": 7.087, "grad_time_ms": 11586.926, "update_time_ms": 7.533, "default": {"policy_loss": -0.012820429168641567, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.40053585171699524, "total_loss": 57.82076644897461, "cur_kl_coeff": 0.33750009536743164, "vf_loss": 57.828617095947266, "kl": 0.014719207771122456, "entropy": 1.454778790473938}, "num_steps_sampled": 4960655}, "episodes_this_iter": 35, "time_this_iter_s": 34.49609351158142}
{"episode_reward_mean": 980.1276027960416, "timesteps_total": 5005113, "iterations_since_restore": 88, "timesteps_since_restore": 5005113, "pid": 59703, "custom_metrics": {"outflow_rate_min": 479.27864688977405, "system_level_velocity_min": 13.221456135317398, "cost1_max": 433.66295259962254, "cost2_max": -20.49802999362228, "cost2_min": -78.46283703461, "outflow_rate_max": 1256.3021141182635, "system_level_velocity_mean": 15.394632548085678, "cost1_mean": 393.8359102656874, "cost2_mean": -49.74075559999431, "outflow_rate_mean": 1029.9477420295962, "system_level_velocity_max": 18.221705083254797, "cost1_min": 24.07407778460813}, "policy_reward_mean": {}, "timesteps_this_iter": 44458, "training_iteration": 88, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435407, "hostname": "flow-main", "episode_reward_max": 1147.4895142017183, "episode_reward_min": 60.7990870149664, "episodes_total": 2638, "time_since_restore": 3695.484847545624, "date": "2019-05-21_10-43-27", "time_total_s": 3695.484847545624, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e4e6278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0000b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf326d8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 691.25, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5005113, "sample_time_ms": 21273.399, "load_time_ms": 6.895, "grad_time_ms": 11595.583, "update_time_ms": 7.673, "default": {"policy_loss": -0.01188135240226984, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.39464280009269714, "total_loss": 58.620574951171875, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 58.62777328491211, "kl": 0.013875818811357021, "entropy": 1.4835349321365356}, "num_steps_sampled": 5005113}, "episodes_this_iter": 33, "time_this_iter_s": 32.54310941696167}
{"episode_reward_mean": 977.5739328265685, "timesteps_total": 5050042, "iterations_since_restore": 89, "timesteps_since_restore": 5050042, "pid": 59703, "custom_metrics": {"outflow_rate_min": 479.27864688977405, "system_level_velocity_min": 13.221456135317398, "cost1_max": 438.64591380560375, "cost2_max": -20.49802999362228, "cost2_min": -92.74817873947809, "outflow_rate_max": 1256.3021141182635, "system_level_velocity_mean": 15.580369229881388, "cost1_mean": 398.5623164536282, "cost2_mean": -49.09969914585707, "outflow_rate_mean": 1024.9120527650575, "system_level_velocity_max": 18.221705083254797, "cost1_min": 24.07407778460813}, "policy_reward_mean": {}, "timesteps_this_iter": 44929, "training_iteration": 89, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435441, "hostname": "flow-main", "episode_reward_max": 1147.4895142017183, "episode_reward_min": 60.7990870149664, "episodes_total": 2672, "time_since_restore": 3729.147087097168, "date": "2019-05-21_10-44-01", "time_total_s": 3729.147087097168, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf325c0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 691.25, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5050042, "sample_time_ms": 21367.052, "load_time_ms": 6.85, "grad_time_ms": 11498.425, "update_time_ms": 7.865, "default": {"policy_loss": -0.012172980234026909, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.34909698367118835, "total_loss": 59.43009948730469, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 59.43751525878906, "kl": 0.014078199863433838, "entropy": 1.4829459190368652}, "num_steps_sampled": 5050042}, "episodes_this_iter": 34, "time_this_iter_s": 33.66223955154419}
{"episode_reward_mean": 972.5322335809304, "timesteps_total": 5094438, "iterations_since_restore": 90, "timesteps_since_restore": 5094438, "pid": 59703, "custom_metrics": {"outflow_rate_min": 710.2303489799227, "system_level_velocity_min": 12.417048941053945, "cost1_max": 438.64591380560375, "cost2_max": -32.32882767509117, "cost2_min": -92.74817873947809, "outflow_rate_max": 1206.5759753312013, "system_level_velocity_mean": 15.6363468730565, "cost1_mean": 403.9199216206296, "cost2_mean": -47.55131883698397, "outflow_rate_mean": 1008.1432789652266, "system_level_velocity_max": 17.263076853596484, "cost1_min": 301.75341648663493}, "policy_reward_mean": {}, "timesteps_this_iter": 44396, "training_iteration": 90, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435472, "hostname": "flow-main", "episode_reward_max": 1121.1938890234715, "episode_reward_min": 731.6555701563547, "episodes_total": 2703, "time_since_restore": 3760.885498523712, "date": "2019-05-21_10-44-32", "time_total_s": 3760.885498523712, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbf60>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 697.88, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5094438, "sample_time_ms": 21289.751, "load_time_ms": 6.959, "grad_time_ms": 11517.761, "update_time_ms": 7.778, "default": {"policy_loss": -0.009689390659332275, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3554108142852783, "total_loss": 53.865108489990234, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 53.87031555175781, "kl": 0.0133012430742383, "entropy": 1.4925847053527832}, "num_steps_sampled": 5094438}, "episodes_this_iter": 31, "time_this_iter_s": 31.73841142654419}
{"episode_reward_mean": 944.763159165562, "timesteps_total": 5139495, "iterations_since_restore": 91, "timesteps_since_restore": 5139495, "pid": 59703, "custom_metrics": {"outflow_rate_min": 502.66918130924233, "system_level_velocity_min": 12.417048941053945, "cost1_max": 438.64591380560375, "cost2_max": -19.13058089125906, "cost2_min": -92.74817873947809, "outflow_rate_max": 1206.5759753312013, "system_level_velocity_mean": 15.687060746791946, "cost1_mean": 398.6260801441376, "cost2_mean": -46.52332645582417, "outflow_rate_mean": 983.4767787375758, "system_level_velocity_max": 18.63314903275019, "cost1_min": 23.102644980494592}, "policy_reward_mean": {}, "timesteps_this_iter": 45057, "training_iteration": 91, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435506, "hostname": "flow-main", "episode_reward_max": 1121.1938890234715, "episode_reward_min": 54.986957250141124, "episodes_total": 2737, "time_since_restore": 3794.004707098007, "date": "2019-05-21_10-45-06", "time_total_s": 3794.004707098007, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000c18>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 688.42, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5139495, "sample_time_ms": 21335.095, "load_time_ms": 6.916, "grad_time_ms": 11572.302, "update_time_ms": 7.927, "default": {"policy_loss": -0.010942207649350166, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.30156201124191284, "total_loss": 58.73429870605469, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 58.74052429199219, "kl": 0.013976668938994408, "entropy": 1.5068806409835815}, "num_steps_sampled": 5139495}, "episodes_this_iter": 34, "time_this_iter_s": 33.119208574295044}
{"episode_reward_mean": 921.1404353189292, "timesteps_total": 5184272, "iterations_since_restore": 92, "timesteps_since_restore": 5184272, "pid": 59703, "custom_metrics": {"outflow_rate_min": 466.57782141583624, "system_level_velocity_min": 12.417048941053945, "cost1_max": 438.27446645119676, "cost2_max": -19.13058089125906, "cost2_min": -87.53889914355243, "outflow_rate_max": 1186.7547498952663, "system_level_velocity_mean": 15.756123372908606, "cost1_mean": 395.2820104183061, "cost2_mean": -44.49628276630568, "outflow_rate_mean": 954.9066024433106, "system_level_velocity_max": 18.63314903275019, "cost1_min": 22.90406396556786}, "policy_reward_mean": {}, "timesteps_this_iter": 44777, "training_iteration": 92, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435538, "hostname": "flow-main", "episode_reward_max": 1062.1539248670872, "episode_reward_min": 54.986957250141124, "episodes_total": 2771, "time_since_restore": 3826.6741638183594, "date": "2019-05-21_10-45-38", "time_total_s": 3826.6741638183594, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb5f8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 681.77, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5184272, "sample_time_ms": 21251.888, "load_time_ms": 6.885, "grad_time_ms": 11533.173, "update_time_ms": 7.862, "default": {"policy_loss": -0.012082547880709171, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3151165246963501, "total_loss": 56.07050323486328, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 56.077823638916016, "kl": 0.014106539078056812, "entropy": 1.5238474607467651}, "num_steps_sampled": 5184272}, "episodes_this_iter": 34, "time_this_iter_s": 32.66945672035217}
{"episode_reward_mean": 918.8606072150334, "timesteps_total": 5229826, "iterations_since_restore": 93, "timesteps_since_restore": 5229826, "pid": 59703, "custom_metrics": {"outflow_rate_min": 466.57782141583624, "system_level_velocity_min": 12.913095957942815, "cost1_max": 437.965214862859, "cost2_max": -19.13058089125906, "cost2_min": -89.64386221815947, "outflow_rate_max": 1186.7547498952663, "system_level_velocity_mean": 15.709031513992581, "cost1_mean": 394.51673657051, "cost2_mean": -44.29819905085261, "outflow_rate_mean": 950.1786301172122, "system_level_velocity_max": 18.63314903275019, "cost1_min": 22.90406396556786}, "policy_reward_mean": {}, "timesteps_this_iter": 45554, "training_iteration": 93, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435570, "hostname": "flow-main", "episode_reward_max": 1066.5165543184105, "episode_reward_min": 54.986957250141124, "episodes_total": 2801, "time_since_restore": 3858.5097193717957, "date": "2019-05-21_10-46-10", "time_total_s": 3858.5097193717957, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0184a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8d68>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 681.77, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5229826, "sample_time_ms": 21279.411, "load_time_ms": 6.921, "grad_time_ms": 11524.151, "update_time_ms": 7.587, "default": {"policy_loss": -0.013597093522548676, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.38014355301856995, "total_loss": 50.38185501098633, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 50.3903923034668, "kl": 0.01499750092625618, "entropy": 1.5075948238372803}, "num_steps_sampled": 5229826}, "episodes_this_iter": 30, "time_this_iter_s": 31.83555555343628}
{"episode_reward_mean": 940.7343805407113, "timesteps_total": 5275486, "iterations_since_restore": 94, "timesteps_since_restore": 5275486, "pid": 59703, "custom_metrics": {"outflow_rate_min": 466.57782141583624, "system_level_velocity_min": 12.248897182327845, "cost1_max": 437.965214862859, "cost2_max": -20.80523314293947, "cost2_min": -106.05631520915068, "outflow_rate_max": 1184.1061480003013, "system_level_velocity_mean": 15.542940045907567, "cost1_mean": 398.6824896511552, "cost2_mean": -45.83565543476159, "outflow_rate_mean": 957.8476223300266, "system_level_velocity_max": 18.311413260231156, "cost1_min": 22.90406396556786}, "policy_reward_mean": {}, "timesteps_this_iter": 45660, "training_iteration": 94, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435602, "hostname": "flow-main", "episode_reward_max": 1083.5581068168965, "episode_reward_min": 58.64245349962624, "episodes_total": 2833, "time_since_restore": 3890.01601934433, "date": "2019-05-21_10-46-42", "time_total_s": 3890.01601934433, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fb38>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.35, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5275486, "sample_time_ms": 21208.49, "load_time_ms": 6.92, "grad_time_ms": 11562.07, "update_time_ms": 7.557, "default": {"policy_loss": -0.01037618424743414, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3664117157459259, "total_loss": 53.432701110839844, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 53.43850326538086, "kl": 0.013546105474233627, "entropy": 1.5191746950149536}, "num_steps_sampled": 5275486}, "episodes_this_iter": 32, "time_this_iter_s": 31.50629997253418}
{"episode_reward_mean": 946.4792313301652, "timesteps_total": 5321344, "iterations_since_restore": 95, "timesteps_since_restore": 5321344, "pid": 59703, "custom_metrics": {"outflow_rate_min": 819.6717494387069, "system_level_velocity_min": 11.591648249894627, "cost1_max": 433.4227535407627, "cost2_max": -30.074442834739823, "cost2_min": -115.03332693048384, "outflow_rate_max": 1184.1061480003013, "system_level_velocity_mean": 15.331694352892905, "cost1_mean": 398.64072322354457, "cost2_mean": -46.717761515574054, "outflow_rate_mean": 958.2510093558016, "system_level_velocity_max": 16.902510792028938, "cost1_min": 301.0569787710692}, "policy_reward_mean": {}, "timesteps_this_iter": 45858, "training_iteration": 95, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435632, "hostname": "flow-main", "episode_reward_max": 1083.5581068168965, "episode_reward_min": 857.9215537699745, "episodes_total": 2867, "time_since_restore": 3920.5848140716553, "date": "2019-05-21_10-47-12", "time_total_s": 3920.5848140716553, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f6d8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5321344, "sample_time_ms": 21106.576, "load_time_ms": 6.899, "grad_time_ms": 11459.937, "update_time_ms": 7.716, "default": {"policy_loss": -0.012570390477776527, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4193885922431946, "total_loss": 48.74436950683594, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 48.75229263305664, "kl": 0.013775436207652092, "entropy": 1.5060806274414062}, "num_steps_sampled": 5321344}, "episodes_this_iter": 34, "time_this_iter_s": 30.56879472732544}
{"episode_reward_mean": 932.2543308233298, "timesteps_total": 5366451, "iterations_since_restore": 96, "timesteps_since_restore": 5366451, "pid": 59703, "custom_metrics": {"outflow_rate_min": 496.26021248702307, "system_level_velocity_min": 11.591648249894627, "cost1_max": 433.2276858719721, "cost2_max": -19.440439234039644, "cost2_min": -115.03332693048384, "outflow_rate_max": 1173.9070226918905, "system_level_velocity_mean": 15.41052597637608, "cost1_mean": 396.25382989052787, "cost2_mean": -44.5286492636844, "outflow_rate_mean": 944.3441129130298, "system_level_velocity_max": 18.5332122620537, "cost1_min": 23.02629496389014}, "policy_reward_mean": {}, "timesteps_this_iter": 45107, "training_iteration": 96, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435664, "hostname": "flow-main", "episode_reward_max": 1083.5581068168965, "episode_reward_min": 55.46821599841319, "episodes_total": 2901, "time_since_restore": 3952.486684322357, "date": "2019-05-21_10-47-44", "time_total_s": 3952.486684322357, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fe10>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.35, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5366451, "sample_time_ms": 20920.117, "load_time_ms": 6.781, "grad_time_ms": 11388.239, "update_time_ms": 7.646, "default": {"policy_loss": -0.010388937778770924, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2904313802719116, "total_loss": 58.50090026855469, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 58.506954193115234, "kl": 0.012843579053878784, "entropy": 1.5165863037109375}, "num_steps_sampled": 5366451}, "episodes_this_iter": 34, "time_this_iter_s": 31.901870250701904}
{"episode_reward_mean": 927.2090125626906, "timesteps_total": 5411673, "iterations_since_restore": 97, "timesteps_since_restore": 5411673, "pid": 59703, "custom_metrics": {"outflow_rate_min": 496.26021248702307, "system_level_velocity_min": 11.591648249894627, "cost1_max": 432.1607447947418, "cost2_max": -19.440439234039644, "cost2_min": -115.03332693048384, "outflow_rate_max": 1086.1655821357936, "system_level_velocity_mean": 15.451721370908265, "cost1_mean": 397.30964760578956, "cost2_mean": -42.231909930277936, "outflow_rate_mean": 937.6781290459772, "system_level_velocity_max": 18.5332122620537, "cost1_min": 23.02629496389014}, "policy_reward_mean": {}, "timesteps_this_iter": 45222, "training_iteration": 97, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435696, "hostname": "flow-main", "episode_reward_max": 1053.7911579734318, "episode_reward_min": 55.46821599841319, "episodes_total": 2936, "time_since_restore": 3984.546438217163, "date": "2019-05-21_10-48-16", "time_total_s": 3984.546438217163, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fb38>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.35, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5411673, "sample_time_ms": 20755.455, "load_time_ms": 6.737, "grad_time_ms": 11310.202, "update_time_ms": 7.512, "default": {"policy_loss": -0.010928556323051453, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2937451899051666, "total_loss": 54.003822326660156, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 54.01043701171875, "kl": 0.012782826088368893, "entropy": 1.5281370878219604}, "num_steps_sampled": 5411673}, "episodes_this_iter": 35, "time_this_iter_s": 32.05975389480591}
{"episode_reward_mean": 925.697658526381, "timesteps_total": 5455866, "iterations_since_restore": 98, "timesteps_since_restore": 5455866, "pid": 59703, "custom_metrics": {"outflow_rate_min": 496.26021248702307, "system_level_velocity_min": 12.845952864435931, "cost1_max": 432.1607447947418, "cost2_max": -18.806541518415948, "cost2_min": -88.32790669297232, "outflow_rate_max": 1087.6637132710132, "system_level_velocity_mean": 15.520063103978593, "cost1_mean": 394.98001819875026, "cost2_mean": -41.01585238891343, "outflow_rate_mean": 938.987156157636, "system_level_velocity_max": 18.5952774223029, "cost1_min": 23.02629496389014}, "policy_reward_mean": {}, "timesteps_this_iter": 44193, "training_iteration": 98, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435729, "hostname": "flow-main", "episode_reward_max": 1066.892897844935, "episode_reward_min": 55.46821599841319, "episodes_total": 2970, "time_since_restore": 4016.8511850833893, "date": "2019-05-21_10-48-49", "time_total_s": 4016.8511850833893, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fa90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f940>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 686.72, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5455866, "sample_time_ms": 20777.243, "load_time_ms": 6.776, "grad_time_ms": 11265.901, "update_time_ms": 7.455, "default": {"policy_loss": -0.014098016545176506, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.301911860704422, "total_loss": 57.067562103271484, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 57.076602935791016, "kl": 0.014968642964959145, "entropy": 1.538772702217102}, "num_steps_sampled": 5455866}, "episodes_this_iter": 34, "time_this_iter_s": 32.304746866226196}
{"episode_reward_mean": 936.4440253500729, "timesteps_total": 5500933, "iterations_since_restore": 99, "timesteps_since_restore": 5500933, "pid": 59703, "custom_metrics": {"outflow_rate_min": 504.21486338125436, "system_level_velocity_min": 12.885864869266053, "cost1_max": 429.35353599779955, "cost2_max": -18.806541518415948, "cost2_min": -85.44438834362569, "outflow_rate_max": 1087.6637132710132, "system_level_velocity_mean": 15.358309269673025, "cost1_mean": 396.23523756580215, "cost2_mean": -41.435837530166125, "outflow_rate_mean": 944.2981818222797, "system_level_velocity_max": 18.5952774223029, "cost1_min": 24.2326300423564}, "policy_reward_mean": {}, "timesteps_this_iter": 45067, "training_iteration": 99, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435760, "hostname": "flow-main", "episode_reward_max": 1066.892897844935, "episode_reward_min": 57.56245602587898, "episodes_total": 3003, "time_since_restore": 4048.164685487747, "date": "2019-05-21_10-49-20", "time_total_s": 4048.164685487747, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf326d8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.37, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5500933, "sample_time_ms": 20492.284, "load_time_ms": 6.803, "grad_time_ms": 11315.261, "update_time_ms": 7.312, "default": {"policy_loss": -0.01033304538577795, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.27883830666542053, "total_loss": 50.5067024230957, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 50.512447357177734, "kl": 0.013606837019324303, "entropy": 1.5320388078689575}, "num_steps_sampled": 5500933}, "episodes_this_iter": 33, "time_this_iter_s": 31.31350040435791}
{"episode_reward_mean": 920.5480647680422, "timesteps_total": 5546220, "iterations_since_restore": 100, "timesteps_since_restore": 5546220, "pid": 59703, "custom_metrics": {"outflow_rate_min": 468.1459400254859, "system_level_velocity_min": 12.885864869266053, "cost1_max": 429.35353599779955, "cost2_max": -18.806541518415948, "cost2_min": -87.09421634036669, "outflow_rate_max": 1086.704837069473, "system_level_velocity_mean": 15.374538946765409, "cost1_mean": 392.6021454464298, "cost2_mean": -39.94867915502056, "outflow_rate_mean": 928.9067343217679, "system_level_velocity_max": 18.5952774223029, "cost1_min": 22.791597235899033}, "policy_reward_mean": {}, "timesteps_this_iter": 45287, "training_iteration": 100, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435792, "hostname": "flow-main", "episode_reward_max": 1041.4566802762342, "episode_reward_min": 57.56245602587898, "episodes_total": 3039, "time_since_restore": 4080.360944747925, "date": "2019-05-21_10-49-52", "time_total_s": 4080.360944747925, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f208>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 686.72, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5546220, "sample_time_ms": 20552.689, "load_time_ms": 6.787, "grad_time_ms": 11298.302, "update_time_ms": 7.337, "default": {"policy_loss": -0.011200815439224243, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2792615294456482, "total_loss": 57.95420837402344, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 57.960960388183594, "kl": 0.013193404302001, "entropy": 1.5441054105758667}, "num_steps_sampled": 5546220}, "episodes_this_iter": 36, "time_this_iter_s": 32.19625926017761}
{"episode_reward_mean": 924.8413669927958, "timesteps_total": 5590223, "iterations_since_restore": 101, "timesteps_since_restore": 5590223, "pid": 59703, "custom_metrics": {"outflow_rate_min": 468.1459400254859, "system_level_velocity_min": 12.885864869266053, "cost1_max": 429.35353599779955, "cost2_max": -19.558046863233972, "cost2_min": -87.09421634036669, "outflow_rate_max": 1068.8042060515131, "system_level_velocity_mean": 15.348918903115583, "cost1_mean": 396.60961210777367, "cost2_mean": -38.340418462106115, "outflow_rate_mean": 925.4422783031207, "system_level_velocity_max": 18.323111708104253, "cost1_min": 22.791597235899033}, "policy_reward_mean": {}, "timesteps_this_iter": 44003, "training_iteration": 101, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435823, "hostname": "flow-main", "episode_reward_max": 1041.4566802762342, "episode_reward_min": 59.31352437214092, "episodes_total": 3070, "time_since_restore": 4111.083365917206, "date": "2019-05-21_10-50-23", "time_total_s": 4111.083365917206, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a58>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.35, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5590223, "sample_time_ms": 20440.947, "load_time_ms": 6.771, "grad_time_ms": 11171.189, "update_time_ms": 7.222, "default": {"policy_loss": -0.011241985484957695, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2901758551597595, "total_loss": 49.151824951171875, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 49.158287048339844, "kl": 0.014154109172523022, "entropy": 1.5365595817565918}, "num_steps_sampled": 5590223}, "episodes_this_iter": 31, "time_this_iter_s": 30.722421169281006}
{"episode_reward_mean": 922.2342402091812, "timesteps_total": 5636200, "iterations_since_restore": 102, "timesteps_since_restore": 5636200, "pid": 59703, "custom_metrics": {"outflow_rate_min": 468.1459400254859, "system_level_velocity_min": 13.277569071371488, "cost1_max": 425.57952081251096, "cost2_max": -19.558046863233972, "cost2_min": -87.09421634036669, "outflow_rate_max": 1075.7682024504752, "system_level_velocity_mean": 15.275400080946374, "cost1_mean": 395.1812495241961, "cost2_mean": -38.42806813392449, "outflow_rate_mean": 922.1957177255023, "system_level_velocity_max": 18.323111708104253, "cost1_min": 22.791597235899033}, "policy_reward_mean": {}, "timesteps_this_iter": 45977, "training_iteration": 102, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435855, "hostname": "flow-main", "episode_reward_max": 1041.4566802762342, "episode_reward_min": 59.31352437214092, "episodes_total": 3101, "time_since_restore": 4142.931080341339, "date": "2019-05-21_10-50-55", "time_total_s": 4142.931080341339, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf329b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32400>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.35, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5636200, "sample_time_ms": 20404.375, "load_time_ms": 6.898, "grad_time_ms": 11125.708, "update_time_ms": 7.282, "default": {"policy_loss": -0.010737311094999313, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2861614227294922, "total_loss": 46.6154670715332, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 46.62188720703125, "kl": 0.012771505862474442, "entropy": 1.5407111644744873}, "num_steps_sampled": 5636200}, "episodes_this_iter": 31, "time_this_iter_s": 31.8477144241333}
{"episode_reward_mean": 941.9068081898903, "timesteps_total": 5680321, "iterations_since_restore": 103, "timesteps_since_restore": 5680321, "pid": 59703, "custom_metrics": {"outflow_rate_min": 848.88, "system_level_velocity_min": 13.297732707268864, "cost1_max": 425.57952081251096, "cost2_max": -24.561315755101624, "cost2_min": -70.91318813440812, "outflow_rate_max": 1086.5355384615386, "system_level_velocity_mean": 15.156933716996003, "cost1_mean": 397.1673790359372, "cost2_mean": -39.253094296718416, "outflow_rate_mean": 942.088538683852, "system_level_velocity_max": 16.493260027506857, "cost1_min": 348.5945769880693}, "policy_reward_mean": {}, "timesteps_this_iter": 44121, "training_iteration": 103, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435887, "hostname": "flow-main", "episode_reward_max": 1022.6218436907934, "episode_reward_min": 858.2668182821736, "episodes_total": 3132, "time_since_restore": 4174.979845523834, "date": "2019-05-21_10-51-27", "time_total_s": 4174.979845523834, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2ff98>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5680321, "sample_time_ms": 20420.923, "load_time_ms": 6.779, "grad_time_ms": 11130.948, "update_time_ms": 7.294, "default": {"policy_loss": -0.008166501298546791, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2061360627412796, "total_loss": 52.62057113647461, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 52.6245002746582, "kl": 0.0125582255423069, "entropy": 1.5308152437210083}, "num_steps_sampled": 5680321}, "episodes_this_iter": 31, "time_this_iter_s": 32.04876518249512}
{"episode_reward_mean": 941.5368345642347, "timesteps_total": 5724352, "iterations_since_restore": 104, "timesteps_since_restore": 5724352, "pid": 59703, "custom_metrics": {"outflow_rate_min": 848.88, "system_level_velocity_min": 13.297732707268864, "cost1_max": 425.57952081251096, "cost2_max": -27.257185934966614, "cost2_min": -78.62663007723846, "outflow_rate_max": 1092.1991922921745, "system_level_velocity_mean": 15.081863252827118, "cost1_mean": 395.9278491871895, "cost2_mean": -39.37313504258257, "outflow_rate_mean": 945.1403859108428, "system_level_velocity_max": 16.493260027506857, "cost1_min": 348.5945769880693}, "policy_reward_mean": {}, "timesteps_this_iter": 44031, "training_iteration": 104, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435917, "hostname": "flow-main", "episode_reward_max": 1022.6218436907934, "episode_reward_min": 858.2668182821736, "episodes_total": 3165, "time_since_restore": 4204.63075876236, "date": "2019-05-21_10-51-57", "time_total_s": 4204.63075876236, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8e48>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5724352, "sample_time_ms": 20360.595, "load_time_ms": 6.701, "grad_time_ms": 11005.893, "update_time_ms": 7.313, "default": {"policy_loss": -0.011512226425111294, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3519335985183716, "total_loss": 52.862159729003906, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 52.869117736816406, "kl": 0.013495397754013538, "entropy": 1.5464682579040527}, "num_steps_sampled": 5724352}, "episodes_this_iter": 33, "time_this_iter_s": 29.65091323852539}
{"episode_reward_mean": 942.7731043416584, "timesteps_total": 5768671, "iterations_since_restore": 105, "timesteps_since_restore": 5768671, "pid": 59703, "custom_metrics": {"outflow_rate_min": 841.6192325315004, "system_level_velocity_min": 13.297732707268864, "cost1_max": 425.20667502003914, "cost2_max": -26.72689643159815, "cost2_min": -78.62663007723846, "outflow_rate_max": 1092.1991922921745, "system_level_velocity_mean": 15.045870264070466, "cost1_mean": 395.6276331350875, "cost2_mean": -38.67648450332454, "outflow_rate_mean": 941.9016768270063, "system_level_velocity_max": 16.245640023447947, "cost1_min": 348.5945769880693}, "policy_reward_mean": {}, "timesteps_this_iter": 44319, "training_iteration": 105, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435949, "hostname": "flow-main", "episode_reward_max": 1022.6218436907934, "episode_reward_min": 858.2668182821736, "episodes_total": 3198, "time_since_restore": 4237.190009832382, "date": "2019-05-21_10-52-29", "time_total_s": 4237.190009832382, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c000fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde0f0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5768671, "sample_time_ms": 20520.089, "load_time_ms": 6.628, "grad_time_ms": 11044.654, "update_time_ms": 7.275, "default": {"policy_loss": -0.012404361739754677, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.43912121653556824, "total_loss": 48.41748809814453, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 48.4251823425293, "kl": 0.013941342011094093, "entropy": 1.5456708669662476}, "num_steps_sampled": 5768671}, "episodes_this_iter": 33, "time_this_iter_s": 32.55925107002258}
{"episode_reward_mean": 934.5779788247112, "timesteps_total": 5813244, "iterations_since_restore": 106, "timesteps_since_restore": 5813244, "pid": 59703, "custom_metrics": {"outflow_rate_min": 826.6775, "system_level_velocity_min": 12.565013368805227, "cost1_max": 424.99317982649353, "cost2_max": -26.72689643159815, "cost2_min": -78.62663007723846, "outflow_rate_max": 1092.1991922921745, "system_level_velocity_mean": 15.043302436617662, "cost1_mean": 396.00840063992507, "cost2_mean": -37.10071305648685, "outflow_rate_mean": 928.5412891979951, "system_level_velocity_max": 16.223971746726143, "cost1_min": 327.4581528535698}, "policy_reward_mean": {}, "timesteps_this_iter": 44573, "training_iteration": 106, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558435983, "hostname": "flow-main", "episode_reward_max": 1001.1987889993834, "episode_reward_min": 864.4448566701527, "episodes_total": 3231, "time_since_restore": 4270.315327882767, "date": "2019-05-21_10-53-03", "time_total_s": 4270.315327882767, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f4a8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5813244, "sample_time_ms": 20619.218, "load_time_ms": 6.638, "grad_time_ms": 11068.505, "update_time_ms": 7.341, "default": {"policy_loss": -0.008988327346742153, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3093055784702301, "total_loss": 56.7021598815918, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 56.70685577392578, "kl": 0.012706260196864605, "entropy": 1.535127878189087}, "num_steps_sampled": 5813244}, "episodes_this_iter": 33, "time_this_iter_s": 33.12531805038452}
{"episode_reward_mean": 934.9828395019441, "timesteps_total": 5857765, "iterations_since_restore": 107, "timesteps_since_restore": 5857765, "pid": 59703, "custom_metrics": {"outflow_rate_min": 826.6775, "system_level_velocity_min": 12.565013368805227, "cost1_max": 424.7048720352751, "cost2_max": -26.48329399045611, "cost2_min": -74.92766640425762, "outflow_rate_max": 1079.1354622852878, "system_level_velocity_mean": 14.99058637272649, "cost1_mean": 395.2773814294122, "cost2_mean": -36.916239015529065, "outflow_rate_mean": 926.6510710583165, "system_level_velocity_max": 16.14809838322457, "cost1_min": 327.4581528535698}, "policy_reward_mean": {}, "timesteps_this_iter": 44521, "training_iteration": 107, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436014, "hostname": "flow-main", "episode_reward_max": 1006.903003554572, "episode_reward_min": 865.2534603738234, "episodes_total": 3264, "time_since_restore": 4301.911202907562, "date": "2019-05-21_10-53-34", "time_total_s": 4301.911202907562, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f278>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5857765, "sample_time_ms": 20603.628, "load_time_ms": 6.741, "grad_time_ms": 11037.094, "update_time_ms": 7.43, "default": {"policy_loss": -0.010743815451860428, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.36798614263534546, "total_loss": 54.87456130981445, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 54.88083267211914, "kl": 0.013232876546680927, "entropy": 1.5494170188903809}, "num_steps_sampled": 5857765}, "episodes_this_iter": 33, "time_this_iter_s": 31.595875024795532}
{"episode_reward_mean": 931.6830327914219, "timesteps_total": 5903080, "iterations_since_restore": 108, "timesteps_since_restore": 5903080, "pid": 59703, "custom_metrics": {"outflow_rate_min": 826.6775, "system_level_velocity_min": 12.565013368805227, "cost1_max": 424.7048720352751, "cost2_max": -26.48329399045611, "cost2_min": -74.92766640425762, "outflow_rate_max": 1079.1354622852878, "system_level_velocity_mean": 14.857839478247653, "cost1_mean": 392.15402369979313, "cost2_mean": -37.347874596877915, "outflow_rate_mean": 926.9719191105033, "system_level_velocity_max": 16.14809838322457, "cost1_min": 327.4581528535698}, "policy_reward_mean": {}, "timesteps_this_iter": 45315, "training_iteration": 108, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436047, "hostname": "flow-main", "episode_reward_max": 1006.903003554572, "episode_reward_min": 848.7638451799439, "episodes_total": 3296, "time_since_restore": 4334.916719198227, "date": "2019-05-21_10-54-07", "time_total_s": 4334.916719198227, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2ff98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f2e8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5903080, "sample_time_ms": 20681.809, "load_time_ms": 6.773, "grad_time_ms": 11028.949, "update_time_ms": 7.427, "default": {"policy_loss": -0.00984777882695198, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3660738170146942, "total_loss": 47.70720672607422, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 47.712646484375, "kl": 0.013043379411101341, "entropy": 1.5423587560653687}, "num_steps_sampled": 5903080}, "episodes_this_iter": 32, "time_this_iter_s": 33.00551629066467}
{"episode_reward_mean": 925.6963912102043, "timesteps_total": 5948053, "iterations_since_restore": 109, "timesteps_since_restore": 5948053, "pid": 59703, "custom_metrics": {"outflow_rate_min": 850.8802347452605, "system_level_velocity_min": 12.565013368805227, "cost1_max": 417.3924625321171, "cost2_max": -26.48329399045611, "cost2_min": -80.20397261856009, "outflow_rate_max": 1091.064214365371, "system_level_velocity_mean": 14.664651081371938, "cost1_mean": 387.3433910950105, "cost2_mean": -38.43966135302845, "outflow_rate_mean": 927.2702153805976, "system_level_velocity_max": 16.001947249708998, "cost1_min": 327.4581528535698}, "policy_reward_mean": {}, "timesteps_this_iter": 44973, "training_iteration": 109, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436080, "hostname": "flow-main", "episode_reward_max": 1019.2994252808974, "episode_reward_min": 848.7638451799439, "episodes_total": 3329, "time_since_restore": 4367.958866357803, "date": "2019-05-21_10-54-40", "time_total_s": 4367.958866357803, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2feb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f0f0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5948053, "sample_time_ms": 20792.31, "load_time_ms": 6.823, "grad_time_ms": 11090.812, "update_time_ms": 7.409, "default": {"policy_loss": -0.00963074155151844, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.33490338921546936, "total_loss": 48.50857925415039, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 48.514122009277344, "kl": 0.012120472267270088, "entropy": 1.5428329706192017}, "num_steps_sampled": 5948053}, "episodes_this_iter": 33, "time_this_iter_s": 33.042147159576416}
{"episode_reward_mean": 925.7481451037731, "timesteps_total": 5991879, "iterations_since_restore": 110, "timesteps_since_restore": 5991879, "pid": 59703, "custom_metrics": {"outflow_rate_min": 840.9384259259261, "system_level_velocity_min": 13.180411627720334, "cost1_max": 412.0530067916272, "cost2_max": -27.125861659252365, "cost2_min": -80.20397261856009, "outflow_rate_max": 1091.064214365371, "system_level_velocity_mean": 14.672233217635949, "cost1_mean": 387.6223188036284, "cost2_mean": -37.853908405676925, "outflow_rate_mean": 924.7036836395757, "system_level_velocity_max": 15.659112673289455, "cost1_min": 350.0066424500208}, "policy_reward_mean": {}, "timesteps_this_iter": 43826, "training_iteration": 110, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436112, "hostname": "flow-main", "episode_reward_max": 1019.2994252808974, "episode_reward_min": 848.7638451799439, "episodes_total": 3361, "time_since_restore": 4399.6390154361725, "date": "2019-05-21_10-55-12", "time_total_s": 4399.6390154361725, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f5c0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 5991879, "sample_time_ms": 20767.201, "load_time_ms": 6.73, "grad_time_ms": 11065.852, "update_time_ms": 7.449, "default": {"policy_loss": -0.006841018330305815, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.31343594193458557, "total_loss": 51.39397048950195, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 51.39704513549805, "kl": 0.011165352538228035, "entropy": 1.550543189048767}, "num_steps_sampled": 5991879}, "episodes_this_iter": 32, "time_this_iter_s": 31.68014907836914}
{"episode_reward_mean": 928.2277117588533, "timesteps_total": 6035858, "iterations_since_restore": 111, "timesteps_since_restore": 6035858, "pid": 59703, "custom_metrics": {"outflow_rate_min": 827.1644813650647, "system_level_velocity_min": 13.475716089449582, "cost1_max": 420.38003853504074, "cost2_max": -27.125861659252365, "cost2_min": -80.20397261856009, "outflow_rate_max": 1091.064214365371, "system_level_velocity_mean": 14.832762522646549, "cost1_mean": 391.3833394411957, "cost2_mean": -36.9874624628791, "outflow_rate_mean": 922.5202342104759, "system_level_velocity_max": 16.119108285731166, "cost1_min": 355.0406602081701}, "policy_reward_mean": {}, "timesteps_this_iter": 43979, "training_iteration": 111, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436145, "hostname": "flow-main", "episode_reward_max": 1019.2994252808974, "episode_reward_min": 840.0104430575242, "episodes_total": 3392, "time_since_restore": 4432.4935421943665, "date": "2019-05-21_10-55-45", "time_total_s": 4432.4935421943665, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2feb8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6035858, "sample_time_ms": 20952.396, "load_time_ms": 6.774, "grad_time_ms": 11093.487, "update_time_ms": 7.776, "default": {"policy_loss": -0.01076455321162939, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4103975296020508, "total_loss": 46.733734130859375, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 46.74010467529297, "kl": 0.013032160699367523, "entropy": 1.550413966178894}, "num_steps_sampled": 6035858}, "episodes_this_iter": 31, "time_this_iter_s": 32.85452675819397}
{"episode_reward_mean": 924.9496929033444, "timesteps_total": 6080086, "iterations_since_restore": 112, "timesteps_since_restore": 6080086, "pid": 59703, "custom_metrics": {"outflow_rate_min": 827.1644813650647, "system_level_velocity_min": 13.621338319154752, "cost1_max": 420.38003853504074, "cost2_max": -27.125861659252365, "cost2_min": -80.20397261856009, "outflow_rate_max": 1091.064214365371, "system_level_velocity_mean": 14.868764734040239, "cost1_mean": 392.0951886928576, "cost2_mean": -37.10513226388645, "outflow_rate_mean": 918.0302436476202, "system_level_velocity_max": 16.119108285731166, "cost1_min": 359.21490538859547}, "policy_reward_mean": {}, "timesteps_this_iter": 44228, "training_iteration": 112, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436176, "hostname": "flow-main", "episode_reward_max": 1019.2994252808974, "episode_reward_min": 840.0104430575242, "episodes_total": 3422, "time_since_restore": 4463.620558261871, "date": "2019-05-21_10-56-16", "time_total_s": 4463.620558261871, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fa58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f0b8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6080086, "sample_time_ms": 20825.77, "load_time_ms": 6.68, "grad_time_ms": 11147.686, "update_time_ms": 7.676, "default": {"policy_loss": -0.008928140625357628, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3688850402832031, "total_loss": 45.61965560913086, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 45.62430953979492, "kl": 0.012656908482313156, "entropy": 1.557806134223938}, "num_steps_sampled": 6080086}, "episodes_this_iter": 30, "time_this_iter_s": 31.127016067504883}
{"episode_reward_mean": 917.35432412752, "timesteps_total": 6124195, "iterations_since_restore": 113, "timesteps_since_restore": 6124195, "pid": 59703, "custom_metrics": {"outflow_rate_min": 827.1644813650647, "system_level_velocity_min": 13.185974125939953, "cost1_max": 420.38003853504074, "cost2_max": -27.350276769989016, "cost2_min": -61.260143767324905, "outflow_rate_max": 966.8585955310881, "system_level_velocity_mean": 14.88177461560491, "cost1_mean": 391.81038661554135, "cost2_mean": -36.80290525922855, "outflow_rate_mean": 909.2152758789168, "system_level_velocity_max": 16.119108285731166, "cost1_min": 345.3537673746349}, "policy_reward_mean": {}, "timesteps_this_iter": 44109, "training_iteration": 113, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436208, "hostname": "flow-main", "episode_reward_max": 988.1471754458336, "episode_reward_min": 840.0104430575242, "episodes_total": 3454, "time_since_restore": 4495.223146677017, "date": "2019-05-21_10-56-48", "time_total_s": 4495.223146677017, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbac8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6124195, "sample_time_ms": 20829.984, "load_time_ms": 6.664, "grad_time_ms": 11098.612, "update_time_ms": 7.733, "default": {"policy_loss": -0.01150091364979744, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4370983839035034, "total_loss": 42.53020477294922, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 42.53744125366211, "kl": 0.012642315588891506, "entropy": 1.5545132160186768}, "num_steps_sampled": 6124195}, "episodes_this_iter": 32, "time_this_iter_s": 31.602588415145874}
{"episode_reward_mean": 910.8859649455662, "timesteps_total": 6168567, "iterations_since_restore": 114, "timesteps_since_restore": 6168567, "pid": 59703, "custom_metrics": {"outflow_rate_min": 841.122319061074, "system_level_velocity_min": 12.659875806584646, "cost1_max": 417.8063006301077, "cost2_max": -23.673857686907475, "cost2_min": -62.60624560265391, "outflow_rate_max": 987.2105346213168, "system_level_velocity_mean": 14.769261492713229, "cost1_mean": 388.4797825781521, "cost2_mean": -38.26580614304582, "outflow_rate_mean": 909.3427210639035, "system_level_velocity_max": 15.882914090316918, "cost1_min": 329.61873123065595}, "policy_reward_mean": {}, "timesteps_this_iter": 44372, "training_iteration": 114, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436239, "hostname": "flow-main", "episode_reward_max": 982.7966165539768, "episode_reward_min": 855.5984129493881, "episodes_total": 3488, "time_since_restore": 4526.835449457169, "date": "2019-05-21_10-57-19", "time_total_s": 4526.835449457169, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f9e8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6168567, "sample_time_ms": 21006.412, "load_time_ms": 6.618, "grad_time_ms": 11118.559, "update_time_ms": 7.801, "default": {"policy_loss": -0.008468782529234886, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3751305937767029, "total_loss": 50.54121780395508, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 50.54595947265625, "kl": 0.011045446619391441, "entropy": 1.5615664720535278}, "num_steps_sampled": 6168567}, "episodes_this_iter": 34, "time_this_iter_s": 31.612302780151367}
{"episode_reward_mean": 914.5463084818913, "timesteps_total": 6213629, "iterations_since_restore": 115, "timesteps_since_restore": 6213629, "pid": 59703, "custom_metrics": {"outflow_rate_min": 841.122319061074, "system_level_velocity_min": 12.659875806584646, "cost1_max": 417.8063006301077, "cost2_max": -23.673857686907475, "cost2_min": -66.3983753360113, "outflow_rate_max": 1033.8405123261257, "system_level_velocity_mean": 14.797766659799333, "cost1_mean": 389.2041747292814, "cost2_mean": -37.719237983504094, "outflow_rate_mean": 913.9609239951476, "system_level_velocity_max": 15.882914090316918, "cost1_min": 329.61873123065595}, "policy_reward_mean": {}, "timesteps_this_iter": 45062, "training_iteration": 115, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436272, "hostname": "flow-main", "episode_reward_max": 981.9150897861821, "episode_reward_min": 855.5984129493881, "episodes_total": 3518, "time_since_restore": 4559.02622961998, "date": "2019-05-21_10-57-52", "time_total_s": 4559.02622961998, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf324a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32438>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6213629, "sample_time_ms": 20935.438, "load_time_ms": 6.583, "grad_time_ms": 11153.383, "update_time_ms": 7.735, "default": {"policy_loss": -0.010990777052938938, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.38495877385139465, "total_loss": 47.85087585449219, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 47.85708236694336, "kl": 0.014154463075101376, "entropy": 1.5491600036621094}, "num_steps_sampled": 6213629}, "episodes_this_iter": 30, "time_this_iter_s": 32.19078016281128}
{"episode_reward_mean": 920.6938017760426, "timesteps_total": 6258367, "iterations_since_restore": 116, "timesteps_since_restore": 6258367, "pid": 59703, "custom_metrics": {"outflow_rate_min": 841.122319061074, "system_level_velocity_min": 12.659875806584646, "cost1_max": 414.1022892960855, "cost2_max": -23.673857686907475, "cost2_min": -78.85167148339005, "outflow_rate_max": 1055.7171701003128, "system_level_velocity_mean": 14.727473222381239, "cost1_mean": 387.50739852582757, "cost2_mean": -39.36077232770935, "outflow_rate_mean": 924.6764875524434, "system_level_velocity_max": 15.744112657357215, "cost1_min": 329.61873123065595}, "policy_reward_mean": {}, "timesteps_this_iter": 44738, "training_iteration": 116, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436305, "hostname": "flow-main", "episode_reward_max": 997.6543846089288, "episode_reward_min": 855.5984129493881, "episodes_total": 3553, "time_since_restore": 4592.801763534546, "date": "2019-05-21_10-58-25", "time_total_s": 4592.801763534546, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32dd8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6258367, "sample_time_ms": 21025.011, "load_time_ms": 6.585, "grad_time_ms": 11128.514, "update_time_ms": 7.736, "default": {"policy_loss": -0.013287456706166267, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3406819701194763, "total_loss": 52.37696838378906, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 52.38536071777344, "kl": 0.01449443120509386, "entropy": 1.5577994585037231}, "num_steps_sampled": 6258367}, "episodes_this_iter": 35, "time_this_iter_s": 33.77553391456604}
{"episode_reward_mean": 922.7498125955531, "timesteps_total": 6302668, "iterations_since_restore": 117, "timesteps_since_restore": 6302668, "pid": 59703, "custom_metrics": {"outflow_rate_min": 841.3332520325202, "system_level_velocity_min": 12.86248907428269, "cost1_max": 415.55498571055085, "cost2_max": -26.27333750396702, "cost2_min": -78.85167148339005, "outflow_rate_max": 1055.7171701003128, "system_level_velocity_mean": 14.748958254896326, "cost1_mean": 387.91802697381155, "cost2_mean": -40.192103664566346, "outflow_rate_mean": 927.5145807430875, "system_level_velocity_max": 15.835005016434929, "cost1_min": 338.3610390741621}, "policy_reward_mean": {}, "timesteps_this_iter": 44301, "training_iteration": 117, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436339, "hostname": "flow-main", "episode_reward_max": 1002.9682085286446, "episode_reward_min": 865.8613456642948, "episodes_total": 3585, "time_since_restore": 4626.184345245361, "date": "2019-05-21_10-58-59", "time_total_s": 4626.184345245361, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0004e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2ff60>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6302668, "sample_time_ms": 21070.653, "load_time_ms": 6.658, "grad_time_ms": 11260.874, "update_time_ms": 7.613, "default": {"policy_loss": -0.01254623755812645, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.40694189071655273, "total_loss": 48.770503997802734, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 48.77825164794922, "kl": 0.014218299649655819, "entropy": 1.5786080360412598}, "num_steps_sampled": 6302668}, "episodes_this_iter": 32, "time_this_iter_s": 33.38258171081543}
{"episode_reward_mean": 930.3368900782662, "timesteps_total": 6347378, "iterations_since_restore": 118, "timesteps_since_restore": 6347378, "pid": 59703, "custom_metrics": {"outflow_rate_min": 841.3332520325202, "system_level_velocity_min": 12.86248907428269, "cost1_max": 415.55498571055085, "cost2_max": -26.288306199356523, "cost2_min": -87.38477182960767, "outflow_rate_max": 1055.7171701003128, "system_level_velocity_mean": 14.818456926738527, "cost1_mean": 389.56797589402066, "cost2_mean": -42.364676650949825, "outflow_rate_mean": 933.9127166670505, "system_level_velocity_max": 15.835005016434929, "cost1_min": 338.3610390741621}, "policy_reward_mean": {}, "timesteps_this_iter": 44710, "training_iteration": 118, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436373, "hostname": "flow-main", "episode_reward_max": 1004.3740794351455, "episode_reward_min": 865.6481714052882, "episodes_total": 3617, "time_since_restore": 4660.253487825394, "date": "2019-05-21_10-59-33", "time_total_s": 4660.253487825394, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbe10>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6347378, "sample_time_ms": 21126.324, "load_time_ms": 6.63, "grad_time_ms": 11310.842, "update_time_ms": 7.642, "default": {"policy_loss": -0.010694477707147598, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.35016292333602905, "total_loss": 53.406333923339844, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 53.41310119628906, "kl": 0.01163159403949976, "entropy": 1.5835517644882202}, "num_steps_sampled": 6347378}, "episodes_this_iter": 32, "time_this_iter_s": 34.06914258003235}
{"episode_reward_mean": 926.2530054417934, "timesteps_total": 6391495, "iterations_since_restore": 119, "timesteps_since_restore": 6391495, "pid": 59703, "custom_metrics": {"outflow_rate_min": 489.92492200470633, "system_level_velocity_min": 12.86248907428269, "cost1_max": 416.7931430590562, "cost2_max": -16.517361276262115, "cost2_min": -87.38477182960767, "outflow_rate_max": 1050.3445101225727, "system_level_velocity_mean": 14.972276821050288, "cost1_mean": 388.83375492367463, "cost2_mean": -42.160684961722566, "outflow_rate_mean": 935.9889935460141, "system_level_velocity_max": 17.60113073465202, "cost1_min": 17.808135860459863}, "policy_reward_mean": {}, "timesteps_this_iter": 44117, "training_iteration": 119, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436405, "hostname": "flow-main", "episode_reward_max": 1004.3740794351455, "episode_reward_min": 43.15020597981159, "episodes_total": 3649, "time_since_restore": 4691.947109699249, "date": "2019-05-21_11-00-05", "time_total_s": 4691.947109699249, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf320b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32fd0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.27, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6391495, "sample_time_ms": 21054.701, "load_time_ms": 6.663, "grad_time_ms": 11247.773, "update_time_ms": 7.72, "default": {"policy_loss": -0.011598560027778149, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2204015851020813, "total_loss": 58.788936614990234, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 58.79604721069336, "kl": 0.013304732739925385, "entropy": 1.592682957649231}, "num_steps_sampled": 6391495}, "episodes_this_iter": 32, "time_this_iter_s": 31.69362187385559}
{"episode_reward_mean": 931.5984690870496, "timesteps_total": 6435531, "iterations_since_restore": 120, "timesteps_since_restore": 6435531, "pid": 59703, "custom_metrics": {"outflow_rate_min": 489.92492200470633, "system_level_velocity_min": 13.474082545258565, "cost1_max": 421.45775180072746, "cost2_max": -16.517361276262115, "cost2_min": -87.38477182960767, "outflow_rate_max": 1050.3445101225727, "system_level_velocity_mean": 15.0894915821095, "cost1_mean": 391.83954157743415, "cost2_mean": -42.16479908742401, "outflow_rate_mean": 940.5143039760352, "system_level_velocity_max": 17.60113073465202, "cost1_min": 17.808135860459863}, "policy_reward_mean": {}, "timesteps_this_iter": 44036, "training_iteration": 120, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436438, "hostname": "flow-main", "episode_reward_max": 1008.286856894323, "episode_reward_min": 43.15020597981159, "episodes_total": 3683, "time_since_restore": 4725.037089347839, "date": "2019-05-21_11-00-38", "time_total_s": 4725.037089347839, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbd30>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.27, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6435531, "sample_time_ms": 21091.742, "load_time_ms": 6.582, "grad_time_ms": 11352.224, "update_time_ms": 7.736, "default": {"policy_loss": -0.00831338670104742, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.318238765001297, "total_loss": 57.42374801635742, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 57.42826843261719, "kl": 0.011232122778892517, "entropy": 1.6113193035125732}, "num_steps_sampled": 6435531}, "episodes_this_iter": 34, "time_this_iter_s": 33.08997964859009}
{"episode_reward_mean": 935.010316915641, "timesteps_total": 6479707, "iterations_since_restore": 121, "timesteps_since_restore": 6479707, "pid": 59703, "custom_metrics": {"outflow_rate_min": 489.92492200470633, "system_level_velocity_min": 13.561374506759352, "cost1_max": 424.35616083411867, "cost2_max": -16.517361276262115, "cost2_min": -70.06833234018046, "outflow_rate_max": 1049.9178536585366, "system_level_velocity_mean": 15.18180004797395, "cost1_mean": 394.34084555009633, "cost2_mean": -40.393698944091746, "outflow_rate_mean": 942.9564994134984, "system_level_velocity_max": 17.60113073465202, "cost1_min": 17.808135860459863}, "policy_reward_mean": {}, "timesteps_this_iter": 44176, "training_iteration": 121, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436469, "hostname": "flow-main", "episode_reward_max": 1012.6382067523759, "episode_reward_min": 43.15020597981159, "episodes_total": 3714, "time_since_restore": 4755.86727309227, "date": "2019-05-21_11-01-09", "time_total_s": 4755.86727309227, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32da0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.27, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6479707, "sample_time_ms": 20858.37, "load_time_ms": 6.671, "grad_time_ms": 11383.368, "update_time_ms": 7.384, "default": {"policy_loss": -0.010064659640192986, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.25906068086624146, "total_loss": 55.06846618652344, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 55.07439041137695, "kl": 0.012279770337045193, "entropy": 1.6185239553451538}, "num_steps_sampled": 6479707}, "episodes_this_iter": 31, "time_this_iter_s": 30.830183744430542}
{"episode_reward_mean": 955.1161201464769, "timesteps_total": 6524163, "iterations_since_restore": 122, "timesteps_since_restore": 6524163, "pid": 59703, "custom_metrics": {"outflow_rate_min": 854.9800817307689, "system_level_velocity_min": 13.561374506759352, "cost1_max": 424.35616083411867, "cost2_max": -26.94491114857476, "cost2_min": -66.37959090085859, "outflow_rate_max": 1088.9980630797772, "system_level_velocity_mean": 15.192087855289865, "cost1_mean": 399.21949532756764, "cost2_mean": -40.12003776889504, "outflow_rate_mean": 957.0336454669164, "system_level_velocity_max": 16.17680805538896, "cost1_min": 356.949957964091}, "policy_reward_mean": {}, "timesteps_this_iter": 44456, "training_iteration": 122, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436502, "hostname": "flow-main", "episode_reward_max": 1028.6907726221277, "episode_reward_min": 867.5495603561629, "episodes_total": 3746, "time_since_restore": 4788.754070281982, "date": "2019-05-21_11-01-42", "time_total_s": 4788.754070281982, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf320f0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6524163, "sample_time_ms": 21057.235, "load_time_ms": 6.624, "grad_time_ms": 11361.756, "update_time_ms": 7.411, "default": {"policy_loss": -0.009555516764521599, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.17037120461463928, "total_loss": 62.17217254638672, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 62.17778396606445, "kl": 0.011683924123644829, "entropy": 1.6218857765197754}, "num_steps_sampled": 6524163}, "episodes_this_iter": 32, "time_this_iter_s": 32.886797189712524}
{"episode_reward_mean": 965.5061175300029, "timesteps_total": 6569138, "iterations_since_restore": 123, "timesteps_since_restore": 6569138, "pid": 59703, "custom_metrics": {"outflow_rate_min": 854.9800817307689, "system_level_velocity_min": 13.561374506759352, "cost1_max": 424.35616083411867, "cost2_max": -26.94491114857476, "cost2_min": -72.76521493172456, "outflow_rate_max": 1088.9980630797772, "system_level_velocity_mean": 15.1835368903126, "cost1_mean": 399.34456156987915, "cost2_mean": -40.88687919846321, "outflow_rate_mean": 968.8027792173423, "system_level_velocity_max": 16.17680805538896, "cost1_min": 356.949957964091}, "policy_reward_mean": {}, "timesteps_this_iter": 44975, "training_iteration": 123, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436534, "hostname": "flow-main", "episode_reward_max": 1057.3409006216357, "episode_reward_min": 883.5782779691971, "episodes_total": 3777, "time_since_restore": 4821.457183122635, "date": "2019-05-21_11-02-14", "time_total_s": 4821.457183122635, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32320>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6569138, "sample_time_ms": 21117.938, "load_time_ms": 6.621, "grad_time_ms": 11410.773, "update_time_ms": 7.321, "default": {"policy_loss": -0.011944318190217018, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.34592464566230774, "total_loss": 52.622596740722656, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 52.63037109375, "kl": 0.012355931103229523, "entropy": 1.6248327493667603}, "num_steps_sampled": 6569138}, "episodes_this_iter": 31, "time_this_iter_s": 32.703112840652466}
{"episode_reward_mean": 964.2593353412676, "timesteps_total": 6613421, "iterations_since_restore": 124, "timesteps_since_restore": 6613421, "pid": 59703, "custom_metrics": {"outflow_rate_min": 874.7288662131521, "system_level_velocity_min": 13.450687359020261, "cost1_max": 418.94390078830185, "cost2_max": -26.693401639070558, "cost2_min": -75.82883957424092, "outflow_rate_max": 1088.9980630797772, "system_level_velocity_mean": 15.108692930725395, "cost1_mean": 397.432754366163, "cost2_mean": -42.58549776410421, "outflow_rate_mean": 970.890880200595, "system_level_velocity_max": 15.953942811850757, "cost1_min": 353.2483384927659}, "policy_reward_mean": {}, "timesteps_this_iter": 44283, "training_iteration": 124, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436566, "hostname": "flow-main", "episode_reward_max": 1057.3409006216357, "episode_reward_min": 880.2840706143826, "episodes_total": 3808, "time_since_restore": 4853.03059720993, "date": "2019-05-21_11-02-46", "time_total_s": 4853.03059720993, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32a90>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6613421, "sample_time_ms": 21053.822, "load_time_ms": 6.708, "grad_time_ms": 11470.343, "update_time_ms": 7.222, "default": {"policy_loss": -0.011363341473042965, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.25546371936798096, "total_loss": 56.16810989379883, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 56.17523956298828, "kl": 0.012567529454827309, "entropy": 1.6189460754394531}, "num_steps_sampled": 6613421}, "episodes_this_iter": 31, "time_this_iter_s": 31.573414087295532}
{"episode_reward_mean": 950.1357827107735, "timesteps_total": 6658154, "iterations_since_restore": 125, "timesteps_since_restore": 6658154, "pid": 59703, "custom_metrics": {"outflow_rate_min": 873.9426324786326, "system_level_velocity_min": 13.291220401155936, "cost1_max": 419.5006290710048, "cost2_max": -26.693401639070558, "cost2_min": -75.82883957424092, "outflow_rate_max": 1109.3506409687875, "system_level_velocity_mean": 15.001766594208805, "cost1_mean": 393.0653644141704, "cost2_mean": -44.86159633157048, "outflow_rate_mean": 960.69499386723, "system_level_velocity_max": 16.08066700839291, "cost1_min": 255.7458649396193}, "policy_reward_mean": {}, "timesteps_this_iter": 44733, "training_iteration": 125, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436598, "hostname": "flow-main", "episode_reward_max": 1057.3409006216357, "episode_reward_min": 609.2143103665611, "episodes_total": 3843, "time_since_restore": 4885.003131389618, "date": "2019-05-21_11-03-18", "time_total_s": 4885.003131389618, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fe10>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 697.77, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6658154, "sample_time_ms": 21085.347, "load_time_ms": 6.897, "grad_time_ms": 11414.513, "update_time_ms": 7.379, "default": {"policy_loss": -0.012498023919761181, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3321242928504944, "total_loss": 52.533164978027344, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 52.54106521606445, "kl": 0.013601581566035748, "entropy": 1.6206245422363281}, "num_steps_sampled": 6658154}, "episodes_this_iter": 35, "time_this_iter_s": 31.9725341796875}
{"episode_reward_mean": 939.7109043170007, "timesteps_total": 6703050, "iterations_since_restore": 126, "timesteps_since_restore": 6703050, "pid": 59703, "custom_metrics": {"outflow_rate_min": 873.9426324786326, "system_level_velocity_min": 13.291220401155936, "cost1_max": 424.510757102772, "cost2_max": -26.693401639070558, "cost2_min": -87.21787745248506, "outflow_rate_max": 1109.3506409687875, "system_level_velocity_mean": 14.893106986749114, "cost1_mean": 389.7688171337512, "cost2_mean": -46.747594155093545, "outflow_rate_mean": 954.0816259153493, "system_level_velocity_max": 16.190139732622622, "cost1_min": 255.7458649396193}, "policy_reward_mean": {}, "timesteps_this_iter": 44896, "training_iteration": 126, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436631, "hostname": "flow-main", "episode_reward_max": 1055.9545912834953, "episode_reward_min": 609.2143103665611, "episodes_total": 3877, "time_since_restore": 4917.934794425964, "date": "2019-05-21_11-03-51", "time_total_s": 4917.934794425964, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfc8128>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 697.77, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6703050, "sample_time_ms": 21014.067, "load_time_ms": 7.095, "grad_time_ms": 11400.2, "update_time_ms": 7.399, "default": {"policy_loss": -0.011733722873032093, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2711750268936157, "total_loss": 54.73185348510742, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 54.73906707763672, "kl": 0.013393760658800602, "entropy": 1.6221195459365845}, "num_steps_sampled": 6703050}, "episodes_this_iter": 34, "time_this_iter_s": 32.931663036346436}
{"episode_reward_mean": 933.1892034755415, "timesteps_total": 6747549, "iterations_since_restore": 127, "timesteps_since_restore": 6747549, "pid": 59703, "custom_metrics": {"outflow_rate_min": 834.4318666002983, "system_level_velocity_min": 13.291220401155936, "cost1_max": 424.510757102772, "cost2_max": -28.755761408995966, "cost2_min": -87.21787745248506, "outflow_rate_max": 1109.3506409687875, "system_level_velocity_mean": 14.890246269114964, "cost1_mean": 389.3872214923522, "cost2_mean": -46.599544810400566, "outflow_rate_mean": 944.1848998038852, "system_level_velocity_max": 16.190139732622622, "cost1_min": 255.7458649396193}, "policy_reward_mean": {}, "timesteps_this_iter": 44499, "training_iteration": 127, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436663, "hostname": "flow-main", "episode_reward_max": 1055.9545912834953, "episode_reward_min": 609.2143103665611, "episodes_total": 3908, "time_since_restore": 4949.894287109375, "date": "2019-05-21_11-04-23", "time_total_s": 4949.894287109375, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f710>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 697.77, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6747549, "sample_time_ms": 20974.137, "load_time_ms": 6.942, "grad_time_ms": 11298.989, "update_time_ms": 7.435, "default": {"policy_loss": -0.011662429198622704, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.34648647904396057, "total_loss": 47.921871185302734, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 47.928871154785156, "kl": 0.01381002739071846, "entropy": 1.6263278722763062}, "num_steps_sampled": 6747549}, "episodes_this_iter": 31, "time_this_iter_s": 31.959492683410645}
{"episode_reward_mean": 924.3163480916176, "timesteps_total": 6792442, "iterations_since_restore": 128, "timesteps_since_restore": 6792442, "pid": 59703, "custom_metrics": {"outflow_rate_min": 794.3889552238808, "system_level_velocity_min": 13.376059970419202, "cost1_max": 424.510757102772, "cost2_max": -27.84608438707982, "cost2_min": -87.21787745248506, "outflow_rate_max": 1092.3557172897913, "system_level_velocity_mean": 14.926037274939336, "cost1_mean": 391.4067054044943, "cost2_mean": -44.87097926296964, "outflow_rate_mean": 928.3740040448597, "system_level_velocity_max": 16.190139732622622, "cost1_min": 344.6355187467891}, "policy_reward_mean": {}, "timesteps_this_iter": 44893, "training_iteration": 128, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436695, "hostname": "flow-main", "episode_reward_max": 1010.0322922191413, "episode_reward_min": 845.198319280125, "episodes_total": 3940, "time_since_restore": 4981.886100769043, "date": "2019-05-21_11-04-55", "time_total_s": 4981.886100769043, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdee10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde668>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6792442, "sample_time_ms": 20758.501, "load_time_ms": 7.03, "grad_time_ms": 11307.236, "update_time_ms": 7.39, "default": {"policy_loss": -0.011474682949483395, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.27524301409721375, "total_loss": 47.052879333496094, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 47.05990982055664, "kl": 0.013182021677494049, "entropy": 1.6444416046142578}, "num_steps_sampled": 6792442}, "episodes_this_iter": 32, "time_this_iter_s": 31.99181365966797}
{"episode_reward_mean": 916.443588067952, "timesteps_total": 6837631, "iterations_since_restore": 129, "timesteps_since_restore": 6837631, "pid": 59703, "custom_metrics": {"outflow_rate_min": 794.3889552238808, "system_level_velocity_min": 13.376059970419202, "cost1_max": 418.4190978857364, "cost2_max": -27.84608438707982, "cost2_min": -77.33577471908498, "outflow_rate_max": 1037.917603686636, "system_level_velocity_mean": 14.933282506653393, "cost1_mean": 391.6913037488659, "cost2_mean": -43.33676099879199, "outflow_rate_mean": 913.156547897977, "system_level_velocity_max": 16.162753246758506, "cost1_min": 352.38111141329114}, "policy_reward_mean": {}, "timesteps_this_iter": 45189, "training_iteration": 129, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436727, "hostname": "flow-main", "episode_reward_max": 999.5451747341046, "episode_reward_min": 845.198319280125, "episodes_total": 3971, "time_since_restore": 5013.899981975555, "date": "2019-05-21_11-05-27", "time_total_s": 5013.899981975555, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fbe0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6837631, "sample_time_ms": 20773.665, "load_time_ms": 7.051, "grad_time_ms": 11324.344, "update_time_ms": 7.379, "default": {"policy_loss": -0.013267534784972668, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3653538227081299, "total_loss": 47.06541442871094, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 47.073875427246094, "kl": 0.014251049607992172, "entropy": 1.6173187494277954}, "num_steps_sampled": 6837631}, "episodes_this_iter": 31, "time_this_iter_s": 32.01388120651245}
{"episode_reward_mean": 911.1811133135277, "timesteps_total": 6881556, "iterations_since_restore": 130, "timesteps_since_restore": 6881556, "pid": 59703, "custom_metrics": {"outflow_rate_min": 794.3889552238808, "system_level_velocity_min": 13.39949279069583, "cost1_max": 419.7547887331051, "cost2_max": -25.37578729413618, "cost2_min": -77.33577471908498, "outflow_rate_max": 1061.3564143763213, "system_level_velocity_mean": 14.847339657817768, "cost1_mean": 389.5052467553993, "cost2_mean": -43.524038502211624, "outflow_rate_mean": 908.211958958776, "system_level_velocity_max": 16.17868317886494, "cost1_min": 345.58121811458756}, "policy_reward_mean": {}, "timesteps_this_iter": 43925, "training_iteration": 130, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436760, "hostname": "flow-main", "episode_reward_max": 993.890182075471, "episode_reward_min": 845.198319280125, "episodes_total": 4005, "time_since_restore": 5047.178973674774, "date": "2019-05-21_11-06-00", "time_total_s": 5047.178973674774, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0009e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32c50>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6881556, "sample_time_ms": 20871.586, "load_time_ms": 7.246, "grad_time_ms": 11244.827, "update_time_ms": 7.298, "default": {"policy_loss": -0.011612643487751484, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2445785254240036, "total_loss": 54.000911712646484, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 54.00769805908203, "kl": 0.014282121323049068, "entropy": 1.6432101726531982}, "num_steps_sampled": 6881556}, "episodes_this_iter": 34, "time_this_iter_s": 33.27899169921875}
{"episode_reward_mean": 914.3999394036089, "timesteps_total": 6926293, "iterations_since_restore": 131, "timesteps_since_restore": 6926293, "pid": 59703, "custom_metrics": {"outflow_rate_min": 804.0075590551179, "system_level_velocity_min": 11.881619071013576, "cost1_max": 424.57540084822625, "cost2_max": -25.37578729413618, "cost2_min": -82.03311836195421, "outflow_rate_max": 1097.7938859368844, "system_level_velocity_mean": 14.73275894811498, "cost1_mean": 386.6635585433879, "cost2_mean": -45.3921297653005, "outflow_rate_mean": 916.8109805157577, "system_level_velocity_max": 16.376912985571973, "cost1_min": 310.9115963056997}, "policy_reward_mean": {}, "timesteps_this_iter": 44737, "training_iteration": 131, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436792, "hostname": "flow-main", "episode_reward_max": 1011.2865975984714, "episode_reward_min": 845.3550378341253, "episodes_total": 4037, "time_since_restore": 5078.637978315353, "date": "2019-05-21_11-06-32", "time_total_s": 5078.637978315353, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbcc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb390>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6926293, "sample_time_ms": 20921.146, "load_time_ms": 7.284, "grad_time_ms": 11256.597, "update_time_ms": 7.532, "default": {"policy_loss": -0.011190779507160187, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.28888776898384094, "total_loss": 54.80128479003906, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 54.80809020996094, "kl": 0.012990311719477177, "entropy": 1.6234074831008911}, "num_steps_sampled": 6926293}, "episodes_this_iter": 32, "time_this_iter_s": 31.459004640579224}
{"episode_reward_mean": 904.9191127692169, "timesteps_total": 6970633, "iterations_since_restore": 132, "timesteps_since_restore": 6970633, "pid": 59703, "custom_metrics": {"outflow_rate_min": 487.4942679513799, "system_level_velocity_min": 11.881619071013576, "cost1_max": 424.57540084822625, "cost2_max": -19.145665709745273, "cost2_min": -82.03311836195421, "outflow_rate_max": 1097.7938859368844, "system_level_velocity_mean": 14.75853398768515, "cost1_mean": 382.750575979958, "cost2_mean": -45.12435592807959, "outflow_rate_mean": 911.4976704232187, "system_level_velocity_max": 18.262519127768595, "cost1_min": 23.833915027715957}, "policy_reward_mean": {}, "timesteps_this_iter": 44340, "training_iteration": 132, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436823, "hostname": "flow-main", "episode_reward_max": 1011.2865975984714, "episode_reward_min": 59.78242750650617, "episodes_total": 4069, "time_since_restore": 5109.738373994827, "date": "2019-05-21_11-07-03", "time_total_s": 5109.738373994827, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbfd0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.37, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 6970633, "sample_time_ms": 20782.223, "load_time_ms": 7.328, "grad_time_ms": 11216.57, "update_time_ms": 7.599, "default": {"policy_loss": -0.013491719961166382, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3445196747779846, "total_loss": 46.51881408691406, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 46.527252197265625, "kl": 0.014976042322814465, "entropy": 1.6188735961914062}, "num_steps_sampled": 6970633}, "episodes_this_iter": 32, "time_this_iter_s": 31.100395679473877}
{"episode_reward_mean": 904.2656411307316, "timesteps_total": 7014566, "iterations_since_restore": 133, "timesteps_since_restore": 7014566, "pid": 59703, "custom_metrics": {"outflow_rate_min": 487.4942679513799, "system_level_velocity_min": 11.881619071013576, "cost1_max": 424.57540084822625, "cost2_max": -19.145665709745273, "cost2_min": -82.03311836195421, "outflow_rate_max": 1097.7938859368844, "system_level_velocity_mean": 14.821060805282645, "cost1_mean": 384.619240484257, "cost2_mean": -43.38538431201833, "outflow_rate_mean": 911.1122041210491, "system_level_velocity_max": 18.262519127768595, "cost1_min": 23.833915027715957}, "policy_reward_mean": {}, "timesteps_this_iter": 43933, "training_iteration": 133, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436855, "hostname": "flow-main", "episode_reward_max": 1011.2865975984714, "episode_reward_min": 59.78242750650617, "episodes_total": 4101, "time_since_restore": 5141.957075119019, "date": "2019-05-21_11-07-35", "time_total_s": 5141.957075119019, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf320f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32c50>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.37, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7014566, "sample_time_ms": 20753.778, "load_time_ms": 7.385, "grad_time_ms": 11196.896, "update_time_ms": 7.613, "default": {"policy_loss": -0.012814961373806, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.30643269419670105, "total_loss": 49.76459503173828, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 49.772640228271484, "kl": 0.014116908423602581, "entropy": 1.6121349334716797}, "num_steps_sampled": 7014566}, "episodes_this_iter": 32, "time_this_iter_s": 32.218701124191284}
{"episode_reward_mean": 906.4114325410561, "timesteps_total": 7059476, "iterations_since_restore": 134, "timesteps_since_restore": 7059476, "pid": 59703, "custom_metrics": {"outflow_rate_min": 487.4942679513799, "system_level_velocity_min": 12.095167280381075, "cost1_max": 418.71980989802387, "cost2_max": -19.145665709745273, "cost2_min": -77.58931987054281, "outflow_rate_max": 1038.4527692307693, "system_level_velocity_mean": 14.892086752964328, "cost1_mean": 386.7164637286782, "cost2_mean": -40.856704590133575, "outflow_rate_mean": 910.5335960964952, "system_level_velocity_max": 18.262519127768595, "cost1_min": 23.833915027715957}, "policy_reward_mean": {}, "timesteps_this_iter": 44910, "training_iteration": 134, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436888, "hostname": "flow-main", "episode_reward_max": 1001.3583943249661, "episode_reward_min": 59.78242750650617, "episodes_total": 4135, "time_since_restore": 5174.049661874771, "date": "2019-05-21_11-08-08", "time_total_s": 5174.049661874771, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc860>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.37, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7059476, "sample_time_ms": 20809.238, "load_time_ms": 7.442, "grad_time_ms": 11192.491, "update_time_ms": 7.634, "default": {"policy_loss": -0.011097604408860207, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.317249059677124, "total_loss": 49.64975357055664, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 49.656639099121094, "kl": 0.012475240044295788, "entropy": 1.5999269485473633}, "num_steps_sampled": 7059476}, "episodes_this_iter": 34, "time_this_iter_s": 32.09258675575256}
{"episode_reward_mean": 923.2825338542154, "timesteps_total": 7104281, "iterations_since_restore": 135, "timesteps_since_restore": 7104281, "pid": 59703, "custom_metrics": {"outflow_rate_min": 819.8415975609756, "system_level_velocity_min": 13.385953198452695, "cost1_max": 418.15655310792636, "cost2_max": -27.709050554723536, "cost2_min": -75.68167078552776, "outflow_rate_max": 1078.0206334310851, "system_level_velocity_mean": 14.83267690635563, "cost1_mean": 390.4233520263462, "cost2_mean": -40.400008132530175, "outflow_rate_mean": 923.2722510403703, "system_level_velocity_max": 15.834309624093322, "cost1_min": 353.2308924162912}, "policy_reward_mean": {}, "timesteps_this_iter": 44805, "training_iteration": 135, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436918, "hostname": "flow-main", "episode_reward_max": 1017.1795229480429, "episode_reward_min": 866.0639955623143, "episodes_total": 4166, "time_since_restore": 5204.824402093887, "date": "2019-05-21_11-08-38", "time_total_s": 5204.824402093887, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c1d0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7104281, "sample_time_ms": 20720.512, "load_time_ms": 7.096, "grad_time_ms": 11163.539, "update_time_ms": 7.592, "default": {"policy_loss": -0.010729292407631874, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.30219775438308716, "total_loss": 49.63140106201172, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 49.63772201538086, "kl": 0.013067704625427723, "entropy": 1.6188244819641113}, "num_steps_sampled": 7104281}, "episodes_this_iter": 31, "time_this_iter_s": 30.77474021911621}
{"episode_reward_mean": 925.9718419278324, "timesteps_total": 7148336, "iterations_since_restore": 136, "timesteps_since_restore": 7148336, "pid": 59703, "custom_metrics": {"outflow_rate_min": 849.1233041158534, "system_level_velocity_min": 13.385953198452695, "cost1_max": 418.15655310792636, "cost2_max": -25.763830280865136, "cost2_min": -75.68167078552776, "outflow_rate_max": 1078.0206334310851, "system_level_velocity_mean": 14.769040662934644, "cost1_mean": 388.8791567684147, "cost2_mean": -40.60329787785692, "outflow_rate_mean": 923.5467055550121, "system_level_velocity_max": 15.834309624093322, "cost1_min": 353.2308924162912}, "policy_reward_mean": {}, "timesteps_this_iter": 44055, "training_iteration": 136, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436949, "hostname": "flow-main", "episode_reward_max": 1017.1795229480429, "episode_reward_min": 866.0639955623143, "episodes_total": 4197, "time_since_restore": 5235.827560663223, "date": "2019-05-21_11-09-09", "time_total_s": 5235.827560663223, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ccf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c2e8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7148336, "sample_time_ms": 20531.973, "load_time_ms": 7.031, "grad_time_ms": 11159.539, "update_time_ms": 7.585, "default": {"policy_loss": -0.011996820569038391, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.310222327709198, "total_loss": 46.364036560058594, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 46.37144470214844, "kl": 0.013595658354461193, "entropy": 1.6332721710205078}, "num_steps_sampled": 7148336}, "episodes_this_iter": 31, "time_this_iter_s": 31.003158569335938}
{"episode_reward_mean": 920.7574421964528, "timesteps_total": 7191917, "iterations_since_restore": 137, "timesteps_since_restore": 7191917, "pid": 59703, "custom_metrics": {"outflow_rate_min": 818.1716666666666, "system_level_velocity_min": 13.366844648115658, "cost1_max": 418.15655310792636, "cost2_max": -25.49187466709821, "cost2_min": -57.4553164355396, "outflow_rate_max": 1078.0206334310851, "system_level_velocity_mean": 14.792385821339169, "cost1_mean": 389.3387690622147, "cost2_mean": -38.465758480200094, "outflow_rate_mean": 915.7621637871641, "system_level_velocity_max": 15.834309624093322, "cost1_min": 350.4347342886277}, "policy_reward_mean": {}, "timesteps_this_iter": 43581, "training_iteration": 137, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558436980, "hostname": "flow-main", "episode_reward_max": 1017.1795229480429, "episode_reward_min": 808.5028101159345, "episodes_total": 4229, "time_since_restore": 5266.2148859500885, "date": "2019-05-21_11-09-40", "time_total_s": 5266.2148859500885, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb048>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7191917, "sample_time_ms": 20406.593, "load_time_ms": 7.185, "grad_time_ms": 11127.023, "update_time_ms": 7.525, "default": {"policy_loss": -0.01013137400150299, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.255400151014328, "total_loss": 51.03728103637695, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 51.043094635009766, "kl": 0.012778930366039276, "entropy": 1.6305402517318726}, "num_steps_sampled": 7191917}, "episodes_this_iter": 32, "time_this_iter_s": 30.387325286865234}
{"episode_reward_mean": 911.9762698685482, "timesteps_total": 7236904, "iterations_since_restore": 138, "timesteps_since_restore": 7236904, "pid": 59703, "custom_metrics": {"outflow_rate_min": 747.7559070498429, "system_level_velocity_min": 11.236301894109866, "cost1_max": 414.1456856163776, "cost2_max": -25.49187466709821, "cost2_min": -57.153394234990785, "outflow_rate_max": 1038.6480747663552, "system_level_velocity_mean": 14.778906955294767, "cost1_mean": 388.7700401236023, "cost2_mean": -37.585325073961656, "outflow_rate_mean": 905.9151383418709, "system_level_velocity_max": 15.725816529141861, "cost1_min": 296.2693310745184}, "policy_reward_mean": {}, "timesteps_this_iter": 44987, "training_iteration": 138, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437012, "hostname": "flow-main", "episode_reward_max": 998.0422935351272, "episode_reward_min": 808.5028101159345, "episodes_total": 4263, "time_since_restore": 5298.429834365845, "date": "2019-05-21_11-10-12", "time_total_s": 5298.429834365845, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfde1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbfd0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7236904, "sample_time_ms": 20476.79, "load_time_ms": 7.082, "grad_time_ms": 11079.971, "update_time_ms": 7.515, "default": {"policy_loss": -0.012426521629095078, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.332210510969162, "total_loss": 45.47348403930664, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 45.48122024536133, "kl": 0.013892523013055325, "entropy": 1.64907705783844}, "num_steps_sampled": 7236904}, "episodes_this_iter": 34, "time_this_iter_s": 32.214948415756226}
{"episode_reward_mean": 903.0092624912484, "timesteps_total": 7281887, "iterations_since_restore": 139, "timesteps_since_restore": 7281887, "pid": 59703, "custom_metrics": {"outflow_rate_min": 747.7559070498429, "system_level_velocity_min": 11.236301894109866, "cost1_max": 414.1456856163776, "cost2_max": -24.61053071927748, "cost2_min": -64.82954604092942, "outflow_rate_max": 1027.6687931483896, "system_level_velocity_mean": 14.786028489357962, "cost1_mean": 388.9886387608877, "cost2_mean": -36.65176822676932, "outflow_rate_mean": 893.6277419264105, "system_level_velocity_max": 15.725816529141861, "cost1_min": 296.2693310745184}, "policy_reward_mean": {}, "timesteps_this_iter": 44983, "training_iteration": 139, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437043, "hostname": "flow-main", "episode_reward_max": 990.2371594737025, "episode_reward_min": 800.675370958639, "episodes_total": 4296, "time_since_restore": 5329.484324932098, "date": "2019-05-21_11-10-43", "time_total_s": 5329.484324932098, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdb208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfdbe80>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7281887, "sample_time_ms": 20499.954, "load_time_ms": 6.878, "grad_time_ms": 10960.383, "update_time_ms": 7.412, "default": {"policy_loss": -0.009986033663153648, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.26717549562454224, "total_loss": 49.3687858581543, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 49.37445068359375, "kl": 0.012814999558031559, "entropy": 1.640079379081726}, "num_steps_sampled": 7281887}, "episodes_this_iter": 33, "time_this_iter_s": 31.054490566253662}
{"episode_reward_mean": 892.821238313599, "timesteps_total": 7325797, "iterations_since_restore": 140, "timesteps_since_restore": 7325797, "pid": 59703, "custom_metrics": {"outflow_rate_min": 747.7559070498429, "system_level_velocity_min": 11.236301894109866, "cost1_max": 412.44589428046237, "cost2_max": -21.897999177724266, "cost2_min": -64.8501141655525, "outflow_rate_max": 1011.2527627494454, "system_level_velocity_mean": 14.711419412766006, "cost1_mean": 387.2471551006532, "cost2_mean": -35.827217827144366, "outflow_rate_mean": 880.8574514222056, "system_level_velocity_max": 15.694720022869694, "cost1_min": 296.2693310745184}, "policy_reward_mean": {}, "timesteps_this_iter": 43910, "training_iteration": 140, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437075, "hostname": "flow-main", "episode_reward_max": 990.2371594737025, "episode_reward_min": 800.675370958639, "episodes_total": 4331, "time_since_restore": 5361.200563430786, "date": "2019-05-21_11-11-15", "time_total_s": 5361.200563430786, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cf98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ce10>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7325797, "sample_time_ms": 20380.342, "load_time_ms": 6.805, "grad_time_ms": 10924.356, "update_time_ms": 7.51, "default": {"policy_loss": -0.010326262563467026, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.20720985531806946, "total_loss": 53.20909118652344, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 53.21507263183594, "kl": 0.012876343913376331, "entropy": 1.6546274423599243}, "num_steps_sampled": 7325797}, "episodes_this_iter": 35, "time_this_iter_s": 31.716238498687744}
{"episode_reward_mean": 883.3735593038062, "timesteps_total": 7369812, "iterations_since_restore": 141, "timesteps_since_restore": 7369812, "pid": 59703, "custom_metrics": {"outflow_rate_min": 771.937643020595, "system_level_velocity_min": 12.715935100289618, "cost1_max": 416.62752796073, "cost2_max": -21.897999177724266, "cost2_min": -64.8501141655525, "outflow_rate_max": 955.9312893401016, "system_level_velocity_mean": 14.677107647889319, "cost1_mean": 386.1927615328431, "cost2_mean": -34.21688849951225, "outflow_rate_mean": 868.5533948364604, "system_level_velocity_max": 15.825947776454882, "cost1_min": 330.76166392753476}, "policy_reward_mean": {}, "timesteps_this_iter": 44015, "training_iteration": 141, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437106, "hostname": "flow-main", "episode_reward_max": 976.3553351321953, "episode_reward_min": 800.675370958639, "episodes_total": 4364, "time_since_restore": 5391.854381561279, "date": "2019-05-21_11-11-46", "time_total_s": 5391.854381561279, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ceb8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7369812, "sample_time_ms": 20331.221, "load_time_ms": 6.527, "grad_time_ms": 10894.133, "update_time_ms": 7.453, "default": {"policy_loss": -0.009306843392550945, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.20915113389492035, "total_loss": 48.262413024902344, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 48.267601013183594, "kl": 0.012210282497107983, "entropy": 1.655021071434021}, "num_steps_sampled": 7369812}, "episodes_this_iter": 33, "time_this_iter_s": 30.653818130493164}
{"episode_reward_mean": 876.6024154489243, "timesteps_total": 7413983, "iterations_since_restore": 142, "timesteps_since_restore": 7413983, "pid": 59703, "custom_metrics": {"outflow_rate_min": 738.7281407035177, "system_level_velocity_min": 12.715935100289618, "cost1_max": 416.62752796073, "cost2_max": -21.897999177724266, "cost2_min": -64.8501141655525, "outflow_rate_max": 947.3128240569184, "system_level_velocity_mean": 14.668994401428463, "cost1_mean": 385.74434849787554, "cost2_mean": -33.58876298834943, "outflow_rate_mean": 862.1423828380946, "system_level_velocity_max": 15.825947776454882, "cost1_min": 330.76166392753476}, "policy_reward_mean": {}, "timesteps_this_iter": 44171, "training_iteration": 142, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437137, "hostname": "flow-main", "episode_reward_max": 929.6724363130224, "episode_reward_min": 805.4999885327436, "episodes_total": 4397, "time_since_restore": 5423.417429924011, "date": "2019-05-21_11-12-17", "time_total_s": 5423.417429924011, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cf28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cf60>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7413983, "sample_time_ms": 20308.201, "load_time_ms": 6.515, "grad_time_ms": 10962.753, "update_time_ms": 7.474, "default": {"policy_loss": -0.010191150940954685, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.18869748711585999, "total_loss": 50.61517333984375, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 50.620792388916016, "kl": 0.013558296486735344, "entropy": 1.6566883325576782}, "num_steps_sampled": 7413983}, "episodes_this_iter": 33, "time_this_iter_s": 31.563048362731934}
{"episode_reward_mean": 876.0081597174478, "timesteps_total": 7458621, "iterations_since_restore": 143, "timesteps_since_restore": 7458621, "pid": 59703, "custom_metrics": {"outflow_rate_min": 738.7281407035177, "system_level_velocity_min": 12.715935100289618, "cost1_max": 416.62752796073, "cost2_max": -24.30892588292509, "cost2_min": -63.518150272194234, "outflow_rate_max": 947.3128240569184, "system_level_velocity_mean": 14.678883163700586, "cost1_mean": 385.61244636933645, "cost2_mean": -34.436517204661016, "outflow_rate_mean": 862.8529265939293, "system_level_velocity_max": 15.825947776454882, "cost1_min": 330.76166392753476}, "policy_reward_mean": {}, "timesteps_this_iter": 44638, "training_iteration": 143, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437169, "hostname": "flow-main", "episode_reward_max": 938.5685136246015, "episode_reward_min": 805.8686998778772, "episodes_total": 4430, "time_since_restore": 5455.352474451065, "date": "2019-05-21_11-12-49", "time_total_s": 5455.352474451065, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cf98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ce10>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7458621, "sample_time_ms": 20282.091, "load_time_ms": 6.476, "grad_time_ms": 10959.427, "update_time_ms": 7.767, "default": {"policy_loss": -0.011644675396382809, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.19362737238407135, "total_loss": 51.33795928955078, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 51.34468078613281, "kl": 0.014567406848073006, "entropy": 1.6660075187683105}, "num_steps_sampled": 7458621}, "episodes_this_iter": 33, "time_this_iter_s": 31.935044527053833}
{"episode_reward_mean": 874.1730112760904, "timesteps_total": 7503336, "iterations_since_restore": 144, "timesteps_since_restore": 7503336, "pid": 59703, "custom_metrics": {"outflow_rate_min": 738.7281407035177, "system_level_velocity_min": 13.08593815331341, "cost1_max": 412.7433991443287, "cost2_max": -24.369777625363366, "cost2_min": -75.04928440136229, "outflow_rate_max": 965.2793955747438, "system_level_velocity_mean": 14.632368918814961, "cost1_mean": 384.2277384793787, "cost2_mean": -35.75180051826678, "outflow_rate_mean": 864.1142892150839, "system_level_velocity_max": 15.761122606698011, "cost1_min": 340.9956978884783}, "policy_reward_mean": {}, "timesteps_this_iter": 44715, "training_iteration": 144, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437201, "hostname": "flow-main", "episode_reward_max": 938.5685136246015, "episode_reward_min": 805.8686998778772, "episodes_total": 4464, "time_since_restore": 5486.6355240345, "date": "2019-05-21_11-13-21", "time_total_s": 5486.6355240345, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cf28>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7503336, "sample_time_ms": 20223.308, "load_time_ms": 6.465, "grad_time_ms": 10938.295, "update_time_ms": 7.888, "default": {"policy_loss": -0.00986876618117094, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.25460290908813477, "total_loss": 44.09037399291992, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 44.09589767456055, "kl": 0.01286297757178545, "entropy": 1.6656571626663208}, "num_steps_sampled": 7503336}, "episodes_this_iter": 34, "time_this_iter_s": 31.28304958343506}
{"episode_reward_mean": 871.7042678653708, "timesteps_total": 7547327, "iterations_since_restore": 145, "timesteps_since_restore": 7547327, "pid": 59703, "custom_metrics": {"outflow_rate_min": 686.6096419446679, "system_level_velocity_min": 13.08593815331341, "cost1_max": 412.7433991443287, "cost2_max": -24.369777625363366, "cost2_min": -75.04928440136229, "outflow_rate_max": 965.2793955747438, "system_level_velocity_mean": 14.56624663171641, "cost1_mean": 382.5584191245267, "cost2_mean": -36.79600188676704, "outflow_rate_mean": 863.8489809563225, "system_level_velocity_max": 15.737138051082148, "cost1_min": 340.9956978884783}, "policy_reward_mean": {}, "timesteps_this_iter": 43991, "training_iteration": 145, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437231, "hostname": "flow-main", "episode_reward_max": 938.5685136246015, "episode_reward_min": 767.2059924889729, "episodes_total": 4496, "time_since_restore": 5517.305544614792, "date": "2019-05-21_11-13-51", "time_total_s": 5517.305544614792, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ceb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cba8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7547327, "sample_time_ms": 20161.152, "load_time_ms": 6.724, "grad_time_ms": 10990.014, "update_time_ms": 7.74, "default": {"policy_loss": -0.010395909659564495, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2025391310453415, "total_loss": 49.69720458984375, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 49.70330810546875, "kl": 0.012710635550320148, "entropy": 1.67721426486969}, "num_steps_sampled": 7547327}, "episodes_this_iter": 32, "time_this_iter_s": 30.670020580291748}
{"episode_reward_mean": 864.9339595686052, "timesteps_total": 7590893, "iterations_since_restore": 146, "timesteps_since_restore": 7590893, "pid": 59703, "custom_metrics": {"outflow_rate_min": 686.6096419446679, "system_level_velocity_min": 13.08593815331341, "cost1_max": 408.2468037867535, "cost2_max": -23.011729154308163, "cost2_min": -75.04928440136229, "outflow_rate_max": 965.2793955747438, "system_level_velocity_mean": 14.637496633935468, "cost1_mean": 384.0571012911553, "cost2_mean": -35.475683502356475, "outflow_rate_mean": 854.6188141705167, "system_level_velocity_max": 15.65345781028866, "cost1_min": 340.9956978884783}, "policy_reward_mean": {}, "timesteps_this_iter": 43566, "training_iteration": 146, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437263, "hostname": "flow-main", "episode_reward_max": 928.2458157701475, "episode_reward_min": 763.3864905736305, "episodes_total": 4529, "time_since_restore": 5548.512419223785, "date": "2019-05-21_11-14-23", "time_total_s": 5548.512419223785, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfd4518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0186d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0004e0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7590893, "sample_time_ms": 20184.456, "load_time_ms": 6.868, "grad_time_ms": 10987.256, "update_time_ms": 7.697, "default": {"policy_loss": -0.009590734727680683, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.21942614018917084, "total_loss": 48.57760238647461, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 48.582698822021484, "kl": 0.013321982696652412, "entropy": 1.676279902458191}, "num_steps_sampled": 7590893}, "episodes_this_iter": 33, "time_this_iter_s": 31.20687460899353}
{"episode_reward_mean": 857.3896302808382, "timesteps_total": 7634523, "iterations_since_restore": 147, "timesteps_since_restore": 7634523, "pid": 59703, "custom_metrics": {"outflow_rate_min": 686.6096419446679, "system_level_velocity_min": 13.030830905520856, "cost1_max": 406.82162495271916, "cost2_max": -23.011729154308163, "cost2_min": -54.21435695026365, "outflow_rate_max": 951.4029874213837, "system_level_velocity_mean": 14.623457575530397, "cost1_mean": 383.7280700924467, "cost2_mean": -35.22318047626237, "outflow_rate_mean": 848.054493354385, "system_level_velocity_max": 15.597620468191709, "cost1_min": 341.0207571462542}, "policy_reward_mean": {}, "timesteps_this_iter": 43630, "training_iteration": 147, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437292, "hostname": "flow-main", "episode_reward_max": 927.260459020391, "episode_reward_min": 763.3864905736305, "episodes_total": 4561, "time_since_restore": 5577.762513875961, "date": "2019-05-21_11-14-52", "time_total_s": 5577.762513875961, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c320>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7634523, "sample_time_ms": 20141.895, "load_time_ms": 6.428, "grad_time_ms": 10916.583, "update_time_ms": 7.822, "default": {"policy_loss": -0.011007333174347878, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.21178698539733887, "total_loss": 48.957584381103516, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 48.96416473388672, "kl": 0.013109423220157623, "entropy": 1.6859550476074219}, "num_steps_sampled": 7634523}, "episodes_this_iter": 32, "time_this_iter_s": 29.250094652175903}
{"episode_reward_mean": 856.6156473420037, "timesteps_total": 7678555, "iterations_since_restore": 148, "timesteps_since_restore": 7678555, "pid": 59703, "custom_metrics": {"outflow_rate_min": 734.6498411744507, "system_level_velocity_min": 13.030830905520856, "cost1_max": 415.40088980674665, "cost2_max": -23.011729154308163, "cost2_min": -57.0872201041229, "outflow_rate_max": 951.4029874213837, "system_level_velocity_mean": 14.693951015446306, "cost1_mean": 385.25172691799344, "cost2_mean": -34.02867567170032, "outflow_rate_mean": 846.772249483877, "system_level_velocity_max": 15.925622460671503, "cost1_min": 341.0207571462542}, "policy_reward_mean": {}, "timesteps_this_iter": 44032, "training_iteration": 148, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437324, "hostname": "flow-main", "episode_reward_max": 920.9681075842244, "episode_reward_min": 763.3864905736305, "episodes_total": 4596, "time_since_restore": 5609.835949897766, "date": "2019-05-21_11-15-24", "time_total_s": 5609.835949897766, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cf60>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7678555, "sample_time_ms": 20185.054, "load_time_ms": 6.391, "grad_time_ms": 10858.453, "update_time_ms": 7.814, "default": {"policy_loss": -0.012283150106668472, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2524586021900177, "total_loss": 47.47687530517578, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 47.484493255615234, "kl": 0.013824647292494774, "entropy": 1.6884957551956177}, "num_steps_sampled": 7678555}, "episodes_this_iter": 35, "time_this_iter_s": 32.07343602180481}
{"episode_reward_mean": 860.035429192168, "timesteps_total": 7722256, "iterations_since_restore": 149, "timesteps_since_restore": 7722256, "pid": 59703, "custom_metrics": {"outflow_rate_min": 695.5672303206994, "system_level_velocity_min": 13.030830905520856, "cost1_max": 415.40088980674665, "cost2_max": -23.93382171882999, "cost2_min": -69.55766731860888, "outflow_rate_max": 955.8240298507461, "system_level_velocity_mean": 14.719433484616484, "cost1_mean": 385.70421219800403, "cost2_mean": -34.92266858247996, "outflow_rate_mean": 852.1974173065809, "system_level_velocity_max": 15.925622460671503, "cost1_min": 341.0207571462542}, "policy_reward_mean": {}, "timesteps_this_iter": 43701, "training_iteration": 149, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437354, "hostname": "flow-main", "episode_reward_max": 921.3154778916057, "episode_reward_min": 745.9750962023853, "episodes_total": 4629, "time_since_restore": 5640.3325979709625, "date": "2019-05-21_11-15-54", "time_total_s": 5640.3325979709625, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fe48>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7722256, "sample_time_ms": 19936.463, "load_time_ms": 6.429, "grad_time_ms": 11050.899, "update_time_ms": 7.877, "default": {"policy_loss": -0.012373040430247784, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.26249030232429504, "total_loss": 52.47003173828125, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 52.47785186767578, "kl": 0.013476861640810966, "entropy": 1.6866027116775513}, "num_steps_sampled": 7722256}, "episodes_this_iter": 33, "time_this_iter_s": 30.49664807319641}
{"episode_reward_mean": 859.9134756414534, "timesteps_total": 7765196, "iterations_since_restore": 150, "timesteps_since_restore": 7765196, "pid": 59703, "custom_metrics": {"outflow_rate_min": 695.5672303206994, "system_level_velocity_min": 13.526850919293079, "cost1_max": 415.63747862224614, "cost2_max": -23.93382171882999, "cost2_min": -69.55766731860888, "outflow_rate_max": 955.8240298507461, "system_level_velocity_mean": 14.824112798459934, "cost1_mean": 387.63727248125934, "cost2_mean": -35.131550242643804, "outflow_rate_mean": 852.8277772054713, "system_level_velocity_max": 15.925622460671503, "cost1_min": 353.9997180101992}, "policy_reward_mean": {}, "timesteps_this_iter": 42940, "training_iteration": 150, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437385, "hostname": "flow-main", "episode_reward_max": 921.3154778916057, "episode_reward_min": 745.9750962023853, "episodes_total": 4663, "time_since_restore": 5670.979657411575, "date": "2019-05-21_11-16-25", "time_total_s": 5670.979657411575, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ce80>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7765196, "sample_time_ms": 19915.08, "load_time_ms": 6.283, "grad_time_ms": 10965.931, "update_time_ms": 8.036, "default": {"policy_loss": -0.013311941176652908, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3845430612564087, "total_loss": 43.32341003417969, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 43.33132553100586, "kl": 0.015996195375919342, "entropy": 1.7011840343475342}, "num_steps_sampled": 7765196}, "episodes_this_iter": 34, "time_this_iter_s": 30.647059440612793}
{"episode_reward_mean": 849.8796920003385, "timesteps_total": 7807574, "iterations_since_restore": 151, "timesteps_since_restore": 7807574, "pid": 59703, "custom_metrics": {"outflow_rate_min": 684.0221899606299, "system_level_velocity_min": 13.526850919293079, "cost1_max": 415.63747862224614, "cost2_max": -23.51999503708706, "cost2_min": -69.55766731860888, "outflow_rate_max": 959.7559701492537, "system_level_velocity_mean": 14.958317789108403, "cost1_mean": 387.74467737478807, "cost2_mean": -34.5487908953632, "outflow_rate_mean": 848.8539709410123, "system_level_velocity_max": 16.142580499249043, "cost1_min": 173.8386255435552}, "policy_reward_mean": {}, "timesteps_this_iter": 42378, "training_iteration": 151, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437414, "hostname": "flow-main", "episode_reward_max": 921.3154778916057, "episode_reward_min": 388.17701367309917, "episodes_total": 4695, "time_since_restore": 5699.674012899399, "date": "2019-05-21_11-16-54", "time_total_s": 5699.674012899399, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf323c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf322e8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.97, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7807574, "sample_time_ms": 19971.348, "load_time_ms": 6.206, "grad_time_ms": 10714.491, "update_time_ms": 7.85, "default": {"policy_loss": -0.011261523701250553, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2797126770019531, "total_loss": 47.004669189453125, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 47.011474609375, "kl": 0.01320455688983202, "entropy": 1.6917835474014282}, "num_steps_sampled": 7807574}, "episodes_this_iter": 32, "time_this_iter_s": 28.694355487823486}
{"episode_reward_mean": 847.7511583499908, "timesteps_total": 7850338, "iterations_since_restore": 152, "timesteps_since_restore": 7850338, "pid": 59703, "custom_metrics": {"outflow_rate_min": 684.0221899606299, "system_level_velocity_min": 13.526850919293079, "cost1_max": 415.63747862224614, "cost2_max": -23.51999503708706, "cost2_min": -56.21176746269183, "outflow_rate_max": 959.7559701492537, "system_level_velocity_mean": 15.065747448409763, "cost1_mean": 389.8905382064277, "cost2_mean": -33.31783563214162, "outflow_rate_mean": 847.6548641967805, "system_level_velocity_max": 16.155132359814946, "cost1_min": 173.8386255435552}, "policy_reward_mean": {}, "timesteps_this_iter": 42764, "training_iteration": 152, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437445, "hostname": "flow-main", "episode_reward_max": 930.4295620220814, "episode_reward_min": 388.17701367309917, "episodes_total": 4730, "time_since_restore": 5730.593688011169, "date": "2019-05-21_11-17-25", "time_total_s": 5730.593688011169, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2ff28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bfbc8d0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.97, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7850338, "sample_time_ms": 19862.499, "load_time_ms": 6.037, "grad_time_ms": 10758.869, "update_time_ms": 7.793, "default": {"policy_loss": -0.012804479338228703, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.233317568898201, "total_loss": 50.808746337890625, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 50.816734313964844, "kl": 0.014262801967561245, "entropy": 1.6910195350646973}, "num_steps_sampled": 7850338}, "episodes_this_iter": 35, "time_this_iter_s": 30.91967511177063}
{"episode_reward_mean": 854.7265726435478, "timesteps_total": 7893525, "iterations_since_restore": 153, "timesteps_since_restore": 7893525, "pid": 59703, "custom_metrics": {"outflow_rate_min": 684.0221899606299, "system_level_velocity_min": 13.698187676860284, "cost1_max": 426.90029835493203, "cost2_max": -23.51999503708706, "cost2_min": -57.00218832556515, "outflow_rate_max": 959.7559701492537, "system_level_velocity_mean": 15.30522847335023, "cost1_mean": 394.9770907043491, "cost2_mean": -32.0950764009862, "outflow_rate_mean": 856.0718067549075, "system_level_velocity_max": 16.68317018068165, "cost1_min": 173.8386255435552}, "policy_reward_mean": {}, "timesteps_this_iter": 43187, "training_iteration": 153, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437475, "hostname": "flow-main", "episode_reward_max": 930.4295620220814, "episode_reward_min": 388.17701367309917, "episodes_total": 4763, "time_since_restore": 5760.8932056427, "date": "2019-05-21_11-17-55", "time_total_s": 5760.8932056427, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32b70>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.54, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7893525, "sample_time_ms": 19810.321, "load_time_ms": 5.899, "grad_time_ms": 10649.345, "update_time_ms": 7.586, "default": {"policy_loss": -0.011036592535674572, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2203090637922287, "total_loss": 52.066429138183594, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 52.072967529296875, "kl": 0.013327193446457386, "entropy": 1.678623080253601}, "num_steps_sampled": 7893525}, "episodes_this_iter": 33, "time_this_iter_s": 30.29951763153076}
{"episode_reward_mean": 867.4078730441487, "timesteps_total": 7936936, "iterations_since_restore": 154, "timesteps_since_restore": 7936936, "pid": 59703, "custom_metrics": {"outflow_rate_min": 693.3221878515185, "system_level_velocity_min": 13.689779543581881, "cost1_max": 426.90029835493203, "cost2_max": -24.543938226273326, "cost2_min": -57.00218832556515, "outflow_rate_max": 947.8106081449937, "system_level_velocity_mean": 15.314251477873604, "cost1_mean": 396.5730806943944, "cost2_mean": -34.225026124488615, "outflow_rate_mean": 870.230610237176, "system_level_velocity_max": 16.68317018068165, "cost1_min": 325.6516544831576}, "policy_reward_mean": {}, "timesteps_this_iter": 43411, "training_iteration": 154, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437506, "hostname": "flow-main", "episode_reward_max": 930.4295620220814, "episode_reward_min": 741.8935400940055, "episodes_total": 4796, "time_since_restore": 5792.032061338425, "date": "2019-05-21_11-18-26", "time_total_s": 5792.032061338425, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c2e8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 698.34, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7936936, "sample_time_ms": 19832.713, "load_time_ms": 5.739, "grad_time_ms": 10611.775, "update_time_ms": 7.541, "default": {"policy_loss": -0.012372090481221676, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2797020673751831, "total_loss": 46.78760528564453, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 46.79535675048828, "kl": 0.0136996665969491, "entropy": 1.6683893203735352}, "num_steps_sampled": 7936936}, "episodes_this_iter": 33, "time_this_iter_s": 31.138855695724487}
{"episode_reward_mean": 877.7434445182793, "timesteps_total": 7980457, "iterations_since_restore": 155, "timesteps_since_restore": 7980457, "pid": 59703, "custom_metrics": {"outflow_rate_min": 712.705081300813, "system_level_velocity_min": 13.689779543581881, "cost1_max": 429.2622728256868, "cost2_max": -25.759688865817395, "cost2_min": -69.88000570110476, "outflow_rate_max": 1038.9237480074244, "system_level_velocity_mean": 15.430822176348839, "cost1_mean": 398.6249659845617, "cost2_mean": -35.54250902803495, "outflow_rate_mean": 883.0701584169115, "system_level_velocity_max": 16.72537638575295, "cost1_min": 325.6516544831576}, "policy_reward_mean": {}, "timesteps_this_iter": 43521, "training_iteration": 155, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437538, "hostname": "flow-main", "episode_reward_max": 966.0387489378614, "episode_reward_min": 741.8935400940055, "episodes_total": 4829, "time_since_restore": 5823.66032910347, "date": "2019-05-21_11-18-58", "time_total_s": 5823.66032910347, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32160>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 698.34, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 7980457, "sample_time_ms": 19810.164, "load_time_ms": 5.622, "grad_time_ms": 10729.656, "update_time_ms": 7.697, "default": {"policy_loss": -0.012770779430866241, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.26124268770217896, "total_loss": 46.502864837646484, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 46.5109748840332, "kl": 0.01381524559110403, "entropy": 1.6944338083267212}, "num_steps_sampled": 7980457}, "episodes_this_iter": 33, "time_this_iter_s": 31.628267765045166}
{"episode_reward_mean": 874.4046621317465, "timesteps_total": 8022790, "iterations_since_restore": 156, "timesteps_since_restore": 8022790, "pid": 59703, "custom_metrics": {"outflow_rate_min": 730.1371097730429, "system_level_velocity_min": 13.34052557123206, "cost1_max": 431.81031968215734, "cost2_max": -24.874998197717527, "cost2_min": -69.88000570110476, "outflow_rate_max": 1038.9237480074244, "system_level_velocity_mean": 15.33303486874362, "cost1_mean": 395.67029772843756, "cost2_mean": -37.97970593186218, "outflow_rate_mean": 883.7316206442126, "system_level_velocity_max": 17.22851992678308, "cost1_min": 325.6516544831576}, "policy_reward_mean": {}, "timesteps_this_iter": 42333, "training_iteration": 156, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437567, "hostname": "flow-main", "episode_reward_max": 966.0387489378614, "episode_reward_min": 741.8935400940055, "episodes_total": 4862, "time_since_restore": 5852.927193641663, "date": "2019-05-21_11-19-27", "time_total_s": 5852.927193641663, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cfd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ccf8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 698.77, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8022790, "sample_time_ms": 19763.802, "load_time_ms": 5.307, "grad_time_ms": 10583.513, "update_time_ms": 7.853, "default": {"policy_loss": -0.014406531117856503, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.23428760468959808, "total_loss": 51.67930221557617, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 51.68866729736328, "kl": 0.014935298822820187, "entropy": 1.7279043197631836}, "num_steps_sampled": 8022790}, "episodes_this_iter": 33, "time_this_iter_s": 29.26686453819275}
{"episode_reward_mean": 875.0147898174854, "timesteps_total": 8066044, "iterations_since_restore": 157, "timesteps_since_restore": 8066044, "pid": 59703, "custom_metrics": {"outflow_rate_min": 713.931079467728, "system_level_velocity_min": 13.34052557123206, "cost1_max": 431.81031968215734, "cost2_max": -24.874998197717527, "cost2_min": -69.88000570110476, "outflow_rate_max": 1038.9237480074244, "system_level_velocity_mean": 15.425416288031318, "cost1_mean": 397.7326176984068, "cost2_mean": -37.70314103289931, "outflow_rate_mean": 882.5189420724503, "system_level_velocity_max": 17.22851992678308, "cost1_min": 347.60672247376755}, "policy_reward_mean": {}, "timesteps_this_iter": 43254, "training_iteration": 157, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437600, "hostname": "flow-main", "episode_reward_max": 966.0387489378614, "episode_reward_min": 759.1792914450936, "episodes_total": 4895, "time_since_restore": 5884.975992202759, "date": "2019-05-21_11-20-00", "time_total_s": 5884.975992202759, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c0b8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8066044, "sample_time_ms": 20053.27, "load_time_ms": 5.495, "grad_time_ms": 10573.664, "update_time_ms": 7.772, "default": {"policy_loss": -0.011925804428756237, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.311368465423584, "total_loss": 46.2738037109375, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 46.28128433227539, "kl": 0.013164166361093521, "entropy": 1.7119067907333374}, "num_steps_sampled": 8066044}, "episodes_this_iter": 33, "time_this_iter_s": 32.04879856109619}
{"episode_reward_mean": 871.4605081909414, "timesteps_total": 8109928, "iterations_since_restore": 158, "timesteps_since_restore": 8109928, "pid": 59703, "custom_metrics": {"outflow_rate_min": 713.931079467728, "system_level_velocity_min": 12.82252858143865, "cost1_max": 431.81031968215734, "cost2_max": -24.874998197717527, "cost2_min": -64.50683485424487, "outflow_rate_max": 1050.1387983834754, "system_level_velocity_mean": 15.353716288197175, "cost1_mean": 395.7484512732496, "cost2_mean": -38.06573414447439, "outflow_rate_mean": 881.2456800418768, "system_level_velocity_max": 17.22851992678308, "cost1_min": 330.1763909983108}, "policy_reward_mean": {}, "timesteps_this_iter": 43884, "training_iteration": 158, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437631, "hostname": "flow-main", "episode_reward_max": 945.9767300604551, "episode_reward_min": 759.1792914450936, "episodes_total": 4928, "time_since_restore": 5916.394645214081, "date": "2019-05-21_11-20-31", "time_total_s": 5916.394645214081, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c630>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 699.57, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8109928, "sample_time_ms": 19831.917, "load_time_ms": 5.596, "grad_time_ms": 10729.366, "update_time_ms": 7.773, "default": {"policy_loss": -0.01363841537386179, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2497515082359314, "total_loss": 52.49046325683594, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 52.499107360839844, "kl": 0.014791224151849747, "entropy": 1.7086584568023682}, "num_steps_sampled": 8109928}, "episodes_this_iter": 33, "time_this_iter_s": 31.41865301132202}
{"episode_reward_mean": 881.8373107498068, "timesteps_total": 8154222, "iterations_since_restore": 159, "timesteps_since_restore": 8154222, "pid": 59703, "custom_metrics": {"outflow_rate_min": 713.931079467728, "system_level_velocity_min": 12.82252858143865, "cost1_max": 427.1672467458557, "cost2_max": -25.90932798349137, "cost2_min": -68.0510758778855, "outflow_rate_max": 1050.1387983834754, "system_level_velocity_mean": 15.350027838035338, "cost1_mean": 396.0474879076444, "cost2_mean": -38.19735112327978, "outflow_rate_mean": 891.4214585963028, "system_level_velocity_max": 16.748053968742543, "cost1_min": 330.1763909983108}, "policy_reward_mean": {}, "timesteps_this_iter": 44294, "training_iteration": 159, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437662, "hostname": "flow-main", "episode_reward_max": 987.0922910606396, "episode_reward_min": 791.8155164727514, "episodes_total": 4961, "time_since_restore": 5947.312222003937, "date": "2019-05-21_11-21-02", "time_total_s": 5947.312222003937, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c198>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 699.57, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8154222, "sample_time_ms": 20035.588, "load_time_ms": 5.901, "grad_time_ms": 10568.802, "update_time_ms": 7.832, "default": {"policy_loss": -0.012721558101475239, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2577512860298157, "total_loss": 49.13833236694336, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 49.14634704589844, "kl": 0.013938860036432743, "entropy": 1.7118417024612427}, "num_steps_sampled": 8154222}, "episodes_this_iter": 33, "time_this_iter_s": 30.917576789855957}
{"episode_reward_mean": 894.2200091991343, "timesteps_total": 8199421, "iterations_since_restore": 160, "timesteps_since_restore": 8199421, "pid": 59703, "custom_metrics": {"outflow_rate_min": 805.2357853589195, "system_level_velocity_min": 12.82252858143865, "cost1_max": 422.01385852908567, "cost2_max": -27.175473906765927, "cost2_min": -71.58923565782509, "outflow_rate_max": 1069.834310596447, "system_level_velocity_mean": 15.204572384909802, "cost1_mean": 393.77543550410695, "cost2_mean": -39.27104083476094, "outflow_rate_mean": 906.5621404710878, "system_level_velocity_max": 16.595134060474965, "cost1_min": 330.1763909983108}, "policy_reward_mean": {}, "timesteps_this_iter": 45199, "training_iteration": 160, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437694, "hostname": "flow-main", "episode_reward_max": 987.0922910606396, "episode_reward_min": 801.0266039915002, "episodes_total": 4995, "time_since_restore": 5979.77746629715, "date": "2019-05-21_11-21-34", "time_total_s": 5979.77746629715, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ccf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cfd0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 699.57, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8199421, "sample_time_ms": 20227.804, "load_time_ms": 6.101, "grad_time_ms": 10557.902, "update_time_ms": 7.622, "default": {"policy_loss": -0.01417650654911995, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2849159836769104, "total_loss": 47.06920623779297, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 47.07866668701172, "kl": 0.013965555466711521, "entropy": 1.7088203430175781}, "num_steps_sampled": 8199421}, "episodes_this_iter": 34, "time_this_iter_s": 32.46524429321289}
{"episode_reward_mean": 905.2903162319246, "timesteps_total": 8243954, "iterations_since_restore": 161, "timesteps_since_restore": 8243954, "pid": 59703, "custom_metrics": {"outflow_rate_min": 805.2357853589195, "system_level_velocity_min": 13.781069243589497, "cost1_max": 424.8437994732908, "cost2_max": -28.162496849500478, "cost2_min": -71.58923565782509, "outflow_rate_max": 1069.834310596447, "system_level_velocity_mean": 15.15172215161188, "cost1_mean": 393.22738736438, "cost2_mean": -40.514835951319384, "outflow_rate_mean": 922.6038770706767, "system_level_velocity_max": 16.595134060474965, "cost1_min": 353.37530483104223}, "policy_reward_mean": {}, "timesteps_this_iter": 44533, "training_iteration": 161, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437726, "hostname": "flow-main", "episode_reward_max": 987.0922910606396, "episode_reward_min": 801.0266039915002, "episodes_total": 5028, "time_since_restore": 6011.5656843185425, "date": "2019-05-21_11-22-06", "time_total_s": 6011.5656843185425, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ca90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c518>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8243954, "sample_time_ms": 20177.818, "load_time_ms": 6.368, "grad_time_ms": 10915.862, "update_time_ms": 7.625, "default": {"policy_loss": -0.013719921931624413, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.3020324110984802, "total_loss": 50.68435287475586, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 50.693031311035156, "kl": 0.014930476434528828, "entropy": 1.709404706954956}, "num_steps_sampled": 8243954}, "episodes_this_iter": 33, "time_this_iter_s": 31.788218021392822}
{"episode_reward_mean": 911.0773510635452, "timesteps_total": 8288270, "iterations_since_restore": 162, "timesteps_since_restore": 8288270, "pid": 59703, "custom_metrics": {"outflow_rate_min": 828.8098417426919, "system_level_velocity_min": 13.781069243589497, "cost1_max": 424.8437994732908, "cost2_max": -26.931740706682653, "cost2_min": -71.58923565782509, "outflow_rate_max": 1080.6404324324328, "system_level_velocity_mean": 15.245886196582711, "cost1_mean": 395.1113245049044, "cost2_mean": -40.23078927899435, "outflow_rate_mean": 934.3381839919664, "system_level_velocity_max": 16.869619237425628, "cost1_min": 360.56279672459885}, "policy_reward_mean": {}, "timesteps_this_iter": 44316, "training_iteration": 162, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437758, "hostname": "flow-main", "episode_reward_max": 1025.2996032728197, "episode_reward_min": 801.0266039915002, "episodes_total": 5063, "time_since_restore": 6042.812534570694, "date": "2019-05-21_11-22-38", "time_total_s": 6042.812534570694, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ca20>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8288270, "sample_time_ms": 20260.117, "load_time_ms": 6.603, "grad_time_ms": 10866.589, "update_time_ms": 7.673, "default": {"policy_loss": -0.014852193184196949, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.30087894201278687, "total_loss": 49.835208892822266, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 49.84517288208008, "kl": 0.0144749004393816, "entropy": 1.71961510181427}, "num_steps_sampled": 8288270}, "episodes_this_iter": 35, "time_this_iter_s": 31.24685025215149}
{"episode_reward_mean": 914.9990158612934, "timesteps_total": 8333886, "iterations_since_restore": 163, "timesteps_since_restore": 8333886, "pid": 59703, "custom_metrics": {"outflow_rate_min": 840.4018421052632, "system_level_velocity_min": 13.781069243589497, "cost1_max": 424.8437994732908, "cost2_max": -26.664631130453774, "cost2_min": -71.33798389168693, "outflow_rate_max": 1091.6898238636363, "system_level_velocity_mean": 15.270093353929433, "cost1_mean": 395.1650861077513, "cost2_mean": -40.831258857693896, "outflow_rate_mean": 945.5734355585384, "system_level_velocity_max": 16.869619237425628, "cost1_min": 362.6514681911623}, "policy_reward_mean": {}, "timesteps_this_iter": 45616, "training_iteration": 163, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437789, "hostname": "flow-main", "episode_reward_max": 1025.2996032728197, "episode_reward_min": 842.8540183343878, "episodes_total": 5095, "time_since_restore": 6074.6301856040955, "date": "2019-05-21_11-23-09", "time_total_s": 6074.6301856040955, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cb70>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8333886, "sample_time_ms": 20418.69, "load_time_ms": 6.699, "grad_time_ms": 10859.464, "update_time_ms": 7.722, "default": {"policy_loss": -0.014954588375985622, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.25470468401908875, "total_loss": 52.6737060546875, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 52.68295669555664, "kl": 0.016910908743739128, "entropy": 1.7046467065811157}, "num_steps_sampled": 8333886}, "episodes_this_iter": 32, "time_this_iter_s": 31.81765103340149}
{"episode_reward_mean": 912.0071833788753, "timesteps_total": 8378327, "iterations_since_restore": 164, "timesteps_since_restore": 8378327, "pid": 59703, "custom_metrics": {"outflow_rate_min": 840.4018421052632, "system_level_velocity_min": 13.708317264484654, "cost1_max": 423.17322347810995, "cost2_max": -26.664631130453774, "cost2_min": -75.01606486735285, "outflow_rate_max": 1091.6898238636363, "system_level_velocity_mean": 15.287366951845032, "cost1_mean": 393.3312954396336, "cost2_mean": -40.670273702926245, "outflow_rate_mean": 947.6285998740937, "system_level_velocity_max": 16.869619237425628, "cost1_min": 240.9456923534093}, "policy_reward_mean": {}, "timesteps_this_iter": 44441, "training_iteration": 164, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437821, "hostname": "flow-main", "episode_reward_max": 1025.2996032728197, "episode_reward_min": 523.1263858037703, "episodes_total": 5127, "time_since_restore": 6106.001214504242, "date": "2019-05-21_11-23-41", "time_total_s": 6106.001214504242, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2ff98>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 696.95, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8378327, "sample_time_ms": 20280.374, "load_time_ms": 6.886, "grad_time_ms": 11021.691, "update_time_ms": 7.616, "default": {"policy_loss": -0.013989216648042202, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2634483575820923, "total_loss": 49.220787048339844, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 49.229129791259766, "kl": 0.0167430080473423, "entropy": 1.72029447555542}, "num_steps_sampled": 8378327}, "episodes_this_iter": 32, "time_this_iter_s": 31.371028900146484}
{"episode_reward_mean": 907.1470109678637, "timesteps_total": 8422338, "iterations_since_restore": 165, "timesteps_since_restore": 8422338, "pid": 59703, "custom_metrics": {"outflow_rate_min": 818.1197213622287, "system_level_velocity_min": 13.708317264484654, "cost1_max": 416.58682125035386, "cost2_max": -24.564964627546036, "cost2_min": -75.01606486735285, "outflow_rate_max": 1091.6898238636363, "system_level_velocity_mean": 15.188101726882355, "cost1_mean": 391.4490690445102, "cost2_mean": -40.440455002785576, "outflow_rate_mean": 940.3901969693877, "system_level_velocity_max": 16.712989471924775, "cost1_min": 240.9456923534093}, "policy_reward_mean": {}, "timesteps_this_iter": 44011, "training_iteration": 165, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437851, "hostname": "flow-main", "episode_reward_max": 1008.626850622594, "episode_reward_min": 523.1263858037703, "episodes_total": 5162, "time_since_restore": 6135.908255338669, "date": "2019-05-21_11-24-11", "time_total_s": 6135.908255338669, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c828>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 696.95, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8422338, "sample_time_ms": 20171.744, "load_time_ms": 6.957, "grad_time_ms": 10958.049, "update_time_ms": 7.676, "default": {"policy_loss": -0.012557250447571278, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2659725248813629, "total_loss": 52.440494537353516, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 52.44841003417969, "kl": 0.013778572902083397, "entropy": 1.7336244583129883}, "num_steps_sampled": 8422338}, "episodes_this_iter": 35, "time_this_iter_s": 29.90704083442688}
{"episode_reward_mean": 900.3325020081097, "timesteps_total": 8465365, "iterations_since_restore": 166, "timesteps_since_restore": 8465365, "pid": 59703, "custom_metrics": {"outflow_rate_min": 818.1197213622287, "system_level_velocity_min": 12.93886848942375, "cost1_max": 425.65812247813756, "cost2_max": -24.564964627546036, "cost2_min": -75.01606486735285, "outflow_rate_max": 1066.3701487236406, "system_level_velocity_mean": 15.32125831834257, "cost1_mean": 393.4955922693578, "cost2_mean": -39.5160475777989, "outflow_rate_mean": 932.4310167249403, "system_level_velocity_max": 16.712989471924775, "cost1_min": 240.9456923534093}, "policy_reward_mean": {}, "timesteps_this_iter": 43027, "training_iteration": 166, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437881, "hostname": "flow-main", "episode_reward_max": 994.0650040348742, "episode_reward_min": 523.1263858037703, "episodes_total": 5194, "time_since_restore": 6165.8440136909485, "date": "2019-05-21_11-24-41", "time_total_s": 6165.8440136909485, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2ffd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2ff28>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 696.95, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8465365, "sample_time_ms": 20307.256, "load_time_ms": 6.844, "grad_time_ms": 10888.927, "update_time_ms": 7.701, "default": {"policy_loss": -0.0125723946839571, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.20237427949905396, "total_loss": 51.844051361083984, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 51.851463317871094, "kl": 0.015293724834918976, "entropy": 1.7281217575073242}, "num_steps_sampled": 8465365}, "episodes_this_iter": 32, "time_this_iter_s": 29.935758352279663}
{"episode_reward_mean": 897.9065313546089, "timesteps_total": 8508178, "iterations_since_restore": 167, "timesteps_since_restore": 8508178, "pid": 59703, "custom_metrics": {"outflow_rate_min": 818.1197213622287, "system_level_velocity_min": 12.93886848942375, "cost1_max": 431.01393695446, "cost2_max": -24.564964627546036, "cost2_min": -72.07311072306925, "outflow_rate_max": 1065.8189213993637, "system_level_velocity_mean": 15.461884573503783, "cost1_mean": 397.875745067269, "cost2_mean": -38.68921624820646, "outflow_rate_mean": 926.1884972776203, "system_level_velocity_max": 17.285013567483198, "cost1_min": 337.8033311843218}, "policy_reward_mean": {}, "timesteps_this_iter": 42813, "training_iteration": 167, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437910, "hostname": "flow-main", "episode_reward_max": 981.2933741555992, "episode_reward_min": 834.4569681263707, "episodes_total": 5226, "time_since_restore": 6195.271252155304, "date": "2019-05-21_11-25-10", "time_total_s": 6195.271252155304, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f898>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8508178, "sample_time_ms": 20056.148, "load_time_ms": 6.761, "grad_time_ms": 10878.209, "update_time_ms": 7.694, "default": {"policy_loss": -0.013701002113521099, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.23477794229984283, "total_loss": 48.061622619628906, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 48.070255279541016, "kl": 0.015019869431853294, "entropy": 1.740768551826477}, "num_steps_sampled": 8508178}, "episodes_this_iter": 32, "time_this_iter_s": 29.42723846435547}
{"episode_reward_mean": 891.3097308775187, "timesteps_total": 8551308, "iterations_since_restore": 168, "timesteps_since_restore": 8551308, "pid": 59703, "custom_metrics": {"outflow_rate_min": 476.16837092108835, "system_level_velocity_min": 12.93886848942375, "cost1_max": 436.5354755557867, "cost2_max": -16.77426603314148, "cost2_min": -72.07311072306925, "outflow_rate_max": 1072.957484949833, "system_level_velocity_mean": 15.745495677436487, "cost1_mean": 398.76467135022125, "cost2_mean": -37.46436933212064, "outflow_rate_mean": 927.5844909660356, "system_level_velocity_max": 17.497512399288603, "cost1_min": 17.679671575877226}, "policy_reward_mean": {}, "timesteps_this_iter": 43130, "training_iteration": 168, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437940, "hostname": "flow-main", "episode_reward_max": 982.3798843827778, "episode_reward_min": 45.705003170313915, "episodes_total": 5262, "time_since_restore": 6225.361327648163, "date": "2019-05-21_11-25-40", "time_total_s": 6225.361327648163, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fe48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2ff98>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.27, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8551308, "sample_time_ms": 20026.483, "load_time_ms": 6.597, "grad_time_ms": 10775.407, "update_time_ms": 7.999, "default": {"policy_loss": -0.012547647580504417, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2284882664680481, "total_loss": 52.74223327636719, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 52.7502326965332, "kl": 0.013487582094967365, "entropy": 1.7261955738067627}, "num_steps_sampled": 8551308}, "episodes_this_iter": 36, "time_this_iter_s": 30.090075492858887}
{"episode_reward_mean": 890.0750982931918, "timesteps_total": 8594104, "iterations_since_restore": 169, "timesteps_since_restore": 8594104, "pid": 59703, "custom_metrics": {"outflow_rate_min": 476.16837092108835, "system_level_velocity_min": 13.712810265560227, "cost1_max": 436.5354755557867, "cost2_max": -16.77426603314148, "cost2_min": -72.07311072306925, "outflow_rate_max": 1072.957484949833, "system_level_velocity_mean": 15.786797543229842, "cost1_mean": 399.04886431650283, "cost2_mean": -38.560114750437, "outflow_rate_mean": 926.5751122962607, "system_level_velocity_max": 17.497512399288603, "cost1_min": 17.679671575877226}, "policy_reward_mean": {}, "timesteps_this_iter": 42796, "training_iteration": 169, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558437971, "hostname": "flow-main", "episode_reward_max": 982.3798843827778, "episode_reward_min": 45.705003170313915, "episodes_total": 5296, "time_since_restore": 6256.300587177277, "date": "2019-05-21_11-26-11", "time_total_s": 6256.300587177277, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2fcc0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 693.27, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8594104, "sample_time_ms": 20176.1, "load_time_ms": 6.199, "grad_time_ms": 10628.733, "update_time_ms": 7.954, "default": {"policy_loss": -0.012662389315664768, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.24753686785697937, "total_loss": 53.985591888427734, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 53.993473052978516, "kl": 0.01415578369051218, "entropy": 1.731575608253479}, "num_steps_sampled": 8594104}, "episodes_this_iter": 34, "time_this_iter_s": 30.93925952911377}
{"episode_reward_mean": 885.8085105082, "timesteps_total": 8637051, "iterations_since_restore": 170, "timesteps_since_restore": 8637051, "pid": 59703, "custom_metrics": {"outflow_rate_min": 476.16837092108835, "system_level_velocity_min": 14.209539045715184, "cost1_max": 436.5354755557867, "cost2_max": -16.77426603314148, "cost2_min": -64.88857901644388, "outflow_rate_max": 1072.957484949833, "system_level_velocity_mean": 15.838884382698955, "cost1_mean": 397.71004238588176, "cost2_mean": -39.20921848880521, "outflow_rate_mean": 923.3467289408223, "system_level_velocity_max": 17.497512399288603, "cost1_min": 17.679671575877226}, "policy_reward_mean": {}, "timesteps_this_iter": 42947, "training_iteration": 170, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438004, "hostname": "flow-main", "episode_reward_max": 982.3798843827778, "episode_reward_min": 45.705003170313915, "episodes_total": 5329, "time_since_restore": 6288.736462593079, "date": "2019-05-21_11-26-44", "time_total_s": 6288.736462593079, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c0004e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c550>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 689.24, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8637051, "sample_time_ms": 20069.955, "load_time_ms": 5.934, "grad_time_ms": 10731.404, "update_time_ms": 7.98, "default": {"policy_loss": -0.014551544561982155, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.26495233178138733, "total_loss": 51.62470245361328, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 51.63397979736328, "kl": 0.015637123957276344, "entropy": 1.7443909645080566}, "num_steps_sampled": 8637051}, "episodes_this_iter": 33, "time_this_iter_s": 32.435875415802}
{"episode_reward_mean": 888.9066585683464, "timesteps_total": 8679227, "iterations_since_restore": 171, "timesteps_since_restore": 8679227, "pid": 59703, "custom_metrics": {"outflow_rate_min": 804.5557291666669, "system_level_velocity_min": 13.632795716203766, "cost1_max": 434.5999763950274, "cost2_max": -26.83820415457581, "cost2_min": -67.57759836240955, "outflow_rate_max": 1067.2558705906065, "system_level_velocity_mean": 15.893734630001347, "cost1_mean": 402.6136598986248, "cost2_mean": -39.29345690983867, "outflow_rate_mean": 921.4381476950879, "system_level_velocity_max": 17.371025110335157, "cost1_min": 181.51456552558057}, "policy_reward_mean": {}, "timesteps_this_iter": 42176, "training_iteration": 171, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438033, "hostname": "flow-main", "episode_reward_max": 969.3533376064447, "episode_reward_min": 402.98173331482184, "episodes_total": 5362, "time_since_restore": 6317.561141490936, "date": "2019-05-21_11-27-13", "time_total_s": 6317.561141490936, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c2e8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.97, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8679227, "sample_time_ms": 19951.847, "load_time_ms": 5.671, "grad_time_ms": 10554.464, "update_time_ms": 8.09, "default": {"policy_loss": -0.016410786658525467, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.25743284821510315, "total_loss": 50.28392791748047, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 50.294891357421875, "kl": 0.016135290265083313, "entropy": 1.7461971044540405}, "num_steps_sampled": 8679227}, "episodes_this_iter": 33, "time_this_iter_s": 28.824678897857666}
{"episode_reward_mean": 882.4034181617347, "timesteps_total": 8720816, "iterations_since_restore": 172, "timesteps_since_restore": 8720816, "pid": 59703, "custom_metrics": {"outflow_rate_min": 784.0668211527038, "system_level_velocity_min": 13.632795716203766, "cost1_max": 434.14770576044293, "cost2_max": -26.83820415457581, "cost2_min": -67.57759836240955, "outflow_rate_max": 1052.6279034664328, "system_level_velocity_mean": 15.97970852702691, "cost1_mean": 404.9241317884573, "cost2_mean": -37.94788587914077, "outflow_rate_mean": 912.2898113180572, "system_level_velocity_max": 17.60586588973351, "cost1_min": 181.51456552558057}, "policy_reward_mean": {}, "timesteps_this_iter": 41589, "training_iteration": 172, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438064, "hostname": "flow-main", "episode_reward_max": 969.3533376064447, "episode_reward_min": 402.98173331482184, "episodes_total": 5395, "time_since_restore": 6348.797478437424, "date": "2019-05-21_11-27-44", "time_total_s": 6348.797478437424, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ca90>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.97, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8720816, "sample_time_ms": 20042.13, "load_time_ms": 5.387, "grad_time_ms": 10463.724, "update_time_ms": 8.01, "default": {"policy_loss": -0.012412942945957184, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.18028676509857178, "total_loss": 56.749324798583984, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 56.75646209716797, "kl": 0.015613782219588757, "entropy": 1.7666277885437012}, "num_steps_sampled": 8720816}, "episodes_this_iter": 33, "time_this_iter_s": 31.236336946487427}
{"episode_reward_mean": 879.6341143392124, "timesteps_total": 8762995, "iterations_since_restore": 173, "timesteps_since_restore": 8762995, "pid": 59703, "custom_metrics": {"outflow_rate_min": 784.0668211527038, "system_level_velocity_min": 13.632795716203766, "cost1_max": 434.14770576044293, "cost2_max": -26.83820415457581, "cost2_min": -72.0615738673894, "outflow_rate_max": 1069.0026943543153, "system_level_velocity_mean": 15.98928239140889, "cost1_mean": 406.9428764053853, "cost2_mean": -37.40827785855068, "outflow_rate_mean": 907.574049241577, "system_level_velocity_max": 17.60586588973351, "cost1_min": 344.775944631425}, "policy_reward_mean": {}, "timesteps_this_iter": 42179, "training_iteration": 173, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438096, "hostname": "flow-main", "episode_reward_max": 969.3533376064447, "episode_reward_min": 798.4304663972621, "episodes_total": 5430, "time_since_restore": 6380.45170044899, "date": "2019-05-21_11-28-16", "time_total_s": 6380.45170044899, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf323c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32550>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8762995, "sample_time_ms": 19927.045, "load_time_ms": 5.247, "grad_time_ms": 10562.141, "update_time_ms": 7.95, "default": {"policy_loss": -0.012317793443799019, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.22905471920967102, "total_loss": 50.289466857910156, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 50.29633331298828, "kl": 0.016161834821105003, "entropy": 1.7557759284973145}, "num_steps_sampled": 8762995}, "episodes_this_iter": 35, "time_this_iter_s": 31.654222011566162}
{"episode_reward_mean": 868.52948346829, "timesteps_total": 8804875, "iterations_since_restore": 174, "timesteps_since_restore": 8804875, "pid": 59703, "custom_metrics": {"outflow_rate_min": 784.0668211527038, "system_level_velocity_min": 13.711013992044562, "cost1_max": 433.54959926173836, "cost2_max": -26.802818411634085, "cost2_min": -72.0615738673894, "outflow_rate_max": 1069.0026943543153, "system_level_velocity_mean": 15.995720967994611, "cost1_mean": 404.4309032528181, "cost2_mean": -36.59540892018092, "outflow_rate_mean": 903.0013680638616, "system_level_velocity_max": 17.60586588973351, "cost1_min": 225.10180646981559}, "policy_reward_mean": {}, "timesteps_this_iter": 41880, "training_iteration": 174, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438124, "hostname": "flow-main", "episode_reward_max": 938.3956943293589, "episode_reward_min": 516.6211607641563, "episodes_total": 5463, "time_since_restore": 6408.813526630402, "date": "2019-05-21_11-28-44", "time_total_s": 6408.813526630402, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81e502c18>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.62, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8804875, "sample_time_ms": 19827.623, "load_time_ms": 5.041, "grad_time_ms": 10361.585, "update_time_ms": 8.03, "default": {"policy_loss": -0.011723170056939125, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.1657778024673462, "total_loss": 58.97842025756836, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 58.98541259765625, "kl": 0.014006620272994041, "entropy": 1.7833483219146729}, "num_steps_sampled": 8804875}, "episodes_this_iter": 33, "time_this_iter_s": 28.361826181411743}
{"episode_reward_mean": 869.6790387749311, "timesteps_total": 8846833, "iterations_since_restore": 175, "timesteps_since_restore": 8846833, "pid": 59703, "custom_metrics": {"outflow_rate_min": 785.2539154411767, "system_level_velocity_min": 13.711013992044562, "cost1_max": 431.08319279621185, "cost2_max": -26.802818411634085, "cost2_min": -72.0615738673894, "outflow_rate_max": 1069.0026943543153, "system_level_velocity_mean": 15.922437735608908, "cost1_mean": 402.3191987526446, "cost2_mean": -37.433258823955015, "outflow_rate_mean": 904.724314530732, "system_level_velocity_max": 17.544171264991085, "cost1_min": 225.10180646981559}, "policy_reward_mean": {}, "timesteps_this_iter": 41958, "training_iteration": 175, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438154, "hostname": "flow-main", "episode_reward_max": 965.6398223311674, "episode_reward_min": 516.6211607641563, "episodes_total": 5496, "time_since_restore": 6438.522835731506, "date": "2019-05-21_11-29-14", "time_total_s": 6438.522835731506, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ccc0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.62, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8846833, "sample_time_ms": 19950.534, "load_time_ms": 4.656, "grad_time_ms": 10219.72, "update_time_ms": 7.878, "default": {"policy_loss": -0.012987515889108181, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.19697631895542145, "total_loss": 51.19280242919922, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 51.20101547241211, "kl": 0.014149550348520279, "entropy": 1.7915916442871094}, "num_steps_sampled": 8846833}, "episodes_this_iter": 33, "time_this_iter_s": 29.709309101104736}
{"episode_reward_mean": 869.3076178083325, "timesteps_total": 8888838, "iterations_since_restore": 176, "timesteps_since_restore": 8888838, "pid": 59703, "custom_metrics": {"outflow_rate_min": 785.2539154411767, "system_level_velocity_min": 13.913133074015883, "cost1_max": 431.5825313816696, "cost2_max": -26.802818411634085, "cost2_min": -70.11987953566981, "outflow_rate_max": 1067.872352429571, "system_level_velocity_mean": 15.961056666162733, "cost1_mean": 403.52649851946137, "cost2_mean": -37.404647105979144, "outflow_rate_mean": 902.0455734539579, "system_level_velocity_max": 17.544171264991085, "cost1_min": 225.10180646981559}, "policy_reward_mean": {}, "timesteps_this_iter": 42005, "training_iteration": 176, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438184, "hostname": "flow-main", "episode_reward_max": 975.8735929421197, "episode_reward_min": 516.6211607641563, "episodes_total": 5528, "time_since_restore": 6468.8596823215485, "date": "2019-05-21_11-29-44", "time_total_s": 6468.8596823215485, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf325c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32ba8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.62, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8888838, "sample_time_ms": 19822.7, "load_time_ms": 4.688, "grad_time_ms": 10387.648, "update_time_ms": 7.69, "default": {"policy_loss": -0.012348659336566925, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.27998971939086914, "total_loss": 46.65819549560547, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 46.665523529052734, "kl": 0.014877119101583958, "entropy": 1.8015638589859009}, "num_steps_sampled": 8888838}, "episodes_this_iter": 32, "time_this_iter_s": 30.336846590042114}
{"episode_reward_mean": 864.9089682214291, "timesteps_total": 8931026, "iterations_since_restore": 177, "timesteps_since_restore": 8931026, "pid": 59703, "custom_metrics": {"outflow_rate_min": 785.2539154411767, "system_level_velocity_min": 13.287297581474412, "cost1_max": 431.5825313816696, "cost2_max": -27.52659747756691, "cost2_min": -70.11987953566981, "outflow_rate_max": 1067.872352429571, "system_level_velocity_mean": 15.808832305692022, "cost1_mean": 401.07408627521266, "cost2_mean": -39.19904826926742, "outflow_rate_mean": 896.1917547320844, "system_level_velocity_max": 17.64439894777157, "cost1_min": 167.7465265990609}, "policy_reward_mean": {}, "timesteps_this_iter": 42188, "training_iteration": 177, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438215, "hostname": "flow-main", "episode_reward_max": 978.4153340204641, "episode_reward_min": 393.0513160672835, "episodes_total": 5565, "time_since_restore": 6499.347291946411, "date": "2019-05-21_11-30-15", "time_total_s": 6499.347291946411, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3aa90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3acc0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 696.08, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8931026, "sample_time_ms": 19929.887, "load_time_ms": 4.719, "grad_time_ms": 10387.541, "update_time_ms": 7.7, "default": {"policy_loss": -0.01287396252155304, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.20194728672504425, "total_loss": 58.90678405761719, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 58.91453552246094, "kl": 0.015170362778007984, "entropy": 1.8110295534133911}, "num_steps_sampled": 8931026}, "episodes_this_iter": 37, "time_this_iter_s": 30.48760962486267}
{"episode_reward_mean": 847.091555698211, "timesteps_total": 8972980, "iterations_since_restore": 178, "timesteps_since_restore": 8972980, "pid": 59703, "custom_metrics": {"outflow_rate_min": 503.01846532385935, "system_level_velocity_min": 13.287297581474412, "cost1_max": 431.5825313816696, "cost2_max": -18.72791852022218, "cost2_min": -70.11987953566981, "outflow_rate_max": 1067.872352429571, "system_level_velocity_mean": 15.806249264673705, "cost1_mean": 394.2237377428283, "cost2_mean": -38.64777312233536, "outflow_rate_mean": 885.6427577504584, "system_level_velocity_max": 18.499021296853034, "cost1_min": 24.89229805851002}, "policy_reward_mean": {}, "timesteps_this_iter": 41954, "training_iteration": 178, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438244, "hostname": "flow-main", "episode_reward_max": 978.4153340204641, "episode_reward_min": 62.56893961212711, "episodes_total": 5598, "time_since_restore": 6528.56871342659, "date": "2019-05-21_11-30-44", "time_total_s": 6528.56871342659, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3add8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a240>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 684.1, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 8972980, "sample_time_ms": 19923.547, "load_time_ms": 4.779, "grad_time_ms": 10307.216, "update_time_ms": 7.364, "default": {"policy_loss": -0.013858219608664513, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.24568292498588562, "total_loss": 51.68855667114258, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 51.69727325439453, "kl": 0.015250812284648418, "entropy": 1.841094732284546}, "num_steps_sampled": 8972980}, "episodes_this_iter": 33, "time_this_iter_s": 29.221421480178833}
{"episode_reward_mean": 846.228292724535, "timesteps_total": 9014797, "iterations_since_restore": 179, "timesteps_since_restore": 9014797, "pid": 59703, "custom_metrics": {"outflow_rate_min": 503.01846532385935, "system_level_velocity_min": 13.287297581474412, "cost1_max": 430.6623783504413, "cost2_max": -18.72791852022218, "cost2_min": -65.78342106305467, "outflow_rate_max": 1020.5994940089008, "system_level_velocity_mean": 15.749686765812676, "cost1_mean": 393.94798572544533, "cost2_mean": -38.49695178655537, "outflow_rate_mean": 879.3776718449475, "system_level_velocity_max": 18.499021296853034, "cost1_min": 24.89229805851002}, "policy_reward_mean": {}, "timesteps_this_iter": 41817, "training_iteration": 179, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438274, "hostname": "flow-main", "episode_reward_max": 978.4153340204641, "episode_reward_min": 62.56893961212711, "episodes_total": 5631, "time_since_restore": 6558.661761522293, "date": "2019-05-21_11-31-14", "time_total_s": 6558.661761522293, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cfd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32358>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 684.1, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9014797, "sample_time_ms": 19645.363, "load_time_ms": 4.738, "grad_time_ms": 10499.895, "update_time_ms": 7.543, "default": {"policy_loss": -0.013424612581729889, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.18620319664478302, "total_loss": 51.562103271484375, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 51.57038497924805, "kl": 0.015255776233971119, "entropy": 1.8447246551513672}, "num_steps_sampled": 9014797}, "episodes_this_iter": 33, "time_this_iter_s": 30.093048095703125}
{"episode_reward_mean": 847.0496707978186, "timesteps_total": 9057660, "iterations_since_restore": 180, "timesteps_since_restore": 9057660, "pid": 59703, "custom_metrics": {"outflow_rate_min": 503.01846532385935, "system_level_velocity_min": 14.229980227318023, "cost1_max": 430.5158318642864, "cost2_max": -18.72791852022218, "cost2_min": -62.11070417637954, "outflow_rate_max": 1000.2184077669903, "system_level_velocity_mean": 15.729775166569448, "cost1_mean": 396.2252499089269, "cost2_mean": -37.78513838534974, "outflow_rate_mean": 866.7686832834199, "system_level_velocity_max": 18.499021296853034, "cost1_min": 24.89229805851002}, "policy_reward_mean": {}, "timesteps_this_iter": 42863, "training_iteration": 180, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438305, "hostname": "flow-main", "episode_reward_max": 925.0079261735111, "episode_reward_min": 62.56893961212711, "episodes_total": 5664, "time_since_restore": 6588.99768280983, "date": "2019-05-21_11-31-45", "time_total_s": 6588.99768280983, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ab00>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 688.02, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9057660, "sample_time_ms": 19514.37, "load_time_ms": 4.752, "grad_time_ms": 10421.183, "update_time_ms": 7.564, "default": {"policy_loss": -0.014437692239880562, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2560696601867676, "total_loss": 50.22412872314453, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 50.23329162597656, "kl": 0.015645969659090042, "entropy": 1.8785427808761597}, "num_steps_sampled": 9057660}, "episodes_this_iter": 33, "time_this_iter_s": 30.33592128753662}
{"episode_reward_mean": 848.0435586544149, "timesteps_total": 9100073, "iterations_since_restore": 181, "timesteps_since_restore": 9100073, "pid": 59703, "custom_metrics": {"outflow_rate_min": 756.2875041118423, "system_level_velocity_min": 14.514378230898537, "cost1_max": 430.5158318642864, "cost2_max": -21.84520071076342, "cost2_min": -53.77062967417453, "outflow_rate_max": 932.3649979838711, "system_level_velocity_mean": 15.744394956170474, "cost1_mean": 401.30348551830895, "cost2_mean": -36.68627068666508, "outflow_rate_mean": 857.1375431582617, "system_level_velocity_max": 17.651554003203046, "cost1_min": 135.0639911573957}, "policy_reward_mean": {}, "timesteps_this_iter": 42413, "training_iteration": 181, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438335, "hostname": "flow-main", "episode_reward_max": 916.7053607456238, "episode_reward_min": 273.97704359551676, "episodes_total": 5699, "time_since_restore": 6618.947896718979, "date": "2019-05-21_11-32-15", "time_total_s": 6618.947896718979, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81c016f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf32390>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.15, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9100073, "sample_time_ms": 19636.399, "load_time_ms": 4.863, "grad_time_ms": 10410.281, "update_time_ms": 7.575, "default": {"policy_loss": -0.013180866837501526, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.293345183134079, "total_loss": 49.283721923828125, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 49.291839599609375, "kl": 0.014998219907283783, "entropy": 1.8703798055648804}, "num_steps_sampled": 9100073}, "episodes_this_iter": 35, "time_this_iter_s": 29.95021390914917}
{"episode_reward_mean": 837.3155952958427, "timesteps_total": 9142724, "iterations_since_restore": 182, "timesteps_since_restore": 9142724, "pid": 59703, "custom_metrics": {"outflow_rate_min": 703.2263320463317, "system_level_velocity_min": 13.992315025879263, "cost1_max": 439.25298648069236, "cost2_max": -21.84520071076342, "cost2_min": -57.9900683063635, "outflow_rate_max": 953.0087963800906, "system_level_velocity_mean": 15.802244745272644, "cost1_mean": 401.63831272507355, "cost2_mean": -36.237030053842076, "outflow_rate_mean": 845.4720050752512, "system_level_velocity_max": 17.836646300819453, "cost1_min": 135.0639911573957}, "policy_reward_mean": {}, "timesteps_this_iter": 42651, "training_iteration": 182, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438363, "hostname": "flow-main", "episode_reward_max": 911.4537926911424, "episode_reward_min": 273.97704359551676, "episodes_total": 5732, "time_since_restore": 6647.354309797287, "date": "2019-05-21_11-32-43", "time_total_s": 6647.354309797287, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ae10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a6d8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 695.15, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9142724, "sample_time_ms": 19278.759, "load_time_ms": 4.86, "grad_time_ms": 10484.53, "update_time_ms": 7.614, "default": {"policy_loss": -0.01240435428917408, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2643100321292877, "total_loss": 52.3237419128418, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 52.33125686645508, "kl": 0.014508617110550404, "entropy": 1.8824694156646729}, "num_steps_sampled": 9142724}, "episodes_this_iter": 33, "time_this_iter_s": 28.406413078308105}
{"episode_reward_mean": 834.9478411610445, "timesteps_total": 9184615, "iterations_since_restore": 183, "timesteps_since_restore": 9184615, "pid": 59703, "custom_metrics": {"outflow_rate_min": 703.2263320463317, "system_level_velocity_min": 13.950199796843602, "cost1_max": 439.25298648069236, "cost2_max": -21.84520071076342, "cost2_min": -59.91906115228457, "outflow_rate_max": 953.0087963800906, "system_level_velocity_mean": 15.763428096361281, "cost1_mean": 399.69038898509456, "cost2_mean": -36.74625870476552, "outflow_rate_mean": 846.2473046536246, "system_level_velocity_max": 17.836646300819453, "cost1_min": 135.0639911573957}, "policy_reward_mean": {}, "timesteps_this_iter": 41891, "training_iteration": 183, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438392, "hostname": "flow-main", "episode_reward_max": 908.5416885065064, "episode_reward_min": 273.97704359551676, "episodes_total": 5767, "time_since_restore": 6676.703322172165, "date": "2019-05-21_11-33-12", "time_total_s": 6676.703322172165, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a5f8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 694.72, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9184615, "sample_time_ms": 19263.834, "load_time_ms": 4.791, "grad_time_ms": 10269.801, "update_time_ms": 7.591, "default": {"policy_loss": -0.014347811229526997, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.222933828830719, "total_loss": 57.74797058105469, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 57.7569465637207, "kl": 0.015920113772153854, "entropy": 1.8624184131622314}, "num_steps_sampled": 9184615}, "episodes_this_iter": 35, "time_this_iter_s": 29.34901237487793}
{"episode_reward_mean": 831.2341485630798, "timesteps_total": 9226831, "iterations_since_restore": 184, "timesteps_since_restore": 9226831, "pid": 59703, "custom_metrics": {"outflow_rate_min": 499.88320831925165, "system_level_velocity_min": 13.015625434349214, "cost1_max": 439.25298648069236, "cost2_max": -16.638380860469923, "cost2_min": -59.91906115228457, "outflow_rate_max": 962.4920425690815, "system_level_velocity_mean": 15.784315362096825, "cost1_mean": 397.38747710416095, "cost2_mean": -37.165610121125646, "outflow_rate_mean": 845.439884378104, "system_level_velocity_max": 18.09133503513694, "cost1_min": 22.343655720170744}, "policy_reward_mean": {}, "timesteps_this_iter": 42216, "training_iteration": 184, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438423, "hostname": "flow-main", "episode_reward_max": 908.5416885065064, "episode_reward_min": 55.745414712195, "episodes_total": 5802, "time_since_restore": 6706.843101739883, "date": "2019-05-21_11-33-43", "time_total_s": 6706.843101739883, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ab00>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 692.49, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9226831, "sample_time_ms": 19405.518, "load_time_ms": 4.787, "grad_time_ms": 10305.417, "update_time_ms": 7.492, "default": {"policy_loss": -0.015202730894088745, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.24175412952899933, "total_loss": 53.099056243896484, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 53.10847854614258, "kl": 0.017121797427535057, "entropy": 1.8874328136444092}, "num_steps_sampled": 9226831}, "episodes_this_iter": 35, "time_this_iter_s": 30.139779567718506}
{"episode_reward_mean": 838.9063146362695, "timesteps_total": 9268596, "iterations_since_restore": 185, "timesteps_since_restore": 9268596, "pid": 59703, "custom_metrics": {"outflow_rate_min": 499.88320831925165, "system_level_velocity_min": 13.015625434349214, "cost1_max": 434.84278913846725, "cost2_max": -16.638380860469923, "cost2_min": -59.91906115228457, "outflow_rate_max": 1018.5118723640398, "system_level_velocity_mean": 15.855879678720529, "cost1_mean": 398.2366510053821, "cost2_mean": -37.17646809169982, "outflow_rate_mean": 858.5906909260904, "system_level_velocity_max": 18.09133503513694, "cost1_min": 22.343655720170744}, "policy_reward_mean": {}, "timesteps_this_iter": 41765, "training_iteration": 185, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438452, "hostname": "flow-main", "episode_reward_max": 906.2926252126564, "episode_reward_min": 55.745414712195, "episodes_total": 5837, "time_since_restore": 6736.636162996292, "date": "2019-05-21_11-34-12", "time_total_s": 6736.636162996292, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f9e8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 691.17, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9268596, "sample_time_ms": 19312.312, "load_time_ms": 5.036, "grad_time_ms": 10403.88, "update_time_ms": 7.512, "default": {"policy_loss": -0.015547049231827259, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2805682122707367, "total_loss": 50.60453414916992, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 50.61465835571289, "kl": 0.016063014045357704, "entropy": 1.8636947870254517}, "num_steps_sampled": 9268596}, "episodes_this_iter": 35, "time_this_iter_s": 29.79306125640869}
{"episode_reward_mean": 846.7871602602293, "timesteps_total": 9311266, "iterations_since_restore": 186, "timesteps_since_restore": 9311266, "pid": 59703, "custom_metrics": {"outflow_rate_min": 499.88320831925165, "system_level_velocity_min": 13.69449666742486, "cost1_max": 440.6784143344578, "cost2_max": -16.638380860469923, "cost2_min": -63.76529131739031, "outflow_rate_max": 1026.225672313084, "system_level_velocity_mean": 15.959838802012571, "cost1_mean": 401.0745174481042, "cost2_mean": -37.32791066764938, "outflow_rate_mean": 871.9000861071015, "system_level_velocity_max": 18.09133503513694, "cost1_min": 22.343655720170744}, "policy_reward_mean": {}, "timesteps_this_iter": 42670, "training_iteration": 186, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438485, "hostname": "flow-main", "episode_reward_max": 955.5904476403905, "episode_reward_min": 55.745414712195, "episodes_total": 5874, "time_since_restore": 6769.242337226868, "date": "2019-05-21_11-34-45", "time_total_s": 6769.242337226868, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a7b8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 691.6, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9311266, "sample_time_ms": 19705.366, "load_time_ms": 4.979, "grad_time_ms": 10237.457, "update_time_ms": 7.91, "default": {"policy_loss": -0.014533243142068386, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.24829009175300598, "total_loss": 54.34286880493164, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 54.3523063659668, "kl": 0.015095175243914127, "entropy": 1.8624004125595093}, "num_steps_sampled": 9311266}, "episodes_this_iter": 37, "time_this_iter_s": 32.60617423057556}
{"episode_reward_mean": 858.3180296018916, "timesteps_total": 9353265, "iterations_since_restore": 187, "timesteps_since_restore": 9353265, "pid": 59703, "custom_metrics": {"outflow_rate_min": 717.5925536639527, "system_level_velocity_min": 13.69449666742486, "cost1_max": 440.6784143344578, "cost2_max": -24.822469008587962, "cost2_min": -63.76529131739031, "outflow_rate_max": 1072.9473346880409, "system_level_velocity_mean": 15.959960772571575, "cost1_mean": 405.38146594296524, "cost2_mean": -37.72241174182183, "outflow_rate_mean": 884.8228253096938, "system_level_velocity_max": 17.701554274128124, "cost1_min": 339.69155379343175}, "policy_reward_mean": {}, "timesteps_this_iter": 41999, "training_iteration": 187, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438515, "hostname": "flow-main", "episode_reward_max": 955.5904476403905, "episode_reward_min": 672.8865604576544, "episodes_total": 5905, "time_since_restore": 6799.026990890503, "date": "2019-05-21_11-35-15", "time_total_s": 6799.026990890503, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3cac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3c7b8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 698.68, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9353265, "sample_time_ms": 19550.194, "load_time_ms": 4.963, "grad_time_ms": 10320.859, "update_time_ms": 7.895, "default": {"policy_loss": -0.014382260851562023, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.22456081211566925, "total_loss": 53.36073303222656, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 53.36973571777344, "kl": 0.015946410596370697, "entropy": 1.870191216468811}, "num_steps_sampled": 9353265}, "episodes_this_iter": 31, "time_this_iter_s": 29.784653663635254}
{"episode_reward_mean": 858.5108000290522, "timesteps_total": 9395628, "iterations_since_restore": 188, "timesteps_since_restore": 9395628, "pid": 59703, "custom_metrics": {"outflow_rate_min": 717.5925536639527, "system_level_velocity_min": 14.084150259537806, "cost1_max": 444.5354043824001, "cost2_max": -24.822469008587962, "cost2_min": -71.33217278943523, "outflow_rate_max": 1072.9473346880409, "system_level_velocity_mean": 15.818557370486984, "cost1_mean": 400.6752577003029, "cost2_mean": -39.11285100688231, "outflow_rate_mean": 895.0729763896987, "system_level_velocity_max": 17.98332107343892, "cost1_min": 189.14279516682225}, "policy_reward_mean": {}, "timesteps_this_iter": 42363, "training_iteration": 188, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438545, "hostname": "flow-main", "episode_reward_max": 955.5904476403905, "episode_reward_min": 399.74193813545526, "episodes_total": 5938, "time_since_restore": 6828.969331502914, "date": "2019-05-21_11-35-45", "time_total_s": 6828.969331502914, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a7b8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 696.05, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9395628, "sample_time_ms": 19559.715, "load_time_ms": 4.925, "grad_time_ms": 10383.797, "update_time_ms": 8.032, "default": {"policy_loss": -0.0128795076161623, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.24344348907470703, "total_loss": 46.02002716064453, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 46.0274543762207, "kl": 0.016149058938026428, "entropy": 1.8695471286773682}, "num_steps_sampled": 9395628}, "episodes_this_iter": 33, "time_this_iter_s": 29.9423406124115}
{"episode_reward_mean": 859.2972124496181, "timesteps_total": 9437428, "iterations_since_restore": 189, "timesteps_since_restore": 9437428, "pid": 59703, "custom_metrics": {"outflow_rate_min": 717.5925536639527, "system_level_velocity_min": 14.084150259537806, "cost1_max": 444.5354043824001, "cost2_max": -25.399264300874727, "cost2_min": -71.33217278943523, "outflow_rate_max": 1072.9473346880409, "system_level_velocity_mean": 15.847125183819813, "cost1_mean": 398.9630661345893, "cost2_mean": -39.33944946077449, "outflow_rate_mean": 900.7470791575938, "system_level_velocity_max": 17.98332107343892, "cost1_min": 187.34871589521862}, "policy_reward_mean": {}, "timesteps_this_iter": 41800, "training_iteration": 189, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438574, "hostname": "flow-main", "episode_reward_max": 962.5128174301648, "episode_reward_min": 399.74193813545526, "episodes_total": 5971, "time_since_restore": 6858.151810407639, "date": "2019-05-21_11-36-14", "time_total_s": 6858.151810407639, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ae80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3aa20>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 692.1, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9437428, "sample_time_ms": 19621.418, "load_time_ms": 4.879, "grad_time_ms": 10231.871, "update_time_ms": 7.847, "default": {"policy_loss": -0.014552406035363674, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.24612927436828613, "total_loss": 52.468048095703125, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 52.47734069824219, "kl": 0.01558951660990715, "entropy": 1.8877067565917969}, "num_steps_sampled": 9437428}, "episodes_this_iter": 33, "time_this_iter_s": 29.18247890472412}
{"episode_reward_mean": 864.4662348036633, "timesteps_total": 9479371, "iterations_since_restore": 190, "timesteps_since_restore": 9479371, "pid": 59703, "custom_metrics": {"outflow_rate_min": 753.2843902439022, "system_level_velocity_min": 14.0463411276302, "cost1_max": 444.5354043824001, "cost2_max": -25.399264300874727, "cost2_min": -71.33217278943523, "outflow_rate_max": 1059.1277572689135, "system_level_velocity_mean": 15.790712745852243, "cost1_mean": 397.80384858503174, "cost2_mean": -39.75592377568912, "outflow_rate_mean": 906.376330317482, "system_level_velocity_max": 17.98332107343892, "cost1_min": 187.34871589521862}, "policy_reward_mean": {}, "timesteps_this_iter": 41943, "training_iteration": 190, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438607, "hostname": "flow-main", "episode_reward_max": 962.5128174301648, "episode_reward_min": 399.74193813545526, "episodes_total": 6004, "time_since_restore": 6890.911796331406, "date": "2019-05-21_11-36-47", "time_total_s": 6890.911796331406, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ad30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ac88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a5c0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 692.1, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9479371, "sample_time_ms": 19655.593, "load_time_ms": 4.838, "grad_time_ms": 10441.081, "update_time_ms": 7.931, "default": {"policy_loss": -0.013212897814810276, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.27638667821884155, "total_loss": 56.076541900634766, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 56.0844612121582, "kl": 0.0156863946467638, "entropy": 1.8942548036575317}, "num_steps_sampled": 9479371}, "episodes_this_iter": 33, "time_this_iter_s": 32.75998592376709}
{"episode_reward_mean": 860.8244639163496, "timesteps_total": 9521487, "iterations_since_restore": 191, "timesteps_since_restore": 9521487, "pid": 59703, "custom_metrics": {"outflow_rate_min": 753.2843902439022, "system_level_velocity_min": 14.0463411276302, "cost1_max": 436.13778236797236, "cost2_max": -25.557732938996264, "cost2_min": -69.17125264369325, "outflow_rate_max": 1053.8622540250446, "system_level_velocity_mean": 15.901697850151479, "cost1_mean": 398.75560660280905, "cost2_mean": -38.46673880222691, "outflow_rate_mean": 902.305102860925, "system_level_velocity_max": 17.429310136403814, "cost1_min": 187.34871589521862}, "policy_reward_mean": {}, "timesteps_this_iter": 42116, "training_iteration": 191, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438636, "hostname": "flow-main", "episode_reward_max": 962.5128174301648, "episode_reward_min": 417.85988409872533, "episodes_total": 6035, "time_since_restore": 6919.662098407745, "date": "2019-05-21_11-37-16", "time_total_s": 6919.662098407745, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ada0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3afd0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 689.36, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9521487, "sample_time_ms": 19516.849, "load_time_ms": 4.751, "grad_time_ms": 10461.184, "update_time_ms": 7.822, "default": {"policy_loss": -0.013597285374999046, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.22589749097824097, "total_loss": 49.07640838623047, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 49.08436965942383, "kl": 0.016691578552126884, "entropy": 1.8890985250473022}, "num_steps_sampled": 9521487}, "episodes_this_iter": 31, "time_this_iter_s": 28.75030207633972}
{"episode_reward_mean": 864.1280277078415, "timesteps_total": 9563079, "iterations_since_restore": 192, "timesteps_since_restore": 9563079, "pid": 59703, "custom_metrics": {"outflow_rate_min": 753.2843902439022, "system_level_velocity_min": 13.751506579258058, "cost1_max": 436.13778236797236, "cost2_max": -25.557732938996264, "cost2_min": -69.17125264369325, "outflow_rate_max": 1038.725346742091, "system_level_velocity_mean": 15.882086214821918, "cost1_mean": 399.65803243816873, "cost2_mean": -38.634397265825804, "outflow_rate_mean": 905.4548974942101, "system_level_velocity_max": 17.413625823600185, "cost1_min": 242.38121015385087}, "policy_reward_mean": {}, "timesteps_this_iter": 41592, "training_iteration": 192, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438667, "hostname": "flow-main", "episode_reward_max": 949.9043582117303, "episode_reward_min": 516.4051401297864, "episodes_total": 6072, "time_since_restore": 6951.097806930542, "date": "2019-05-21_11-37-47", "time_total_s": 6951.097806930542, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf2f240>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 691.98, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9563079, "sample_time_ms": 19874.374, "load_time_ms": 4.757, "grad_time_ms": 10406.953, "update_time_ms": 7.824, "default": {"policy_loss": -0.011657897382974625, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.20061765611171722, "total_loss": 57.75596237182617, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 57.761940002441406, "kl": 0.016822952777147293, "entropy": 1.8645669221878052}, "num_steps_sampled": 9563079}, "episodes_this_iter": 37, "time_this_iter_s": 31.43570852279663}
{"episode_reward_mean": 862.3657463300653, "timesteps_total": 9605060, "iterations_since_restore": 193, "timesteps_since_restore": 9605060, "pid": 59703, "custom_metrics": {"outflow_rate_min": 776.8313064295487, "system_level_velocity_min": 13.751506579258058, "cost1_max": 437.38649036957884, "cost2_max": -25.557732938996264, "cost2_min": -66.72020020444273, "outflow_rate_max": 1038.725346742091, "system_level_velocity_mean": 15.88221881177012, "cost1_mean": 399.16246428333767, "cost2_mean": -39.001623444134886, "outflow_rate_mean": 903.8066249553875, "system_level_velocity_max": 17.68981638571071, "cost1_min": 242.38121015385087}, "policy_reward_mean": {}, "timesteps_this_iter": 41981, "training_iteration": 193, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438698, "hostname": "flow-main", "episode_reward_max": 950.2906576905926, "episode_reward_min": 516.4051401297864, "episodes_total": 6105, "time_since_restore": 6981.479690074921, "date": "2019-05-21_11-38-18", "time_total_s": 6981.479690074921, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a8d0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 691.98, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9605060, "sample_time_ms": 19805.466, "load_time_ms": 4.842, "grad_time_ms": 10579.011, "update_time_ms": 7.814, "default": {"policy_loss": -0.011822547763586044, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.21397089958190918, "total_loss": 53.023067474365234, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 53.02933120727539, "kl": 0.01646238937973976, "entropy": 1.8926856517791748}, "num_steps_sampled": 9605060}, "episodes_this_iter": 33, "time_this_iter_s": 30.381883144378662}
{"episode_reward_mean": 874.5650007244087, "timesteps_total": 9647882, "iterations_since_restore": 194, "timesteps_since_restore": 9647882, "pid": 59703, "custom_metrics": {"outflow_rate_min": 754.569931181775, "system_level_velocity_min": 13.654973100390214, "cost1_max": 437.38649036957884, "cost2_max": -27.863001040730964, "cost2_min": -66.72020020444273, "outflow_rate_max": 1038.725346742091, "system_level_velocity_mean": 15.739381631054163, "cost1_mean": 399.58678813349155, "cost2_mean": -41.04819534963913, "outflow_rate_mean": 912.6741235361601, "system_level_velocity_max": 17.68981638571071, "cost1_min": 300.10119067250554}, "policy_reward_mean": {}, "timesteps_this_iter": 42822, "training_iteration": 194, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438729, "hostname": "flow-main", "episode_reward_max": 963.5838510341888, "episode_reward_min": 704.3093484471625, "episodes_total": 6140, "time_since_restore": 7012.358087539673, "date": "2019-05-21_11-38-49", "time_total_s": 7012.358087539673, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3acf8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 698.67, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9647882, "sample_time_ms": 19861.768, "load_time_ms": 4.824, "grad_time_ms": 10596.665, "update_time_ms": 7.92, "default": {"policy_loss": -0.012708109803497791, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.2132013738155365, "total_loss": 53.517860412597656, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 53.52505111694336, "kl": 0.016331184655427933, "entropy": 1.8875077962875366}, "num_steps_sampled": 9647882}, "episodes_this_iter": 35, "time_this_iter_s": 30.878397464752197}
{"episode_reward_mean": 877.8312312077464, "timesteps_total": 9691399, "iterations_since_restore": 195, "timesteps_since_restore": 9691399, "pid": 59703, "custom_metrics": {"outflow_rate_min": 754.569931181775, "system_level_velocity_min": 13.654973100390214, "cost1_max": 437.38649036957884, "cost2_max": -27.863001040730964, "cost2_min": -63.57238651470699, "outflow_rate_max": 1038.1442987599003, "system_level_velocity_mean": 15.640789033639194, "cost1_mean": 398.20727273863463, "cost2_mean": -41.102128967654515, "outflow_rate_mean": 909.7951720751222, "system_level_velocity_max": 17.68981638571071, "cost1_min": 342.06596608162334}, "policy_reward_mean": {}, "timesteps_this_iter": 43517, "training_iteration": 195, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438759, "hostname": "flow-main", "episode_reward_max": 963.5838510341888, "episode_reward_min": 782.0599568836087, "episodes_total": 6174, "time_since_restore": 7043.090173244476, "date": "2019-05-21_11-39-19", "time_total_s": 7043.090173244476, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3add8>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9691399, "sample_time_ms": 19961.035, "load_time_ms": 4.838, "grad_time_ms": 10592.702, "update_time_ms": 7.915, "default": {"policy_loss": -0.013793435879051685, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.25656306743621826, "total_loss": 50.79154586791992, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 50.799800872802734, "kl": 0.016415640711784363, "entropy": 1.8898756504058838}, "num_steps_sampled": 9691399}, "episodes_this_iter": 34, "time_this_iter_s": 30.732085704803467}
{"episode_reward_mean": 870.921332525253, "timesteps_total": 9734955, "iterations_since_restore": 196, "timesteps_since_restore": 9734955, "pid": 59703, "custom_metrics": {"outflow_rate_min": 492.665104950494, "system_level_velocity_min": 13.654973100390214, "cost1_max": 421.4319525976375, "cost2_max": -17.738576315230784, "cost2_min": -71.97794611519701, "outflow_rate_max": 1043.5542123984787, "system_level_velocity_mean": 15.471450082843774, "cost1_mean": 389.11135026054313, "cost2_mean": -40.97386341168716, "outflow_rate_mean": 908.865970629019, "system_level_velocity_max": 18.554529299359174, "cost1_min": 22.922836809888274}, "policy_reward_mean": {}, "timesteps_this_iter": 43556, "training_iteration": 196, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438791, "hostname": "flow-main", "episode_reward_max": 964.9601412007734, "episode_reward_min": 58.77974668164067, "episodes_total": 6209, "time_since_restore": 7074.77140045166, "date": "2019-05-21_11-39-51", "time_total_s": 7074.77140045166, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a8d0>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 689.4, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9734955, "sample_time_ms": 19670.475, "load_time_ms": 4.962, "grad_time_ms": 10790.928, "update_time_ms": 7.581, "default": {"policy_loss": -0.01290744636207819, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.22706347703933716, "total_loss": 54.779754638671875, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 54.787452697753906, "kl": 0.015414995141327381, "entropy": 1.8911328315734863}, "num_steps_sampled": 9734955}, "episodes_this_iter": 35, "time_this_iter_s": 31.681227207183838}
{"episode_reward_mean": 872.8329871369789, "timesteps_total": 9778312, "iterations_since_restore": 197, "timesteps_since_restore": 9778312, "pid": 59703, "custom_metrics": {"outflow_rate_min": 492.665104950494, "system_level_velocity_min": 13.73401695073894, "cost1_max": 420.6106726878264, "cost2_max": -17.738576315230784, "cost2_min": -71.97794611519701, "outflow_rate_max": 1043.5542123984787, "system_level_velocity_mean": 15.386290774292398, "cost1_mean": 388.07967850180995, "cost2_mean": -40.544743788847754, "outflow_rate_mean": 906.7380520687733, "system_level_velocity_max": 18.554529299359174, "cost1_min": 22.922836809888274}, "policy_reward_mean": {}, "timesteps_this_iter": 43357, "training_iteration": 197, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438821, "hostname": "flow-main", "episode_reward_max": 964.9601412007734, "episode_reward_min": 58.77974668164067, "episodes_total": 6241, "time_since_restore": 7104.832541227341, "date": "2019-05-21_11-40-21", "time_total_s": 7104.832541227341, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3afd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a630>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 689.4, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9778312, "sample_time_ms": 19763.652, "load_time_ms": 4.997, "grad_time_ms": 10725.859, "update_time_ms": 7.615, "default": {"policy_loss": -0.014462511986494064, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.24406634271144867, "total_loss": 48.10839080810547, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 48.11729049682617, "kl": 0.016472103074193, "entropy": 1.902268648147583}, "num_steps_sampled": 9778312}, "episodes_this_iter": 32, "time_this_iter_s": 30.061140775680542}
{"episode_reward_mean": 875.904108697573, "timesteps_total": 9822146, "iterations_since_restore": 198, "timesteps_since_restore": 9822146, "pid": 59703, "custom_metrics": {"outflow_rate_min": 492.665104950494, "system_level_velocity_min": 13.73401695073894, "cost1_max": 425.80691861699785, "cost2_max": -17.738576315230784, "cost2_min": -71.97794611519701, "outflow_rate_max": 1043.5542123984787, "system_level_velocity_mean": 15.325973337984278, "cost1_mean": 388.1942669886493, "cost2_mean": -40.03328406196308, "outflow_rate_mean": 908.2001809132655, "system_level_velocity_max": 18.554529299359174, "cost1_min": 22.922836809888274}, "policy_reward_mean": {}, "timesteps_this_iter": 43834, "training_iteration": 198, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438853, "hostname": "flow-main", "episode_reward_max": 964.9601412007734, "episode_reward_min": 58.77974668164067, "episodes_total": 6274, "time_since_restore": 7136.854101657867, "date": "2019-05-21_11-40-53", "time_total_s": 7136.854101657867, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3acf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3aeb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a710>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 689.4, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9822146, "sample_time_ms": 19972.293, "load_time_ms": 5.062, "grad_time_ms": 10724.454, "update_time_ms": 7.541, "default": {"policy_loss": -0.013525730930268764, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.31114670634269714, "total_loss": 51.67341613769531, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 51.68181228637695, "kl": 0.015215237624943256, "entropy": 1.8757673501968384}, "num_steps_sampled": 9822146}, "episodes_this_iter": 33, "time_this_iter_s": 32.02156043052673}
{"episode_reward_mean": 890.9627767109818, "timesteps_total": 9866233, "iterations_since_restore": 199, "timesteps_since_restore": 9866233, "pid": 59703, "custom_metrics": {"outflow_rate_min": 776.0530922389269, "system_level_velocity_min": 13.375904667422612, "cost1_max": 425.80691861699785, "cost2_max": -28.641063846048212, "cost2_min": -67.12992890215564, "outflow_rate_max": 1051.7021748518548, "system_level_velocity_mean": 15.213241291188588, "cost1_mean": 393.4007122844045, "cost2_mean": -40.07412536958167, "outflow_rate_mean": 912.2452403919608, "system_level_velocity_max": 17.143413458314942, "cost1_min": 347.2225716669631}, "policy_reward_mean": {}, "timesteps_this_iter": 44087, "training_iteration": 199, "node_ip": "10.138.0.2", "done": false, "timestamp": 1558438885, "hostname": "flow-main", "episode_reward_max": 996.3059355783711, "episode_reward_min": 768.486686006467, "episodes_total": 6306, "time_since_restore": 7168.230885028839, "date": "2019-05-21_11-41-25", "time_total_s": 7168.230885028839, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a080>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 700.0, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9866233, "sample_time_ms": 19953.982, "load_time_ms": 5.367, "grad_time_ms": 10961.316, "update_time_ms": 7.565, "default": {"policy_loss": -0.014238215051591396, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.33975836634635925, "total_loss": 46.941402435302734, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 46.95029830932617, "kl": 0.01583208702504635, "entropy": 1.8959487676620483}, "num_steps_sampled": 9866233}, "episodes_this_iter": 32, "time_this_iter_s": 31.37678337097168}
{"episode_reward_mean": 895.5526180146641, "timesteps_total": 9911327, "iterations_since_restore": 200, "timesteps_since_restore": 9911327, "pid": 59703, "custom_metrics": {"outflow_rate_min": 776.0530922389269, "system_level_velocity_min": 12.792266650667186, "cost1_max": 425.80691861699785, "cost2_max": -28.709923433902404, "cost2_min": -67.12992890215564, "outflow_rate_max": 1056.756161199625, "system_level_velocity_mean": 15.146749214572766, "cost1_mean": 392.75357011507367, "cost2_mean": -40.37253302023213, "outflow_rate_mean": 914.82305214352, "system_level_velocity_max": 17.143413458314942, "cost1_min": 329.29375113800074}, "policy_reward_mean": {}, "timesteps_this_iter": 45094, "training_iteration": 200, "node_ip": "10.138.0.2", "done": true, "timestamp": 1558438917, "hostname": "flow-main", "episode_reward_max": 996.3059355783711, "episode_reward_min": 768.486686006467, "episodes_total": 6337, "time_since_restore": 7200.220092058182, "date": "2019-05-21_11-41-57", "time_total_s": 7200.220092058182, "config": {"monitor": false, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:10.0_buf_len: 1", "custom_resources_per_worker": {}, "output_compress_columns": ["obs", "new_obs"], "lr_schedule": null, "collect_metrics_timeout": 180, "num_cpus_for_driver": 1, "model": {"conv_filters": null, "zero_mean": true, "framestack": true, "lstm_cell_size": 256, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "dim": 84, "free_log_std": false, "conv_activation": "relu", "use_lstm": false, "custom_options": {}, "max_seq_len": 20, "fcnet_activation": "tanh", "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null}, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "input_evaluation": null, "vf_loss_coeff": 1.0, "vf_share_layers": false, "clip_param": 0.3, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "preprocessor_pref": "deepmind", "sample_batch_size": 750, "lambda": 0.97, "output_max_file_size": 67108864, "synchronize_filters": true, "num_gpus_per_worker": 0, "compress_observations": false, "output": null, "optimizer": {}, "entropy_coeff": 0.0, "gamma": 0.99, "train_batch_size": 30000, "num_envs_per_worker": 1, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "lr": 0.0005, "sample_async": false, "use_gae": true, "vf_clip_param": 1000000.0, "num_workers": 20, "straggler_mitigation": false, "num_gpus": 0, "clip_actions": false, "log_level": "INFO", "batch_mode": "truncate_episodes", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "kl_target": 0.01, "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ab00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3a588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7ff81bf3ac88>", "on_sample_end": null, "on_train_result": null}, "input": "sampler", "clip_rewards": null}, "episode_len_mean": 699.65, "num_metric_batches_dropped": 0, "experiment_id": "fe82f40c26154220842995cbad5df216", "info": {"num_steps_trained": 9911327, "sample_time_ms": 19951.227, "load_time_ms": 5.653, "grad_time_ms": 10885.57, "update_time_ms": 7.688, "default": {"policy_loss": -0.014658906497061253, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.37572288513183594, "total_loss": 43.62392807006836, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 43.63276290893555, "kl": 0.01726461760699749, "entropy": 1.8832716941833496}, "num_steps_sampled": 9911327}, "episodes_this_iter": 31, "time_this_iter_s": 31.98920702934265}

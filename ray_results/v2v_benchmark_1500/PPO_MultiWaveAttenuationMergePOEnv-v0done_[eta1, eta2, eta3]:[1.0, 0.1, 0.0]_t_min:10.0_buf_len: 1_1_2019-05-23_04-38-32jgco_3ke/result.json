{"episode_reward_max": -1109.9329748351513, "episode_reward_mean": -1884.2705748819571, "timestamp": 1558586418, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 27, "episode_len_mean": 700.0, "pid": 31789, "done": false, "episodes_total": 27, "info": {"update_time_ms": 1294.795, "sample_time_ms": 53559.882, "num_steps_trained": 60829, "grad_time_ms": 17327.811, "num_steps_sampled": 60829, "default": {"vf_loss": 35.01138687133789, "cur_lr": 0.0005000000237487257, "entropy": 1.4224342107772827, "vf_explained_var": 2.2983551843935857e-06, "kl": 0.0009027167106978595, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0002815161133185029, "total_loss": 35.01128387451172}, "load_time_ms": 65.474}, "training_iteration": 1, "hostname": "flow-main", "time_since_restore": 72.41910243034363, "iterations_since_restore": 1, "timesteps_since_restore": 60829, "date": "2019-05-23_04-40-18", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 60829, "num_metric_batches_dropped": 0, "time_total_s": 72.41910243034363, "episode_reward_min": -2422.075983957352, "time_this_iter_s": 72.41910243034363, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf2fef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf2feb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf2ff28>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 160.9441060649038, "outflow_rate_min": 242.09481174563146, "cost1_max": 262.62810262729056, "system_level_velocity_min": 6.271669414469552, "cost2_min": -80.01270155102476, "cost1_mean": 198.97708176599124, "system_level_velocity_mean": 7.695484404083653, "cost2_max": -37.264330079034416, "outflow_rate_mean": 344.21012137921304, "outflow_rate_max": 607.2942118674918, "cost2_mean": -51.5473384996477, "system_level_velocity_max": 10.098261452570055}, "timesteps_this_iter": 60829}
{"episode_reward_max": -1109.9329748351513, "episode_reward_mean": -1866.334475193545, "timestamp": 1558586467, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 28, "episode_len_mean": 700.0, "pid": 31789, "done": false, "episodes_total": 55, "info": {"update_time_ms": 651.83, "sample_time_ms": 42477.244, "num_steps_trained": 125351, "grad_time_ms": 17352.64, "num_steps_sampled": 125351, "default": {"vf_loss": 29.41343879699707, "cur_lr": 0.0005000000237487257, "entropy": 1.4170970916748047, "vf_explained_var": 0.49511027336120605, "kl": 0.00552261620759964, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0019145662663504481, "total_loss": 29.41207504272461}, "load_time_ms": 37.133}, "training_iteration": 2, "hostname": "flow-main", "time_since_restore": 121.31188297271729, "iterations_since_restore": 2, "timesteps_since_restore": 125351, "date": "2019-05-23_04-41-07", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 125351, "num_metric_batches_dropped": 0, "time_total_s": 121.31188297271729, "episode_reward_min": -2618.4475155177042, "time_this_iter_s": 48.89278054237366, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed23c8>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 160.9441060649038, "outflow_rate_min": 242.09481174563146, "cost1_max": 262.62810262729056, "system_level_velocity_min": 6.271669414469552, "cost2_min": -82.34819660067082, "cost1_mean": 206.09445610609646, "system_level_velocity_mean": 7.962218837602553, "cost2_max": -35.1279357451609, "outflow_rate_mean": 394.8997323559447, "outflow_rate_max": 650.694705882353, "cost2_mean": -53.516005656532776, "system_level_velocity_max": 10.098261452570055}, "timesteps_this_iter": 64522}
{"episode_reward_max": -1109.9329748351513, "episode_reward_mean": -1862.130401227012, "timestamp": 1558586520, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 27, "episode_len_mean": 700.0, "pid": 31789, "done": false, "episodes_total": 82, "info": {"update_time_ms": 437.101, "sample_time_ms": 39963.81, "num_steps_trained": 190648, "grad_time_ms": 17512.91, "num_steps_sampled": 190648, "default": {"vf_loss": 42.752864837646484, "cur_lr": 0.0005000000237487257, "entropy": 1.4093869924545288, "vf_explained_var": 0.674458920955658, "kl": 0.008714491501450539, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0038209084887057543, "total_loss": 42.749916076660156}, "load_time_ms": 27.765}, "training_iteration": 3, "hostname": "flow-main", "time_since_restore": 174.219890832901, "iterations_since_restore": 3, "timesteps_since_restore": 190648, "date": "2019-05-23_04-42-00", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 190648, "num_metric_batches_dropped": 0, "time_total_s": 174.219890832901, "episode_reward_min": -2618.4475155177042, "time_this_iter_s": 52.908007860183716, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee12e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee12b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1320>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 160.9441060649038, "outflow_rate_min": 242.09481174563146, "cost1_max": 300.3020700509171, "system_level_velocity_min": 6.271669414469552, "cost2_min": -104.05226711628427, "cost1_mean": 216.36068348749757, "system_level_velocity_mean": 8.333744487368339, "cost2_max": -35.1279357451609, "outflow_rate_mean": 460.61060632618904, "outflow_rate_max": 834.4381646488312, "cost2_mean": -61.21519971257436, "system_level_velocity_max": 11.457142851125223}, "timesteps_this_iter": 65297}
{"episode_reward_max": -25.488681704230434, "episode_reward_mean": -1759.105992943407, "timestamp": 1558586569, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 29, "episode_len_mean": 693.27, "pid": 31789, "done": false, "episodes_total": 111, "info": {"update_time_ms": 330.108, "sample_time_ms": 38039.21, "num_steps_trained": 253679, "grad_time_ms": 17398.651, "num_steps_sampled": 253679, "default": {"vf_loss": 40.513633728027344, "cur_lr": 0.0005000000237487257, "entropy": 1.3846876621246338, "vf_explained_var": 0.8164823055267334, "kl": 0.015271571464836597, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.005417211912572384, "total_loss": 40.509742736816406}, "load_time_ms": 22.718}, "training_iteration": 4, "hostname": "flow-main", "time_since_restore": 223.66298079490662, "iterations_since_restore": 4, "timesteps_since_restore": 253679, "date": "2019-05-23_04-42-49", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 253679, "num_metric_batches_dropped": 0, "time_total_s": 223.66298079490662, "episode_reward_min": -2618.4475155177042, "time_this_iter_s": 49.443089962005615, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed24e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2390>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 17.53949543867252, "outflow_rate_min": 242.09481174563146, "cost1_max": 311.8597399316342, "system_level_velocity_min": 6.271669414469552, "cost2_min": -135.05955754267342, "cost1_mean": 232.42984836891003, "system_level_velocity_mean": 9.104627093823007, "cost2_max": -19.585525749003033, "outflow_rate_mean": 580.9331252903655, "outflow_rate_max": 1108.0378373181647, "cost2_mean": -70.13808592805849, "system_level_velocity_max": 16.751683469811773}, "timesteps_this_iter": 63031}
{"episode_reward_max": -25.488681704230434, "episode_reward_mean": -1607.939554454916, "timestamp": 1558586617, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 27, "episode_len_mean": 693.27, "pid": 31789, "done": false, "episodes_total": 138, "info": {"update_time_ms": 265.93, "sample_time_ms": 36669.261, "num_steps_trained": 311104, "grad_time_ms": 17122.2, "num_steps_sampled": 311104, "default": {"vf_loss": 30.00795555114746, "cur_lr": 0.0005000000237487257, "entropy": 1.3628976345062256, "vf_explained_var": 0.8825038075447083, "kl": 0.012216540053486824, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.005649005528539419, "total_loss": 30.003528594970703}, "load_time_ms": 19.643}, "training_iteration": 5, "hostname": "flow-main", "time_since_restore": 270.98569321632385, "iterations_since_restore": 5, "timesteps_since_restore": 311104, "date": "2019-05-23_04-43-37", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 311104, "num_metric_batches_dropped": 0, "time_total_s": 270.98569321632385, "episode_reward_min": -2618.4475155177042, "time_this_iter_s": 47.322712421417236, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2b00>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 17.53949543867252, "outflow_rate_min": 245.8720056875209, "cost1_max": 360.29705377897375, "system_level_velocity_min": 6.586126086080316, "cost2_min": -146.04367051300306, "cost1_mean": 265.56634387639974, "system_level_velocity_mean": 10.359838766636301, "cost2_max": -19.585525749003033, "outflow_rate_mean": 775.4546239772775, "outflow_rate_max": 1280.0055849950804, "cost2_mean": -84.57020195899453, "system_level_velocity_max": 16.751683469811773}, "timesteps_this_iter": 57425}
{"episode_reward_max": -25.488681704230434, "episode_reward_mean": -1450.284049081477, "timestamp": 1558586668, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 27, "episode_len_mean": 693.27, "pid": 31789, "done": false, "episodes_total": 165, "info": {"update_time_ms": 223.005, "sample_time_ms": 35896.308, "num_steps_trained": 372433, "grad_time_ms": 17530.863, "num_steps_sampled": 372433, "default": {"vf_loss": 36.176822662353516, "cur_lr": 0.0005000000237487257, "entropy": 1.3678443431854248, "vf_explained_var": 0.8730219006538391, "kl": 0.006497869733721018, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.002316428814083338, "total_loss": 36.17515182495117}, "load_time_ms": 17.764}, "training_iteration": 6, "hostname": "flow-main", "time_since_restore": 322.71420431137085, "iterations_since_restore": 6, "timesteps_since_restore": 372433, "date": "2019-05-23_04-44-28", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 372433, "num_metric_batches_dropped": 0, "time_total_s": 322.71420431137085, "episode_reward_min": -2358.719022270085, "time_this_iter_s": 51.728511095047, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1780>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 17.53949543867252, "outflow_rate_min": 341.83813243297715, "cost1_max": 379.87891506361257, "system_level_velocity_min": 7.781648371588924, "cost2_min": -151.5493701243454, "cost1_mean": 295.76635422639106, "system_level_velocity_mean": 11.498456639024733, "cost2_max": -19.585525749003033, "outflow_rate_mean": 961.8390907331881, "outflow_rate_max": 1371.1017648591705, "cost2_mean": -100.18047105310993, "system_level_velocity_max": 16.751683469811773}, "timesteps_this_iter": 61329}
{"episode_reward_max": -976.0418175210216, "episode_reward_mean": -1366.4547370961436, "timestamp": 1558586719, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 27, "episode_len_mean": 700.0, "pid": 31789, "done": false, "episodes_total": 192, "info": {"update_time_ms": 192.769, "sample_time_ms": 35269.891, "num_steps_trained": 436341, "grad_time_ms": 17658.606, "num_steps_sampled": 436341, "default": {"vf_loss": 44.3453369140625, "cur_lr": 0.0005000000237487257, "entropy": 1.3615964651107788, "vf_explained_var": 0.8571527004241943, "kl": 0.004857503343373537, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0013247549068182707, "total_loss": 44.34449768066406}, "load_time_ms": 16.457}, "training_iteration": 7, "hostname": "flow-main", "time_since_restore": 372.79838824272156, "iterations_since_restore": 7, "timesteps_since_restore": 436341, "date": "2019-05-23_04-45-19", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 436341, "num_metric_batches_dropped": 0, "time_total_s": 372.79838824272156, "episode_reward_min": -2125.0542375041446, "time_this_iter_s": 50.08418393135071, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee12e8>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 226.91497952872697, "outflow_rate_min": 535.0962362637363, "cost1_max": 421.2248002377161, "system_level_velocity_min": 8.88957679116659, "cost2_min": -174.6119666509295, "cost1_mean": 325.5992058913334, "system_level_velocity_mean": 12.458979748207891, "cost2_max": -53.4978540126875, "outflow_rate_mean": 1118.985747487999, "outflow_rate_max": 1436.5735896138951, "cost2_mean": -116.91793831797605, "system_level_velocity_max": 16.1789036538195}, "timesteps_this_iter": 63908}
{"episode_reward_max": -976.0418175210216, "episode_reward_mean": -1374.9683979007177, "timestamp": 1558586771, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 26, "episode_len_mean": 700.0, "pid": 31789, "done": false, "episodes_total": 218, "info": {"update_time_ms": 169.696, "sample_time_ms": 35078.186, "num_steps_trained": 502684, "grad_time_ms": 17788.711, "num_steps_sampled": 502684, "default": {"vf_loss": 44.028621673583984, "cur_lr": 0.0005000000237487257, "entropy": 1.3498848676681519, "vf_explained_var": 0.8736998438835144, "kl": 0.0051682936027646065, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0009145276271738112, "total_loss": 44.02796936035156}, "load_time_ms": 15.754}, "training_iteration": 8, "hostname": "flow-main", "time_since_restore": 425.40691614151, "iterations_since_restore": 8, "timesteps_since_restore": 502684, "date": "2019-05-23_04-46-11", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 502684, "num_metric_batches_dropped": 0, "time_total_s": 425.40691614151, "episode_reward_min": -1874.1561479125455, "time_this_iter_s": 52.60852789878845, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed26d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2a58>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 236.48611984422587, "outflow_rate_min": 785.7641803278691, "cost1_max": 431.47197920813306, "system_level_velocity_min": 8.88957679116659, "cost2_min": -180.78496183371203, "cost1_mean": 341.7709510090522, "system_level_velocity_mean": 13.034171923798546, "cost2_max": -56.80409387669466, "outflow_rate_mean": 1205.0852986035825, "outflow_rate_max": 1457.7718686661697, "cost2_mean": -132.8955051091529, "system_level_velocity_max": 16.520679720216616}, "timesteps_this_iter": 66343}
{"episode_reward_max": -25.100566676207922, "episode_reward_mean": -1434.1033103177845, "timestamp": 1558586821, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 31, "episode_len_mean": 693.27, "pid": 31789, "done": false, "episodes_total": 249, "info": {"update_time_ms": 151.869, "sample_time_ms": 34605.9, "num_steps_trained": 564855, "grad_time_ms": 17909.786, "num_steps_sampled": 564855, "default": {"vf_loss": 40.46822738647461, "cur_lr": 0.0005000000237487257, "entropy": 1.3473647832870483, "vf_explained_var": 0.8673425316810608, "kl": 0.006263671908527613, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0014456139178946614, "total_loss": 40.46709060668945}, "load_time_ms": 15.025}, "training_iteration": 9, "hostname": "flow-main", "time_since_restore": 475.23961997032166, "iterations_since_restore": 9, "timesteps_since_restore": 564855, "date": "2019-05-23_04-47-01", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 564855, "num_metric_batches_dropped": 0, "time_total_s": 475.23961997032166, "episode_reward_min": -1874.1561479125455, "time_this_iter_s": 49.832703828811646, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee11d0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 17.71966378632583, "outflow_rate_min": 442.8785900830537, "cost1_max": 431.47197920813306, "system_level_velocity_min": 8.88957679116659, "cost2_min": -197.03999158491976, "cost1_mean": 342.8933769654809, "system_level_velocity_mean": 13.218380493036584, "cost2_max": -20.377423073805193, "outflow_rate_mean": 1232.221012668914, "outflow_rate_max": 1526.8753631985996, "cost2_mean": -147.02043483998128, "system_level_velocity_max": 16.92072180890588}, "timesteps_this_iter": 62171}
{"episode_reward_max": -25.100566676207922, "episode_reward_mean": -1394.4470804983107, "timestamp": 1558586869, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 35, "episode_len_mean": 693.27, "pid": 31789, "done": false, "episodes_total": 284, "info": {"update_time_ms": 137.44, "sample_time_ms": 34163.125, "num_steps_trained": 623010, "grad_time_ms": 17920.428, "num_steps_sampled": 623010, "default": {"vf_loss": 37.19278335571289, "cur_lr": 0.0005000000237487257, "entropy": 1.331261396408081, "vf_explained_var": 0.8514679670333862, "kl": 0.0072344159707427025, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.00197929167188704, "total_loss": 37.191165924072266}, "load_time_ms": 14.386}, "training_iteration": 10, "hostname": "flow-main", "time_since_restore": 523.5915431976318, "iterations_since_restore": 10, "timesteps_since_restore": 623010, "date": "2019-05-23_04-47-49", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 623010, "num_metric_batches_dropped": 0, "time_total_s": 523.5915431976318, "episode_reward_min": -1873.20182147119, "time_this_iter_s": 48.35192322731018, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1668>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 17.71966378632583, "outflow_rate_min": 442.8785900830537, "cost1_max": 431.47197920813306, "system_level_velocity_min": 10.268090454529128, "cost2_min": -197.03999158491976, "cost1_mean": 349.9441518733705, "system_level_velocity_mean": 13.479830820905502, "cost2_max": -20.377423073805193, "outflow_rate_mean": 1252.4167770068768, "outflow_rate_max": 1533.332932806426, "cost2_mean": -148.82537371113148, "system_level_velocity_max": 16.92072180890588}, "timesteps_this_iter": 58155}
{"episode_reward_max": -25.100566676207922, "episode_reward_mean": -1289.2664934419881, "timestamp": 1558586917, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 31, "episode_len_mean": 693.27, "pid": 31789, "done": false, "episodes_total": 315, "info": {"update_time_ms": 8.964, "sample_time_ms": 31662.11, "num_steps_trained": 677843, "grad_time_ms": 18099.656, "num_steps_sampled": 677843, "default": {"vf_loss": 25.12055778503418, "cur_lr": 0.0005000000237487257, "entropy": 1.3125746250152588, "vf_explained_var": 0.870613694190979, "kl": 0.007780904415994883, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002234872430562973, "total_loss": 25.118709564208984}, "load_time_ms": 8.565}, "training_iteration": 11, "hostname": "flow-main", "time_since_restore": 571.392420053482, "iterations_since_restore": 11, "timesteps_since_restore": 677843, "date": "2019-05-23_04-48-37", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 677843, "num_metric_batches_dropped": 0, "time_total_s": 571.392420053482, "episode_reward_min": -1873.20182147119, "time_this_iter_s": 47.80087685585022, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee14e0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 17.71966378632583, "outflow_rate_min": 442.8785900830537, "cost1_max": 430.8806191778361, "system_level_velocity_min": 10.268090454529128, "cost2_min": -197.03999158491976, "cost1_mean": 353.5920891429538, "system_level_velocity_mean": 13.684994282226066, "cost2_max": -20.377423073805193, "outflow_rate_mean": 1264.2442371766238, "outflow_rate_max": 1533.332932806426, "cost2_mean": -139.33971672756786, "system_level_velocity_max": 16.92072180890588}, "timesteps_this_iter": 54833}
{"episode_reward_max": -32.82770851358767, "episode_reward_mean": -1101.4207896470432, "timestamp": 1558586961, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 35, "episode_len_mean": 691.23, "pid": 31789, "done": false, "episodes_total": 350, "info": {"update_time_ms": 8.943, "sample_time_ms": 31399.177, "num_steps_trained": 729517, "grad_time_ms": 17887.931, "num_steps_sampled": 729517, "default": {"vf_loss": 19.82459259033203, "cur_lr": 0.0005000000237487257, "entropy": 1.3068138360977173, "vf_explained_var": 0.8744968175888062, "kl": 0.007789203431457281, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0021964709740132093, "total_loss": 19.822784423828125}, "load_time_ms": 8.382}, "training_iteration": 12, "hostname": "flow-main", "time_since_restore": 615.5396959781647, "iterations_since_restore": 12, "timesteps_since_restore": 729517, "date": "2019-05-23_04-49-21", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 729517, "num_metric_batches_dropped": 0, "time_total_s": 615.5396959781647, "episode_reward_min": -1629.534727157584, "time_this_iter_s": 44.14727592468262, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed74a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed73c8>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 23.143651192636234, "outflow_rate_min": 460.7989278777953, "cost1_max": 426.2144105416146, "system_level_velocity_min": 10.87237857890963, "cost2_min": -170.66956799948807, "cost1_mean": 363.05914160914733, "system_level_velocity_mean": 14.204156703187174, "cost2_max": -23.601022055008812, "outflow_rate_mean": 1274.94728179799, "outflow_rate_max": 1533.332932806426, "cost2_mean": -120.75122148826532, "system_level_velocity_max": 18.588334952966736}, "timesteps_this_iter": 51674}
{"episode_reward_max": -32.82770851358767, "episode_reward_mean": -1046.498090506768, "timestamp": 1558587007, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 28, "episode_len_mean": 691.23, "pid": 31789, "done": false, "episodes_total": 378, "info": {"update_time_ms": 9.062, "sample_time_ms": 30892.106, "num_steps_trained": 785467, "grad_time_ms": 17695.761, "num_steps_sampled": 785467, "default": {"vf_loss": 22.68088150024414, "cur_lr": 0.0005000000237487257, "entropy": 1.295470118522644, "vf_explained_var": 0.8821113705635071, "kl": 0.007240847684442997, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0014198145363479853, "total_loss": 22.67982292175293}, "load_time_ms": 8.22}, "training_iteration": 13, "hostname": "flow-main", "time_since_restore": 661.4336364269257, "iterations_since_restore": 13, "timesteps_since_restore": 785467, "date": "2019-05-23_04-50-07", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 785467, "num_metric_batches_dropped": 0, "time_total_s": 661.4336364269257, "episode_reward_min": -1629.534727157584, "time_this_iter_s": 45.893940448760986, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed75c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7978>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 23.143651192636234, "outflow_rate_min": 460.7989278777953, "cost1_max": 437.7657287193517, "system_level_velocity_min": 10.87237857890963, "cost2_min": -154.0898477999246, "cost1_mean": 365.6151961228285, "system_level_velocity_mean": 14.35372027685218, "cost2_max": -23.601022055008812, "outflow_rate_mean": 1277.9325041298978, "outflow_rate_max": 1468.85423475666, "cost2_mean": -114.16667488994084, "system_level_velocity_max": 18.588334952966736}, "timesteps_this_iter": 55950}
{"episode_reward_max": -32.82770851358767, "episode_reward_mean": -1009.5061393451775, "timestamp": 1558587050, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 28, "episode_len_mean": 690.8, "pid": 31789, "done": false, "episodes_total": 406, "info": {"update_time_ms": 9.284, "sample_time_ms": 30507.472, "num_steps_trained": 839325, "grad_time_ms": 17389.575, "num_steps_sampled": 839325, "default": {"vf_loss": 19.504499435424805, "cur_lr": 0.0005000000237487257, "entropy": 1.2661367654800415, "vf_explained_var": 0.8913227915763855, "kl": 0.007731996476650238, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002452224027365446, "total_loss": 19.50243377685547}, "load_time_ms": 8.279}, "training_iteration": 14, "hostname": "flow-main", "time_since_restore": 703.9640641212463, "iterations_since_restore": 14, "timesteps_since_restore": 839325, "date": "2019-05-23_04-50-50", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 839325, "num_metric_batches_dropped": 0, "time_total_s": 703.9640641212463, "episode_reward_min": -1448.5077907135494, "time_this_iter_s": 42.53042769432068, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee14e0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 23.143651192636234, "outflow_rate_min": 460.7989278777953, "cost1_max": 444.6771948683515, "system_level_velocity_min": 11.167200196967642, "cost2_min": -153.51707284693947, "cost1_mean": 369.66465556276603, "system_level_velocity_mean": 14.51274685771517, "cost2_max": -23.601022055008812, "outflow_rate_mean": 1290.125458199003, "outflow_rate_max": 1468.85423475666, "cost2_mean": -112.69961112009187, "system_level_velocity_max": 18.588334952966736}, "timesteps_this_iter": 53858}
{"episode_reward_max": -32.82770851358767, "episode_reward_mean": -954.5419700698046, "timestamp": 1558587092, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 31, "episode_len_mean": 681.84, "pid": 31789, "done": false, "episodes_total": 437, "info": {"update_time_ms": 9.185, "sample_time_ms": 30314.301, "num_steps_trained": 892290, "grad_time_ms": 17030.821, "num_steps_sampled": 892290, "default": {"vf_loss": 15.344029426574707, "cur_lr": 0.0005000000237487257, "entropy": 1.2673468589782715, "vf_explained_var": 0.9025666117668152, "kl": 0.009322253055870533, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.002597341313958168, "total_loss": 15.341897010803223}, "load_time_ms": 8.192}, "training_iteration": 15, "hostname": "flow-main", "time_since_restore": 745.7627058029175, "iterations_since_restore": 15, "timesteps_since_restore": 892290, "date": "2019-05-23_04-51-32", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 892290, "num_metric_batches_dropped": 0, "time_total_s": 745.7627058029175, "episode_reward_min": -1370.6384463854283, "time_this_iter_s": 41.79864168167114, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee11d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1828>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 23.143651192636234, "outflow_rate_min": 460.7989278777953, "cost1_max": 449.40882668906704, "system_level_velocity_min": 11.167200196967642, "cost2_min": -143.03604843310177, "cost1_mean": 373.28265495933795, "system_level_velocity_mean": 14.848221338173534, "cost2_max": -23.601022055008812, "outflow_rate_mean": 1299.3743640481239, "outflow_rate_max": 1468.85423475666, "cost2_mean": -111.23681898560875, "system_level_velocity_max": 18.588334952966736}, "timesteps_this_iter": 52965}
{"episode_reward_max": -104.10146229917127, "episode_reward_mean": -899.8370986687562, "timestamp": 1558587135, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 31, "episode_len_mean": 681.75, "pid": 31789, "done": false, "episodes_total": 468, "info": {"update_time_ms": 9.106, "sample_time_ms": 30049.185, "num_steps_trained": 945375, "grad_time_ms": 16483.821, "num_steps_sampled": 945375, "default": {"vf_loss": 17.15471839904785, "cur_lr": 0.0005000000237487257, "entropy": 1.2529668807983398, "vf_explained_var": 0.8911724090576172, "kl": 0.007739178370684385, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0017639073776081204, "total_loss": 17.15334129333496}, "load_time_ms": 8.217}, "training_iteration": 16, "hostname": "flow-main", "time_since_restore": 789.3699321746826, "iterations_since_restore": 16, "timesteps_since_restore": 945375, "date": "2019-05-23_04-52-15", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 945375, "num_metric_batches_dropped": 0, "time_total_s": 789.3699321746826, "episode_reward_min": -1350.2151762997223, "time_this_iter_s": 43.60722637176514, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2550>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 77.53855878200511, "outflow_rate_min": 732.7514749651108, "cost1_max": 449.40882668906704, "system_level_velocity_min": 11.167200196967642, "cost2_min": -138.08456814857226, "cost1_mean": 383.3353069371362, "system_level_velocity_mean": 15.260427549927009, "cost2_max": -52.09548161025926, "outflow_rate_mean": 1314.596076969899, "outflow_rate_max": 1497.9052333500613, "cost2_mean": -110.5617703475217, "system_level_velocity_max": 18.178138820535537}, "timesteps_this_iter": 53085}
{"episode_reward_max": -104.10146229917127, "episode_reward_mean": -875.0679022318573, "timestamp": 1558587178, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 31, "episode_len_mean": 680.85, "pid": 31789, "done": false, "episodes_total": 499, "info": {"update_time_ms": 8.723, "sample_time_ms": 29735.577, "num_steps_trained": 997854, "grad_time_ms": 16063.918, "num_steps_sampled": 997854, "default": {"vf_loss": 16.122032165527344, "cur_lr": 0.0005000000237487257, "entropy": 1.2460479736328125, "vf_explained_var": 0.8960938453674316, "kl": 0.0082927281036973, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0020817809272557497, "total_loss": 16.120363235473633}, "load_time_ms": 8.469}, "training_iteration": 17, "hostname": "flow-main", "time_since_restore": 832.0867686271667, "iterations_since_restore": 17, "timesteps_since_restore": 997854, "date": "2019-05-23_04-52-58", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 997854, "num_metric_batches_dropped": 0, "time_total_s": 832.0867686271667, "episode_reward_min": -1350.2151762997223, "time_this_iter_s": 42.71683645248413, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed75c0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 77.53855878200511, "outflow_rate_min": 732.7514749651108, "cost1_max": 454.8780321277874, "system_level_velocity_min": 11.88863940876337, "cost2_min": -131.91984846003416, "cost1_mean": 383.3111759888216, "system_level_velocity_mean": 15.292802805925781, "cost2_max": -52.09548161025926, "outflow_rate_mean": 1312.671583563206, "outflow_rate_max": 1497.9052333500613, "cost2_mean": -109.05406929176655, "system_level_velocity_max": 18.178138820535537}, "timesteps_this_iter": 52479}
{"episode_reward_max": -104.10146229917127, "episode_reward_mean": -841.6592044320308, "timestamp": 1558587219, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 30, "episode_len_mean": 685.92, "pid": 31789, "done": false, "episodes_total": 529, "info": {"update_time_ms": 8.591, "sample_time_ms": 28766.176, "num_steps_trained": 1046292, "grad_time_ms": 15840.814, "num_steps_sampled": 1046292, "default": {"vf_loss": 13.235715866088867, "cur_lr": 0.0005000000237487257, "entropy": 1.2238373756408691, "vf_explained_var": 0.9053654074668884, "kl": 0.009750820696353912, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.003173163626343012, "total_loss": 13.233030319213867}, "load_time_ms": 8.168}, "training_iteration": 18, "hostname": "flow-main", "time_since_restore": 872.7198944091797, "iterations_since_restore": 18, "timesteps_since_restore": 1046292, "date": "2019-05-23_04-53-39", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1046292, "num_metric_batches_dropped": 0, "time_total_s": 872.7198944091797, "episode_reward_min": -1243.6459120912832, "time_this_iter_s": 40.63312578201294, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0940>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 78.41595802599113, "outflow_rate_min": 751.6283380406145, "cost1_max": 454.8780321277874, "system_level_velocity_min": 11.88863940876337, "cost2_min": -129.1541669692558, "cost1_mean": 389.6421580946532, "system_level_velocity_mean": 15.47118601430306, "cost2_max": -52.09548161025926, "outflow_rate_mean": 1316.0176356039474, "outflow_rate_max": 1497.9052333500613, "cost2_mean": -105.97772513591163, "system_level_velocity_max": 18.178138820535537}, "timesteps_this_iter": 48438}
{"episode_reward_max": -104.10146229917127, "episode_reward_mean": -803.5608900765269, "timestamp": 1558587259, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 31, "episode_len_mean": 688.95, "pid": 31789, "done": false, "episodes_total": 560, "info": {"update_time_ms": 8.953, "sample_time_ms": 28279.805, "num_steps_trained": 1095858, "grad_time_ms": 15377.845, "num_steps_sampled": 1095858, "default": {"vf_loss": 12.836660385131836, "cur_lr": 0.0005000000237487257, "entropy": 1.2115225791931152, "vf_explained_var": 0.8937869071960449, "kl": 0.010399101302027702, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0028281304985284805, "total_loss": 12.834352493286133}, "load_time_ms": 7.97}, "training_iteration": 19, "hostname": "flow-main", "time_since_restore": 913.0496833324432, "iterations_since_restore": 19, "timesteps_since_restore": 1095858, "date": "2019-05-23_04-54-19", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1095858, "num_metric_batches_dropped": 0, "time_total_s": 913.0496833324432, "episode_reward_min": -1223.1856912384667, "time_this_iter_s": 40.32978892326355, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee11d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1208>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 78.41595802599113, "outflow_rate_min": 751.6283380406145, "cost1_max": 454.8780321277874, "system_level_velocity_min": 11.856695737196304, "cost2_min": -129.1541669692558, "cost1_mean": 392.6088596891794, "system_level_velocity_mean": 15.603595017868837, "cost2_max": -52.09548161025926, "outflow_rate_mean": 1298.1105527618836, "outflow_rate_max": 1497.9052333500613, "cost2_mean": -99.25519036767564, "system_level_velocity_max": 18.178138820535537}, "timesteps_this_iter": 49566}
{"episode_reward_max": -186.76513798211863, "episode_reward_mean": -760.5239811365457, "timestamp": 1558587301, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 35, "episode_len_mean": 681.4, "pid": 31789, "done": false, "episodes_total": 595, "info": {"update_time_ms": 9.276, "sample_time_ms": 28034.485, "num_steps_trained": 1144771, "grad_time_ms": 14947.469, "num_steps_sampled": 1144771, "default": {"vf_loss": 13.773580551147461, "cur_lr": 0.0005000000237487257, "entropy": 1.1855453252792358, "vf_explained_var": 0.8954535126686096, "kl": 0.009929507039487362, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0026421123184263706, "total_loss": 13.771435737609863}, "load_time_ms": 7.774}, "training_iteration": 20, "hostname": "flow-main", "time_since_restore": 954.5876383781433, "iterations_since_restore": 20, "timesteps_since_restore": 1144771, "date": "2019-05-23_04-55-01", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1144771, "num_metric_batches_dropped": 0, "time_total_s": 954.5876383781433, "episode_reward_min": -1141.2914919794046, "time_this_iter_s": 41.53795504570007, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0198>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 128.27405478035217, "outflow_rate_min": 978.7655982256468, "cost1_max": 448.7698377577802, "system_level_velocity_min": 11.856695737196304, "cost2_min": -123.91589404725097, "cost1_mean": 388.4714716343806, "system_level_velocity_mean": 15.684854121349815, "cost2_max": -51.83701345455938, "outflow_rate_mean": 1282.0990046311797, "outflow_rate_max": 1451.014220075007, "cost2_mean": -92.62965892283628, "system_level_velocity_max": 18.386738121630884}, "timesteps_this_iter": 48913}
{"episode_reward_max": -186.76513798211863, "episode_reward_mean": -745.5764260593326, "timestamp": 1558587342, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 34, "episode_len_mean": 679.14, "pid": 31789, "done": false, "episodes_total": 629, "info": {"update_time_ms": 9.058, "sample_time_ms": 28075.389, "num_steps_trained": 1193278, "grad_time_ms": 14284.517, "num_steps_sampled": 1193278, "default": {"vf_loss": 13.406041145324707, "cur_lr": 0.0005000000237487257, "entropy": 1.1803392171859741, "vf_explained_var": 0.8933358788490295, "kl": 0.009981932118535042, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.003529731649905443, "total_loss": 13.403010368347168}, "load_time_ms": 7.801}, "training_iteration": 21, "hostname": "flow-main", "time_since_restore": 996.1454038619995, "iterations_since_restore": 21, "timesteps_since_restore": 1193278, "date": "2019-05-23_04-55-42", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1193278, "num_metric_batches_dropped": 0, "time_total_s": 996.1454038619995, "episode_reward_min": -1191.974685257411, "time_this_iter_s": 41.5577654838562, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1438>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 128.27405478035217, "outflow_rate_min": 978.7655982256468, "cost1_max": 446.8787676318043, "system_level_velocity_min": 11.856695737196304, "cost2_min": -115.47086589499845, "cost1_mean": 388.015322541695, "system_level_velocity_mean": 15.75897498972912, "cost2_max": -51.83701345455938, "outflow_rate_mean": 1278.9585360647047, "outflow_rate_max": 1449.0881258458635, "cost2_mean": -90.67672866492556, "system_level_velocity_max": 18.386738121630884}, "timesteps_this_iter": 48507}
{"episode_reward_max": -186.76513798211863, "episode_reward_mean": -746.3351399193125, "timestamp": 1558587382, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 35, "episode_len_mean": 673.86, "pid": 31789, "done": false, "episodes_total": 664, "info": {"update_time_ms": 9.047, "sample_time_ms": 27992.508, "num_steps_trained": 1241170, "grad_time_ms": 13956.6, "num_steps_sampled": 1241170, "default": {"vf_loss": 12.617362022399902, "cur_lr": 0.0005000000237487257, "entropy": 1.1778104305267334, "vf_explained_var": 0.8981295228004456, "kl": 0.009009662084281445, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0029578329995274544, "total_loss": 12.61485481262207}, "load_time_ms": 7.852}, "training_iteration": 22, "hostname": "flow-main", "time_since_restore": 1036.166382074356, "iterations_since_restore": 22, "timesteps_since_restore": 1241170, "date": "2019-05-23_04-56-22", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1241170, "num_metric_batches_dropped": 0, "time_total_s": 1036.166382074356, "episode_reward_min": -1191.974685257411, "time_this_iter_s": 40.02097821235657, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef09b0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 127.94483506213389, "outflow_rate_min": 920.2154330988592, "cost1_max": 448.14287695816245, "system_level_velocity_min": 12.022835711104875, "cost2_min": -115.47086589499845, "cost1_mean": 385.9773854704055, "system_level_velocity_mean": 15.786170524314317, "cost2_max": -48.01992530585697, "outflow_rate_mean": 1279.2701631143736, "outflow_rate_max": 1449.0881258458635, "cost2_mean": -91.31315995943663, "system_level_velocity_max": 18.386738121630884}, "timesteps_this_iter": 47892}
{"episode_reward_max": -190.03065345967457, "episode_reward_mean": -734.7289967997319, "timestamp": 1558587421, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 31, "episode_len_mean": 684.11, "pid": 31789, "done": false, "episodes_total": 695, "info": {"update_time_ms": 8.985, "sample_time_ms": 27511.967, "num_steps_trained": 1287479, "grad_time_ms": 13666.317, "num_steps_sampled": 1287479, "default": {"vf_loss": 10.4786958694458, "cur_lr": 0.0005000000237487257, "entropy": 1.164797067642212, "vf_explained_var": 0.8942928314208984, "kl": 0.009637306444346905, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0020865886472165585, "total_loss": 10.477089881896973}, "load_time_ms": 7.787}, "training_iteration": 23, "hostname": "flow-main", "time_since_restore": 1074.3469729423523, "iterations_since_restore": 23, "timesteps_since_restore": 1287479, "date": "2019-05-23_04-57-01", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1287479, "num_metric_batches_dropped": 0, "time_total_s": 1074.3469729423523, "episode_reward_min": -1191.974685257411, "time_this_iter_s": 38.180590867996216, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1b00>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 127.94483506213389, "outflow_rate_min": 920.2154330988592, "cost1_max": 450.835894779947, "system_level_velocity_min": 12.022835711104875, "cost2_min": -114.78920713671931, "cost1_mean": 396.95117461431664, "system_level_velocity_mean": 15.984699750172835, "cost2_max": -48.01992530585697, "outflow_rate_mean": 1282.4409429622226, "outflow_rate_max": 1449.0881258458635, "cost2_mean": -88.38091793287879, "system_level_velocity_max": 18.353451417707404}, "timesteps_this_iter": 46309}
{"episode_reward_max": -224.78240785260115, "episode_reward_mean": -717.6719191134591, "timestamp": 1558587459, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 30, "episode_len_mean": 690.26, "pid": 31789, "done": false, "episodes_total": 725, "info": {"update_time_ms": 8.805, "sample_time_ms": 27047.5, "num_steps_trained": 1334916, "grad_time_ms": 13746.358, "num_steps_sampled": 1334916, "default": {"vf_loss": 10.181849479675293, "cur_lr": 0.0005000000237487257, "entropy": 1.1464958190917969, "vf_explained_var": 0.8954989314079285, "kl": 0.011307870969176292, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0028884485363960266, "total_loss": 10.179525375366211}, "load_time_ms": 8.004}, "training_iteration": 24, "hostname": "flow-main", "time_since_restore": 1113.0448989868164, "iterations_since_restore": 24, "timesteps_since_restore": 1334916, "date": "2019-05-23_04-57-39", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1334916, "num_metric_batches_dropped": 0, "time_total_s": 1113.0448989868164, "episode_reward_min": -1136.069689231304, "time_this_iter_s": 38.69792604446411, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf2ff98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef02b0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 127.94483506213389, "outflow_rate_min": 920.2154330988592, "cost1_max": 450.835894779947, "system_level_velocity_min": 12.67035980501222, "cost2_min": -112.92779520653168, "cost1_mean": 404.75332806260076, "system_level_velocity_mean": 16.176024246155812, "cost2_max": -48.01992530585697, "outflow_rate_mean": 1277.4117918537236, "outflow_rate_max": 1429.3628295666504, "cost2_mean": -84.27393059156181, "system_level_velocity_max": 18.17480613881868}, "timesteps_this_iter": 47437}
{"episode_reward_max": -321.34570018385716, "episode_reward_mean": -681.5779877260409, "timestamp": 1558587500, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 33, "episode_len_mean": 692.51, "pid": 31789, "done": false, "episodes_total": 758, "info": {"update_time_ms": 9.024, "sample_time_ms": 26777.36, "num_steps_trained": 1381961, "grad_time_ms": 13864.995, "num_steps_sampled": 1381961, "default": {"vf_loss": 9.897466659545898, "cur_lr": 0.0005000000237487257, "entropy": 1.1342881917953491, "vf_explained_var": 0.8938279151916504, "kl": 0.009546471759676933, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0016901986673474312, "total_loss": 9.896252632141113}, "load_time_ms": 8.08}, "training_iteration": 25, "hostname": "flow-main", "time_since_restore": 1153.331004858017, "iterations_since_restore": 25, "timesteps_since_restore": 1381961, "date": "2019-05-23_04-58-20", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1381961, "num_metric_batches_dropped": 0, "time_total_s": 1153.331004858017, "episode_reward_min": -917.0215256959513, "time_this_iter_s": 40.28610587120056, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0cf8>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 167.15178279657624, "outflow_rate_min": 1047.5140165289258, "cost1_max": 450.835894779947, "system_level_velocity_min": 13.198536907334445, "cost2_min": -112.92779520653168, "cost1_mean": 410.2425501255397, "system_level_velocity_mean": 16.383337203866645, "cost2_max": -54.42383041137905, "outflow_rate_mean": 1281.9156943729363, "outflow_rate_max": 1408.8349774682804, "cost2_mean": -78.6493312920665, "system_level_velocity_max": 18.063522204103336}, "timesteps_this_iter": 47045}
{"episode_reward_max": -382.6960310739909, "episode_reward_mean": -659.4817643937761, "timestamp": 1558587538, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 32, "episode_len_mean": 693.84, "pid": 31789, "done": false, "episodes_total": 790, "info": {"update_time_ms": 9.211, "sample_time_ms": 26414.674, "num_steps_trained": 1427803, "grad_time_ms": 13669.298, "num_steps_sampled": 1427803, "default": {"vf_loss": 9.251350402832031, "cur_lr": 0.0005000000237487257, "entropy": 1.114578366279602, "vf_explained_var": 0.9018770456314087, "kl": 0.011505345813930035, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002302067819982767, "total_loss": 9.24962329864502}, "load_time_ms": 7.922}, "training_iteration": 26, "hostname": "flow-main", "time_since_restore": 1191.3439502716064, "iterations_since_restore": 26, "timesteps_since_restore": 1427803, "date": "2019-05-23_04-58-58", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1427803, "num_metric_batches_dropped": 0, "time_total_s": 1191.3439502716064, "episode_reward_min": -819.5709359332963, "time_this_iter_s": 38.01294541358948, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed24a8>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 222.69262330017307, "outflow_rate_min": 1157.6031541636753, "cost1_max": 448.03895921086246, "system_level_velocity_min": 13.544073571300999, "cost2_min": -95.46322126262203, "cost1_mean": 413.99430235479485, "system_level_velocity_mean": 16.527826032228106, "cost2_max": -60.03762859758849, "outflow_rate_mean": 1277.9052885278754, "outflow_rate_max": 1408.8349774682804, "cost2_mean": -74.88959011864637, "system_level_velocity_max": 18.2031475648981}, "timesteps_this_iter": 45842}
{"episode_reward_max": -36.112461995654684, "episode_reward_mean": -642.0080549264135, "timestamp": 1558587576, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 34, "episode_len_mean": 685.86, "pid": 31789, "done": false, "episodes_total": 824, "info": {"update_time_ms": 9.451, "sample_time_ms": 26249.414, "num_steps_trained": 1474727, "grad_time_ms": 13376.688, "num_steps_sampled": 1474727, "default": {"vf_loss": 9.200040817260742, "cur_lr": 0.0005000000237487257, "entropy": 1.1045516729354858, "vf_explained_var": 0.8987841010093689, "kl": 0.011068510822951794, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0017768563702702522, "total_loss": 9.198817253112793}, "load_time_ms": 7.532}, "training_iteration": 27, "hostname": "flow-main", "time_since_restore": 1229.4764475822449, "iterations_since_restore": 27, "timesteps_since_restore": 1474727, "date": "2019-05-23_04-59-36", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1474727, "num_metric_batches_dropped": 0, "time_total_s": 1229.4764475822449, "episode_reward_min": -819.5709359332963, "time_this_iter_s": 38.13249731063843, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0eb8>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 22.658888758507093, "outflow_rate_min": 424.4559491199726, "cost1_max": 448.03895921086246, "system_level_velocity_min": 13.544073571300999, "cost2_min": -95.46322126262203, "cost1_mean": 408.80743040401154, "system_level_velocity_mean": 16.51461309918315, "cost2_max": -24.82138573969696, "outflow_rate_mean": 1270.0668880191536, "outflow_rate_max": 1376.5759627805703, "cost2_mean": -73.12109177967037, "system_level_velocity_max": 18.2031475648981}, "timesteps_this_iter": 46924}
{"episode_reward_max": -36.112461995654684, "episode_reward_mean": -640.1131149670942, "timestamp": 1558587613, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 30, "episode_len_mean": 688.89, "pid": 31789, "done": false, "episodes_total": 854, "info": {"update_time_ms": 9.48, "sample_time_ms": 26287.425, "num_steps_trained": 1520742, "grad_time_ms": 12961.852, "num_steps_sampled": 1520742, "default": {"vf_loss": 8.78322982788086, "cur_lr": 0.0005000000237487257, "entropy": 1.0721479654312134, "vf_explained_var": 0.8998661041259766, "kl": 0.009330780245363712, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0018963824259117246, "total_loss": 8.781800270080566}, "load_time_ms": 7.94}, "training_iteration": 28, "hostname": "flow-main", "time_since_restore": 1266.339263677597, "iterations_since_restore": 28, "timesteps_since_restore": 1520742, "date": "2019-05-23_05-00-13", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1520742, "num_metric_batches_dropped": 0, "time_total_s": 1266.339263677597, "episode_reward_min": -758.4749401894201, "time_this_iter_s": 36.86281609535217, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed22e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed26a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2400>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 22.658888758507093, "outflow_rate_min": 424.4559491199726, "cost1_max": 449.2731868983002, "system_level_velocity_min": 14.74671488609172, "cost2_min": -91.55716665000038, "cost1_mean": 411.7946001347298, "system_level_velocity_mean": 16.571713904026893, "cost2_max": -24.82138573969696, "outflow_rate_mean": 1267.098346802624, "outflow_rate_max": 1376.5759627805703, "cost2_mean": -72.45320487852285, "system_level_velocity_max": 18.2031475648981}, "timesteps_this_iter": 46015}
{"episode_reward_max": -36.112461995654684, "episode_reward_mean": -633.8848585672215, "timestamp": 1558587651, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 34, "episode_len_mean": 687.99, "pid": 31789, "done": false, "episodes_total": 888, "info": {"update_time_ms": 9.214, "sample_time_ms": 26259.972, "num_steps_trained": 1566341, "grad_time_ms": 12774.57, "num_steps_sampled": 1566341, "default": {"vf_loss": 9.146588325500488, "cur_lr": 0.0005000000237487257, "entropy": 1.0691063404083252, "vf_explained_var": 0.8936260342597961, "kl": 0.010247889906167984, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0017944748979061842, "total_loss": 9.145306587219238}, "load_time_ms": 7.864}, "training_iteration": 29, "hostname": "flow-main", "time_since_restore": 1304.511884689331, "iterations_since_restore": 29, "timesteps_since_restore": 1566341, "date": "2019-05-23_05-00-51", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1566341, "num_metric_batches_dropped": 0, "time_total_s": 1304.511884689331, "episode_reward_min": -769.2457530375109, "time_this_iter_s": 38.17262101173401, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef09e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0240>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 22.658888758507093, "outflow_rate_min": 424.4559491199726, "cost1_max": 449.2731868983002, "system_level_velocity_min": 14.589015292304346, "cost2_min": -91.55716665000038, "cost1_mean": 411.0903555660358, "system_level_velocity_mean": 16.60488397743073, "cost2_max": -24.82138573969696, "outflow_rate_mean": 1265.1703247129008, "outflow_rate_max": 1376.5759627805703, "cost2_mean": -71.05833532055621, "system_level_velocity_max": 18.497666790395854}, "timesteps_this_iter": 45599}
{"episode_reward_max": -220.2996916078079, "episode_reward_mean": -626.8181009801395, "timestamp": 1558587690, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 33, "episode_len_mean": 694.21, "pid": 31789, "done": false, "episodes_total": 921, "info": {"update_time_ms": 9.021, "sample_time_ms": 25943.322, "num_steps_trained": 1611901, "grad_time_ms": 12818.17, "num_steps_sampled": 1611901, "default": {"vf_loss": 8.74238109588623, "cur_lr": 0.0005000000237487257, "entropy": 1.0728604793548584, "vf_explained_var": 0.8997482657432556, "kl": 0.009919950738549232, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0025055252481251955, "total_loss": 8.740371704101562}, "load_time_ms": 7.86}, "training_iteration": 30, "hostname": "flow-main", "time_since_restore": 1343.3181993961334, "iterations_since_restore": 30, "timesteps_since_restore": 1611901, "date": "2019-05-23_05-01-30", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1611901, "num_metric_batches_dropped": 0, "time_total_s": 1343.3181993961334, "episode_reward_min": -769.2457530375109, "time_this_iter_s": 38.80631470680237, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef03c8>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 194.4562447476478, "outflow_rate_min": 1158.0823006179437, "cost1_max": 459.89759826728437, "system_level_velocity_min": 14.5337120330095, "cost2_min": -91.55716665000038, "cost1_mean": 417.8864179757412, "system_level_velocity_mean": 16.743213739696603, "cost2_max": -41.9130464977093, "outflow_rate_mean": 1271.2294204160812, "outflow_rate_max": 1387.4673388172523, "cost2_mean": -68.79814081769615, "system_level_velocity_max": 18.561073515998103}, "timesteps_this_iter": 45560}
{"episode_reward_max": -220.2996916078079, "episode_reward_mean": -614.7417069257738, "timestamp": 1558587728, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 32, "episode_len_mean": 694.21, "pid": 31789, "done": false, "episodes_total": 953, "info": {"update_time_ms": 9.082, "sample_time_ms": 25571.025, "num_steps_trained": 1656628, "grad_time_ms": 12831.412, "num_steps_sampled": 1656628, "default": {"vf_loss": 8.078079223632812, "cur_lr": 0.0005000000237487257, "entropy": 1.0597962141036987, "vf_explained_var": 0.9015188217163086, "kl": 0.011551041156053543, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0031690201722085476, "total_loss": 8.075488090515137}, "load_time_ms": 7.741}, "training_iteration": 31, "hostname": "flow-main", "time_since_restore": 1381.2847089767456, "iterations_since_restore": 31, "timesteps_since_restore": 1656628, "date": "2019-05-23_05-02-08", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1656628, "num_metric_batches_dropped": 0, "time_total_s": 1381.2847089767456, "episode_reward_min": -769.2457530375109, "time_this_iter_s": 37.96650958061218, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed26a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2be0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 194.4562447476478, "outflow_rate_min": 1158.0823006179437, "cost1_max": 459.89759826728437, "system_level_velocity_min": 14.5337120330095, "cost2_min": -83.61779086869637, "cost1_mean": 419.65744066095135, "system_level_velocity_mean": 16.841037677191345, "cost2_max": -41.9130464977093, "outflow_rate_mean": 1263.0550632804022, "outflow_rate_max": 1387.4673388172523, "cost2_mean": -65.77633182245036, "system_level_velocity_max": 18.561073515998103}, "timesteps_this_iter": 44727}
{"episode_reward_max": -479.06947975663525, "episode_reward_mean": -605.1681781849359, "timestamp": 1558587763, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 33, "episode_len_mean": 695.58, "pid": 31789, "done": false, "episodes_total": 986, "info": {"update_time_ms": 9.221, "sample_time_ms": 25182.072, "num_steps_trained": 1700622, "grad_time_ms": 12719.192, "num_steps_sampled": 1700622, "default": {"vf_loss": 7.706714630126953, "cur_lr": 0.0005000000237487257, "entropy": 1.0231475830078125, "vf_explained_var": 0.9006831645965576, "kl": 0.01182409655302763, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002538105472922325, "total_loss": 7.704767227172852}, "load_time_ms": 7.687}, "training_iteration": 32, "hostname": "flow-main", "time_since_restore": 1416.2911040782928, "iterations_since_restore": 32, "timesteps_since_restore": 1700622, "date": "2019-05-23_05-02-43", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1700622, "num_metric_batches_dropped": 0, "time_total_s": 1416.2911040782928, "episode_reward_min": -727.8057621184468, "time_this_iter_s": 35.00639510154724, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef00b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0ef0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 310.21441543186796, "outflow_rate_min": 1158.0823006179437, "cost1_max": 459.89759826728437, "system_level_velocity_min": 14.5337120330095, "cost2_min": -83.61779086869637, "cost1_mean": 422.8426904527686, "system_level_velocity_mean": 16.951660509834127, "cost2_max": -47.124497665833054, "outflow_rate_mean": 1253.8776764805166, "outflow_rate_max": 1387.4673388172523, "cost2_mean": -63.34966722394834, "system_level_velocity_max": 18.561073515998103}, "timesteps_this_iter": 43994}
{"episode_reward_max": -149.2308446784097, "episode_reward_mean": -580.975412593178, "timestamp": 1558587801, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 36, "episode_len_mean": 688.93, "pid": 31789, "done": false, "episodes_total": 1022, "info": {"update_time_ms": 9.13, "sample_time_ms": 25231.554, "num_steps_trained": 1745290, "grad_time_ms": 12610.986, "num_steps_sampled": 1745290, "default": {"vf_loss": 7.980407238006592, "cur_lr": 0.0005000000237487257, "entropy": 1.0174933671951294, "vf_explained_var": 0.8960450291633606, "kl": 0.010519588366150856, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0021263957023620605, "total_loss": 7.978806972503662}, "load_time_ms": 7.598}, "training_iteration": 33, "hostname": "flow-main", "time_since_restore": 1453.8782465457916, "iterations_since_restore": 33, "timesteps_since_restore": 1745290, "date": "2019-05-23_05-03-21", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1745290, "num_metric_batches_dropped": 0, "time_total_s": 1453.8782465457916, "episode_reward_min": -723.2712387695339, "time_this_iter_s": 37.58714246749878, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef02b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0dd8>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 138.27849971296962, "outflow_rate_min": 991.5400007164401, "cost1_max": 454.70971808096203, "system_level_velocity_min": 14.73035327549289, "cost2_min": -83.61779086869637, "cost1_mean": 421.94499343550257, "system_level_velocity_mean": 17.160867955922882, "cost2_max": -34.98773829698293, "outflow_rate_mean": 1232.2639156600133, "outflow_rate_max": 1350.4354437796103, "cost2_mean": -59.10565035050455, "system_level_velocity_max": 18.85671222899959}, "timesteps_this_iter": 44668}
{"episode_reward_max": -149.2308446784097, "episode_reward_mean": -564.9947338389632, "timestamp": 1558587836, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 31, "episode_len_mean": 686.27, "pid": 31789, "done": false, "episodes_total": 1053, "info": {"update_time_ms": 9.407, "sample_time_ms": 25133.964, "num_steps_trained": 1789645, "grad_time_ms": 12372.155, "num_steps_sampled": 1789645, "default": {"vf_loss": 7.425947666168213, "cur_lr": 0.0005000000237487257, "entropy": 1.0158989429473877, "vf_explained_var": 0.9037350416183472, "kl": 0.012249105609953403, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0026048370636999607, "total_loss": 7.423955917358398}, "load_time_ms": 7.208}, "training_iteration": 34, "hostname": "flow-main", "time_since_restore": 1489.212232351303, "iterations_since_restore": 34, "timesteps_since_restore": 1789645, "date": "2019-05-23_05-03-56", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1789645, "num_metric_batches_dropped": 0, "time_total_s": 1489.212232351303, "episode_reward_min": -721.8062545492722, "time_this_iter_s": 35.333985805511475, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef60b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6048>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 138.27849971296962, "outflow_rate_min": 991.5400007164401, "cost1_max": 454.70971808096203, "system_level_velocity_min": 14.80620197731031, "cost2_min": -79.87086851280067, "cost1_mean": 421.4132128739846, "system_level_velocity_mean": 17.26868797457906, "cost2_max": -34.98773829698293, "outflow_rate_mean": 1214.5095984017948, "outflow_rate_max": 1328.0468178226763, "cost2_mean": -55.91239505470516, "system_level_velocity_max": 18.85671222899959}, "timesteps_this_iter": 44355}
{"episode_reward_max": -149.2308446784097, "episode_reward_mean": -557.5208708305948, "timestamp": 1558587872, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 34, "episode_len_mean": 684.66, "pid": 31789, "done": false, "episodes_total": 1087, "info": {"update_time_ms": 9.599, "sample_time_ms": 24851.19, "num_steps_trained": 1834346, "grad_time_ms": 12275.506, "num_steps_sampled": 1834346, "default": {"vf_loss": 7.842647552490234, "cur_lr": 0.0005000000237487257, "entropy": 1.0034921169281006, "vf_explained_var": 0.8981409072875977, "kl": 0.013040229678153992, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0021813667844980955, "total_loss": 7.841116905212402}, "load_time_ms": 7.317}, "training_iteration": 35, "hostname": "flow-main", "time_since_restore": 1525.7135829925537, "iterations_since_restore": 35, "timesteps_since_restore": 1834346, "date": "2019-05-23_05-04-32", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1834346, "num_metric_batches_dropped": 0, "time_total_s": 1525.7135829925537, "episode_reward_min": -667.0801529329538, "time_this_iter_s": 36.50135064125061, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed26a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9b00>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 138.27849971296962, "outflow_rate_min": 991.5400007164401, "cost1_max": 454.70971808096203, "system_level_velocity_min": 14.80620197731031, "cost2_min": -70.76279865514911, "cost1_mean": 419.95449993284916, "system_level_velocity_mean": 17.26822365374483, "cost2_max": -34.98773829698293, "outflow_rate_mean": 1204.2972855099504, "outflow_rate_max": 1327.7928435793767, "cost2_mean": -54.72518754766553, "system_level_velocity_max": 18.85671222899959}, "timesteps_this_iter": 44701}
{"episode_reward_max": -270.5143412275134, "episode_reward_mean": -562.270275452145, "timestamp": 1558587911, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 32, "episode_len_mean": 688.61, "pid": 31789, "done": false, "episodes_total": 1119, "info": {"update_time_ms": 9.615, "sample_time_ms": 24730.287, "num_steps_trained": 1879016, "grad_time_ms": 12448.62, "num_steps_sampled": 1879016, "default": {"vf_loss": 7.656290054321289, "cur_lr": 0.0005000000237487257, "entropy": 0.9956935048103333, "vf_explained_var": 0.9018001556396484, "kl": 0.011858602054417133, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0023327015805989504, "total_loss": 7.654550075531006}, "load_time_ms": 7.29}, "training_iteration": 36, "hostname": "flow-main", "time_since_restore": 1564.2454149723053, "iterations_since_restore": 36, "timesteps_since_restore": 1879016, "date": "2019-05-23_05-05-11", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1879016, "num_metric_batches_dropped": 0, "time_total_s": 1564.2454149723053, "episode_reward_min": -667.0801529329538, "time_this_iter_s": 38.53183197975159, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9a58>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 178.17301904044385, "outflow_rate_min": 1064.2940909090905, "cost1_max": 452.7920930564439, "system_level_velocity_min": 15.182478528437418, "cost2_min": -70.76279865514911, "cost1_mean": 420.13051117636314, "system_level_velocity_mean": 17.153438569321143, "cost2_max": -41.66817000497119, "outflow_rate_mean": 1202.7043216547181, "outflow_rate_max": 1282.62562290286, "cost2_mean": -54.88644470775721, "system_level_velocity_max": 18.666125280334853}, "timesteps_this_iter": 44670}
{"episode_reward_max": -270.5143412275134, "episode_reward_mean": -565.8484981589957, "timestamp": 1558587948, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 34, "episode_len_mean": 688.61, "pid": 31789, "done": false, "episodes_total": 1153, "info": {"update_time_ms": 9.697, "sample_time_ms": 24617.374, "num_steps_trained": 1923154, "grad_time_ms": 12437.339, "num_steps_sampled": 1923154, "default": {"vf_loss": 7.804635047912598, "cur_lr": 0.0005000000237487257, "entropy": 0.9834675192832947, "vf_explained_var": 0.8984705209732056, "kl": 0.012795674614608288, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0019559187348932028, "total_loss": 7.803318977355957}, "load_time_ms": 7.233}, "training_iteration": 37, "hostname": "flow-main", "time_since_restore": 1601.12291097641, "iterations_since_restore": 37, "timesteps_since_restore": 1923154, "date": "2019-05-23_05-05-48", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1923154, "num_metric_batches_dropped": 0, "time_total_s": 1601.12291097641, "episode_reward_min": -667.0801529329538, "time_this_iter_s": 36.877496004104614, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2048>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 178.17301904044385, "outflow_rate_min": 1064.2940909090905, "cost1_max": 452.5695741622071, "system_level_velocity_min": 15.182478528437418, "cost2_min": -70.76279865514911, "cost1_mean": 418.89777901065247, "system_level_velocity_mean": 17.086968648611936, "cost2_max": -41.6569517669276, "outflow_rate_mean": 1197.7166630532918, "outflow_rate_max": 1282.62562290286, "cost2_mean": -54.97282522625888, "system_level_velocity_max": 18.505236039499735}, "timesteps_this_iter": 44138}
{"episode_reward_max": -265.37082699439514, "episode_reward_mean": -557.8599988987877, "timestamp": 1558587985, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 34, "episode_len_mean": 687.6, "pid": 31789, "done": false, "episodes_total": 1187, "info": {"update_time_ms": 9.877, "sample_time_ms": 24774.653, "num_steps_trained": 1967467, "grad_time_ms": 12350.722, "num_steps_sampled": 1967467, "default": {"vf_loss": 7.674235820770264, "cur_lr": 0.0005000000237487257, "entropy": 0.976012110710144, "vf_explained_var": 0.8966270685195923, "kl": 0.010577227920293808, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0012513180263340473, "total_loss": 7.673513412475586}, "load_time_ms": 6.697}, "training_iteration": 38, "hostname": "flow-main", "time_since_restore": 1638.6806290149689, "iterations_since_restore": 38, "timesteps_since_restore": 1967467, "date": "2019-05-23_05-06-25", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1967467, "num_metric_batches_dropped": 0, "time_total_s": 1638.6806290149689, "episode_reward_min": -658.1174896188228, "time_this_iter_s": 37.55771803855896, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef64a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef69e8>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 176.7950990875146, "outflow_rate_min": 1061.0321818181815, "cost1_max": 452.5695741622071, "system_level_velocity_min": 15.459472729647509, "cost2_min": -69.909544070379, "cost1_mean": 419.9963400710946, "system_level_velocity_mean": 17.178711124204405, "cost2_max": -41.6569517669276, "outflow_rate_mean": 1193.56298013267, "outflow_rate_max": 1262.6475716572093, "cost2_mean": -53.289210435641046, "system_level_velocity_max": 18.505236039499735}, "timesteps_this_iter": 44313}
{"episode_reward_max": -265.37082699439514, "episode_reward_mean": -556.890249924349, "timestamp": 1558588022, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 34, "episode_len_mean": 691.72, "pid": 31789, "done": false, "episodes_total": 1221, "info": {"update_time_ms": 9.774, "sample_time_ms": 24632.971, "num_steps_trained": 2011419, "grad_time_ms": 12284.799, "num_steps_sampled": 2011419, "default": {"vf_loss": 7.44117546081543, "cur_lr": 0.0005000000237487257, "entropy": 0.9871928691864014, "vf_explained_var": 0.9039546847343445, "kl": 0.01391678024083376, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002358161611482501, "total_loss": 7.439512729644775}, "load_time_ms": 6.649}, "training_iteration": 39, "hostname": "flow-main", "time_since_restore": 1674.7758386135101, "iterations_since_restore": 39, "timesteps_since_restore": 2011419, "date": "2019-05-23_05-07-02", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2011419, "num_metric_batches_dropped": 0, "time_total_s": 1674.7758386135101, "episode_reward_min": -648.8583191404974, "time_this_iter_s": 36.09520959854126, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6320>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 176.7950990875146, "outflow_rate_min": 1061.0321818181815, "cost1_max": 451.16587443900426, "system_level_velocity_min": 15.463288781652164, "cost2_min": -72.1140310835203, "cost1_mean": 422.94631059634133, "system_level_velocity_mean": 17.22104849031786, "cost2_max": -41.6569517669276, "outflow_rate_mean": 1188.3119285378898, "outflow_rate_max": 1254.4492106056923, "cost2_mean": -52.40483666351051, "system_level_velocity_max": 18.51765301972157}, "timesteps_this_iter": 43952}
{"episode_reward_max": -22.70531631959341, "episode_reward_mean": -532.9038516395016, "timestamp": 1558588058, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 38, "episode_len_mean": 664.91, "pid": 31789, "done": false, "episodes_total": 1259, "info": {"update_time_ms": 9.657, "sample_time_ms": 24445.618, "num_steps_trained": 2055441, "grad_time_ms": 12210.876, "num_steps_sampled": 2055441, "default": {"vf_loss": 9.264952659606934, "cur_lr": 0.0005000000237487257, "entropy": 0.9752029180526733, "vf_explained_var": 0.8811125755310059, "kl": 0.011197054758667946, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0010834221029654145, "total_loss": 9.264429092407227}, "load_time_ms": 6.462}, "training_iteration": 40, "hostname": "flow-main", "time_since_restore": 1710.9736328125, "iterations_since_restore": 40, "timesteps_since_restore": 2055441, "date": "2019-05-23_05-07-38", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2055441, "num_metric_batches_dropped": 0, "time_total_s": 1710.9736328125, "episode_reward_min": -644.5258919625338, "time_this_iter_s": 36.19779419898987, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6668>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 17.725858297047886, "outflow_rate_min": 473.27835081641, "cost1_max": 451.16587443900426, "system_level_velocity_min": 15.463288781652164, "cost2_min": -72.1140310835203, "cost1_mean": 405.04503035197047, "system_level_velocity_mean": 17.17393903520968, "cost2_max": -16.355925069876825, "outflow_rate_mean": 1161.4798754205804, "outflow_rate_max": 1265.4035294117648, "cost2_mean": -50.94390922367129, "system_level_velocity_max": 19.15031150547141}, "timesteps_this_iter": 44022}
{"episode_reward_max": -22.70531631959341, "episode_reward_mean": -526.7707014756533, "timestamp": 1558588094, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 35, "episode_len_mean": 660.24, "pid": 31789, "done": false, "episodes_total": 1294, "info": {"update_time_ms": 9.685, "sample_time_ms": 24221.608, "num_steps_trained": 2099652, "grad_time_ms": 12250.725, "num_steps_sampled": 2099652, "default": {"vf_loss": 7.629429340362549, "cur_lr": 0.0005000000237487257, "entropy": 0.9508228302001953, "vf_explained_var": 0.8983240723609924, "kl": 0.015156986191868782, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0027126851491630077, "total_loss": 7.627473831176758}, "load_time_ms": 6.495}, "training_iteration": 41, "hostname": "flow-main", "time_since_restore": 1747.115488767624, "iterations_since_restore": 41, "timesteps_since_restore": 2099652, "date": "2019-05-23_05-08-14", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2099652, "num_metric_batches_dropped": 0, "time_total_s": 1747.115488767624, "episode_reward_min": -711.5170468052102, "time_this_iter_s": 36.1418559551239, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed20f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2860>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 17.725858297047886, "outflow_rate_min": 473.27835081641, "cost1_max": 453.92823360745183, "system_level_velocity_min": 14.937325745062425, "cost2_min": -72.1140310835203, "cost1_mean": 402.27038825497044, "system_level_velocity_mean": 17.211828872272726, "cost2_max": -16.355925069876825, "outflow_rate_mean": 1160.1782910273316, "outflow_rate_max": 1265.4035294117648, "cost2_mean": -50.343133455077734, "system_level_velocity_max": 19.15031150547141}, "timesteps_this_iter": 44211}
{"episode_reward_max": -22.70531631959341, "episode_reward_mean": -530.8120946015407, "timestamp": 1558588131, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 33, "episode_len_mean": 665.21, "pid": 31789, "done": false, "episodes_total": 1327, "info": {"update_time_ms": 9.765, "sample_time_ms": 24313.109, "num_steps_trained": 2143566, "grad_time_ms": 12328.667, "num_steps_sampled": 2143566, "default": {"vf_loss": 7.650256633758545, "cur_lr": 0.0005000000237487257, "entropy": 0.9360452890396118, "vf_explained_var": 0.8913691639900208, "kl": 0.012761152349412441, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0021223730873316526, "total_loss": 7.648773670196533}, "load_time_ms": 6.47}, "training_iteration": 42, "hostname": "flow-main", "time_since_restore": 1783.820898771286, "iterations_since_restore": 42, "timesteps_since_restore": 2143566, "date": "2019-05-23_05-08-51", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2143566, "num_metric_batches_dropped": 0, "time_total_s": 1783.820898771286, "episode_reward_min": -711.5170468052102, "time_this_iter_s": 36.70541000366211, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef62b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef65c0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 17.725858297047886, "outflow_rate_min": 473.27835081641, "cost1_max": 453.92823360745183, "system_level_velocity_min": 14.937325745062425, "cost2_min": -70.33197229717483, "cost1_mean": 405.6612531229483, "system_level_velocity_mean": 17.211054295001553, "cost2_max": -16.968372367387456, "outflow_rate_mean": 1169.531806795593, "outflow_rate_max": 1265.4035294117648, "cost2_mean": -50.38966596405751, "system_level_velocity_max": 19.15031150547141}, "timesteps_this_iter": 43914}
{"episode_reward_max": -153.23066511784762, "episode_reward_mean": -545.9555792210001, "timestamp": 1558588167, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 32, "episode_len_mean": 687.95, "pid": 31789, "done": false, "episodes_total": 1359, "info": {"update_time_ms": 9.789, "sample_time_ms": 24292.718, "num_steps_trained": 2187593, "grad_time_ms": 12191.915, "num_steps_sampled": 2187593, "default": {"vf_loss": 7.133426666259766, "cur_lr": 0.0005000000237487257, "entropy": 0.9453076124191284, "vf_explained_var": 0.9010742902755737, "kl": 0.012102745473384857, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0021241444628685713, "total_loss": 7.131908416748047}, "load_time_ms": 6.373}, "training_iteration": 43, "hostname": "flow-main", "time_since_restore": 1819.8238334655762, "iterations_since_restore": 43, "timesteps_since_restore": 2187593, "date": "2019-05-23_05-09-27", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2187593, "num_metric_batches_dropped": 0, "time_total_s": 1819.8238334655762, "episode_reward_min": -711.5170468052102, "time_this_iter_s": 36.00293469429016, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6898>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 129.49672518791687, "outflow_rate_min": 937.3474332933653, "cost1_max": 453.92823360745183, "system_level_velocity_min": 14.937325745062425, "cost2_min": -70.33197229717483, "cost1_mean": 420.87269140902526, "system_level_velocity_mean": 17.263926446140463, "cost2_max": -34.55350960573608, "outflow_rate_mean": 1188.6119336514316, "outflow_rate_max": 1254.5388306182226, "cost2_mean": -50.756116767161735, "system_level_velocity_max": 18.64073487257945}, "timesteps_this_iter": 44027}
{"episode_reward_max": -146.97819082116584, "episode_reward_mean": -543.8078837591484, "timestamp": 1558588204, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 36, "episode_len_mean": 686.15, "pid": 31789, "done": false, "episodes_total": 1395, "info": {"update_time_ms": 9.399, "sample_time_ms": 24480.288, "num_steps_trained": 2231440, "grad_time_ms": 12156.059, "num_steps_sampled": 2231440, "default": {"vf_loss": 8.02585506439209, "cur_lr": 0.0005000000237487257, "entropy": 0.9283614158630371, "vf_explained_var": 0.8899921774864197, "kl": 0.012503501027822495, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.002970494097098708, "total_loss": 8.023509979248047}, "load_time_ms": 6.305}, "training_iteration": 44, "hostname": "flow-main", "time_since_restore": 1856.644474029541, "iterations_since_restore": 44, "timesteps_since_restore": 2231440, "date": "2019-05-23_05-10-04", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2231440, "num_metric_batches_dropped": 0, "time_total_s": 1856.644474029541, "episode_reward_min": -652.0371026230682, "time_this_iter_s": 36.820640563964844, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9ef0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 135.4817340972903, "outflow_rate_min": 954.7348332249074, "cost1_max": 453.78349815912395, "system_level_velocity_min": 14.63063170516257, "cost2_min": -62.397758729078575, "cost1_mean": 420.1395819088139, "system_level_velocity_mean": 17.261790051948502, "cost2_max": -32.04501253698101, "outflow_rate_mean": 1185.5836876225283, "outflow_rate_max": 1254.5388306182226, "cost2_mean": -50.416734133505976, "system_level_velocity_max": 18.593340153864254}, "timesteps_this_iter": 43847}
{"episode_reward_max": -146.97819082116584, "episode_reward_mean": -530.1383446462443, "timestamp": 1558588239, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 33, "episode_len_mean": 673.59, "pid": 31789, "done": false, "episodes_total": 1428, "info": {"update_time_ms": 9.006, "sample_time_ms": 24434.448, "num_steps_trained": 2275023, "grad_time_ms": 12086.137, "num_steps_sampled": 2275023, "default": {"vf_loss": 6.505550384521484, "cur_lr": 0.0005000000237487257, "entropy": 0.9197089076042175, "vf_explained_var": 0.9094191789627075, "kl": 0.01279501337558031, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0006742167170159519, "total_loss": 6.505516052246094}, "load_time_ms": 6.131}, "training_iteration": 45, "hostname": "flow-main", "time_since_restore": 1891.974482536316, "iterations_since_restore": 45, "timesteps_since_restore": 2275023, "date": "2019-05-23_05-10-39", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2275023, "num_metric_batches_dropped": 0, "time_total_s": 1891.974482536316, "episode_reward_min": -652.0371026230682, "time_this_iter_s": 35.3300085067749, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed22b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2da0>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 135.4817340972903, "outflow_rate_min": 954.7348332249074, "cost1_max": 456.10162185357035, "system_level_velocity_min": 14.63063170516257, "cost2_min": -62.397758729078575, "cost1_mean": 412.7405647344188, "system_level_velocity_mean": 17.283576844881132, "cost2_max": -32.04501253698101, "outflow_rate_mean": 1178.7184289811562, "outflow_rate_max": 1254.5388306182226, "cost2_mean": -49.93796181455329, "system_level_velocity_max": 18.78779218409671}, "timesteps_this_iter": 43583}
{"episode_reward_max": -146.97819082116584, "episode_reward_mean": -526.6737334974111, "timestamp": 1558588273, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 35, "episode_len_mean": 674.49, "pid": 31789, "done": false, "episodes_total": 1463, "info": {"update_time_ms": 8.922, "sample_time_ms": 24190.06, "num_steps_trained": 2319116, "grad_time_ms": 11839.245, "num_steps_sampled": 2319116, "default": {"vf_loss": 7.628250598907471, "cur_lr": 0.0005000000237487257, "entropy": 0.9225736856460571, "vf_explained_var": 0.8948328495025635, "kl": 0.014717284590005875, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0020471347961574793, "total_loss": 7.626938819885254}, "load_time_ms": 6.152}, "training_iteration": 46, "hostname": "flow-main", "time_since_restore": 1925.6056394577026, "iterations_since_restore": 46, "timesteps_since_restore": 2319116, "date": "2019-05-23_05-11-13", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2319116, "num_metric_batches_dropped": 0, "time_total_s": 1925.6056394577026, "episode_reward_min": -689.2824895004055, "time_this_iter_s": 33.63115692138672, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0748>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 135.4817340972903, "outflow_rate_min": 954.7348332249074, "cost1_max": 456.10162185357035, "system_level_velocity_min": 14.63063170516257, "cost2_min": -62.397758729078575, "cost1_mean": 414.87004414939065, "system_level_velocity_mean": 17.349179152711848, "cost2_max": -32.04501253698101, "outflow_rate_mean": 1183.258509443343, "outflow_rate_max": 1255.308966942149, "cost2_mean": -49.719670484159344, "system_level_velocity_max": 18.78779218409671}, "timesteps_this_iter": 44093}
{"episode_reward_max": -148.25307559441632, "episode_reward_mean": -529.9903532621097, "timestamp": 1558588309, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 35, "episode_len_mean": 680.05, "pid": 31789, "done": false, "episodes_total": 1498, "info": {"update_time_ms": 8.691, "sample_time_ms": 24105.296, "num_steps_trained": 2362879, "grad_time_ms": 11893.056, "num_steps_sampled": 2362879, "default": {"vf_loss": 7.6044392585754395, "cur_lr": 0.0005000000237487257, "entropy": 0.9184353947639465, "vf_explained_var": 0.8934575915336609, "kl": 0.014402462169528008, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0013208403252065182, "total_loss": 7.6038384437561035}, "load_time_ms": 6.341}, "training_iteration": 47, "hostname": "flow-main", "time_since_restore": 1962.1858880519867, "iterations_since_restore": 47, "timesteps_since_restore": 2362879, "date": "2019-05-23_05-11-49", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2362879, "num_metric_batches_dropped": 0, "time_total_s": 1962.1858880519867, "episode_reward_min": -689.2824895004055, "time_this_iter_s": 36.58024859428406, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef66d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6b38>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 136.89339218803158, "outflow_rate_min": 960.0980057504846, "cost1_max": 456.10162185357035, "system_level_velocity_min": 14.889934123663437, "cost2_min": -65.56299902921994, "cost1_mean": 418.96789465833723, "system_level_velocity_mean": 17.35858774205477, "cost2_max": -32.60572074818615, "outflow_rate_mean": 1187.010265788646, "outflow_rate_max": 1255.308966942149, "cost2_mean": -49.895164675018705, "system_level_velocity_max": 18.78779218409671}, "timesteps_this_iter": 43763}
{"episode_reward_max": -319.9643055085562, "episode_reward_mean": -539.3980629430606, "timestamp": 1558588346, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 34, "episode_len_mean": 692.61, "pid": 31789, "done": false, "episodes_total": 1532, "info": {"update_time_ms": 8.73, "sample_time_ms": 23930.85, "num_steps_trained": 2407060, "grad_time_ms": 11944.424, "num_steps_sampled": 2407060, "default": {"vf_loss": 6.654318332672119, "cur_lr": 0.0005000000237487257, "entropy": 0.9200271368026733, "vf_explained_var": 0.9069100618362427, "kl": 0.013157703913748264, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0010398855665698647, "total_loss": 6.65393590927124}, "load_time_ms": 6.4}, "training_iteration": 48, "hostname": "flow-main", "time_since_restore": 1998.5119512081146, "iterations_since_restore": 48, "timesteps_since_restore": 2407060, "date": "2019-05-23_05-12-26", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2407060, "num_metric_batches_dropped": 0, "time_total_s": 1998.5119512081146, "episode_reward_min": -689.2824895004055, "time_this_iter_s": 36.32606315612793, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee15c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee12e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2908>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 240.54598365630892, "outflow_rate_min": 1125.9300837103765, "cost1_max": 456.3244457970377, "system_level_velocity_min": 14.889934123663437, "cost2_min": -65.56299902921994, "cost1_mean": 428.82015534802537, "system_level_velocity_mean": 17.43292675893201, "cost2_max": -39.73372121246188, "outflow_rate_mean": 1197.8411609440116, "outflow_rate_max": 1260.325552082772, "cost2_mean": -50.47114864578319, "system_level_velocity_max": 18.807086902903976}, "timesteps_this_iter": 44181}
{"episode_reward_max": -228.83688155568228, "episode_reward_mean": -537.133630254942, "timestamp": 1558588382, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 35, "episode_len_mean": 690.46, "pid": 31789, "done": false, "episodes_total": 1567, "info": {"update_time_ms": 8.955, "sample_time_ms": 23752.252, "num_steps_trained": 2450939, "grad_time_ms": 12134.967, "num_steps_sampled": 2450939, "default": {"vf_loss": 6.804121971130371, "cur_lr": 0.0005000000237487257, "entropy": 0.9090665578842163, "vf_explained_var": 0.9050472378730774, "kl": 0.014627641066908836, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0014690473908558488, "total_loss": 6.803383827209473}, "load_time_ms": 6.486}, "training_iteration": 49, "hostname": "flow-main", "time_since_restore": 2034.7325251102448, "iterations_since_restore": 49, "timesteps_since_restore": 2450939, "date": "2019-05-23_05-13-02", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2450939, "num_metric_batches_dropped": 0, "time_total_s": 2034.7325251102448, "episode_reward_min": -680.7156809754364, "time_this_iter_s": 36.22057390213013, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89dac7f6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89dac7feb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89dac7fd68>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 198.99565241373608, "outflow_rate_min": 1121.9658321381803, "cost1_max": 460.09863935213195, "system_level_velocity_min": 14.890521159703804, "cost2_min": -65.56299902921994, "cost1_mean": 428.9566481359779, "system_level_velocity_mean": 17.506439836955504, "cost2_max": -39.09050880580715, "outflow_rate_mean": 1199.9688133705436, "outflow_rate_max": 1260.325552082772, "cost2_mean": -50.60237575192442, "system_level_velocity_max": 18.885943303251572}, "timesteps_this_iter": 43879}
{"episode_reward_max": -144.03191408334663, "episode_reward_mean": -528.10394758125, "timestamp": 1558588419, "experiment_id": "c99bd43338114a22ab37aa79d5142cf3", "episodes_this_iter": 35, "episode_len_mean": 681.3, "pid": 31789, "done": true, "episodes_total": 1602, "info": {"update_time_ms": 9.107, "sample_time_ms": 23943.003, "num_steps_trained": 2494898, "grad_time_ms": 12014.954, "num_steps_sampled": 2494898, "default": {"vf_loss": 6.742195129394531, "cur_lr": 0.0005000000237487257, "entropy": 0.8976970911026001, "vf_explained_var": 0.9044061303138733, "kl": 0.01312625128775835, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.001577679649926722, "total_loss": 6.741274833679199}, "load_time_ms": 7.27}, "training_iteration": 50, "hostname": "flow-main", "time_since_restore": 2071.652253627777, "iterations_since_restore": 50, "timesteps_since_restore": 2494898, "date": "2019-05-23_05-13-39", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2494898, "num_metric_batches_dropped": 0, "time_total_s": 2071.652253627777, "episode_reward_min": -620.2129728380922, "time_this_iter_s": 36.91972851753235, "config": {"input": "sampler", "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "kl_coeff": 0.2, "custom_resources_per_worker": {}, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_preprocessor": null, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "grayscale": false}, "output": null, "clip_actions": false, "num_gpus_per_worker": 0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "lambda": 0.97, "lr": 0.0005, "vf_share_layers": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6518>", "on_train_result": null, "on_sample_end": null}, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_clip_param": 1000000.0}, "custom_metrics": {"cost1_min": 138.2477433363405, "outflow_rate_min": 985.4717988515298, "cost1_max": 460.09863935213195, "system_level_velocity_min": 15.92674035555978, "cost2_min": -63.43776015350326, "cost1_mean": 424.1514785214541, "system_level_velocity_mean": 17.551266997338097, "cost2_max": -34.54487890444477, "outflow_rate_mean": 1204.791216558301, "outflow_rate_max": 1260.325552082772, "cost2_mean": -51.090751585837346, "system_level_velocity_max": 18.897527233525555}, "timesteps_this_iter": 43959}

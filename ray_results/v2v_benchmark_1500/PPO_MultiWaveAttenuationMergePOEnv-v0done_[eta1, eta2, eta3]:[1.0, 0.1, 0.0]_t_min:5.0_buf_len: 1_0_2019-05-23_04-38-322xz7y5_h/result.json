{"episode_reward_max": -1529.557446955342, "episode_reward_mean": -1933.1511835692158, "timestamp": 1558586422, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 27, "timesteps_this_iter": 63016, "pid": 31818, "done": false, "episodes_total": 27, "info": {"sample_time_ms": 56856.099, "update_time_ms": 1246.062, "num_steps_trained": 63016, "grad_time_ms": 18696.111, "num_steps_sampled": 63016, "default": {"vf_loss": 34.729976654052734, "cur_lr": 0.0005000000237487257, "entropy": 1.4187984466552734, "vf_explained_var": -1.7573678405824467e-06, "kl": 0.003465319750830531, "cur_kl_coeff": 0.20000001788139343, "policy_loss": -0.0018702080706134439, "total_loss": 34.72880172729492}, "load_time_ms": 66.359}, "training_iteration": 1, "hostname": "flow-main", "time_since_restore": 77.07091045379639, "iterations_since_restore": 1, "timesteps_since_restore": 63016, "date": "2019-05-23_04-40-22", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 63016, "num_metric_batches_dropped": 0, "time_total_s": 77.07091045379639, "episode_reward_min": -2784.596321830733, "time_this_iter_s": 77.07091045379639, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7710>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec76d8>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 172.3960349947435, "outflow_rate_min": 227.0160090403993, "cost1_max": 234.79005324036748, "system_level_velocity_mean": 7.752994966472659, "cost2_min": -42.51417696686007, "cost1_mean": 200.05669997570294, "system_level_velocity_min": 6.559203370538092, "cost2_max": -17.29563268235333, "outflow_rate_mean": 365.75422659178946, "outflow_rate_max": 584.5031626107321, "cost2_mean": -27.134493143810204, "system_level_velocity_max": 8.995557397964781}, "episode_len_mean": 700.0}
{"episode_reward_max": -1160.2012999956344, "episode_reward_mean": -1910.9539721383933, "timestamp": 1558586476, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 28, "timesteps_this_iter": 66902, "pid": 31818, "done": false, "episodes_total": 55, "info": {"sample_time_ms": 45655.029, "update_time_ms": 627.79, "num_steps_trained": 129918, "grad_time_ms": 19033.788, "num_steps_sampled": 129918, "default": {"vf_loss": 27.474449157714844, "cur_lr": 0.0005000000237487257, "entropy": 1.4050421714782715, "vf_explained_var": 0.5190755724906921, "kl": 0.0076832883059978485, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.002344276290386915, "total_loss": 27.47287368774414}, "load_time_ms": 36.86}, "training_iteration": 2, "hostname": "flow-main", "time_since_restore": 131.0319905281067, "iterations_since_restore": 2, "timesteps_since_restore": 129918, "date": "2019-05-23_04-41-16", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 129918, "num_metric_batches_dropped": 0, "time_total_s": 131.0319905281067, "episode_reward_min": -3050.9377009612467, "time_this_iter_s": 53.9610800743103, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7550>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed74e0>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 162.7409420996265, "outflow_rate_min": 224.0508196721311, "cost1_max": 289.9600405144507, "system_level_velocity_mean": 8.101152267278549, "cost2_min": -53.259981992273325, "cost1_mean": 209.71020532333915, "system_level_velocity_min": 6.319181020462165, "cost2_max": -17.29563268235333, "outflow_rate_mean": 430.6241606330901, "outflow_rate_max": 740.5872365339575, "cost2_mean": -30.079048795384672, "system_level_velocity_max": 11.164178065832784}, "episode_len_mean": 700.0}
{"episode_reward_max": -1160.2012999956344, "episode_reward_mean": -1917.9382256583922, "timestamp": 1558586530, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 27, "timesteps_this_iter": 70701, "pid": 31818, "done": false, "episodes_total": 82, "info": {"sample_time_ms": 41739.478, "update_time_ms": 422.175, "num_steps_trained": 200619, "grad_time_ms": 19506.823, "num_steps_sampled": 200619, "default": {"vf_loss": 38.172576904296875, "cur_lr": 0.0005000000237487257, "entropy": 1.3870573043823242, "vf_explained_var": 0.7255451083183289, "kl": 0.008184868842363358, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.002674017334356904, "total_loss": 38.17072296142578}, "load_time_ms": 27.478}, "training_iteration": 3, "hostname": "flow-main", "time_since_restore": 185.52374148368835, "iterations_since_restore": 3, "timesteps_since_restore": 200619, "date": "2019-05-23_04-42-10", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 200619, "num_metric_batches_dropped": 0, "time_total_s": 185.52374148368835, "episode_reward_min": -3050.9377009612467, "time_this_iter_s": 54.491750955581665, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2908>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2780>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 162.7409420996265, "outflow_rate_min": 224.0508196721311, "cost1_max": 304.2629157205469, "system_level_velocity_mean": 8.611118324436104, "cost2_min": -71.5562196641894, "cost1_mean": 223.98332666364183, "system_level_velocity_min": 6.319181020462165, "cost2_max": -17.29563268235333, "outflow_rate_mean": 533.1127828374919, "outflow_rate_max": 931.3327766990292, "cost2_mean": -35.95896931035949, "system_level_velocity_max": 11.496701318580788}, "episode_len_mean": 700.0}
{"episode_reward_max": -1160.2012999956344, "episode_reward_mean": -1879.2464492398099, "timestamp": 1558586583, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 26, "timesteps_this_iter": 67652, "pid": 31818, "done": false, "episodes_total": 108, "info": {"sample_time_ms": 39496.65, "update_time_ms": 319.036, "num_steps_trained": 268271, "grad_time_ms": 19617.764, "num_steps_sampled": 268271, "default": {"vf_loss": 43.42104721069336, "cur_lr": 0.0005000000237487257, "entropy": 1.3638856410980225, "vf_explained_var": 0.8116207718849182, "kl": 0.010600259527564049, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.003756983205676079, "total_loss": 43.41835021972656}, "load_time_ms": 22.743}, "training_iteration": 4, "hostname": "flow-main", "time_since_restore": 238.39912223815918, "iterations_since_restore": 4, "timesteps_since_restore": 268271, "date": "2019-05-23_04-43-03", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 268271, "num_metric_batches_dropped": 0, "time_total_s": 238.39912223815918, "episode_reward_min": -3050.9377009612467, "time_this_iter_s": 52.875380754470825, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee10b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1080>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1198>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 162.7409420996265, "outflow_rate_min": 224.0508196721311, "cost1_max": 337.7586074072282, "system_level_velocity_mean": 9.314290462034627, "cost2_min": -74.9517076735345, "cost1_mean": 243.63955253765235, "system_level_velocity_min": 6.319181020462165, "cost2_max": -18.300809320613094, "outflow_rate_mean": 660.7863044253688, "outflow_rate_max": 1256.6456462486858, "cost2_mean": -42.84810928731054, "system_level_velocity_max": 12.600738632040526}, "episode_len_mean": 700.0}
{"episode_reward_max": -1123.5745568732732, "episode_reward_mean": -1819.290310277196, "timestamp": 1558586636, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 26, "timesteps_this_iter": 67886, "pid": 31818, "done": false, "episodes_total": 134, "info": {"sample_time_ms": 38446.621, "update_time_ms": 256.794, "num_steps_trained": 336157, "grad_time_ms": 19370.186, "num_steps_sampled": 336157, "default": {"vf_loss": 43.539710998535156, "cur_lr": 0.0005000000237487257, "entropy": 1.360135555267334, "vf_explained_var": 0.8484700918197632, "kl": 0.007841750979423523, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.002983381971716881, "total_loss": 43.53750991821289}, "load_time_ms": 19.709}, "training_iteration": 5, "hostname": "flow-main", "time_since_restore": 291.1680073738098, "iterations_since_restore": 5, "timesteps_since_restore": 336157, "date": "2019-05-23_04-43-56", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 336157, "num_metric_batches_dropped": 0, "time_total_s": 291.1680073738098, "episode_reward_min": -3050.9377009612467, "time_this_iter_s": 52.768885135650635, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7b70>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7c88>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 162.7409420996265, "outflow_rate_min": 224.0508196721311, "cost1_max": 398.09561618420696, "system_level_velocity_mean": 10.382474413854004, "cost2_min": -84.08120120176108, "cost1_mean": 272.87429995287107, "system_level_velocity_min": 6.319181020462165, "cost2_max": -18.386423856067474, "outflow_rate_mean": 842.35835134665, "outflow_rate_max": 1313.6782454596773, "cost2_mean": -52.449810258266155, "system_level_velocity_max": 15.142485304568922}, "episode_len_mean": 700.0}
{"episode_reward_max": -1123.5745568732732, "episode_reward_mean": -1751.369511962052, "timestamp": 1558586689, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 26, "timesteps_this_iter": 67861, "pid": 31818, "done": false, "episodes_total": 160, "info": {"sample_time_ms": 37773.596, "update_time_ms": 215.854, "num_steps_trained": 404018, "grad_time_ms": 19125.37, "num_steps_sampled": 404018, "default": {"vf_loss": 40.9280891418457, "cur_lr": 0.0005000000237487257, "entropy": 1.340113878250122, "vf_explained_var": 0.8804239630699158, "kl": 0.005825749132782221, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0009416178800165653, "total_loss": 40.927734375}, "load_time_ms": 17.967}, "training_iteration": 6, "hostname": "flow-main", "time_since_restore": 343.61542987823486, "iterations_since_restore": 6, "timesteps_since_restore": 404018, "date": "2019-05-23_04-44-49", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 404018, "num_metric_batches_dropped": 0, "time_total_s": 343.61542987823486, "episode_reward_min": -2512.5618492089166, "time_this_iter_s": 52.44742250442505, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7c88>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7d68>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 191.75462397704837, "outflow_rate_min": 470.7290961262554, "cost1_max": 398.09561618420696, "system_level_velocity_mean": 11.29693385607989, "cost2_min": -91.17812882011954, "cost1_mean": 298.093710959308, "system_level_velocity_min": 7.414093890043283, "cost2_max": -25.357407079665563, "outflow_rate_mean": 1005.6301384328559, "outflow_rate_max": 1340.5654446064136, "cost2_mean": -63.109840501603955, "system_level_velocity_max": 15.142485304568922}, "episode_len_mean": 700.0}
{"episode_reward_max": -1042.3592361897333, "episode_reward_mean": -1663.5994384122262, "timestamp": 1558586742, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 26, "timesteps_this_iter": 67483, "pid": 31818, "done": false, "episodes_total": 186, "info": {"sample_time_ms": 37339.357, "update_time_ms": 186.003, "num_steps_trained": 471501, "grad_time_ms": 19020.153, "num_steps_sampled": 471501, "default": {"vf_loss": 45.5595703125, "cur_lr": 0.0005000000237487257, "entropy": 1.3304502964019775, "vf_explained_var": 0.8623617887496948, "kl": 0.005316536873579025, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0014032231410965323, "total_loss": 45.55869674682617}, "load_time_ms": 16.789}, "training_iteration": 7, "hostname": "flow-main", "time_since_restore": 396.8748126029968, "iterations_since_restore": 7, "timesteps_since_restore": 471501, "date": "2019-05-23_04-45-42", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 471501, "num_metric_batches_dropped": 0, "time_total_s": 396.8748126029968, "episode_reward_min": -2415.545543585603, "time_this_iter_s": 53.25938272476196, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed26a0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed27f0>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 219.23248521477205, "outflow_rate_min": 766.6999266055044, "cost1_max": 412.0703851639788, "system_level_velocity_mean": 12.121189241321856, "cost2_min": -102.63882045079855, "cost1_mean": 320.1503558588487, "system_level_velocity_min": 8.553704251776942, "cost2_max": -44.89175822384001, "outflow_rate_mean": 1121.0403243219307, "outflow_rate_max": 1443.5592410714285, "cost2_mean": -70.50101786748333, "system_level_velocity_max": 15.56164999852024}, "episode_len_mean": 700.0}
{"episode_reward_max": -948.8862789672496, "episode_reward_mean": -1623.0646645924635, "timestamp": 1558586797, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 29, "timesteps_this_iter": 67291, "pid": 31818, "done": false, "episodes_total": 215, "info": {"sample_time_ms": 37206.087, "update_time_ms": 163.811, "num_steps_trained": 538792, "grad_time_ms": 18920.533, "num_steps_sampled": 538792, "default": {"vf_loss": 41.097537994384766, "cur_lr": 0.0005000000237487257, "entropy": 1.3264511823654175, "vf_explained_var": 0.8731420040130615, "kl": 0.005818571895360947, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.001554171903990209, "total_loss": 41.09656524658203}, "load_time_ms": 15.822}, "training_iteration": 8, "hostname": "flow-main", "time_since_restore": 451.5107750892639, "iterations_since_restore": 8, "timesteps_since_restore": 538792, "date": "2019-05-23_04-46-37", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 538792, "num_metric_batches_dropped": 0, "time_total_s": 451.5107750892639, "episode_reward_min": -2192.1409361640913, "time_this_iter_s": 54.63596248626709, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee12b0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1198>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 219.23248521477205, "outflow_rate_min": 813.6982904564314, "cost1_max": 419.9712689219318, "system_level_velocity_mean": 12.465281507244184, "cost2_min": -113.33705342363982, "cost1_mean": 329.1093360747597, "system_level_velocity_min": 8.553704251776942, "cost2_max": -51.0000814709194, "outflow_rate_mean": 1182.5302290628238, "outflow_rate_max": 1443.5592410714285, "cost2_mean": -77.44360989110011, "system_level_velocity_max": 15.887908324112587}, "episode_len_mean": 700.0}
{"episode_reward_max": -327.2853123333616, "episode_reward_mean": -1573.632518634196, "timestamp": 1558586849, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 27, "timesteps_this_iter": 63702, "pid": 31818, "done": false, "episodes_total": 242, "info": {"sample_time_ms": 36997.222, "update_time_ms": 146.69, "num_steps_trained": 602494, "grad_time_ms": 18690.728, "num_steps_sampled": 602494, "default": {"vf_loss": 38.490074157714844, "cur_lr": 0.0005000000237487257, "entropy": 1.3225220441818237, "vf_explained_var": 0.8832654356956482, "kl": 0.0051826778799295425, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.001777737052179873, "total_loss": 38.48881149291992}, "load_time_ms": 14.724}, "training_iteration": 9, "hostname": "flow-main", "time_since_restore": 503.8110957145691, "iterations_since_restore": 9, "timesteps_since_restore": 602494, "date": "2019-05-23_04-47-29", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 602494, "num_metric_batches_dropped": 0, "time_total_s": 503.8110957145691, "episode_reward_min": -2058.0928390743475, "time_this_iter_s": 52.300320625305176, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7c88>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7f60>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 189.63886741799163, "outflow_rate_min": 1043.418574466884, "cost1_max": 434.63742427392316, "system_level_velocity_mean": 12.669664963464365, "cost2_min": -113.33705342363982, "cost1_mean": 331.4641787811721, "system_level_velocity_min": 9.561507645968357, "cost2_max": -34.50530725031296, "outflow_rate_mean": 1212.4143150003524, "outflow_rate_max": 1507.4186710258257, "cost2_mean": -80.27137628966662, "system_level_velocity_max": 16.746572070028204}, "episode_len_mean": 696.07}
{"episode_reward_max": -327.2853123333616, "episode_reward_mean": -1526.4721959604453, "timestamp": 1558586900, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 28, "timesteps_this_iter": 64998, "pid": 31818, "done": false, "episodes_total": 270, "info": {"sample_time_ms": 36792.705, "update_time_ms": 132.906, "num_steps_trained": 667492, "grad_time_ms": 18455.85, "num_steps_sampled": 667492, "default": {"vf_loss": 43.4890022277832, "cur_lr": 0.0005000000237487257, "entropy": 1.3115496635437012, "vf_explained_var": 0.8763773441314697, "kl": 0.0057322257198393345, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0016414780402556062, "total_loss": 43.48793411254883}, "load_time_ms": 13.899}, "training_iteration": 10, "hostname": "flow-main", "time_since_restore": 555.2378079891205, "iterations_since_restore": 10, "timesteps_since_restore": 667492, "date": "2019-05-23_04-48-20", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 667492, "num_metric_batches_dropped": 0, "time_total_s": 555.2378079891205, "episode_reward_min": -2058.0928390743475, "time_this_iter_s": 51.42671227455139, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee11d0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2be0>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 189.63886741799163, "outflow_rate_min": 1102.7248375653471, "cost1_max": 434.63742427392316, "system_level_velocity_mean": 12.910875584786073, "cost2_min": -113.33705342363982, "cost1_mean": 337.38655434806213, "system_level_velocity_min": 9.561507645968357, "cost2_max": -34.50530725031296, "outflow_rate_mean": 1230.0429114954925, "outflow_rate_max": 1514.2986527272117, "cost2_mean": -82.04949932245401, "system_level_velocity_max": 16.746572070028204}, "episode_len_mean": 696.07}
{"episode_reward_max": -327.2853123333616, "episode_reward_mean": -1477.721294432708, "timestamp": 1558586952, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 35, "timesteps_this_iter": 64527, "pid": 31818, "done": false, "episodes_total": 305, "info": {"sample_time_ms": 34626.832, "update_time_ms": 9.297, "num_steps_trained": 732019, "grad_time_ms": 18178.46, "num_steps_sampled": 732019, "default": {"vf_loss": 46.934730529785156, "cur_lr": 0.0005000000237487257, "entropy": 1.2958085536956787, "vf_explained_var": 0.8561879992485046, "kl": 0.005682002753019333, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0016053274739533663, "total_loss": 46.933692932128906}, "load_time_ms": 8.162}, "training_iteration": 11, "hostname": "flow-main", "time_since_restore": 606.5019798278809, "iterations_since_restore": 11, "timesteps_since_restore": 732019, "date": "2019-05-23_04-49-12", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 732019, "num_metric_batches_dropped": 0, "time_total_s": 606.5019798278809, "episode_reward_min": -1995.521548406119, "time_this_iter_s": 51.264171838760376, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee15f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1748>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1f60>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 189.63886741799163, "outflow_rate_min": 1102.7248375653471, "cost1_max": 444.6505265137031, "system_level_velocity_mean": 13.238410006168628, "cost2_min": -113.33705342363982, "cost1_mean": 344.78147242922785, "system_level_velocity_min": 10.332448904415005, "cost2_max": -34.50530725031296, "outflow_rate_mean": 1245.098797005402, "outflow_rate_max": 1596.5499429490249, "cost2_mean": -83.0524309438841, "system_level_velocity_max": 17.235760936099457}, "episode_len_mean": 696.07}
{"episode_reward_max": -703.543637901799, "episode_reward_mean": -1453.345137649482, "timestamp": 1558587001, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 30, "timesteps_this_iter": 62360, "pid": 31818, "done": false, "episodes_total": 335, "info": {"sample_time_ms": 34509.234, "update_time_ms": 9.163, "num_steps_trained": 794379, "grad_time_ms": 17805.196, "num_steps_sampled": 794379, "default": {"vf_loss": 37.6456413269043, "cur_lr": 0.0005000000237487257, "entropy": 1.2925268411636353, "vf_explained_var": 0.8594633340835571, "kl": 0.004880375228822231, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0018749433802440763, "total_loss": 37.64425277709961}, "load_time_ms": 8.374}, "training_iteration": 12, "hostname": "flow-main", "time_since_restore": 655.557324886322, "iterations_since_restore": 12, "timesteps_since_restore": 794379, "date": "2019-05-23_04-50-01", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 794379, "num_metric_batches_dropped": 0, "time_total_s": 655.557324886322, "episode_reward_min": -1856.1623334872318, "time_this_iter_s": 49.05534505844116, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed24a8>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2048>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 267.44694887385197, "outflow_rate_min": 1090.039485744164, "cost1_max": 444.6505265137031, "system_level_velocity_mean": 13.341635629753775, "cost2_min": -112.47305605415164, "cost1_mean": 349.564469290064, "system_level_velocity_min": 10.332448904415005, "cost2_max": -55.017560429087396, "outflow_rate_mean": 1245.4180415173673, "outflow_rate_max": 1596.5499429490249, "cost2_mean": -83.23435547664042, "system_level_velocity_max": 17.235760936099457}, "episode_len_mean": 700.0}
{"episode_reward_max": -703.543637901799, "episode_reward_mean": -1396.7810052954271, "timestamp": 1558587052, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 31, "timesteps_this_iter": 62182, "pid": 31818, "done": false, "episodes_total": 366, "info": {"sample_time_ms": 34586.964, "update_time_ms": 8.901, "num_steps_trained": 856561, "grad_time_ms": 17381.418, "num_steps_sampled": 856561, "default": {"vf_loss": 35.56694412231445, "cur_lr": 0.0005000000237487257, "entropy": 1.3008455038070679, "vf_explained_var": 0.8658098578453064, "kl": 0.006120400503277779, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0013706533936783671, "total_loss": 35.56588363647461}, "load_time_ms": 8.023}, "training_iteration": 13, "hostname": "flow-main", "time_since_restore": 706.6032340526581, "iterations_since_restore": 13, "timesteps_since_restore": 856561, "date": "2019-05-23_04-50-52", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 856561, "num_metric_batches_dropped": 0, "time_total_s": 706.6032340526581, "episode_reward_min": -1844.1853457947145, "time_this_iter_s": 51.04590916633606, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7be0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7f28>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 267.44694887385197, "outflow_rate_min": 1090.039485744164, "cost1_max": 444.6505265137031, "system_level_velocity_mean": 13.50095137333033, "cost2_min": -112.47305605415164, "cost1_mean": 353.3646789126499, "system_level_velocity_min": 10.332448904415005, "cost2_max": -51.626715170889774, "outflow_rate_mean": 1255.3360378564848, "outflow_rate_max": 1596.5499429490249, "cost2_mean": -80.84403079210489, "system_level_velocity_max": 17.235760936099457}, "episode_len_mean": 700.0}
{"episode_reward_max": -187.90904430845788, "episode_reward_mean": -1339.972697782913, "timestamp": 1558587101, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 27, "timesteps_this_iter": 60167, "pid": 31818, "done": false, "episodes_total": 393, "info": {"sample_time_ms": 34575.415, "update_time_ms": 8.876, "num_steps_trained": 916728, "grad_time_ms": 17000.112, "num_steps_sampled": 916728, "default": {"vf_loss": 31.29267692565918, "cur_lr": 0.0005000000237487257, "entropy": 1.2821171283721924, "vf_explained_var": 0.8753307461738586, "kl": 0.007483446039259434, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0017469205195084214, "total_loss": 31.29130744934082}, "load_time_ms": 8.091}, "training_iteration": 14, "hostname": "flow-main", "time_since_restore": 755.5309646129608, "iterations_since_restore": 14, "timesteps_since_restore": 916728, "date": "2019-05-23_04-51-41", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 916728, "num_metric_batches_dropped": 0, "time_total_s": 755.5309646129608, "episode_reward_min": -1844.1853457947145, "time_this_iter_s": 48.927730560302734, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee14e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7e10>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7c88>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 144.31016283941472, "outflow_rate_min": 1066.029505485801, "cost1_max": 444.46439819898717, "system_level_velocity_mean": 13.56532402832562, "cost2_min": -112.47305605415164, "cost1_mean": 351.9464141378852, "system_level_velocity_min": 10.603263878195854, "cost2_max": -32.21993998284772, "outflow_rate_mean": 1254.8777620296532, "outflow_rate_max": 1545.0581984645955, "cost2_mean": -76.33150618956063, "system_level_velocity_max": 18.19068187943556}, "episode_len_mean": 695.18}
{"episode_reward_max": -32.09568607421948, "episode_reward_mean": -1246.642498092567, "timestamp": 1558587152, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 30, "timesteps_this_iter": 59462, "pid": 31818, "done": false, "episodes_total": 423, "info": {"sample_time_ms": 34462.236, "update_time_ms": 9.222, "num_steps_trained": 976190, "grad_time_ms": 16975.758, "num_steps_sampled": 976190, "default": {"vf_loss": 29.786113739013672, "cur_lr": 0.0005000000237487257, "entropy": 1.2858872413635254, "vf_explained_var": 0.8799058198928833, "kl": 0.0059025706723332405, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0015440977877005935, "total_loss": 29.78486442565918}, "load_time_ms": 7.874}, "training_iteration": 15, "hostname": "flow-main", "time_since_restore": 806.9033312797546, "iterations_since_restore": 15, "timesteps_since_restore": 976190, "date": "2019-05-23_04-52-32", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 976190, "num_metric_batches_dropped": 0, "time_total_s": 806.9033312797546, "episode_reward_min": -1771.6105309035918, "time_this_iter_s": 51.37236666679382, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2c88>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2da0>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.83625147721973, "outflow_rate_min": 465.8227828158284, "cost1_max": 451.1378090676179, "system_level_velocity_mean": 13.917009143163845, "cost2_min": -98.65462385938486, "cost1_mean": 352.95592613760783, "system_level_velocity_min": 10.62682095403941, "cost2_max": -19.104083515023444, "outflow_rate_mean": 1257.1190870925798, "outflow_rate_max": 1545.0581984645955, "cost2_mean": -71.2537153862001, "system_level_velocity_max": 18.291615996473467}, "episode_len_mean": 682.78}
{"episode_reward_max": -31.448428457635654, "episode_reward_mean": -1217.361641916506, "timestamp": 1558587201, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 29, "timesteps_this_iter": 62343, "pid": 31818, "done": false, "episodes_total": 452, "info": {"sample_time_ms": 34253.953, "update_time_ms": 9.012, "num_steps_trained": 1038533, "grad_time_ms": 16804.898, "num_steps_sampled": 1038533, "default": {"vf_loss": 29.31464195251465, "cur_lr": 0.0005000000237487257, "entropy": 1.2751291990280151, "vf_explained_var": 0.8859390616416931, "kl": 0.007647460326552391, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0017677753930911422, "total_loss": 29.313257217407227}, "load_time_ms": 7.761}, "training_iteration": 16, "hostname": "flow-main", "time_since_restore": 855.543671131134, "iterations_since_restore": 16, "timesteps_since_restore": 1038533, "date": "2019-05-23_04-53-21", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1038533, "num_metric_batches_dropped": 0, "time_total_s": 855.543671131134, "episode_reward_min": -1771.6105309035918, "time_this_iter_s": 48.640339851379395, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07c18>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee15f8>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.83625147721973, "outflow_rate_min": 460.7989278777953, "cost1_max": 451.1378090676179, "system_level_velocity_mean": 14.109175253167436, "cost2_min": -93.53023077131267, "cost1_mean": 348.7736059040365, "system_level_velocity_min": 10.62682095403941, "cost2_max": -18.10413172151941, "outflow_rate_mean": 1245.2963282964618, "outflow_rate_max": 1579.223747018022, "cost2_mean": -70.31714392425022, "system_level_velocity_max": 18.564850418313856}, "episode_len_mean": 669.5}
{"episode_reward_max": -23.761538923756504, "episode_reward_mean": -1199.7108954977482, "timestamp": 1558587252, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 29, "timesteps_this_iter": 61940, "pid": 31818, "done": false, "episodes_total": 481, "info": {"sample_time_ms": 34281.26, "update_time_ms": 9.183, "num_steps_trained": 1100473, "grad_time_ms": 16584.426, "num_steps_sampled": 1100473, "default": {"vf_loss": 32.47957992553711, "cur_lr": 0.0005000000237487257, "entropy": 1.279540777206421, "vf_explained_var": 0.8767668604850769, "kl": 0.007200234103947878, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0017611009534448385, "total_loss": 32.478179931640625}, "load_time_ms": 7.714}, "training_iteration": 17, "hostname": "flow-main", "time_since_restore": 906.856005191803, "iterations_since_restore": 17, "timesteps_since_restore": 1100473, "date": "2019-05-23_04-54-12", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1100473, "num_metric_batches_dropped": 0, "time_total_s": 906.856005191803, "episode_reward_min": -1732.8325756347547, "time_this_iter_s": 51.312334060668945, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1e80>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1390>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 18.027443556409636, "outflow_rate_min": 454.9250223567449, "cost1_max": 451.1378090676179, "system_level_velocity_mean": 14.224660792271955, "cost2_min": -101.79057263101684, "cost1_mean": 348.3307627876069, "system_level_velocity_min": 11.021930946956202, "cost2_max": -15.49240779045175, "outflow_rate_mean": 1244.1462639450726, "outflow_rate_max": 1579.223747018022, "cost2_mean": -70.62680285879394, "system_level_velocity_max": 18.564850418313856}, "episode_len_mean": 664.46}
{"episode_reward_max": -23.761538923756504, "episode_reward_mean": -1242.8349458031014, "timestamp": 1558587305, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 28, "timesteps_this_iter": 61384, "pid": 31818, "done": false, "episodes_total": 509, "info": {"sample_time_ms": 34168.606, "update_time_ms": 9.134, "num_steps_trained": 1161857, "grad_time_ms": 16517.405, "num_steps_sampled": 1161857, "default": {"vf_loss": 29.270994186401367, "cur_lr": 0.0005000000237487257, "entropy": 1.2748104333877563, "vf_explained_var": 0.8872610330581665, "kl": 0.00835011899471283, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.001972109777852893, "total_loss": 29.269441604614258}, "load_time_ms": 7.672}, "training_iteration": 18, "hostname": "flow-main", "time_since_restore": 959.7007796764374, "iterations_since_restore": 18, "timesteps_since_restore": 1161857, "date": "2019-05-23_04-55-05", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1161857, "num_metric_batches_dropped": 0, "time_total_s": 959.7007796764374, "episode_reward_min": -1732.8325756347547, "time_this_iter_s": 52.8447744846344, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef09e8>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0c88>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 18.027443556409636, "outflow_rate_min": 454.9250223567449, "cost1_max": 451.5406147710228, "system_level_velocity_mean": 14.088474205835466, "cost2_min": -101.79057263101684, "cost1_mean": 353.13023714761067, "system_level_velocity_min": 11.125414965076452, "cost2_max": -15.49240779045175, "outflow_rate_mean": 1257.2939023259053, "outflow_rate_max": 1627.2491191450285, "cost2_mean": -74.02555990782396, "system_level_velocity_max": 18.564850418313856}, "episode_len_mean": 676.86}
{"episode_reward_max": -23.761538923756504, "episode_reward_mean": -1237.965908668631, "timestamp": 1558587357, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 30, "timesteps_this_iter": 61186, "pid": 31818, "done": false, "episodes_total": 539, "info": {"sample_time_ms": 33969.698, "update_time_ms": 9.195, "num_steps_trained": 1223043, "grad_time_ms": 16653.406, "num_steps_sampled": 1223043, "default": {"vf_loss": 28.953174591064453, "cur_lr": 0.0005000000237487257, "entropy": 1.2583203315734863, "vf_explained_var": 0.8878290057182312, "kl": 0.009445146657526493, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0022790702059865, "total_loss": 28.95136833190918}, "load_time_ms": 7.638}, "training_iteration": 19, "hostname": "flow-main", "time_since_restore": 1011.3682038784027, "iterations_since_restore": 19, "timesteps_since_restore": 1223043, "date": "2019-05-23_04-55-57", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1223043, "num_metric_batches_dropped": 0, "time_total_s": 1011.3682038784027, "episode_reward_min": -1732.8325756347547, "time_this_iter_s": 51.66742420196533, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1208>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1748>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 18.027443556409636, "outflow_rate_min": 454.9250223567449, "cost1_max": 458.75878391456183, "system_level_velocity_mean": 14.095919460922698, "cost2_min": -101.79057263101684, "cost1_mean": 351.00013937975467, "system_level_velocity_min": 10.885498201997057, "cost2_max": -15.49240779045175, "outflow_rate_mean": 1259.988981207204, "outflow_rate_max": 1627.2491191450285, "cost2_mean": -75.55729066916437, "system_level_velocity_max": 18.564850418313856}, "episode_len_mean": 673.63}
{"episode_reward_max": -23.761538923756504, "episode_reward_mean": -1246.387116944498, "timestamp": 1558587408, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 31, "timesteps_this_iter": 60455, "pid": 31818, "done": false, "episodes_total": 570, "info": {"sample_time_ms": 33724.266, "update_time_ms": 9.235, "num_steps_trained": 1283498, "grad_time_ms": 16849.928, "num_steps_sampled": 1283498, "default": {"vf_loss": 24.89044761657715, "cur_lr": 0.0005000000237487257, "entropy": 1.2573050260543823, "vf_explained_var": 0.8951349854469299, "kl": 0.008248236030340195, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0019648170564323664, "total_loss": 24.88889503479004}, "load_time_ms": 7.862}, "training_iteration": 20, "hostname": "flow-main", "time_since_restore": 1062.318578004837, "iterations_since_restore": 20, "timesteps_since_restore": 1283498, "date": "2019-05-23_04-56-48", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1283498, "num_metric_batches_dropped": 0, "time_total_s": 1062.318578004837, "episode_reward_min": -1627.2145805313457, "time_this_iter_s": 50.950374126434326, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef00b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0940>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0dd8>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 18.027443556409636, "outflow_rate_min": 454.9250223567449, "cost1_max": 458.75878391456183, "system_level_velocity_mean": 13.972073372033528, "cost2_min": -100.08758924428648, "cost1_mean": 354.3407448818805, "system_level_velocity_min": 10.885498201997057, "cost2_max": -15.49240779045175, "outflow_rate_mean": 1268.2170817583876, "outflow_rate_max": 1627.2491191450285, "cost2_mean": -77.08518549965089, "system_level_velocity_max": 18.23521408495376}, "episode_len_mean": 683.41}
{"episode_reward_max": -90.92284973567816, "episode_reward_mean": -1246.4647412981255, "timestamp": 1558587458, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 29, "timesteps_this_iter": 58090, "pid": 31818, "done": false, "episodes_total": 599, "info": {"sample_time_ms": 33449.311, "update_time_ms": 9.118, "num_steps_trained": 1341588, "grad_time_ms": 16987.582, "num_steps_sampled": 1341588, "default": {"vf_loss": 20.8980770111084, "cur_lr": 0.0005000000237487257, "entropy": 1.2382241487503052, "vf_explained_var": 0.9067981839179993, "kl": 0.00869683362543583, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0018101517343893647, "total_loss": 20.896703720092773}, "load_time_ms": 7.483}, "training_iteration": 21, "hostname": "flow-main", "time_since_restore": 1112.1934621334076, "iterations_since_restore": 21, "timesteps_since_restore": 1341588, "date": "2019-05-23_04-57-38", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1341588, "num_metric_batches_dropped": 0, "time_total_s": 1112.1934621334076, "episode_reward_min": -1627.2145805313457, "time_this_iter_s": 49.87488412857056, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee19b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1da0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1128>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 78.27633888200744, "outflow_rate_min": 769.4578943253781, "cost1_max": 458.75878391456183, "system_level_velocity_mean": 13.786675972572192, "cost2_min": -100.08758924428648, "cost1_mean": 349.9654599278779, "system_level_velocity_min": 10.885498201997057, "cost2_max": -27.38389015391854, "outflow_rate_mean": 1260.5096786567533, "outflow_rate_max": 1624.4289042207797, "cost2_mean": -77.23347745245253, "system_level_velocity_max": 18.910633531985955}, "episode_len_mean": 684.31}
{"episode_reward_max": -31.840638948036496, "episode_reward_mean": -1205.9305173823, "timestamp": 1558587507, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 34, "timesteps_this_iter": 57317, "pid": 31818, "done": false, "episodes_total": 633, "info": {"sample_time_ms": 33288.85, "update_time_ms": 9.403, "num_steps_trained": 1398905, "grad_time_ms": 17116.109, "num_steps_sampled": 1398905, "default": {"vf_loss": 23.09505271911621, "cur_lr": 0.0005000000237487257, "entropy": 1.2389271259307861, "vf_explained_var": 0.8959971070289612, "kl": 0.009096101857721806, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002140926430001855, "total_loss": 23.093364715576172}, "load_time_ms": 7.263}, "training_iteration": 22, "hostname": "flow-main", "time_since_restore": 1160.9142198562622, "iterations_since_restore": 22, "timesteps_since_restore": 1398905, "date": "2019-05-23_04-58-27", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1398905, "num_metric_batches_dropped": 0, "time_total_s": 1160.9142198562622, "episode_reward_min": -1540.9400913685024, "time_this_iter_s": 48.720757722854614, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee15c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1fd0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1ef0>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.83886302046504, "outflow_rate_min": 463.7321904813336, "cost1_max": 433.90233525735164, "system_level_velocity_mean": 13.836448067448508, "cost2_min": -95.52608140441124, "cost1_mean": 349.3961389128706, "system_level_velocity_min": 11.114594780876104, "cost2_max": -18.043439096778588, "outflow_rate_mean": 1249.532825114842, "outflow_rate_max": 1445.2859850452573, "cost2_mean": -75.17887976300999, "system_level_velocity_max": 18.910633531985955}, "episode_len_mean": 681.77}
{"episode_reward_max": -31.840638948036496, "episode_reward_mean": -1164.7997248906365, "timestamp": 1558587555, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 30, "timesteps_this_iter": 56662, "pid": 31818, "done": false, "episodes_total": 663, "info": {"sample_time_ms": 32930.338, "update_time_ms": 9.651, "num_steps_trained": 1455567, "grad_time_ms": 17211.29, "num_steps_sampled": 1455567, "default": {"vf_loss": 23.868667602539062, "cur_lr": 0.0005000000237487257, "entropy": 1.2388026714324951, "vf_explained_var": 0.8992699384689331, "kl": 0.0082693537697196, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002097061136737466, "total_loss": 23.866987228393555}, "load_time_ms": 7.273}, "training_iteration": 23, "hostname": "flow-main", "time_since_restore": 1209.2973313331604, "iterations_since_restore": 23, "timesteps_since_restore": 1455567, "date": "2019-05-23_04-59-15", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1455567, "num_metric_batches_dropped": 0, "time_total_s": 1209.2973313331604, "episode_reward_min": -1499.0773112192207, "time_this_iter_s": 48.38311147689819, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2ef0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed21d0>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.83886302046504, "outflow_rate_min": 463.7321904813336, "cost1_max": 454.5959611085732, "system_level_velocity_mean": 13.955353904165213, "cost2_min": -90.9485555952876, "cost1_mean": 352.29788609026633, "system_level_velocity_min": 11.519646954816485, "cost2_max": -18.043439096778588, "outflow_rate_mean": 1254.4173344145859, "outflow_rate_max": 1571.2776308433956, "cost2_mean": -73.85576127860679, "system_level_velocity_max": 18.910633531985955}, "episode_len_mean": 681.77}
{"episode_reward_max": -31.840638948036496, "episode_reward_mean": -1135.5232898397542, "timestamp": 1558587600, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 27, "timesteps_this_iter": 55364, "pid": 31818, "done": false, "episodes_total": 690, "info": {"sample_time_ms": 32540.731, "update_time_ms": 9.652, "num_steps_trained": 1510931, "grad_time_ms": 17247.146, "num_steps_sampled": 1510931, "default": {"vf_loss": 17.304784774780273, "cur_lr": 0.0005000000237487257, "entropy": 1.2152339220046997, "vf_explained_var": 0.9202821254730225, "kl": 0.008500921539962292, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0018242003861814737, "total_loss": 17.303386688232422}, "load_time_ms": 7.1}, "training_iteration": 24, "hostname": "flow-main", "time_since_restore": 1254.6606483459473, "iterations_since_restore": 24, "timesteps_since_restore": 1510931, "date": "2019-05-23_05-00-00", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1510931, "num_metric_batches_dropped": 0, "time_total_s": 1254.6606483459473, "episode_reward_min": -1398.734123991507, "time_this_iter_s": 45.363317012786865, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0ef0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0c50>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.83886302046504, "outflow_rate_min": 463.7321904813336, "cost1_max": 455.43615346171487, "system_level_velocity_mean": 13.971083103950823, "cost2_min": -88.1028869291528, "cost1_mean": 356.6048752696516, "system_level_velocity_min": 11.377833367306486, "cost2_max": -18.043439096778588, "outflow_rate_mean": 1264.3020467263525, "outflow_rate_max": 1579.726161901327, "cost2_mean": -73.34093090544138, "system_level_velocity_max": 18.491811805591695}, "episode_len_mean": 687.6}
{"episode_reward_max": -266.82227437891044, "episode_reward_mean": -1096.5171648864764, "timestamp": 1558587644, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 31, "timesteps_this_iter": 53841, "pid": 31818, "done": false, "episodes_total": 721, "info": {"sample_time_ms": 32067.992, "update_time_ms": 9.333, "num_steps_trained": 1564772, "grad_time_ms": 16954.89, "num_steps_sampled": 1564772, "default": {"vf_loss": 16.876617431640625, "cur_lr": 0.0005000000237487257, "entropy": 1.2023228406906128, "vf_explained_var": 0.9165657162666321, "kl": 0.009394294582307339, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0016541534569114447, "total_loss": 16.87543296813965}, "load_time_ms": 7.37}, "training_iteration": 25, "hostname": "flow-main", "time_since_restore": 1298.3840539455414, "iterations_since_restore": 25, "timesteps_since_restore": 1564772, "date": "2019-05-23_05-00-44", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1564772, "num_metric_batches_dropped": 0, "time_total_s": 1298.3840539455414, "episode_reward_min": -1398.734123991507, "time_this_iter_s": 43.723405599594116, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee95c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9588>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9550>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 194.41028547256207, "outflow_rate_min": 1108.3740022385273, "cost1_max": 455.43615346171487, "system_level_velocity_mean": 13.967487216733243, "cost2_min": -88.1028869291528, "cost1_mean": 361.59033568044947, "system_level_velocity_min": 11.317518435876524, "cost2_max": -35.69200770321103, "outflow_rate_mean": 1272.8501460369514, "outflow_rate_max": 1579.726161901327, "cost2_mean": -71.04463554604294, "system_level_velocity_max": 17.816227549708103}, "episode_len_mean": 695.97}
{"episode_reward_max": -30.56714408921611, "episode_reward_mean": -1045.9277966832458, "timestamp": 1558587692, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 30, "timesteps_this_iter": 55521, "pid": 31818, "done": false, "episodes_total": 751, "info": {"sample_time_ms": 31864.784, "update_time_ms": 9.42, "num_steps_trained": 1620293, "grad_time_ms": 17059.046, "num_steps_sampled": 1620293, "default": {"vf_loss": 19.97406768798828, "cur_lr": 0.0005000000237487257, "entropy": 1.2023186683654785, "vf_explained_var": 0.9090707898139954, "kl": 0.008710011839866638, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0016128926072269678, "total_loss": 19.972890853881836}, "load_time_ms": 7.601}, "training_iteration": 26, "hostname": "flow-main", "time_since_restore": 1346.0381045341492, "iterations_since_restore": 26, "timesteps_since_restore": 1620293, "date": "2019-05-23_05-01-32", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1620293, "num_metric_batches_dropped": 0, "time_total_s": 1346.0381045341492, "episode_reward_min": -1398.734123991507, "time_this_iter_s": 47.65405058860779, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0080>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef04a8>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 23.059956955093476, "outflow_rate_min": 477.97970342909986, "cost1_max": 455.43615346171487, "system_level_velocity_mean": 14.114796630525586, "cost2_min": -88.1028869291528, "cost1_mean": 355.69640376132077, "system_level_velocity_min": 11.317518435876524, "cost2_max": -17.13254929492334, "outflow_rate_mean": 1253.4050250396951, "outflow_rate_max": 1579.726161901327, "cost2_mean": -67.9766017265703, "system_level_velocity_max": 18.59470257203186}, "episode_len_mean": 682.67}
{"episode_reward_max": -30.56714408921611, "episode_reward_mean": -994.2106099515794, "timestamp": 1558587738, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 31, "timesteps_this_iter": 55794, "pid": 31818, "done": false, "episodes_total": 782, "info": {"sample_time_ms": 31263.219, "update_time_ms": 9.667, "num_steps_trained": 1676087, "grad_time_ms": 17155.74, "num_steps_sampled": 1676087, "default": {"vf_loss": 19.01195526123047, "cur_lr": 0.0005000000237487257, "entropy": 1.179671049118042, "vf_explained_var": 0.917508602142334, "kl": 0.009653913788497448, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0021451532375067472, "total_loss": 19.010290145874023}, "load_time_ms": 7.22}, "training_iteration": 27, "hostname": "flow-main", "time_since_restore": 1392.3255834579468, "iterations_since_restore": 27, "timesteps_since_restore": 1676087, "date": "2019-05-23_05-02-18", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1676087, "num_metric_batches_dropped": 0, "time_total_s": 1392.3255834579468, "episode_reward_min": -1398.734123991507, "time_this_iter_s": 46.28747892379761, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0320>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef03c8>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 23.059956955093476, "outflow_rate_min": 477.97970342909986, "cost1_max": 447.4428097875947, "system_level_velocity_mean": 14.351420928212342, "cost2_min": -84.6511837591176, "cost1_mean": 350.349523724248, "system_level_velocity_min": 11.317518435876524, "cost2_max": -17.13254929492334, "outflow_rate_mean": 1246.9417011694413, "outflow_rate_max": 1538.5134899630034, "cost2_mean": -65.06525523291583, "system_level_velocity_max": 18.59470257203186}, "episode_len_mean": 667.06}
{"episode_reward_max": -30.56714408921611, "episode_reward_mean": -1001.7291886916863, "timestamp": 1558587782, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 32, "timesteps_this_iter": 54952, "pid": 31818, "done": false, "episodes_total": 814, "info": {"sample_time_ms": 30598.096, "update_time_ms": 9.707, "num_steps_trained": 1731039, "grad_time_ms": 16927.885, "num_steps_sampled": 1731039, "default": {"vf_loss": 18.935792922973633, "cur_lr": 0.0005000000237487257, "entropy": 1.1680009365081787, "vf_explained_var": 0.9104039669036865, "kl": 0.010342059656977654, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0022728079929947853, "total_loss": 18.934038162231445}, "load_time_ms": 7.126}, "training_iteration": 28, "hostname": "flow-main", "time_since_restore": 1436.2106091976166, "iterations_since_restore": 28, "timesteps_since_restore": 1731039, "date": "2019-05-23_05-03-02", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1731039, "num_metric_batches_dropped": 0, "time_total_s": 1436.2106091976166, "episode_reward_min": -1266.9930918571852, "time_this_iter_s": 43.8850257396698, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6e80>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef65f8>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 23.059956955093476, "outflow_rate_min": 477.97970342909986, "cost1_max": 447.4428097875947, "system_level_velocity_mean": 14.2770434680723, "cost2_min": -84.11620861995763, "cost1_mean": 348.78212499642245, "system_level_velocity_min": 11.76525109484142, "cost2_max": -17.13254929492334, "outflow_rate_mean": 1238.9167128702654, "outflow_rate_max": 1538.5134899630034, "cost2_mean": -65.48442943764107, "system_level_velocity_max": 18.59470257203186}, "episode_len_mean": 667.53}
{"episode_reward_max": -105.13757318180868, "episode_reward_mean": -1016.5151007767487, "timestamp": 1558587826, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 32, "timesteps_this_iter": 54449, "pid": 31818, "done": false, "episodes_total": 846, "info": {"sample_time_ms": 30198.024, "update_time_ms": 9.469, "num_steps_trained": 1785488, "grad_time_ms": 16594.041, "num_steps_sampled": 1785488, "default": {"vf_loss": 15.743852615356445, "cur_lr": 0.0005000000237487257, "entropy": 1.173359751701355, "vf_explained_var": 0.927546501159668, "kl": 0.009710417129099369, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0024986339267343283, "total_loss": 15.741838455200195}, "load_time_ms": 8.261}, "training_iteration": 29, "hostname": "flow-main", "time_since_restore": 1480.5488095283508, "iterations_since_restore": 29, "timesteps_since_restore": 1785488, "date": "2019-05-23_05-03-46", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1785488, "num_metric_batches_dropped": 0, "time_total_s": 1480.5488095283508, "episode_reward_min": -1266.9930918571852, "time_this_iter_s": 44.33820033073425, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed21d0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2a90>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 84.02462057245678, "outflow_rate_min": 801.0763685158746, "cost1_max": 450.6423924034831, "system_level_velocity_mean": 14.177090492551192, "cost2_min": -83.7796567703535, "cost1_mean": 355.1331071653196, "system_level_velocity_min": 11.996621140916785, "cost2_max": -31.488292171967526, "outflow_rate_mean": 1255.9806954155013, "outflow_rate_max": 1538.5134899630034, "cost2_mean": -67.6475354287347, "system_level_velocity_max": 18.57245003585316}, "episode_len_mean": 680.83}
{"episode_reward_max": -29.552001948116228, "episode_reward_mean": -999.7359523772731, "timestamp": 1558587869, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 29, "timesteps_this_iter": 51304, "pid": 31818, "done": false, "episodes_total": 875, "info": {"sample_time_ms": 29868.017, "update_time_ms": 9.258, "num_steps_trained": 1836792, "grad_time_ms": 16109.561, "num_steps_sampled": 1836792, "default": {"vf_loss": 15.134804725646973, "cur_lr": 0.0005000000237487257, "entropy": 1.1527223587036133, "vf_explained_var": 0.9196994304656982, "kl": 0.011618285439908504, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002466241829097271, "total_loss": 15.132920265197754}, "load_time_ms": 8.293}, "training_iteration": 30, "hostname": "flow-main", "time_since_restore": 1523.3283264636993, "iterations_since_restore": 30, "timesteps_since_restore": 1836792, "date": "2019-05-23_05-04-29", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1836792, "num_metric_batches_dropped": 0, "time_total_s": 1523.3283264636993, "episode_reward_min": -1244.6968313891887, "time_this_iter_s": 42.77951693534851, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0278>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0e80>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.798378462891563, "outflow_rate_min": 514.5009007334598, "cost1_max": 450.6423924034831, "system_level_velocity_mean": 14.122034082641633, "cost2_min": -83.7796567703535, "cost1_mean": 356.0209580127425, "system_level_velocity_min": 11.959651927286254, "cost2_max": -14.764999435623322, "outflow_rate_mean": 1250.301868506801, "outflow_rate_max": 1542.2837995175134, "cost2_mean": -66.81435398276498, "system_level_velocity_max": 18.570477929153796}, "episode_len_mean": 684.86}
{"episode_reward_max": -29.552001948116228, "episode_reward_mean": -967.9625973512285, "timestamp": 1558587915, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 29, "timesteps_this_iter": 54283, "pid": 31818, "done": false, "episodes_total": 904, "info": {"sample_time_ms": 29473.269, "update_time_ms": 9.448, "num_steps_trained": 1891075, "grad_time_ms": 16085.524, "num_steps_sampled": 1891075, "default": {"vf_loss": 15.290056228637695, "cur_lr": 0.0005000000237487257, "entropy": 1.1419289112091064, "vf_explained_var": 0.9293491244316101, "kl": 0.007888946682214737, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0015617698663845658, "total_loss": 15.28888988494873}, "load_time_ms": 9.533}, "training_iteration": 31, "hostname": "flow-main", "time_since_restore": 1569.0410256385803, "iterations_since_restore": 31, "timesteps_since_restore": 1891075, "date": "2019-05-23_05-05-15", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1891075, "num_metric_batches_dropped": 0, "time_total_s": 1569.0410256385803, "episode_reward_min": -1195.072729705589, "time_this_iter_s": 45.71269917488098, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2400>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2ef0>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.798378462891563, "outflow_rate_min": 514.5009007334598, "cost1_max": 454.26275919299087, "system_level_velocity_mean": 14.368860080632281, "cost2_min": -83.7796567703535, "cost1_mean": 360.4477755254291, "system_level_velocity_min": 11.959651927286254, "cost2_max": -14.764999435623322, "outflow_rate_mean": 1259.891051146764, "outflow_rate_max": 1584.7819051245963, "cost2_mean": -65.08765625774309, "system_level_velocity_max": 18.570477929153796}, "episode_len_mean": 681.81}
{"episode_reward_max": -29.552001948116228, "episode_reward_mean": -951.5119779221442, "timestamp": 1558587960, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 31, "timesteps_this_iter": 52249, "pid": 31818, "done": false, "episodes_total": 935, "info": {"sample_time_ms": 29225.076, "update_time_ms": 9.305, "num_steps_trained": 1943324, "grad_time_ms": 15988.797, "num_steps_sampled": 1943324, "default": {"vf_loss": 15.718177795410156, "cur_lr": 0.0005000000237487257, "entropy": 1.1293792724609375, "vf_explained_var": 0.9086146354675293, "kl": 0.008695314638316631, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0014246245846152306, "total_loss": 15.71718692779541}, "load_time_ms": 9.896}, "training_iteration": 32, "hostname": "flow-main", "time_since_restore": 1614.308599948883, "iterations_since_restore": 32, "timesteps_since_restore": 1943324, "date": "2019-05-23_05-06-00", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1943324, "num_metric_batches_dropped": 0, "time_total_s": 1614.308599948883, "episode_reward_min": -1173.6957072307953, "time_this_iter_s": 45.267574310302734, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef62e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6908>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6080>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.798378462891563, "outflow_rate_min": 514.5009007334598, "cost1_max": 454.26275919299087, "system_level_velocity_mean": 14.450646727495494, "cost2_min": -83.7796567703535, "cost1_mean": 363.6736624765827, "system_level_velocity_min": 11.959651927286254, "cost2_max": -14.764999435623322, "outflow_rate_mean": 1264.9749423750357, "outflow_rate_max": 1584.7819051245963, "cost2_mean": -62.47947904333767, "system_level_velocity_max": 18.570477929153796}, "episode_len_mean": 684.04}
{"episode_reward_max": -94.47194805610499, "episode_reward_mean": -925.5990899268593, "timestamp": 1558588004, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 30, "timesteps_this_iter": 52165, "pid": 31818, "done": false, "episodes_total": 965, "info": {"sample_time_ms": 28879.147, "update_time_ms": 9.022, "num_steps_trained": 1995489, "grad_time_ms": 15850.213, "num_steps_sampled": 1995489, "default": {"vf_loss": 16.076723098754883, "cur_lr": 0.0005000000237487257, "entropy": 1.1349129676818848, "vf_explained_var": 0.9094278812408447, "kl": 0.00953544583171606, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0022517142351716757, "total_loss": 16.074947357177734}, "load_time_ms": 10.195}, "training_iteration": 33, "hostname": "flow-main", "time_since_restore": 1657.8460433483124, "iterations_since_restore": 33, "timesteps_since_restore": 1995489, "date": "2019-05-23_05-06-44", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1995489, "num_metric_batches_dropped": 0, "time_total_s": 1657.8460433483124, "episode_reward_min": -1125.5974789578254, "time_this_iter_s": 43.53744339942932, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee15c0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1048>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 78.01138651454403, "outflow_rate_min": 765.6918198546693, "cost1_max": 454.26275919299087, "system_level_velocity_mean": 14.643381089634158, "cost2_min": -72.82660478650604, "cost1_mean": 369.4615870177147, "system_level_velocity_min": 12.155985442820317, "cost2_max": -24.918451148859514, "outflow_rate_mean": 1288.2009601250234, "outflow_rate_max": 1584.7819051245963, "cost2_mean": -59.27716096196822, "system_level_velocity_max": 18.311967740865786}, "episode_len_mean": 685.84}
{"episode_reward_max": -195.16957890237475, "episode_reward_mean": -919.405029881846, "timestamp": 1558588047, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 35, "timesteps_this_iter": 50063, "pid": 31818, "done": false, "episodes_total": 1000, "info": {"sample_time_ms": 28905.784, "update_time_ms": 8.978, "num_steps_trained": 2045552, "grad_time_ms": 15571.055, "num_steps_sampled": 2045552, "default": {"vf_loss": 15.535383224487305, "cur_lr": 0.0005000000237487257, "entropy": 1.123824119567871, "vf_explained_var": 0.8936653733253479, "kl": 0.010760098695755005, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002642476698383689, "total_loss": 15.533279418945312}, "load_time_ms": 10.244}, "training_iteration": 34, "hostname": "flow-main", "time_since_restore": 1700.6822350025177, "iterations_since_restore": 34, "timesteps_since_restore": 2045552, "date": "2019-05-23_05-07-27", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2045552, "num_metric_batches_dropped": 0, "time_total_s": 1700.6822350025177, "episode_reward_min": -1125.5974789578254, "time_this_iter_s": 42.83619165420532, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1240>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0358>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 137.19861627939986, "outflow_rate_min": 1041.3408376693733, "cost1_max": 435.1973248112533, "system_level_velocity_mean": 14.587709624464962, "cost2_min": -71.20338349669206, "cost1_mean": 372.5229738233252, "system_level_velocity_min": 12.155985442820317, "cost2_max": -25.94823260361936, "outflow_rate_mean": 1289.6603937737514, "outflow_rate_max": 1501.8886679896275, "cost2_mean": -56.95766993975521, "system_level_velocity_max": 17.671982314936947}, "episode_len_mean": 693.82}
{"episode_reward_max": -195.16957890237475, "episode_reward_mean": -895.4136680617627, "timestamp": 1558588088, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 28, "timesteps_this_iter": 51518, "pid": 31818, "done": false, "episodes_total": 1028, "info": {"sample_time_ms": 28885.849, "update_time_ms": 9.118, "num_steps_trained": 2097070, "grad_time_ms": 15357.553, "num_steps_sampled": 2097070, "default": {"vf_loss": 13.371992111206055, "cur_lr": 0.0005000000237487257, "entropy": 1.1275306940078735, "vf_explained_var": 0.920427143573761, "kl": 0.008514772169291973, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0025011259131133556, "total_loss": 13.369917869567871}, "load_time_ms": 10.165}, "training_iteration": 35, "hostname": "flow-main", "time_since_restore": 1742.0794801712036, "iterations_since_restore": 35, "timesteps_since_restore": 2097070, "date": "2019-05-23_05-08-08", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2097070, "num_metric_batches_dropped": 0, "time_total_s": 1742.0794801712036, "episode_reward_min": -1125.5974789578254, "time_this_iter_s": 41.39724516868591, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef64e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef66d8>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6828>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 137.19861627939986, "outflow_rate_min": 1041.3408376693733, "cost1_max": 439.3859473847255, "system_level_velocity_mean": 14.80028653715766, "cost2_min": -67.55603291470362, "cost1_mean": 377.60944551012153, "system_level_velocity_min": 12.155985442820317, "cost2_max": -25.94823260361936, "outflow_rate_mean": 1301.5980946564428, "outflow_rate_max": 1501.8886679896275, "cost2_mean": -54.71614587152093, "system_level_velocity_max": 17.671982314936947}, "episode_len_mean": 695.15}
{"episode_reward_max": -661.8507045649291, "episode_reward_mean": -899.5581073531549, "timestamp": 1558588132, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 28, "timesteps_this_iter": 52308, "pid": 31818, "done": false, "episodes_total": 1056, "info": {"sample_time_ms": 28814.011, "update_time_ms": 8.926, "num_steps_trained": 2149378, "grad_time_ms": 15034.204, "num_steps_sampled": 2149378, "default": {"vf_loss": 17.085664749145508, "cur_lr": 0.0005000000237487257, "entropy": 1.135709285736084, "vf_explained_var": 0.907380998134613, "kl": 0.009873990900814533, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002557579195126891, "total_loss": 17.083600997924805}, "load_time_ms": 10.472}, "training_iteration": 36, "hostname": "flow-main", "time_since_restore": 1785.7703456878662, "iterations_since_restore": 36, "timesteps_since_restore": 2149378, "date": "2019-05-23_05-08-52", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2149378, "num_metric_batches_dropped": 0, "time_total_s": 1785.7703456878662, "episode_reward_min": -1108.5324383962304, "time_this_iter_s": 43.6908655166626, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed22e8>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2390>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 316.3405099859564, "outflow_rate_min": 1109.156796397151, "cost1_max": 439.3859473847255, "system_level_velocity_mean": 14.81710828443774, "cost2_min": -68.73559778188397, "cost1_mean": 380.9168396784118, "system_level_velocity_min": 12.155985442820317, "cost2_max": -39.69274271809813, "outflow_rate_mean": 1308.5916497471073, "outflow_rate_max": 1501.8886679896275, "cost2_mean": -54.990056379160166, "system_level_velocity_max": 17.443150037437814}, "episode_len_mean": 700.0}
{"episode_reward_max": -666.8972469279466, "episode_reward_mean": -910.4703242388416, "timestamp": 1558588176, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 30, "timesteps_this_iter": 51517, "pid": 31818, "done": false, "episodes_total": 1086, "info": {"sample_time_ms": 28882.946, "update_time_ms": 8.807, "num_steps_trained": 2200895, "grad_time_ms": 14728.806, "num_steps_sampled": 2200895, "default": {"vf_loss": 16.68821144104004, "cur_lr": 0.0005000000237487257, "entropy": 1.120986819267273, "vf_explained_var": 0.9043396711349487, "kl": 0.008190231397747993, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0017856169724836946, "total_loss": 16.68683433532715}, "load_time_ms": 10.626}, "training_iteration": 37, "hostname": "flow-main", "time_since_restore": 1829.6719243526459, "iterations_since_restore": 37, "timesteps_since_restore": 2200895, "date": "2019-05-23_05-09-36", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2200895, "num_metric_batches_dropped": 0, "time_total_s": 1829.6719243526459, "episode_reward_min": -1108.5324383962304, "time_this_iter_s": 43.90157866477966, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1240>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1748>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 303.83792612548507, "outflow_rate_min": 1139.8223250839444, "cost1_max": 439.3859473847255, "system_level_velocity_mean": 14.728400765220524, "cost2_min": -68.73559778188397, "cost1_mean": 378.37567574034676, "system_level_velocity_min": 12.264340510692014, "cost2_max": -39.69274271809813, "outflow_rate_mean": 1299.263319733639, "outflow_rate_max": 1500.8279223078755, "cost2_mean": -56.37037097577789, "system_level_velocity_max": 17.443150037437814}, "episode_len_mean": 699.22}
{"episode_reward_max": -653.9357358361015, "episode_reward_mean": -904.1948684092771, "timestamp": 1558588217, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 32, "timesteps_this_iter": 51272, "pid": 31818, "done": false, "episodes_total": 1118, "info": {"sample_time_ms": 28835.771, "update_time_ms": 8.929, "num_steps_trained": 2252167, "grad_time_ms": 14551.834, "num_steps_sampled": 2252167, "default": {"vf_loss": 14.197933197021484, "cur_lr": 0.0005000000237487257, "entropy": 1.1134997606277466, "vf_explained_var": 0.909690797328949, "kl": 0.010247000493109226, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0028871786780655384, "total_loss": 14.195557594299316}, "load_time_ms": 10.828}, "training_iteration": 38, "hostname": "flow-main", "time_since_restore": 1871.313393354416, "iterations_since_restore": 38, "timesteps_since_restore": 2252167, "date": "2019-05-23_05-10-17", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2252167, "num_metric_batches_dropped": 0, "time_total_s": 1871.313393354416, "episode_reward_min": -1108.5324383962304, "time_this_iter_s": 41.64146900177002, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6e10>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef07b8>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 303.83792612548507, "outflow_rate_min": 1152.6929534368066, "cost1_max": 437.13620363914777, "system_level_velocity_mean": 14.682265868632426, "cost2_min": -72.2264248792582, "cost1_mean": 376.72921535821826, "system_level_velocity_min": 12.096485456837545, "cost2_max": -36.83061871888875, "outflow_rate_mean": 1299.1338629041697, "outflow_rate_max": 1498.831698483335, "cost2_mean": -57.00991229809638, "system_level_velocity_max": 17.369865318004887}, "episode_len_mean": 699.22}
{"episode_reward_max": -94.13808143617958, "episode_reward_mean": -862.0903210675334, "timestamp": 1558588259, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 34, "timesteps_this_iter": 50851, "pid": 31818, "done": false, "episodes_total": 1152, "info": {"sample_time_ms": 28732.088, "update_time_ms": 8.988, "num_steps_trained": 2303018, "grad_time_ms": 14356.472, "num_steps_sampled": 2303018, "default": {"vf_loss": 13.48422908782959, "cur_lr": 0.0005000000237487257, "entropy": 1.0966705083847046, "vf_explained_var": 0.9079651236534119, "kl": 0.010988347232341766, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.00229375041089952, "total_loss": 13.48248291015625}, "load_time_ms": 9.827}, "training_iteration": 39, "hostname": "flow-main", "time_since_restore": 1912.6742370128632, "iterations_since_restore": 39, "timesteps_since_restore": 2303018, "date": "2019-05-23_05-10-59", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2303018, "num_metric_batches_dropped": 0, "time_total_s": 1912.6742370128632, "episode_reward_min": -1061.5558041521228, "time_this_iter_s": 41.360843658447266, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6ef0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef65f8>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 77.41624368103689, "outflow_rate_min": 767.498347989302, "cost1_max": 437.13620363914777, "system_level_velocity_mean": 14.820534160296061, "cost2_min": -72.2264248792582, "cost1_mean": 372.0482470099074, "system_level_velocity_min": 12.096485456837545, "cost2_max": -25.959085138079974, "outflow_rate_mean": 1291.6433477072837, "outflow_rate_max": 1482.7055123447979, "cost2_mean": -55.521622180440154, "system_level_velocity_max": 18.181418800006032}, "episode_len_mean": 688.14}
{"episode_reward_max": -31.03825249305149, "episode_reward_mean": -829.6302711127785, "timestamp": 1558588301, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 31, "timesteps_this_iter": 51708, "pid": 31818, "done": false, "episodes_total": 1183, "info": {"sample_time_ms": 28670.21, "update_time_ms": 9.232, "num_steps_trained": 2354726, "grad_time_ms": 14313.126, "num_steps_sampled": 2354726, "default": {"vf_loss": 14.065211296081543, "cur_lr": 0.0005000000237487257, "entropy": 1.0867948532104492, "vf_explained_var": 0.9124130606651306, "kl": 0.01190416794270277, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0026789032854139805, "total_loss": 14.063127517700195}, "load_time_ms": 9.645}, "training_iteration": 40, "hostname": "flow-main", "time_since_restore": 1954.3957448005676, "iterations_since_restore": 40, "timesteps_since_restore": 2354726, "date": "2019-05-23_05-11-41", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2354726, "num_metric_batches_dropped": 0, "time_total_s": 1954.3957448005676, "episode_reward_min": -1061.5558041521228, "time_this_iter_s": 41.72150778770447, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0eb8>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0828>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.86556761710933, "outflow_rate_min": 477.1206855028346, "cost1_max": 437.13620363914777, "system_level_velocity_mean": 14.887532466900266, "cost2_min": -72.2264248792582, "cost1_mean": 368.3079365605515, "system_level_velocity_min": 12.096485456837545, "cost2_max": -16.2158749169089, "outflow_rate_mean": 1290.128040456859, "outflow_rate_max": 1482.7055123447979, "cost2_mean": -54.34258655769688, "system_level_velocity_max": 18.35906236092973}, "episode_len_mean": 680.67}
{"episode_reward_max": -31.03825249305149, "episode_reward_mean": -830.4416662158205, "timestamp": 1558588341, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 30, "timesteps_this_iter": 50706, "pid": 31818, "done": false, "episodes_total": 1213, "info": {"sample_time_ms": 28578.823, "update_time_ms": 8.904, "num_steps_trained": 2405432, "grad_time_ms": 13873.809, "num_steps_sampled": 2405432, "default": {"vf_loss": 16.259103775024414, "cur_lr": 0.0005000000237487257, "entropy": 1.0842723846435547, "vf_explained_var": 0.9065383672714233, "kl": 0.009843571111559868, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0028401908930391073, "total_loss": 16.256757736206055}, "load_time_ms": 8.629}, "training_iteration": 41, "hostname": "flow-main", "time_since_restore": 1994.7502331733704, "iterations_since_restore": 41, "timesteps_since_restore": 2405432, "date": "2019-05-23_05-12-21", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2405432, "num_metric_batches_dropped": 0, "time_total_s": 1994.7502331733704, "episode_reward_min": -1116.8163762968854, "time_this_iter_s": 40.354488372802734, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0128>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef04e0>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.86556761710933, "outflow_rate_min": 477.1206855028346, "cost1_max": 439.1244633159958, "system_level_velocity_mean": 14.931302068904076, "cost2_min": -67.50417920237551, "cost1_mean": 369.7453216422688, "system_level_velocity_min": 12.060905887620866, "cost2_max": -16.2158749169089, "outflow_rate_mean": 1294.1818994379007, "outflow_rate_max": 1469.4722141803743, "cost2_mean": -54.13014869887537, "system_level_velocity_max": 18.35906236092973}, "episode_len_mean": 681.02}
{"episode_reward_max": -31.03825249305149, "episode_reward_mean": -840.9203646227891, "timestamp": 1558588386, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 30, "timesteps_this_iter": 50894, "pid": 31818, "done": false, "episodes_total": 1243, "info": {"sample_time_ms": 28545.863, "update_time_ms": 8.729, "num_steps_trained": 2456326, "grad_time_ms": 13873.472, "num_steps_sampled": 2456326, "default": {"vf_loss": 15.886553764343262, "cur_lr": 0.0005000000237487257, "entropy": 1.0772234201431274, "vf_explained_var": 0.9080150127410889, "kl": 0.009768921881914139, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0027882896829396486, "total_loss": 15.88425350189209}, "load_time_ms": 8.71}, "training_iteration": 42, "hostname": "flow-main", "time_since_restore": 2039.7398459911346, "iterations_since_restore": 42, "timesteps_since_restore": 2456326, "date": "2019-05-23_05-13-06", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2456326, "num_metric_batches_dropped": 0, "time_total_s": 2039.7398459911346, "episode_reward_min": -1116.8163762968854, "time_this_iter_s": 44.98961281776428, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef02b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0ba8>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef03c8>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 22.86556761710933, "outflow_rate_min": 477.1206855028346, "cost1_max": 439.758828518759, "system_level_velocity_mean": 14.815351161771957, "cost2_min": -69.0270941668899, "cost1_mean": 363.93367403231133, "system_level_velocity_min": 12.060905887620866, "cost2_max": -16.2158749169089, "outflow_rate_mean": 1285.8464230077352, "outflow_rate_max": 1505.4537769782278, "cost2_mean": -54.60908910397718, "system_level_velocity_max": 18.35906236092973}, "episode_len_mean": 676.41}
{"episode_reward_max": -33.13868839738691, "episode_reward_mean": -867.3276836936493, "timestamp": 1558588434, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 32, "timesteps_this_iter": 51983, "pid": 31818, "done": false, "episodes_total": 1275, "info": {"sample_time_ms": 28591.243, "update_time_ms": 8.965, "num_steps_trained": 2508309, "grad_time_ms": 14240.372, "num_steps_sampled": 2508309, "default": {"vf_loss": 15.667181968688965, "cur_lr": 0.0005000000237487257, "entropy": 1.0675487518310547, "vf_explained_var": 0.9133732318878174, "kl": 0.010921407490968704, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0028992933221161366, "total_loss": 15.664827346801758}, "load_time_ms": 8.702}, "training_iteration": 43, "hostname": "flow-main", "time_since_restore": 2087.6037995815277, "iterations_since_restore": 43, "timesteps_since_restore": 2508309, "date": "2019-05-23_05-13-54", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2508309, "num_metric_batches_dropped": 0, "time_total_s": 2087.6037995815277, "episode_reward_min": -1137.2222446009105, "time_this_iter_s": 47.863953590393066, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d160>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d940>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 24.100693013053082, "outflow_rate_min": 473.3415874307869, "cost1_max": 447.6201862194207, "system_level_velocity_mean": 14.844275803355282, "cost2_min": -70.58328836485921, "cost1_mean": 368.66572695601224, "system_level_velocity_min": 12.060905887620866, "cost2_max": -17.47928538107767, "outflow_rate_mean": 1295.027784633569, "outflow_rate_max": 1524.981256119273, "cost2_mean": -55.49883839929323, "system_level_velocity_max": 18.354646010516955}, "episode_len_mean": 682.26}
{"episode_reward_max": -33.13868839738691, "episode_reward_mean": -891.0723901660976, "timestamp": 1558588499, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 31, "timesteps_this_iter": 53447, "pid": 31818, "done": false, "episodes_total": 1306, "info": {"sample_time_ms": 30746.645, "update_time_ms": 13.11, "num_steps_trained": 2561756, "grad_time_ms": 14325.304, "num_steps_sampled": 2561756, "default": {"vf_loss": 20.187095642089844, "cur_lr": 0.0005000000237487257, "entropy": 1.0566729307174683, "vf_explained_var": 0.8973167538642883, "kl": 0.010999463498592377, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002670812886208296, "total_loss": 20.184974670410156}, "load_time_ms": 9.123}, "training_iteration": 44, "hostname": "flow-main", "time_since_restore": 2152.9002504348755, "iterations_since_restore": 44, "timesteps_since_restore": 2561756, "date": "2019-05-23_05-14-59", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2561756, "num_metric_batches_dropped": 0, "time_total_s": 2152.9002504348755, "episode_reward_min": -1137.2222446009105, "time_this_iter_s": 65.29645085334778, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed22b0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2160>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 24.100693013053082, "outflow_rate_min": 473.3415874307869, "cost1_max": 447.6201862194207, "system_level_velocity_mean": 14.761769662803635, "cost2_min": -71.92723703468877, "cost1_mean": 364.9546838458557, "system_level_velocity_min": 12.403280817617771, "cost2_max": -17.47928538107767, "outflow_rate_mean": 1287.8781429553421, "outflow_rate_max": 1524.981256119273, "cost2_mean": -57.073515292487265, "system_level_velocity_max": 18.354646010516955}, "episode_len_mean": 678.58}
{"episode_reward_max": -33.13868839738691, "episode_reward_mean": -918.0025257001789, "timestamp": 1558588543, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 31, "timesteps_this_iter": 52530, "pid": 31818, "done": false, "episodes_total": 1337, "info": {"sample_time_ms": 30755.88, "update_time_ms": 13.132, "num_steps_trained": 2614286, "grad_time_ms": 14501.764, "num_steps_sampled": 2614286, "default": {"vf_loss": 18.291406631469727, "cur_lr": 0.0005000000237487257, "entropy": 1.054850459098816, "vf_explained_var": 0.9057018160820007, "kl": 0.01355681661516428, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003944484516978264, "total_loss": 18.28814125061035}, "load_time_ms": 8.852}, "training_iteration": 45, "hostname": "flow-main", "time_since_restore": 2196.13197517395, "iterations_since_restore": 45, "timesteps_since_restore": 2614286, "date": "2019-05-23_05-15-43", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2614286, "num_metric_batches_dropped": 0, "time_total_s": 2196.13197517395, "episode_reward_min": -1158.1303044146503, "time_this_iter_s": 43.23172473907471, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef09b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0d68>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0400>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 24.100693013053082, "outflow_rate_min": 473.3415874307869, "cost1_max": 447.6201862194207, "system_level_velocity_mean": 14.73197535127262, "cost2_min": -73.92511180091236, "cost1_mean": 367.87493505522184, "system_level_velocity_min": 12.482203087568378, "cost2_max": -17.47928538107767, "outflow_rate_mean": 1289.5502919711384, "outflow_rate_max": 1524.981256119273, "cost2_mean": -58.69536963557785, "system_level_velocity_max": 18.354646010516955}, "episode_len_mean": 683.51}
{"episode_reward_max": -33.13868839738691, "episode_reward_mean": -907.5632180167355, "timestamp": 1558588584, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 29, "timesteps_this_iter": 50644, "pid": 31818, "done": false, "episodes_total": 1366, "info": {"sample_time_ms": 30332.895, "update_time_ms": 13.174, "num_steps_trained": 2664930, "grad_time_ms": 14670.257, "num_steps_sampled": 2664930, "default": {"vf_loss": 13.068873405456543, "cur_lr": 0.0005000000237487257, "entropy": 1.051836609840393, "vf_explained_var": 0.9204930663108826, "kl": 0.010373001918196678, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003468807553872466, "total_loss": 13.065923690795898}, "load_time_ms": 8.309}, "training_iteration": 46, "hostname": "flow-main", "time_since_restore": 2237.265679836273, "iterations_since_restore": 46, "timesteps_since_restore": 2664930, "date": "2019-05-23_05-16-24", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2664930, "num_metric_batches_dropped": 0, "time_total_s": 2237.265679836273, "episode_reward_min": -1158.1303044146503, "time_this_iter_s": 41.133704662323, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee7080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee7048>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed76d8>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 24.100693013053082, "outflow_rate_min": 473.3415874307869, "cost1_max": 447.6201862194207, "system_level_velocity_mean": 14.707149046039858, "cost2_min": -73.92511180091236, "cost1_mean": 361.1749724778563, "system_level_velocity_min": 12.255333852828294, "cost2_max": -17.47928538107767, "outflow_rate_mean": 1278.3538826113781, "outflow_rate_max": 1518.2271441547919, "cost2_mean": -58.62848236487916, "system_level_velocity_max": 18.354646010516955}, "episode_len_mean": 673.22}
{"episode_reward_max": -178.293338048703, "episode_reward_mean": -906.0061193152511, "timestamp": 1558588629, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 30, "timesteps_this_iter": 52798, "pid": 31818, "done": false, "episodes_total": 1396, "info": {"sample_time_ms": 30251.434, "update_time_ms": 13.268, "num_steps_trained": 2717728, "grad_time_ms": 14894.538, "num_steps_sampled": 2717728, "default": {"vf_loss": 15.375356674194336, "cur_lr": 0.0005000000237487257, "entropy": 1.044298529624939, "vf_explained_var": 0.920328676700592, "kl": 0.012641996145248413, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.00304475799202919, "total_loss": 15.372942924499512}, "load_time_ms": 8.133}, "training_iteration": 47, "hostname": "flow-main", "time_since_restore": 2282.5939733982086, "iterations_since_restore": 47, "timesteps_since_restore": 2717728, "date": "2019-05-23_05-17-09", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2717728, "num_metric_batches_dropped": 0, "time_total_s": 2282.5939733982086, "episode_reward_min": -1158.1303044146503, "time_this_iter_s": 45.328293561935425, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6e48>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7630>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 131.96669525779635, "outflow_rate_min": 1023.9993237434596, "cost1_max": 446.5220230960865, "system_level_velocity_mean": 14.727558358856118, "cost2_min": -73.92511180091236, "cost1_mean": 365.89426707638245, "system_level_velocity_min": 12.255333852828294, "cost2_max": -29.37372956116601, "outflow_rate_mean": 1291.2266123427576, "outflow_rate_max": 1541.025380333952, "cost2_mean": -57.869061024012254, "system_level_velocity_max": 17.82255426939304}, "episode_len_mean": 679.85}
{"episode_reward_max": -178.293338048703, "episode_reward_mean": -918.743025078067, "timestamp": 1558588672, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 32, "timesteps_this_iter": 53216, "pid": 31818, "done": false, "episodes_total": 1428, "info": {"sample_time_ms": 30286.267, "update_time_ms": 13.193, "num_steps_trained": 2770944, "grad_time_ms": 14954.422, "num_steps_sampled": 2770944, "default": {"vf_loss": 16.193748474121094, "cur_lr": 0.0005000000237487257, "entropy": 1.046574592590332, "vf_explained_var": 0.9211969971656799, "kl": 0.011469153687357903, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0024372779298573732, "total_loss": 16.191883087158203}, "load_time_ms": 8.243}, "training_iteration": 48, "hostname": "flow-main", "time_since_restore": 2325.1890835762024, "iterations_since_restore": 48, "timesteps_since_restore": 2770944, "date": "2019-05-23_05-17-52", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2770944, "num_metric_batches_dropped": 0, "time_total_s": 2325.1890835762024, "episode_reward_min": -1135.3006169186247, "time_this_iter_s": 42.595110177993774, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef05c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0b00>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0320>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 131.96669525779635, "outflow_rate_min": 1023.9993237434596, "cost1_max": 446.5220230960865, "system_level_velocity_mean": 14.583298023285085, "cost2_min": -70.15959690056857, "cost1_mean": 365.4996403524993, "system_level_velocity_min": 12.067166667320729, "cost2_max": -29.37372956116601, "outflow_rate_mean": 1289.3982915801794, "outflow_rate_max": 1541.025380333952, "cost2_mean": -57.597755696743164, "system_level_velocity_max": 17.78831811498078}, "episode_len_mean": 684.78}
{"episode_reward_max": -629.7102705020272, "episode_reward_mean": -941.2843329831975, "timestamp": 1558588716, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 34, "timesteps_this_iter": 52239, "pid": 31818, "done": false, "episodes_total": 1462, "info": {"sample_time_ms": 30321.966, "update_time_ms": 13.273, "num_steps_trained": 2823183, "grad_time_ms": 15233.458, "num_steps_sampled": 2823183, "default": {"vf_loss": 15.928428649902344, "cur_lr": 0.0005000000237487257, "entropy": 1.0545932054519653, "vf_explained_var": 0.9102604985237122, "kl": 0.009780353866517544, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0025070616975426674, "total_loss": 15.926410675048828}, "load_time_ms": 8.441}, "training_iteration": 49, "hostname": "flow-main", "time_since_restore": 2369.666682958603, "iterations_since_restore": 49, "timesteps_since_restore": 2823183, "date": "2019-05-23_05-18-36", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2823183, "num_metric_batches_dropped": 0, "time_total_s": 2369.666682958603, "episode_reward_min": -1140.1494704289653, "time_this_iter_s": 44.47759938240051, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef64e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef65c0>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6160>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 247.61569208748037, "outflow_rate_min": 1145.4527133536315, "cost1_max": 446.5220230960865, "system_level_velocity_mean": 14.475740903971818, "cost2_min": -72.98436454598955, "cost1_mean": 370.5240723206458, "system_level_velocity_min": 12.067166667320729, "cost2_max": -42.95097255374918, "outflow_rate_mean": 1297.5124018619408, "outflow_rate_max": 1541.025380333952, "cost2_mean": -58.09660256826342, "system_level_velocity_max": 17.67218119129309}, "episode_len_mean": 695.62}
{"episode_reward_max": -32.56320650850702, "episode_reward_mean": -958.3082070491837, "timestamp": 1558588761, "experiment_id": "dbec6089debc445789519f7d3ca420dd", "episodes_this_iter": 29, "timesteps_this_iter": 55003, "pid": 31818, "done": true, "episodes_total": 1491, "info": {"sample_time_ms": 30535.038, "update_time_ms": 13.115, "num_steps_trained": 2878186, "grad_time_ms": 15274.303, "num_steps_sampled": 2878186, "default": {"vf_loss": 19.117219924926758, "cur_lr": 0.0005000000237487257, "entropy": 1.0480560064315796, "vf_explained_var": 0.9085274934768677, "kl": 0.011495906859636307, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0024405827280133963, "total_loss": 19.115354537963867}, "load_time_ms": 8.549}, "training_iteration": 50, "hostname": "flow-main", "time_since_restore": 2413.930009365082, "iterations_since_restore": 50, "timesteps_since_restore": 2878186, "date": "2019-05-23_05-19-21", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2878186, "num_metric_batches_dropped": 0, "time_total_s": 2413.930009365082, "episode_reward_min": -1175.6909723862377, "time_this_iter_s": 44.26332640647888, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "synchronize_filters": true, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "lr_schedule": null, "optimizer": {}, "custom_resources_per_worker": {}, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7c18>", "on_train_result": null, "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07a90>"}, "kl_coeff": 0.2, "clip_rewards": null, "model": {"conv_filters": null, "fcnet_activation": "tanh", "framestack": true, "custom_options": {}, "lstm_use_prev_action_reward": false, "channel_major": false, "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "grayscale": false, "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "zero_mean": true, "free_log_std": false}, "output": null, "clip_actions": false, "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "monitor": false, "collect_metrics_timeout": 180, "sample_async": false, "num_sgd_iter": 10, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "batch_mode": "truncate_episodes", "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "clip_param": 0.3, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "kl_target": 0.01}, "custom_metrics": {"cost1_min": 24.203361237859596, "outflow_rate_min": 484.94419746320835, "cost1_max": 436.49843632264435, "system_level_velocity_mean": 14.392368710182073, "cost2_min": -77.50857517915398, "cost1_mean": 363.7130824711874, "system_level_velocity_min": 11.638423450492398, "cost2_max": -17.38536768277591, "outflow_rate_mean": 1285.7662428302167, "outflow_rate_max": 1477.0795752953557, "cost2_mean": -59.39892016015946, "system_level_velocity_max": 18.37275653960801}, "episode_len_mean": 687.41}

{"episode_reward_max": -1278.1555883278738, "episode_reward_mean": -2019.2758228095513, "timestamp": 1558588525, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 26, "timesteps_this_iter": 63231, "pid": 31820, "done": false, "episodes_total": 26, "info": {"load_time_ms": 69.066, "update_time_ms": 2609.824, "num_steps_trained": 63231, "grad_time_ms": 18392.67, "num_steps_sampled": 63231, "default": {"vf_loss": 34.65965270996094, "cur_lr": 0.0005000000237487257, "entropy": 1.4094353914260864, "vf_explained_var": -3.1368001600640127e-06, "kl": 0.0019408926600590348, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0007107965648174286, "total_loss": 34.659332275390625}, "sample_time_ms": 63240.187}, "training_iteration": 1, "hostname": "flow-main", "time_since_restore": 84.46995782852173, "iterations_since_restore": 1, "timesteps_since_restore": 63231, "date": "2019-05-23_05-15-25", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 63231, "num_metric_batches_dropped": 0, "time_total_s": 84.46995782852173, "episode_reward_min": -2594.8952549533637, "time_this_iter_s": 84.46995782852173, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9860>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 155.55969165151927, "outflow_rate_min": 215.26148031496058, "cost1_max": 255.4237962492295, "system_level_velocity_min": 6.168023819011378, "cost2_min": -103.22110753492574, "cost1_mean": 203.44899973018693, "system_level_velocity_mean": 7.832027550324355, "system_level_velocity_max": 9.563805958218111, "outflow_rate_mean": 371.746722342308, "outflow_rate_max": 526.8800016926202, "cost2_mean": -58.927720517475095, "cost2_max": -34.832079410424434}, "episode_len_mean": 700.0}
{"episode_reward_max": -1278.1555883278738, "episode_reward_mean": -2012.7532959258251, "timestamp": 1558588578, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 67067, "pid": 31820, "done": false, "episodes_total": 53, "info": {"load_time_ms": 40.662, "update_time_ms": 1310.334, "num_steps_trained": 130298, "grad_time_ms": 18679.384, "num_steps_sampled": 130298, "default": {"vf_loss": 56.90800476074219, "cur_lr": 0.0005000000237487257, "entropy": 1.3982747793197632, "vf_explained_var": -1.8576591287455813e-07, "kl": 0.004111170768737793, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.00153800705447793, "total_loss": 56.90687561035156}, "sample_time_ms": 48847.383}, "training_iteration": 2, "hostname": "flow-main", "time_since_restore": 138.0389211177826, "iterations_since_restore": 2, "timesteps_since_restore": 130298, "date": "2019-05-23_05-16-18", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 130298, "num_metric_batches_dropped": 0, "time_total_s": 138.0389211177826, "episode_reward_min": -2965.7471146503844, "time_this_iter_s": 53.568963289260864, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1da20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d550>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 155.55969165151927, "outflow_rate_min": 215.26148031496058, "cost1_max": 255.4237962492295, "system_level_velocity_min": 6.168023819011378, "cost2_min": -103.22110753492574, "cost1_mean": 207.35032988449407, "system_level_velocity_mean": 7.994013180018033, "system_level_velocity_max": 9.563805958218111, "outflow_rate_mean": 392.8090348844548, "outflow_rate_max": 705.9194437939112, "cost2_mean": -61.28161328228757, "cost2_max": -34.832079410424434}, "episode_len_mean": 700.0}
{"episode_reward_max": -1257.528692824321, "episode_reward_mean": -1931.896433693792, "timestamp": 1558588629, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 63770, "pid": 31820, "done": false, "episodes_total": 80, "info": {"load_time_ms": 30.645, "update_time_ms": 877.085, "num_steps_trained": 194068, "grad_time_ms": 18877.614, "num_steps_sampled": 194068, "default": {"vf_loss": 41.40672302246094, "cur_lr": 0.0005000000237487257, "entropy": 1.3918397426605225, "vf_explained_var": 0.5418315529823303, "kl": 0.007183968089520931, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.001443340559490025, "total_loss": 41.4056396484375}, "sample_time_ms": 43172.387}, "training_iteration": 3, "hostname": "flow-main", "time_since_restore": 189.25957560539246, "iterations_since_restore": 3, "timesteps_since_restore": 194068, "date": "2019-05-23_05-17-09", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 194068, "num_metric_batches_dropped": 0, "time_total_s": 189.25957560539246, "episode_reward_min": -2965.7471146503844, "time_this_iter_s": 51.22065448760986, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee70f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec70f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee70b8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 155.55969165151927, "outflow_rate_min": 215.26148031496058, "cost1_max": 277.5079996546943, "system_level_velocity_min": 6.168023819011378, "cost2_min": -106.8428810733329, "cost1_mean": 217.73206961210835, "system_level_velocity_mean": 8.366922486334067, "system_level_velocity_max": 10.607374603958384, "outflow_rate_mean": 472.65652634482194, "outflow_rate_max": 836.1790554009714, "cost2_mean": -66.14572715441386, "cost2_max": -34.832079410424434}, "episode_len_mean": 700.0}
{"episode_reward_max": -1167.0756464501037, "episode_reward_mean": -1785.6863649403306, "timestamp": 1558588675, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 28, "timesteps_this_iter": 58350, "pid": 31820, "done": false, "episodes_total": 108, "info": {"load_time_ms": 25.814, "update_time_ms": 660.397, "num_steps_trained": 252418, "grad_time_ms": 18158.599, "num_steps_sampled": 252418, "default": {"vf_loss": 33.202362060546875, "cur_lr": 0.0005000000237487257, "entropy": 1.3722434043884277, "vf_explained_var": 0.8398334383964539, "kl": 0.017244717106223106, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0046899584122002125, "total_loss": 33.19853591918945}, "sample_time_ms": 39697.352}, "training_iteration": 4, "hostname": "flow-main", "time_since_restore": 234.651620388031, "iterations_since_restore": 4, "timesteps_since_restore": 252418, "date": "2019-05-23_05-17-55", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 252418, "num_metric_batches_dropped": 0, "time_total_s": 234.651620388031, "episode_reward_min": -2965.7471146503844, "time_this_iter_s": 45.39204478263855, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed21d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed2940>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 155.55969165151927, "outflow_rate_min": 215.26148031496058, "cost1_max": 334.8080230553227, "system_level_velocity_min": 6.168023819011378, "cost2_min": -126.83775765294922, "cost1_mean": 236.39157368995765, "system_level_velocity_mean": 9.070679950618816, "system_level_velocity_max": 12.80983413681013, "outflow_rate_mean": 583.8685945275049, "outflow_rate_max": 1034.1196182405506, "cost2_mean": -72.78504312493351, "cost2_max": -34.832079410424434}, "episode_len_mean": 700.0}
{"episode_reward_max": -1065.634478501296, "episode_reward_mean": -1621.0726936292378, "timestamp": 1558588724, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 59722, "pid": 31820, "done": false, "episodes_total": 135, "info": {"load_time_ms": 22.863, "update_time_ms": 530.528, "num_steps_trained": 312140, "grad_time_ms": 18072.248, "num_steps_sampled": 312140, "default": {"vf_loss": 37.81123352050781, "cur_lr": 0.0005000000237487257, "entropy": 1.35429847240448, "vf_explained_var": 0.8634240031242371, "kl": 0.009650017134845257, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0029107516165822744, "total_loss": 37.80880355834961}, "sample_time_ms": 38021.96}, "training_iteration": 5, "hostname": "flow-main", "time_since_restore": 283.8646249771118, "iterations_since_restore": 5, "timesteps_since_restore": 312140, "date": "2019-05-23_05-18-44", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 312140, "num_metric_batches_dropped": 0, "time_total_s": 283.8646249771118, "episode_reward_min": -2612.1869555936023, "time_this_iter_s": 49.21300458908081, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0f98>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 176.59739699960744, "outflow_rate_min": 251.19794733170554, "cost1_max": 371.53204562136517, "system_level_velocity_min": 6.813807630729821, "cost2_min": -138.5786374369165, "cost1_mean": 266.01819595339913, "system_level_velocity_mean": 10.192479402062311, "system_level_velocity_max": 14.075374318771896, "outflow_rate_mean": 757.0210226159413, "outflow_rate_max": 1323.7434979883506, "cost2_mean": -87.75305577781987, "cost2_max": -39.56354179967986}, "episode_len_mean": 700.0}
{"episode_reward_max": -993.8660367379368, "episode_reward_mean": -1459.9486914307336, "timestamp": 1558588774, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 64093, "pid": 31820, "done": false, "episodes_total": 162, "info": {"load_time_ms": 20.454, "update_time_ms": 444.401, "num_steps_trained": 376233, "grad_time_ms": 18145.735, "num_steps_sampled": 376233, "default": {"vf_loss": 49.36734390258789, "cur_lr": 0.0005000000237487257, "entropy": 1.3381361961364746, "vf_explained_var": 0.8557774424552917, "kl": 0.009208453819155693, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0028311170171946287, "total_loss": 49.36497116088867}, "sample_time_ms": 36937.898}, "training_iteration": 6, "hostname": "flow-main", "time_since_restore": 334.03295826911926, "iterations_since_restore": 6, "timesteps_since_restore": 376233, "date": "2019-05-23_05-19-34", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 376233, "num_metric_batches_dropped": 0, "time_total_s": 334.03295826911926, "episode_reward_min": -2374.8751398781956, "time_this_iter_s": 50.168333292007446, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9518>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 181.2106618591215, "outflow_rate_min": 409.2126923076924, "cost1_max": 414.9256834562629, "system_level_velocity_min": 7.028621764849405, "cost2_min": -167.152513589875, "cost1_mean": 300.1160001468216, "system_level_velocity_mean": 11.477330759304413, "system_level_velocity_max": 15.859637194671398, "outflow_rate_mean": 967.093262969141, "outflow_rate_max": 1520.9123970981536, "cost2_mean": -108.58712421006248, "cost2_max": -51.48800845416272}, "episode_len_mean": 700.0}
{"episode_reward_max": -672.9809650501511, "episode_reward_mean": -1398.6572515891173, "timestamp": 1558588822, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 67354, "pid": 31820, "done": false, "episodes_total": 189, "info": {"load_time_ms": 18.957, "update_time_ms": 382.298, "num_steps_trained": 443587, "grad_time_ms": 18157.278, "num_steps_sampled": 443587, "default": {"vf_loss": 38.590850830078125, "cur_lr": 0.0005000000237487257, "entropy": 1.3328310251235962, "vf_explained_var": 0.8985379934310913, "kl": 0.008201899006962776, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0017433661269024014, "total_loss": 38.589515686035156}, "sample_time_ms": 35879.602}, "training_iteration": 7, "hostname": "flow-main", "time_since_restore": 381.9283800125122, "iterations_since_restore": 7, "timesteps_since_restore": 443587, "date": "2019-05-23_05-20-22", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 443587, "num_metric_batches_dropped": 0, "time_total_s": 381.9283800125122, "episode_reward_min": -1887.50202813371, "time_this_iter_s": 47.895421743392944, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef03c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0080>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 222.8939053837542, "outflow_rate_min": 677.7039132848158, "cost1_max": 464.36617522919704, "system_level_velocity_min": 8.617663298828052, "cost2_min": -173.88587825416698, "cost1_mean": 324.9808082771837, "system_level_velocity_mean": 12.408528769749807, "system_level_velocity_max": 17.82666543033027, "outflow_rate_mean": 1113.8461217967015, "outflow_rate_max": 1679.355846504416, "cost2_mean": -128.44094543545478, "cost2_max": -67.64751228992068}, "episode_len_mean": 700.0}
{"episode_reward_max": -672.9809650501511, "episode_reward_mean": -1431.900303907094, "timestamp": 1558588871, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 65720, "pid": 31820, "done": false, "episodes_total": 216, "info": {"load_time_ms": 17.928, "update_time_ms": 335.451, "num_steps_trained": 509307, "grad_time_ms": 18023.379, "num_steps_sampled": 509307, "default": {"vf_loss": 36.9780158996582, "cur_lr": 0.0005000000237487257, "entropy": 1.3386870622634888, "vf_explained_var": 0.8992279767990112, "kl": 0.007272497285157442, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0017217377899214625, "total_loss": 36.976654052734375}, "sample_time_ms": 35336.161}, "training_iteration": 8, "hostname": "flow-main", "time_since_restore": 430.6700692176819, "iterations_since_restore": 8, "timesteps_since_restore": 509307, "date": "2019-05-23_05-21-11", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 509307, "num_metric_batches_dropped": 0, "time_total_s": 430.6700692176819, "episode_reward_min": -1842.907105923306, "time_this_iter_s": 48.74168920516968, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1da90>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 256.01548728535164, "outflow_rate_min": 847.9037756686798, "cost1_max": 464.36617522919704, "system_level_velocity_min": 9.870243344763141, "cost2_min": -175.83539418427256, "cost1_mean": 337.6502378145962, "system_level_velocity_mean": 12.896837714076446, "system_level_velocity_max": 17.82666543033027, "outflow_rate_mean": 1206.0953177067706, "outflow_rate_max": 1679.355846504416, "cost2_mean": -145.9963644290801, "cost2_max": -81.16641116539854}, "episode_len_mean": 700.0}
{"episode_reward_max": -672.9809650501511, "episode_reward_mean": -1477.1688559747781, "timestamp": 1558588921, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 30, "timesteps_this_iter": 67597, "pid": 31820, "done": false, "episodes_total": 246, "info": {"load_time_ms": 16.881, "update_time_ms": 299.0, "num_steps_trained": 576904, "grad_time_ms": 18077.886, "num_steps_sampled": 576904, "default": {"vf_loss": 48.57993698120117, "cur_lr": 0.0005000000237487257, "entropy": 1.3251579999923706, "vf_explained_var": 0.8709583878517151, "kl": 0.006466750521212816, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0009178172913379967, "total_loss": 48.579345703125}, "sample_time_ms": 34935.991}, "training_iteration": 9, "hostname": "flow-main", "time_since_restore": 481.0474531650543, "iterations_since_restore": 9, "timesteps_since_restore": 576904, "date": "2019-05-23_05-22-01", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 576904, "num_metric_batches_dropped": 0, "time_total_s": 481.0474531650543, "episode_reward_min": -1910.570135871917, "time_this_iter_s": 50.37738394737244, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef05c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0f98>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 265.77699668313517, "outflow_rate_min": 1065.0658016003085, "cost1_max": 464.36617522919704, "system_level_velocity_min": 10.232170614860355, "cost2_min": -202.09732842525284, "cost1_mean": 342.94201280363006, "system_level_velocity_mean": 13.111859399454397, "system_level_velocity_max": 17.82666543033027, "outflow_rate_mean": 1253.007554273972, "outflow_rate_max": 1679.355846504416, "cost2_mean": -160.32735192905773, "cost2_max": -119.51237103530353}, "episode_len_mean": 700.0}
{"episode_reward_max": -33.63185579696758, "episode_reward_mean": -1511.9457218340692, "timestamp": 1558588968, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 32, "timesteps_this_iter": 64306, "pid": 31820, "done": false, "episodes_total": 278, "info": {"load_time_ms": 16.249, "update_time_ms": 269.796, "num_steps_trained": 641210, "grad_time_ms": 17936.257, "num_steps_sampled": 641210, "default": {"vf_loss": 44.75586700439453, "cur_lr": 0.0005000000237487257, "entropy": 1.313132882118225, "vf_explained_var": 0.8836808800697327, "kl": 0.006008820608258247, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0013536920305341482, "total_loss": 44.754817962646484}, "sample_time_ms": 34461.82}, "training_iteration": 10, "hostname": "flow-main", "time_since_restore": 528.0389077663422, "iterations_since_restore": 10, "timesteps_since_restore": 641210, "date": "2019-05-23_05-22-48", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 641210, "num_metric_batches_dropped": 0, "time_total_s": 528.0389077663422, "episode_reward_min": -1910.570135871917, "time_this_iter_s": 46.99145460128784, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf070b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf075f8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 24.023164701362674, "outflow_rate_min": 479.01891055770665, "cost1_max": 459.76244303706727, "system_level_velocity_min": 10.0125162253716, "cost2_min": -214.6818696090897, "cost1_mean": 333.3794804509051, "system_level_velocity_mean": 12.95603925572564, "system_level_velocity_max": 17.927137409779988, "outflow_rate_mean": 1240.0655558997896, "outflow_rate_max": 1689.2120038312778, "cost2_mean": -167.14049004566397, "cost2_max": -21.971241173153988}, "episode_len_mean": 693.37}
{"episode_reward_max": -28.05703990076302, "episode_reward_mean": -1489.6216541636677, "timestamp": 1558589014, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 31, "timesteps_this_iter": 63009, "pid": 31820, "done": false, "episodes_total": 309, "info": {"load_time_ms": 10.371, "update_time_ms": 9.68, "num_steps_trained": 704219, "grad_time_ms": 17735.487, "num_steps_sampled": 704219, "default": {"vf_loss": 45.626094818115234, "cur_lr": 0.0005000000237487257, "entropy": 1.283605933189392, "vf_explained_var": 0.8780935406684875, "kl": 0.006523695308715105, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0013871437404304743, "total_loss": 45.625030517578125}, "sample_time_ms": 31055.392}, "training_iteration": 11, "hostname": "flow-main", "time_since_restore": 573.7356059551239, "iterations_since_restore": 11, "timesteps_since_restore": 704219, "date": "2019-05-23_05-23-34", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 704219, "num_metric_batches_dropped": 0, "time_total_s": 573.7356059551239, "episode_reward_min": -1910.570135871917, "time_this_iter_s": 45.69669818878174, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef03c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef07b8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.249531993023286, "outflow_rate_min": 479.01891055770665, "cost1_max": 459.76244303706727, "system_level_velocity_min": 10.0125162253716, "cost2_min": -214.6818696090897, "cost1_mean": 335.08511728774187, "system_level_velocity_mean": 13.230345697129781, "system_level_velocity_max": 18.78769462163047, "outflow_rate_mean": 1247.2879048195955, "outflow_rate_max": 1689.2120038312778, "cost2_mean": -169.61072406586547, "cost2_max": -21.971241173153988}, "episode_len_mean": 686.72}
{"episode_reward_max": -28.05703990076302, "episode_reward_mean": -1511.2471152828841, "timestamp": 1558589062, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 31, "timesteps_this_iter": 64925, "pid": 31820, "done": false, "episodes_total": 340, "info": {"load_time_ms": 10.185, "update_time_ms": 9.44, "num_steps_trained": 769144, "grad_time_ms": 17535.618, "num_steps_sampled": 769144, "default": {"vf_loss": 44.8173942565918, "cur_lr": 0.0005000000237487257, "entropy": 1.284834623336792, "vf_explained_var": 0.866367757320404, "kl": 0.007136928383260965, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0016275374218821526, "total_loss": 44.81612014770508}, "sample_time_ms": 30733.312}, "training_iteration": 12, "hostname": "flow-main", "time_since_restore": 622.0609776973724, "iterations_since_restore": 12, "timesteps_since_restore": 769144, "date": "2019-05-23_05-24-22", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 769144, "num_metric_batches_dropped": 0, "time_total_s": 622.0609776973724, "episode_reward_min": -1889.6559279059643, "time_this_iter_s": 48.325371742248535, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1da20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d7b8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.249531993023286, "outflow_rate_min": 479.01891055770665, "cost1_max": 459.76244303706727, "system_level_velocity_min": 10.0125162253716, "cost2_min": -214.6818696090897, "cost1_mean": 329.3661588833668, "system_level_velocity_mean": 13.024864025873974, "system_level_velocity_max": 18.78769462163047, "outflow_rate_mean": 1235.4831852993093, "outflow_rate_max": 1689.2120038312778, "cost2_mean": -171.99424174905747, "cost2_max": -21.971241173153988}, "episode_len_mean": 686.72}
{"episode_reward_max": -28.05703990076302, "episode_reward_mean": -1512.1913713407737, "timestamp": 1558589111, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 28, "timesteps_this_iter": 65077, "pid": 31820, "done": false, "episodes_total": 368, "info": {"load_time_ms": 10.062, "update_time_ms": 9.254, "num_steps_trained": 834221, "grad_time_ms": 17311.271, "num_steps_sampled": 834221, "default": {"vf_loss": 41.75782775878906, "cur_lr": 0.0005000000237487257, "entropy": 1.2803746461868286, "vf_explained_var": 0.8757746815681458, "kl": 0.00794447772204876, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0022718494292348623, "total_loss": 41.755950927734375}, "sample_time_ms": 30685.03}, "training_iteration": 13, "hostname": "flow-main", "time_since_restore": 670.5494859218597, "iterations_since_restore": 13, "timesteps_since_restore": 834221, "date": "2019-05-23_05-25-11", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 834221, "num_metric_batches_dropped": 0, "time_total_s": 670.5494859218597, "episode_reward_min": -1900.5030514600458, "time_this_iter_s": 48.488508224487305, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef05c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0f98>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.249531993023286, "outflow_rate_min": 479.01891055770665, "cost1_max": 463.15867840166374, "system_level_velocity_min": 10.074204303620991, "cost2_min": -213.79125365809827, "cost1_mean": 332.04660303552606, "system_level_velocity_mean": 13.12272163308638, "system_level_velocity_max": 18.78769462163047, "outflow_rate_mean": 1238.096946314082, "outflow_rate_max": 1676.0791376384389, "cost2_mean": -173.87756117191094, "cost2_max": -21.971241173153988}, "episode_len_mean": 686.72}
{"episode_reward_max": -667.3963685277806, "episode_reward_mean": -1516.9035603501322, "timestamp": 1558589158, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 65147, "pid": 31820, "done": false, "episodes_total": 395, "info": {"load_time_ms": 9.656, "update_time_ms": 8.999, "num_steps_trained": 899368, "grad_time_ms": 17414.565, "num_steps_sampled": 899368, "default": {"vf_loss": 39.09260177612305, "cur_lr": 0.0005000000237487257, "entropy": 1.269568920135498, "vf_explained_var": 0.8737727999687195, "kl": 0.007676943205296993, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0018933648243546486, "total_loss": 39.091094970703125}, "sample_time_ms": 30712.871}, "training_iteration": 14, "hostname": "flow-main", "time_since_restore": 717.2684812545776, "iterations_since_restore": 14, "timesteps_since_restore": 899368, "date": "2019-05-23_05-25-58", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 899368, "num_metric_batches_dropped": 0, "time_total_s": 717.2684812545776, "episode_reward_min": -1900.5030514600458, "time_this_iter_s": 46.718995332717896, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1da90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d4e0>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 268.3462354026909, "outflow_rate_min": 1107.9170235141203, "cost1_max": 463.15867840166374, "system_level_velocity_min": 10.310570072781964, "cost2_min": -213.79125365809827, "cost1_mean": 342.18060545752456, "system_level_velocity_mean": 13.150236829369476, "system_level_velocity_max": 17.78927534791988, "outflow_rate_mean": 1262.1044948277404, "outflow_rate_max": 1676.0791376384389, "cost2_mean": -176.62679232453377, "cost2_max": -138.2926339723174}, "episode_len_mean": 700.0}
{"episode_reward_max": -667.3963685277806, "episode_reward_mean": -1498.998985242678, "timestamp": 1558589204, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 26, "timesteps_this_iter": 63434, "pid": 31820, "done": false, "episodes_total": 421, "info": {"load_time_ms": 9.595, "update_time_ms": 8.592, "num_steps_trained": 962802, "grad_time_ms": 17275.607, "num_steps_sampled": 962802, "default": {"vf_loss": 36.27399826049805, "cur_lr": 0.0005000000237487257, "entropy": 1.2439477443695068, "vf_explained_var": 0.8795369267463684, "kl": 0.00848874170333147, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0022027650848031044, "total_loss": 36.272216796875}, "sample_time_ms": 30559.848}, "training_iteration": 15, "hostname": "flow-main", "time_since_restore": 763.5157811641693, "iterations_since_restore": 15, "timesteps_since_restore": 962802, "date": "2019-05-23_05-26-44", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 962802, "num_metric_batches_dropped": 0, "time_total_s": 763.5157811641693, "episode_reward_min": -1900.5030514600458, "time_this_iter_s": 46.247299909591675, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0a20>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 268.3462354026909, "outflow_rate_min": 1107.9170235141203, "cost1_max": 463.15867840166374, "system_level_velocity_min": 10.310570072781964, "cost2_min": -213.79125365809827, "cost1_mean": 346.47650138300344, "system_level_velocity_mean": 13.294266833618146, "system_level_velocity_max": 17.78927534791988, "outflow_rate_mean": 1264.8275595028085, "outflow_rate_max": 1676.0791376384389, "cost2_mean": -175.43874968038537, "cost2_max": -138.2926339723174}, "episode_len_mean": 700.0}
{"episode_reward_max": -21.793125796901197, "episode_reward_mean": -1438.0939731227556, "timestamp": 1558589250, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 29, "timesteps_this_iter": 63637, "pid": 31820, "done": false, "episodes_total": 450, "info": {"load_time_ms": 9.69, "update_time_ms": 8.013, "num_steps_trained": 1026439, "grad_time_ms": 17072.785, "num_steps_sampled": 1026439, "default": {"vf_loss": 32.844974517822266, "cur_lr": 0.0005000000237487257, "entropy": 1.2200026512145996, "vf_explained_var": 0.8897176384925842, "kl": 0.00848557148128748, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.002259532455354929, "total_loss": 32.8431396484375}, "sample_time_ms": 30348.736}, "training_iteration": 16, "hostname": "flow-main", "time_since_restore": 809.5339775085449, "iterations_since_restore": 16, "timesteps_since_restore": 1026439, "date": "2019-05-23_05-27-30", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1026439, "num_metric_batches_dropped": 0, "time_total_s": 809.5339775085449, "episode_reward_min": -1900.5030514600458, "time_this_iter_s": 46.01819634437561, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf075f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07438>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 18.708593780500983, "outflow_rate_min": 497.50056700217027, "cost1_max": 453.25009446715586, "system_level_velocity_min": 10.310570072781964, "cost2_min": -213.79125365809827, "cost1_mean": 345.87143209620166, "system_level_velocity_mean": 13.494478659195943, "system_level_velocity_max": 19.521807265443027, "outflow_rate_mean": 1259.2853552836752, "outflow_rate_max": 1622.290353731903, "cost2_mean": -169.61048656458064, "cost2_max": -19.300658639085615}, "episode_len_mean": 691.15}
{"episode_reward_max": -21.793125796901197, "episode_reward_mean": -1372.253334918948, "timestamp": 1558589293, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 60514, "pid": 31820, "done": false, "episodes_total": 477, "info": {"load_time_ms": 9.543, "update_time_ms": 7.84, "num_steps_trained": 1086953, "grad_time_ms": 16782.507, "num_steps_sampled": 1086953, "default": {"vf_loss": 28.566957473754883, "cur_lr": 0.0005000000237487257, "entropy": 1.2193101644515991, "vf_explained_var": 0.892193078994751, "kl": 0.008427457883954048, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0018614741275087, "total_loss": 28.56551742553711}, "sample_time_ms": 30140.049}, "training_iteration": 17, "hostname": "flow-main", "time_since_restore": 852.4115104675293, "iterations_since_restore": 17, "timesteps_since_restore": 1086953, "date": "2019-05-23_05-28-13", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1086953, "num_metric_batches_dropped": 0, "time_total_s": 852.4115104675293, "episode_reward_min": -1864.123436559654, "time_this_iter_s": 42.877532958984375, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef6b70>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 18.708593780500983, "outflow_rate_min": 497.50056700217027, "cost1_max": 453.25009446715586, "system_level_velocity_min": 10.310570072781964, "cost2_min": -203.65069295446483, "cost1_mean": 349.19037705442236, "system_level_velocity_mean": 13.60621103478222, "system_level_velocity_max": 19.521807265443027, "outflow_rate_mean": 1260.6472334910793, "outflow_rate_max": 1622.290353731903, "cost2_mean": -163.7551028465518, "cost2_max": -19.300658639085615}, "episode_len_mean": 691.15}
{"episode_reward_max": -21.793125796901197, "episode_reward_mean": -1302.0633849658852, "timestamp": 1558589336, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 29, "timesteps_this_iter": 58516, "pid": 31820, "done": false, "episodes_total": 506, "info": {"load_time_ms": 9.517, "update_time_ms": 7.738, "num_steps_trained": 1145469, "grad_time_ms": 16598.039, "num_steps_sampled": 1145469, "default": {"vf_loss": 25.11502456665039, "cur_lr": 0.0005000000237487257, "entropy": 1.2211213111877441, "vf_explained_var": 0.89919114112854, "kl": 0.007073213346302509, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.001555207883939147, "total_loss": 25.11382484436035}, "sample_time_ms": 29735.281}, "training_iteration": 18, "hostname": "flow-main", "time_since_restore": 895.254816532135, "iterations_since_restore": 18, "timesteps_since_restore": 1145469, "date": "2019-05-23_05-28-56", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1145469, "num_metric_batches_dropped": 0, "time_total_s": 895.254816532135, "episode_reward_min": -1735.3688184403993, "time_this_iter_s": 42.84330606460571, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07e48>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 18.708593780500983, "outflow_rate_min": 497.50056700217027, "cost1_max": 452.55830116589067, "system_level_velocity_min": 10.842886953027461, "cost2_min": -193.05264165200154, "cost1_mean": 349.962607971266, "system_level_velocity_mean": 13.786488573736824, "system_level_velocity_max": 19.521807265443027, "outflow_rate_mean": 1254.6840618101658, "outflow_rate_max": 1539.3201580592763, "cost2_mean": -155.53277422689308, "cost2_max": -19.300658639085615}, "episode_len_mean": 685.32}
{"episode_reward_max": -21.793125796901197, "episode_reward_mean": -1189.4881755282308, "timestamp": 1558589376, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 30, "timesteps_this_iter": 56918, "pid": 31820, "done": false, "episodes_total": 536, "info": {"load_time_ms": 9.501, "update_time_ms": 7.801, "num_steps_trained": 1202387, "grad_time_ms": 16209.96, "num_steps_sampled": 1202387, "default": {"vf_loss": 20.106748580932617, "cur_lr": 0.0005000000237487257, "entropy": 1.2239364385604858, "vf_explained_var": 0.9069095849990845, "kl": 0.009143967181444168, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0022496816236525774, "total_loss": 20.104955673217773}, "sample_time_ms": 29141.024}, "training_iteration": 19, "hostname": "flow-main", "time_since_restore": 935.7905464172363, "iterations_since_restore": 19, "timesteps_since_restore": 1202387, "date": "2019-05-23_05-29-36", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1202387, "num_metric_batches_dropped": 0, "time_total_s": 935.7905464172363, "episode_reward_min": -1701.7480032959616, "time_this_iter_s": 40.53572988510132, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0a20>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 18.708593780500983, "outflow_rate_min": 497.50056700217027, "cost1_max": 437.7397890310007, "system_level_velocity_min": 11.16945802644691, "cost2_min": -189.1277125868433, "cost1_mean": 352.6407338292397, "system_level_velocity_mean": 13.971991259661149, "system_level_velocity_max": 19.521807265443027, "outflow_rate_mean": 1261.311903844352, "outflow_rate_max": 1520.3980641107355, "cost2_mean": -144.46443483684993, "cost2_max": -19.300658639085615}, "episode_len_mean": 681.62}
{"episode_reward_max": -92.96621767181726, "episode_reward_mean": -1125.4850368614286, "timestamp": 1558589420, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 31, "timesteps_this_iter": 56585, "pid": 31820, "done": false, "episodes_total": 567, "info": {"load_time_ms": 9.504, "update_time_ms": 7.881, "num_steps_trained": 1258972, "grad_time_ms": 16023.926, "num_steps_sampled": 1258972, "default": {"vf_loss": 24.4014892578125, "cur_lr": 0.0005000000237487257, "entropy": 1.2103770971298218, "vf_explained_var": 0.899914026260376, "kl": 0.009507197886705399, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0017771157436072826, "total_loss": 24.40018653869629}, "sample_time_ms": 28985.995}, "training_iteration": 20, "hostname": "flow-main", "time_since_restore": 979.3506994247437, "iterations_since_restore": 20, "timesteps_since_restore": 1258972, "date": "2019-05-23_05-30-20", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1258972, "num_metric_batches_dropped": 0, "time_total_s": 979.3506994247437, "episode_reward_min": -1592.0559337688146, "time_this_iter_s": 43.560153007507324, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d1d0>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 78.4518468755399, "outflow_rate_min": 771.5520524805917, "cost1_max": 450.1823275676143, "system_level_velocity_min": 11.16945802644691, "cost2_min": -184.28668347156088, "cost1_mean": 362.10637244959184, "system_level_velocity_mean": 14.14877233660581, "system_level_velocity_max": 18.616025423894815, "outflow_rate_mean": 1281.162367999061, "outflow_rate_max": 1598.7284411398705, "cost2_mean": -138.43619431448292, "cost2_max": -46.51443484549746}, "episode_len_mean": 688.34}
{"episode_reward_max": -92.96621767181726, "episode_reward_mean": -1134.7058352242589, "timestamp": 1558589464, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 32, "timesteps_this_iter": 57962, "pid": 31820, "done": false, "episodes_total": 599, "info": {"load_time_ms": 9.525, "update_time_ms": 7.746, "num_steps_trained": 1316934, "grad_time_ms": 15885.131, "num_steps_sampled": 1316934, "default": {"vf_loss": 23.75369644165039, "cur_lr": 0.0005000000237487257, "entropy": 1.2062735557556152, "vf_explained_var": 0.9101311564445496, "kl": 0.008414472453296185, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0019989125430583954, "total_loss": 23.752117156982422}, "sample_time_ms": 28976.49}, "training_iteration": 21, "hostname": "flow-main", "time_since_restore": 1023.5388867855072, "iterations_since_restore": 21, "timesteps_since_restore": 1316934, "date": "2019-05-23_05-31-04", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1316934, "num_metric_batches_dropped": 0, "time_total_s": 1023.5388867855072, "episode_reward_min": -1502.8139888298044, "time_this_iter_s": 44.18818736076355, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef03c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef07b8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 78.4518468755399, "outflow_rate_min": 771.5520524805917, "cost1_max": 450.1823275676143, "system_level_velocity_min": 11.078637340702727, "cost2_min": -174.81544726812882, "cost1_mean": 358.71673021813075, "system_level_velocity_mean": 13.830849391089533, "system_level_velocity_max": 18.413603064946496, "outflow_rate_mean": 1274.1556009814499, "outflow_rate_max": 1598.7284411398705, "cost2_mean": -138.66809292151783, "cost2_max": -46.51443484549746}, "episode_len_mean": 694.17}
{"episode_reward_max": -178.6881430255578, "episode_reward_mean": -1174.0127816011316, "timestamp": 1558589510, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 30, "timesteps_this_iter": 59595, "pid": 31820, "done": false, "episodes_total": 629, "info": {"load_time_ms": 9.348, "update_time_ms": 7.636, "num_steps_trained": 1376529, "grad_time_ms": 15736.2, "num_steps_sampled": 1376529, "default": {"vf_loss": 25.72466468811035, "cur_lr": 0.0005000000237487257, "entropy": 1.201483130455017, "vf_explained_var": 0.9095497727394104, "kl": 0.009063978679478168, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0023283634800463915, "total_loss": 25.722789764404297}, "sample_time_ms": 28835.4}, "training_iteration": 22, "hostname": "flow-main", "time_since_restore": 1068.9523873329163, "iterations_since_restore": 22, "timesteps_since_restore": 1376529, "date": "2019-05-23_05-31-50", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1376529, "num_metric_batches_dropped": 0, "time_total_s": 1068.9523873329163, "episode_reward_min": -1603.9383572931388, "time_this_iter_s": 45.41350054740906, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf070b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf474e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf075f8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 137.4190137675768, "outflow_rate_min": 1063.5511255367114, "cost1_max": 450.1823275676143, "system_level_velocity_min": 10.261277539016755, "cost2_min": -175.83939431420276, "cost1_mean": 356.05462424934774, "system_level_velocity_mean": 13.710194468498068, "system_level_velocity_max": 18.16990531413515, "outflow_rate_mean": 1264.0562740645958, "outflow_rate_max": 1598.7284411398705, "cost2_mean": -142.97118766824886, "cost2_max": -74.04745356748151}, "episode_len_mean": 695.07}
{"episode_reward_max": -178.6881430255578, "episode_reward_mean": -1172.915828113453, "timestamp": 1558589551, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 30, "timesteps_this_iter": 57387, "pid": 31820, "done": false, "episodes_total": 659, "info": {"load_time_ms": 9.274, "update_time_ms": 7.562, "num_steps_trained": 1433916, "grad_time_ms": 15533.873, "num_steps_sampled": 1433916, "default": {"vf_loss": 19.379253387451172, "cur_lr": 0.0005000000237487257, "entropy": 1.2027050256729126, "vf_explained_var": 0.9169858694076538, "kl": 0.009721621870994568, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0015693234745413065, "total_loss": 19.378170013427734}, "sample_time_ms": 28312.529}, "training_iteration": 23, "hostname": "flow-main", "time_since_restore": 1110.1875350475311, "iterations_since_restore": 23, "timesteps_since_restore": 1433916, "date": "2019-05-23_05-32-31", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1433916, "num_metric_batches_dropped": 0, "time_total_s": 1110.1875350475311, "episode_reward_min": -1603.9383572931388, "time_this_iter_s": 41.23514771461487, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee99e8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 137.4190137675768, "outflow_rate_min": 1063.5511255367114, "cost1_max": 450.1823275676143, "system_level_velocity_min": 10.261277539016755, "cost2_min": -175.83939431420276, "cost1_mean": 355.34090005324254, "system_level_velocity_mean": 13.674779144812444, "system_level_velocity_max": 18.16990531413515, "outflow_rate_mean": 1262.2252609137256, "outflow_rate_max": 1598.8044068517688, "cost2_mean": -144.4545137690262, "cost2_max": -74.04745356748151}, "episode_len_mean": 695.07}
{"episode_reward_max": -178.6881430255578, "episode_reward_mean": -1149.2801045254068, "timestamp": 1558589594, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 31, "timesteps_this_iter": 56573, "pid": 31820, "done": false, "episodes_total": 690, "info": {"load_time_ms": 9.461, "update_time_ms": 7.535, "num_steps_trained": 1490489, "grad_time_ms": 15325.561, "num_steps_sampled": 1490489, "default": {"vf_loss": 22.914073944091797, "cur_lr": 0.0005000000237487257, "entropy": 1.190519094467163, "vf_explained_var": 0.910263180732727, "kl": 0.007934629917144775, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0016826015198603272, "total_loss": 22.91278648376465}, "sample_time_ms": 28119.557}, "training_iteration": 24, "hostname": "flow-main", "time_since_restore": 1152.880776166916, "iterations_since_restore": 24, "timesteps_since_restore": 1490489, "date": "2019-05-23_05-33-14", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1490489, "num_metric_batches_dropped": 0, "time_total_s": 1152.880776166916, "episode_reward_min": -1603.9383572931388, "time_this_iter_s": 42.693241119384766, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daefdba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89dafb2e10>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 137.4190137675768, "outflow_rate_min": 1063.5511255367114, "cost1_max": 440.9339705567751, "system_level_velocity_min": 10.261277539016755, "cost2_min": -175.83939431420276, "cost1_mean": 356.7791690698273, "system_level_velocity_mean": 13.825852625138875, "system_level_velocity_max": 18.16990531413515, "outflow_rate_mean": 1272.7847823409702, "outflow_rate_max": 1652.2991994178906, "cost2_mean": -143.40667959741054, "cost2_max": -74.04745356748151}, "episode_len_mean": 691.12}
{"episode_reward_max": -295.22153899372495, "episode_reward_mean": -1116.400555655345, "timestamp": 1558589635, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 28, "timesteps_this_iter": 55234, "pid": 31820, "done": false, "episodes_total": 718, "info": {"load_time_ms": 9.351, "update_time_ms": 7.725, "num_steps_trained": 1545723, "grad_time_ms": 15130.258, "num_steps_sampled": 1545723, "default": {"vf_loss": 16.357412338256836, "cur_lr": 0.0005000000237487257, "entropy": 1.1865917444229126, "vf_explained_var": 0.9347406625747681, "kl": 0.007997614331543446, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0016478014877066016, "total_loss": 16.356164932250977}, "sample_time_ms": 27854.422}, "training_iteration": 25, "hostname": "flow-main", "time_since_restore": 1194.5262882709503, "iterations_since_restore": 25, "timesteps_since_restore": 1545723, "date": "2019-05-23_05-33-55", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1545723, "num_metric_batches_dropped": 0, "time_total_s": 1194.5262882709503, "episode_reward_min": -1398.8994797515666, "time_this_iter_s": 41.645512104034424, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee9dd8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 198.76734780512217, "outflow_rate_min": 1145.8404484858554, "cost1_max": 452.80680291075953, "system_level_velocity_min": 11.546164620164019, "cost2_min": -169.189970872177, "cost1_mean": 364.97912116503807, "system_level_velocity_mean": 14.016635935214625, "system_level_velocity_max": 17.548933191025217, "outflow_rate_mean": 1289.4660195490617, "outflow_rate_max": 1652.2991994178906, "cost2_mean": -141.76194994756352, "cost2_max": -101.70969965536831}, "episode_len_mean": 696.05}
{"episode_reward_max": -295.22153899372495, "episode_reward_mean": -1088.8361506774706, "timestamp": 1558589676, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 28, "timesteps_this_iter": 57235, "pid": 31820, "done": false, "episodes_total": 746, "info": {"load_time_ms": 9.174, "update_time_ms": 7.723, "num_steps_trained": 1602958, "grad_time_ms": 14961.777, "num_steps_sampled": 1602958, "default": {"vf_loss": 17.859455108642578, "cur_lr": 0.0005000000237487257, "entropy": 1.1909832954406738, "vf_explained_var": 0.922309398651123, "kl": 0.009903899393975735, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0028023167978972197, "total_loss": 17.857149124145508}, "sample_time_ms": 27516.572}, "training_iteration": 26, "hostname": "flow-main", "time_since_restore": 1235.4724700450897, "iterations_since_restore": 26, "timesteps_since_restore": 1602958, "date": "2019-05-23_05-34-36", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1602958, "num_metric_batches_dropped": 0, "time_total_s": 1235.4724700450897, "episode_reward_min": -1396.5566125014197, "time_this_iter_s": 40.946181774139404, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee19b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1ef0>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 198.76734780512217, "outflow_rate_min": 1145.8404484858554, "cost1_max": 452.80680291075953, "system_level_velocity_min": 11.546164620164019, "cost2_min": -156.46323598380863, "cost1_mean": 367.8695382811916, "system_level_velocity_mean": 14.124389489239359, "system_level_velocity_max": 17.548933191025217, "outflow_rate_mean": 1299.4942481108492, "outflow_rate_max": 1652.2991994178906, "cost2_mean": -138.96024461514796, "cost2_max": -101.70969965536831}, "episode_len_mean": 696.05}
{"episode_reward_max": -197.0884858562665, "episode_reward_mean": -1068.2952913212418, "timestamp": 1558589719, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 55762, "pid": 31820, "done": false, "episodes_total": 773, "info": {"load_time_ms": 9.166, "update_time_ms": 7.738, "num_steps_trained": 1658720, "grad_time_ms": 15016.344, "num_steps_sampled": 1658720, "default": {"vf_loss": 19.71555519104004, "cur_lr": 0.0005000000237487257, "entropy": 1.1752972602844238, "vf_explained_var": 0.9110811948776245, "kl": 0.008804729208350182, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002154627814888954, "total_loss": 19.713842391967773}, "sample_time_ms": 27439.874}, "training_iteration": 27, "hostname": "flow-main", "time_since_restore": 1278.1259064674377, "iterations_since_restore": 27, "timesteps_since_restore": 1658720, "date": "2019-05-23_05-35-19", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1658720, "num_metric_batches_dropped": 0, "time_total_s": 1278.1259064674377, "episode_reward_min": -1278.9305229712406, "time_this_iter_s": 42.65343642234802, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec76a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7780>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 141.11034796014397, "outflow_rate_min": 1066.1006629774558, "cost1_max": 452.80680291075953, "system_level_velocity_min": 11.546164620164019, "cost2_min": -156.46323598380863, "cost1_mean": 369.78893995413773, "system_level_velocity_mean": 14.217273852506835, "system_level_velocity_max": 17.983361458466725, "outflow_rate_mean": 1307.6700740211145, "outflow_rate_max": 1621.7673510812986, "cost2_mean": -136.3787000994926, "cost2_max": -76.04726066482498}, "episode_len_mean": 695.15}
{"episode_reward_max": -197.0884858562665, "episode_reward_mean": -1037.5472032826565, "timestamp": 1558589761, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 31, "timesteps_this_iter": 57939, "pid": 31820, "done": false, "episodes_total": 804, "info": {"load_time_ms": 8.933, "update_time_ms": 7.892, "num_steps_trained": 1716659, "grad_time_ms": 14975.796, "num_steps_sampled": 1716659, "default": {"vf_loss": 20.06593894958496, "cur_lr": 0.0005000000237487257, "entropy": 1.16133451461792, "vf_explained_var": 0.917402446269989, "kl": 0.009096733294427395, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002211913699284196, "total_loss": 20.064180374145508}, "sample_time_ms": 27408.769}, "training_iteration": 28, "hostname": "flow-main", "time_since_restore": 1320.2503879070282, "iterations_since_restore": 28, "timesteps_since_restore": 1716659, "date": "2019-05-23_05-36-01", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1716659, "num_metric_batches_dropped": 0, "time_total_s": 1320.2503879070282, "episode_reward_min": -1392.5364646792493, "time_this_iter_s": 42.124481439590454, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07358>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 141.11034796014397, "outflow_rate_min": 1066.1006629774558, "cost1_max": 453.28771717836736, "system_level_velocity_min": 11.902984480559029, "cost2_min": -154.73792347463237, "cost1_mean": 372.0386642364416, "system_level_velocity_mean": 14.382905378943184, "system_level_velocity_max": 17.983361458466725, "outflow_rate_mean": 1321.5863046316972, "outflow_rate_max": 1621.7673510812986, "cost2_mean": -134.2012292782486, "cost2_max": -76.04726066482498}, "episode_len_mean": 691.23}
{"episode_reward_max": -197.0884858562665, "episode_reward_mean": -1059.2052562677673, "timestamp": 1558589803, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 29, "timesteps_this_iter": 55825, "pid": 31820, "done": false, "episodes_total": 833, "info": {"load_time_ms": 8.945, "update_time_ms": 7.828, "num_steps_trained": 1772484, "grad_time_ms": 14962.053, "num_steps_sampled": 1772484, "default": {"vf_loss": 19.857694625854492, "cur_lr": 0.0005000000237487257, "entropy": 1.1506470441818237, "vf_explained_var": 0.9147583842277527, "kl": 0.010350064374506474, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002968891989439726, "total_loss": 19.85524559020996}, "sample_time_ms": 27573.994}, "training_iteration": 29, "hostname": "flow-main", "time_since_restore": 1362.2995014190674, "iterations_since_restore": 29, "timesteps_since_restore": 1772484, "date": "2019-05-23_05-36-43", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1772484, "num_metric_batches_dropped": 0, "time_total_s": 1362.2995014190674, "episode_reward_min": -1392.5364646792493, "time_this_iter_s": 42.049113512039185, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf2f8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf2f080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf2f5f8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 141.11034796014397, "outflow_rate_min": 1066.1006629774558, "cost1_max": 453.28771717836736, "system_level_velocity_min": 11.902984480559029, "cost2_min": -154.73792347463237, "cost1_mean": 367.11081358874435, "system_level_velocity_mean": 14.171055312960442, "system_level_velocity_max": 17.983361458466725, "outflow_rate_mean": 1308.3779104439323, "outflow_rate_max": 1605.1601879251696, "cost2_mean": -133.64936810049798, "cost2_max": -76.04726066482498}, "episode_len_mean": 691.23}
{"episode_reward_max": -107.67657489987907, "episode_reward_mean": -1062.797872216824, "timestamp": 1558589846, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 32, "timesteps_this_iter": 56040, "pid": 31820, "done": false, "episodes_total": 865, "info": {"load_time_ms": 8.708, "update_time_ms": 7.89, "num_steps_trained": 1828524, "grad_time_ms": 14936.672, "num_steps_sampled": 1828524, "default": {"vf_loss": 21.28334617614746, "cur_lr": 0.0005000000237487257, "entropy": 1.1400675773620605, "vf_explained_var": 0.9094589352607727, "kl": 0.01287761703133583, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003248073859140277, "total_loss": 21.280738830566406}, "sample_time_ms": 27478.52}, "training_iteration": 30, "hostname": "flow-main", "time_since_restore": 1404.6506242752075, "iterations_since_restore": 30, "timesteps_since_restore": 1828524, "date": "2019-05-23_05-37-26", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1828524, "num_metric_batches_dropped": 0, "time_total_s": 1404.6506242752075, "episode_reward_min": -1392.5364646792493, "time_this_iter_s": 42.35112285614014, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf474e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee96d8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 82.86512776213006, "outflow_rate_min": 797.7854283555373, "cost1_max": 453.28771717836736, "system_level_velocity_min": 11.72052854891601, "cost2_min": -151.67206584563965, "cost1_mean": 363.15433890941085, "system_level_velocity_mean": 14.180452130137605, "system_level_velocity_max": 18.35994196705537, "outflow_rate_mean": 1287.2801928814029, "outflow_rate_max": 1605.1601879251696, "cost2_mean": -131.40703955823426, "cost2_max": -53.96968242758033}, "episode_len_mean": 685.48}
{"episode_reward_max": -107.67657489987907, "episode_reward_mean": -1077.1351981803361, "timestamp": 1558589887, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 30, "timesteps_this_iter": 57106, "pid": 31820, "done": false, "episodes_total": 895, "info": {"load_time_ms": 8.581, "update_time_ms": 7.861, "num_steps_trained": 1885630, "grad_time_ms": 14909.712, "num_steps_sampled": 1885630, "default": {"vf_loss": 20.31256103515625, "cur_lr": 0.0005000000237487257, "entropy": 1.1283198595046997, "vf_explained_var": 0.9058150053024292, "kl": 0.010867495089769363, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002447870559990406, "total_loss": 20.310659408569336}, "sample_time_ms": 27228.864}, "training_iteration": 31, "hostname": "flow-main", "time_since_restore": 1446.0705585479736, "iterations_since_restore": 31, "timesteps_since_restore": 1885630, "date": "2019-05-23_05-38-07", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1885630, "num_metric_batches_dropped": 0, "time_total_s": 1446.0705585479736, "episode_reward_min": -1376.8951729528378, "time_this_iter_s": 41.41993427276611, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec76a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daec7550>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 82.86512776213006, "outflow_rate_min": 797.7854283555373, "cost1_max": 451.5814020635688, "system_level_velocity_min": 11.4875068120727, "cost2_min": -151.67206584563965, "cost1_mean": 362.68184266492847, "system_level_velocity_mean": 14.038081460446644, "system_level_velocity_max": 18.35994196705537, "outflow_rate_mean": 1280.0915745975085, "outflow_rate_max": 1584.6280321632896, "cost2_mean": -131.0626772510602, "cost2_max": -53.96968242758033}, "episode_len_mean": 690.33}
{"episode_reward_max": -107.67657489987907, "episode_reward_mean": -1086.7477580958343, "timestamp": 1558589928, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 56508, "pid": 31820, "done": false, "episodes_total": 922, "info": {"load_time_ms": 8.732, "update_time_ms": 7.913, "num_steps_trained": 1942138, "grad_time_ms": 14820.261, "num_steps_sampled": 1942138, "default": {"vf_loss": 24.06389808654785, "cur_lr": 0.0005000000237487257, "entropy": 1.1363868713378906, "vf_explained_var": 0.8943629264831543, "kl": 0.009159154258668423, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0019960708450526, "total_loss": 24.062360763549805}, "sample_time_ms": 26898.243}, "training_iteration": 32, "hostname": "flow-main", "time_since_restore": 1487.2854356765747, "iterations_since_restore": 32, "timesteps_since_restore": 1942138, "date": "2019-05-23_05-38-48", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1942138, "num_metric_batches_dropped": 0, "time_total_s": 1487.2854356765747, "episode_reward_min": -1309.7061392846495, "time_this_iter_s": 41.214877128601074, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed27f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d1d0>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 82.86512776213006, "outflow_rate_min": 797.7854283555373, "cost1_max": 451.5814020635688, "system_level_velocity_min": 11.4875068120727, "cost2_min": -146.02402523721238, "cost1_mean": 366.10733570044164, "system_level_velocity_mean": 14.097845024515548, "system_level_velocity_max": 18.35994196705537, "outflow_rate_mean": 1279.4090659964265, "outflow_rate_max": 1584.6280321632896, "cost2_mean": -130.9023347244933, "cost2_max": -53.96968242758033}, "episode_len_mean": 694.25}
{"episode_reward_max": -28.678459395878086, "episode_reward_mean": -1077.5994999541376, "timestamp": 1558589971, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 29, "timesteps_this_iter": 56750, "pid": 31820, "done": false, "episodes_total": 951, "info": {"load_time_ms": 8.801, "update_time_ms": 7.901, "num_steps_trained": 1998888, "grad_time_ms": 14796.619, "num_steps_sampled": 1998888, "default": {"vf_loss": 20.29498291015625, "cur_lr": 0.0005000000237487257, "entropy": 1.1083011627197266, "vf_explained_var": 0.909100353717804, "kl": 0.01068952213972807, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003141585970297456, "total_loss": 20.292375564575195}, "sample_time_ms": 27110.069}, "training_iteration": 33, "hostname": "flow-main", "time_since_restore": 1530.4040157794952, "iterations_since_restore": 33, "timesteps_since_restore": 1998888, "date": "2019-05-23_05-39-31", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 1998888, "num_metric_batches_dropped": 0, "time_total_s": 1530.4040157794952, "episode_reward_min": -1309.7061392846495, "time_this_iter_s": 43.11858010292053, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf2f8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf2f128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf2f3c8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.09944674719674, "outflow_rate_min": 503.9678826079437, "cost1_max": 456.7012368920168, "system_level_velocity_min": 11.411029848787319, "cost2_min": -147.3894212619618, "cost1_mean": 364.28215580572595, "system_level_velocity_mean": 14.215058231732954, "system_level_velocity_max": 18.666082467218793, "outflow_rate_mean": 1274.0529553407498, "outflow_rate_max": 1584.6280321632896, "cost2_mean": -130.3648911201029, "cost2_max": -22.575834971912904}, "episode_len_mean": 687.6}
{"episode_reward_max": -28.568927581852332, "episode_reward_mean": -1097.3005555443124, "timestamp": 1558590016, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 35, "timesteps_this_iter": 57496, "pid": 31820, "done": false, "episodes_total": 986, "info": {"load_time_ms": 8.902, "update_time_ms": 7.925, "num_steps_trained": 2056384, "grad_time_ms": 14911.876, "num_steps_sampled": 2056384, "default": {"vf_loss": 25.282751083374023, "cur_lr": 0.0005000000237487257, "entropy": 1.1077131032943726, "vf_explained_var": 0.8921998739242554, "kl": 0.012138607911765575, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.003059159033000469, "total_loss": 25.280298233032227}, "sample_time_ms": 27126.336}, "training_iteration": 34, "hostname": "flow-main", "time_since_restore": 1574.4238629341125, "iterations_since_restore": 34, "timesteps_since_restore": 2056384, "date": "2019-05-23_05-40-16", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2056384, "num_metric_batches_dropped": 0, "time_total_s": 1574.4238629341125, "episode_reward_min": -1306.6918070056317, "time_this_iter_s": 44.01984715461731, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d4a8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.09944674719674, "outflow_rate_min": 492.71989023195596, "cost1_max": 456.7012368920168, "system_level_velocity_min": 11.411029848787319, "cost2_min": -151.4948187521362, "cost1_mean": 365.597291148375, "system_level_velocity_mean": 14.294231916153842, "system_level_velocity_max": 18.764215665433735, "outflow_rate_mean": 1275.8393279211666, "outflow_rate_max": 1644.891554377208, "cost2_mean": -132.66854233056284, "cost2_max": -22.575834971912904}, "episode_len_mean": 686.7}
{"episode_reward_max": -28.568927581852332, "episode_reward_mean": -1091.7889469690883, "timestamp": 1558590058, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 29, "timesteps_this_iter": 56073, "pid": 31820, "done": false, "episodes_total": 1015, "info": {"load_time_ms": 8.877, "update_time_ms": 8.154, "num_steps_trained": 2112457, "grad_time_ms": 14938.763, "num_steps_sampled": 2112457, "default": {"vf_loss": 21.89109992980957, "cur_lr": 0.0005000000237487257, "entropy": 1.0878187417984009, "vf_explained_var": 0.8972010016441345, "kl": 0.013521150685846806, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0034545327071100473, "total_loss": 21.888320922851562}, "sample_time_ms": 27163.023}, "training_iteration": 35, "hostname": "flow-main", "time_since_restore": 1616.7077782154083, "iterations_since_restore": 35, "timesteps_since_restore": 2112457, "date": "2019-05-23_05-40-58", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2112457, "num_metric_batches_dropped": 0, "time_total_s": 1616.7077782154083, "episode_reward_min": -1312.531573447641, "time_this_iter_s": 42.283915281295776, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef07b8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.09944674719674, "outflow_rate_min": 492.71989023195596, "cost1_max": 461.491992619353, "system_level_velocity_min": 11.411029848787319, "cost2_min": -151.4948187521362, "cost1_mean": 361.883562677225, "system_level_velocity_mean": 14.33984522002691, "system_level_velocity_max": 18.908466841003534, "outflow_rate_mean": 1269.4787243342755, "outflow_rate_max": 1644.891554377208, "cost2_mean": -133.68579546396464, "cost2_max": -22.575834971912904}, "episode_len_mean": 680.07}
{"episode_reward_max": -28.568927581852332, "episode_reward_mean": -1082.4623159933044, "timestamp": 1558590098, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 55761, "pid": 31820, "done": false, "episodes_total": 1042, "info": {"load_time_ms": 8.977, "update_time_ms": 8.175, "num_steps_trained": 2168218, "grad_time_ms": 14897.602, "num_steps_sampled": 2168218, "default": {"vf_loss": 19.366544723510742, "cur_lr": 0.0005000000237487257, "entropy": 1.0847212076187134, "vf_explained_var": 0.8984513282775879, "kl": 0.011847568675875664, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003092592116445303, "total_loss": 19.364044189453125}, "sample_time_ms": 27157.526}, "training_iteration": 36, "hostname": "flow-main", "time_since_restore": 1657.18905544281, "iterations_since_restore": 36, "timesteps_since_restore": 2168218, "date": "2019-05-23_05-41-38", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2168218, "num_metric_batches_dropped": 0, "time_total_s": 1657.18905544281, "episode_reward_min": -1312.531573447641, "time_this_iter_s": 40.48127722740173, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf474e0>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.09944674719674, "outflow_rate_min": 492.71989023195596, "cost1_max": 461.491992619353, "system_level_velocity_min": 11.411029848787319, "cost2_min": -151.4948187521362, "cost1_mean": 363.4172628291614, "system_level_velocity_mean": 14.402525016871975, "system_level_velocity_max": 18.908466841003534, "outflow_rate_mean": 1270.6039030643362, "outflow_rate_max": 1644.891554377208, "cost2_mean": -134.73063953566393, "cost2_max": -22.575834971912904}, "episode_len_mean": 680.07}
{"episode_reward_max": -29.820767710647303, "episode_reward_mean": -1086.9471574226895, "timestamp": 1558590139, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 30, "timesteps_this_iter": 56434, "pid": 31820, "done": false, "episodes_total": 1072, "info": {"load_time_ms": 9.099, "update_time_ms": 8.17, "num_steps_trained": 2224652, "grad_time_ms": 14792.629, "num_steps_sampled": 2224652, "default": {"vf_loss": 17.938722610473633, "cur_lr": 0.0005000000237487257, "entropy": 1.0825947523117065, "vf_explained_var": 0.9115857481956482, "kl": 0.01281928364187479, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0038364725187420845, "total_loss": 17.935527801513672}, "sample_time_ms": 27075.768}, "training_iteration": 37, "hostname": "flow-main", "time_since_restore": 1697.9874539375305, "iterations_since_restore": 37, "timesteps_since_restore": 2224652, "date": "2019-05-23_05-42-19", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2224652, "num_metric_batches_dropped": 0, "time_total_s": 1697.9874539375305, "episode_reward_min": -1312.531573447641, "time_this_iter_s": 40.79839849472046, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1d860>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 24.622740254641727, "outflow_rate_min": 501.62544868756635, "cost1_max": 461.491992619353, "system_level_velocity_min": 12.09951963093942, "cost2_min": -151.4948187521362, "cost1_mean": 366.76293623541045, "system_level_velocity_mean": 14.16590426225746, "system_level_velocity_max": 18.908466841003534, "outflow_rate_mean": 1272.1173389283267, "outflow_rate_max": 1644.891554377208, "cost2_mean": -134.7378726095275, "cost2_max": -24.496527016409534}, "episode_len_mean": 693.37}
{"episode_reward_max": -29.820767710647303, "episode_reward_mean": -1042.244745510512, "timestamp": 1558590178, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 29, "timesteps_this_iter": 54074, "pid": 31820, "done": false, "episodes_total": 1101, "info": {"load_time_ms": 9.166, "update_time_ms": 8.107, "num_steps_trained": 2278726, "grad_time_ms": 14705.539, "num_steps_sampled": 2278726, "default": {"vf_loss": 15.673676490783691, "cur_lr": 0.0005000000237487257, "entropy": 1.0520546436309814, "vf_explained_var": 0.9189012050628662, "kl": 0.011296626180410385, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002641732571646571, "total_loss": 15.671599388122559}, "sample_time_ms": 26873.637}, "training_iteration": 38, "hostname": "flow-main", "time_since_restore": 1737.219393491745, "iterations_since_restore": 38, "timesteps_since_restore": 2278726, "date": "2019-05-23_05-42-58", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2278726, "num_metric_batches_dropped": 0, "time_total_s": 1737.219393491745, "episode_reward_min": -1280.1356832225647, "time_this_iter_s": 39.23193955421448, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7438>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 24.622740254641727, "outflow_rate_min": 501.62544868756635, "cost1_max": 463.2279181567948, "system_level_velocity_min": 12.09951963093942, "cost2_min": -149.5809569919967, "cost1_mean": 366.03330731679966, "system_level_velocity_mean": 14.234278854400527, "system_level_velocity_max": 18.908466841003534, "outflow_rate_mean": 1271.1636183029143, "outflow_rate_max": 1614.5098009836352, "cost2_mean": -131.53255282468032, "cost2_max": -24.496527016409534}, "episode_len_mean": 690.24}
{"episode_reward_max": -344.4170314719544, "episode_reward_mean": -1031.2954843460209, "timestamp": 1558590219, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 31, "timesteps_this_iter": 55907, "pid": 31820, "done": false, "episodes_total": 1132, "info": {"load_time_ms": 9.292, "update_time_ms": 8.14, "num_steps_trained": 2334633, "grad_time_ms": 14715.442, "num_steps_sampled": 2334633, "default": {"vf_loss": 22.049768447875977, "cur_lr": 0.0005000000237487257, "entropy": 1.0595604181289673, "vf_explained_var": 0.8952375650405884, "kl": 0.012511699460446835, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0037392210215330124, "total_loss": 22.04665184020996}, "sample_time_ms": 26707.515}, "training_iteration": 39, "hostname": "flow-main", "time_since_restore": 1777.7077100276947, "iterations_since_restore": 39, "timesteps_since_restore": 2334633, "date": "2019-05-23_05-43-39", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2334633, "num_metric_batches_dropped": 0, "time_total_s": 1777.7077100276947, "episode_reward_min": -1280.1356832225647, "time_this_iter_s": 40.48831653594971, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1940>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 256.31809929570295, "outflow_rate_min": 1145.2626725280652, "cost1_max": 463.2279181567948, "system_level_velocity_min": 12.09951963093942, "cost2_min": -149.5809569919967, "cost1_mean": 368.4516776774771, "system_level_velocity_mean": 14.143219788717708, "system_level_velocity_max": 18.267006176713714, "outflow_rate_mean": 1272.0148547777844, "outflow_rate_max": 1622.775687069601, "cost2_mean": -128.12073375007603, "cost2_max": -111.0538619512365}, "episode_len_mean": 696.87}
{"episode_reward_max": -344.4170314719544, "episode_reward_mean": -1010.8485667641545, "timestamp": 1558590259, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 29, "timesteps_this_iter": 55394, "pid": 31820, "done": false, "episodes_total": 1161, "info": {"load_time_ms": 9.25, "update_time_ms": 8.059, "num_steps_trained": 2390027, "grad_time_ms": 14693.988, "num_steps_sampled": 2390027, "default": {"vf_loss": 18.337751388549805, "cur_lr": 0.0005000000237487257, "entropy": 1.0466382503509521, "vf_explained_var": 0.9136866331100464, "kl": 0.014586917124688625, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.004385021515190601, "total_loss": 18.33409309387207}, "sample_time_ms": 26514.579}, "training_iteration": 40, "hostname": "flow-main", "time_since_restore": 1817.907695055008, "iterations_since_restore": 40, "timesteps_since_restore": 2390027, "date": "2019-05-23_05-44-19", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2390027, "num_metric_batches_dropped": 0, "time_total_s": 1817.907695055008, "episode_reward_min": -1205.528014780369, "time_this_iter_s": 40.19998502731323, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7ac8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 256.31809929570295, "outflow_rate_min": 1139.1307947142798, "cost1_max": 465.0862020566797, "system_level_velocity_min": 12.09951963093942, "cost2_min": -147.4464644559111, "cost1_mean": 371.79482170754693, "system_level_velocity_mean": 14.297199245474781, "system_level_velocity_max": 18.267006176713714, "outflow_rate_mean": 1281.0689873479741, "outflow_rate_max": 1649.217789742343, "cost2_mean": -127.75449483833256, "cost2_max": -111.0538619512365}, "episode_len_mean": 696.87}
{"episode_reward_max": -28.58290656134124, "episode_reward_mean": -1019.5824720308019, "timestamp": 1558590300, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 34, "timesteps_this_iter": 56157, "pid": 31820, "done": false, "episodes_total": 1195, "info": {"load_time_ms": 9.097, "update_time_ms": 8.097, "num_steps_trained": 2446184, "grad_time_ms": 14696.15, "num_steps_sampled": 2446184, "default": {"vf_loss": 19.926481246948242, "cur_lr": 0.0005000000237487257, "entropy": 1.0372179746627808, "vf_explained_var": 0.9145402312278748, "kl": 0.0124177485704422, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002518462250009179, "total_loss": 19.924583435058594}, "sample_time_ms": 26474.425}, "training_iteration": 41, "hostname": "flow-main", "time_since_restore": 1858.9561002254486, "iterations_since_restore": 41, "timesteps_since_restore": 2446184, "date": "2019-05-23_05-45-00", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2446184, "num_metric_batches_dropped": 0, "time_total_s": 1858.9561002254486, "episode_reward_min": -1177.6581116746484, "time_this_iter_s": 41.048405170440674, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0320>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.027805086848023, "outflow_rate_min": 502.10807303009216, "cost1_max": 465.0862020566797, "system_level_velocity_min": 12.270314766678544, "cost2_min": -156.0048285417267, "cost1_mean": 369.62238284250566, "system_level_velocity_mean": 14.308444448551445, "system_level_velocity_max": 18.63140289695033, "outflow_rate_mean": 1270.4191245981056, "outflow_rate_max": 1649.217789742343, "cost2_mean": -128.75844637371088, "cost2_max": -23.64811143453165}, "episode_len_mean": 693.35}
{"episode_reward_max": -28.58290656134124, "episode_reward_mean": -1028.2314362734903, "timestamp": 1558590343, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 28, "timesteps_this_iter": 56590, "pid": 31820, "done": false, "episodes_total": 1223, "info": {"load_time_ms": 9.035, "update_time_ms": 8.18, "num_steps_trained": 2502774, "grad_time_ms": 14825.762, "num_steps_sampled": 2502774, "default": {"vf_loss": 20.540998458862305, "cur_lr": 0.0005000000237487257, "entropy": 1.0245071649551392, "vf_explained_var": 0.9145944118499756, "kl": 0.012410920113325119, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.003225120948627591, "total_loss": 20.538394927978516}, "sample_time_ms": 26492.103}, "training_iteration": 42, "hostname": "flow-main", "time_since_restore": 1901.6516485214233, "iterations_since_restore": 42, "timesteps_since_restore": 2502774, "date": "2019-05-23_05-45-43", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2502774, "num_metric_batches_dropped": 0, "time_total_s": 1901.6516485214233, "episode_reward_min": -1239.407251061399, "time_this_iter_s": 42.69554829597473, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed72b0>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.027805086848023, "outflow_rate_min": 502.10807303009216, "cost1_max": 465.0862020566797, "system_level_velocity_min": 12.34788570735262, "cost2_min": -156.0048285417267, "cost1_mean": 367.15745772962845, "system_level_velocity_mean": 14.217209652063339, "system_level_velocity_max": 18.63140289695033, "outflow_rate_mean": 1271.0106993241177, "outflow_rate_max": 1649.217789742343, "cost2_mean": -132.61703135030245, "cost2_max": -23.64811143453165}, "episode_len_mean": 693.35}
{"episode_reward_max": -28.58290656134124, "episode_reward_mean": -1039.4556542147357, "timestamp": 1558590387, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 31, "timesteps_this_iter": 57101, "pid": 31820, "done": false, "episodes_total": 1254, "info": {"load_time_ms": 9.133, "update_time_ms": 8.192, "num_steps_trained": 2559875, "grad_time_ms": 14828.162, "num_steps_sampled": 2559875, "default": {"vf_loss": 21.368322372436523, "cur_lr": 0.0005000000237487257, "entropy": 1.0174299478530884, "vf_explained_var": 0.9128945469856262, "kl": 0.013067947700619698, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003230517264455557, "total_loss": 21.36574363708496}, "sample_time_ms": 26528.663}, "training_iteration": 43, "hostname": "flow-main", "time_since_restore": 1945.160781621933, "iterations_since_restore": 43, "timesteps_since_restore": 2559875, "date": "2019-05-23_05-46-27", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2559875, "num_metric_batches_dropped": 0, "time_total_s": 1945.160781621933, "episode_reward_min": -1248.2860425722354, "time_this_iter_s": 43.509133100509644, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef02b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0940>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.027805086848023, "outflow_rate_min": 502.10807303009216, "cost1_max": 464.3948663814933, "system_level_velocity_min": 11.854655047711011, "cost2_min": -156.0048285417267, "cost1_mean": 362.9154442001397, "system_level_velocity_mean": 14.224617036547906, "system_level_velocity_max": 18.715602870588302, "outflow_rate_mean": 1263.7487026179992, "outflow_rate_max": 1620.875705202312, "cost2_mean": -135.75719026086347, "cost2_max": -23.64811143453165}, "episode_len_mean": 687.09}
{"episode_reward_max": -28.58290656134124, "episode_reward_mean": -1045.3815953677272, "timestamp": 1558590429, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 29, "timesteps_this_iter": 56451, "pid": 31820, "done": false, "episodes_total": 1283, "info": {"load_time_ms": 9.15, "update_time_ms": 8.209, "num_steps_trained": 2616326, "grad_time_ms": 14675.058, "num_steps_sampled": 2616326, "default": {"vf_loss": 20.154489517211914, "cur_lr": 0.0005000000237487257, "entropy": 1.0209968090057373, "vf_explained_var": 0.9195430278778076, "kl": 0.014154060743749142, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0038256465923041105, "total_loss": 20.151369094848633}, "sample_time_ms": 26569.816}, "training_iteration": 44, "hostname": "flow-main", "time_since_restore": 1988.0507371425629, "iterations_since_restore": 44, "timesteps_since_restore": 2616326, "date": "2019-05-23_05-47-09", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2616326, "num_metric_batches_dropped": 0, "time_total_s": 1988.0507371425629, "episode_reward_min": -1281.8904028218042, "time_this_iter_s": 42.88995552062988, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7a20>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 23.027805086848023, "outflow_rate_min": 502.10807303009216, "cost1_max": 465.80067821350895, "system_level_velocity_min": 11.854655047711011, "cost2_min": -158.32362640742775, "cost1_mean": 358.31368497515, "system_level_velocity_mean": 14.159800022433, "system_level_velocity_max": 18.715602870588302, "outflow_rate_mean": 1267.8891967354432, "outflow_rate_max": 1644.730315490031, "cost2_mean": -138.75068335321518, "cost2_max": -23.64811143453165}, "episode_len_mean": 682.87}
{"episode_reward_max": -93.06387378718948, "episode_reward_mean": -1077.859004739849, "timestamp": 1558590473, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 33, "timesteps_this_iter": 58266, "pid": 31820, "done": false, "episodes_total": 1316, "info": {"load_time_ms": 9.349, "update_time_ms": 7.86, "num_steps_trained": 2674592, "grad_time_ms": 14764.253, "num_steps_sampled": 2674592, "default": {"vf_loss": 22.417329788208008, "cur_lr": 0.0005000000237487257, "entropy": 1.0231398344039917, "vf_explained_var": 0.9120827317237854, "kl": 0.013262069784104824, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002132731257006526, "total_loss": 22.415861129760742}, "sample_time_ms": 26621.078}, "training_iteration": 45, "hostname": "flow-main", "time_since_restore": 2031.7380530834198, "iterations_since_restore": 45, "timesteps_since_restore": 2674592, "date": "2019-05-23_05-47-53", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2674592, "num_metric_batches_dropped": 0, "time_total_s": 2031.7380530834198, "episode_reward_min": -1281.8904028218042, "time_this_iter_s": 43.687315940856934, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1208>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 79.86986141434708, "outflow_rate_min": 780.828766247846, "cost1_max": 465.80067821350895, "system_level_velocity_min": 11.853709234097796, "cost2_min": -158.32362640742775, "cost1_mean": 359.7358897997922, "system_level_velocity_mean": 14.058593777659349, "system_level_velocity_max": 18.715602870588302, "outflow_rate_mean": 1271.8882572098307, "outflow_rate_max": 1644.730315490031, "cost2_mean": -142.26639915173993, "cost2_max": -59.57068014934479}, "episode_len_mean": 688.19}
{"episode_reward_max": -30.987251136743765, "episode_reward_mean": -1081.952254116128, "timestamp": 1558590516, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 30, "timesteps_this_iter": 57007, "pid": 31820, "done": false, "episodes_total": 1346, "info": {"load_time_ms": 9.477, "update_time_ms": 7.815, "num_steps_trained": 2731599, "grad_time_ms": 14816.837, "num_steps_sampled": 2731599, "default": {"vf_loss": 22.661027908325195, "cur_lr": 0.0005000000237487257, "entropy": 1.0150787830352783, "vf_explained_var": 0.9159358143806458, "kl": 0.011842458508908749, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.003286419901996851, "total_loss": 22.658334732055664}, "sample_time_ms": 26808.825}, "training_iteration": 46, "hostname": "flow-main", "time_since_restore": 2074.6180794239044, "iterations_since_restore": 46, "timesteps_since_restore": 2731599, "date": "2019-05-23_05-48-36", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2731599, "num_metric_batches_dropped": 0, "time_total_s": 2074.6180794239044, "episode_reward_min": -1411.2382879778452, "time_this_iter_s": 42.88002634048462, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf07d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89dafb2e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf070b8>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 24.384810173778046, "outflow_rate_min": 481.21448900622715, "cost1_max": 467.9281521097129, "system_level_velocity_min": 11.743229411415705, "cost2_min": -165.94232900208684, "cost1_mean": 348.401053248563, "system_level_velocity_mean": 13.954981778227022, "system_level_velocity_max": 18.65586881388557, "outflow_rate_mean": 1256.081707399531, "outflow_rate_max": 1660.6903620214985, "cost2_mean": -142.6506867262742, "cost2_max": -25.77922547443354}, "episode_len_mean": 674.58}
{"episode_reward_max": -30.987251136743765, "episode_reward_mean": -1119.5130517821087, "timestamp": 1558590559, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 27, "timesteps_this_iter": 59276, "pid": 31820, "done": false, "episodes_total": 1373, "info": {"load_time_ms": 9.529, "update_time_ms": 7.813, "num_steps_trained": 2790875, "grad_time_ms": 14892.756, "num_steps_sampled": 2790875, "default": {"vf_loss": 19.230894088745117, "cur_lr": 0.0005000000237487257, "entropy": 1.0057553052902222, "vf_explained_var": 0.9299251437187195, "kl": 0.013798592612147331, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.004824476782232523, "total_loss": 19.226760864257812}, "sample_time_ms": 26978.588}, "training_iteration": 47, "hostname": "flow-main", "time_since_restore": 2117.8667361736298, "iterations_since_restore": 47, "timesteps_since_restore": 2790875, "date": "2019-05-23_05-49-19", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2790875, "num_metric_batches_dropped": 0, "time_total_s": 2117.8667361736298, "episode_reward_min": -1411.2382879778452, "time_this_iter_s": 43.24865674972534, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef07b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daef0b00>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 24.384810173778046, "outflow_rate_min": 481.21448900622715, "cost1_max": 467.9281521097129, "system_level_velocity_min": 11.743229411415705, "cost2_min": -168.65714120407674, "cost1_mean": 349.97549306742775, "system_level_velocity_mean": 13.898686278871448, "system_level_velocity_max": 18.65586881388557, "outflow_rate_mean": 1255.6384912450442, "outflow_rate_max": 1660.6903620214985, "cost2_mean": -146.3091466676701, "cost2_max": -25.77922547443354}, "episode_len_mean": 679.23}
{"episode_reward_max": -30.987251136743765, "episode_reward_mean": -1160.5658794261296, "timestamp": 1558590605, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 32, "timesteps_this_iter": 60395, "pid": 31820, "done": false, "episodes_total": 1405, "info": {"load_time_ms": 9.579, "update_time_ms": 7.842, "num_steps_trained": 2851270, "grad_time_ms": 15059.209, "num_steps_sampled": 2851270, "default": {"vf_loss": 28.313329696655273, "cur_lr": 0.0005000000237487257, "entropy": 0.9885192513465881, "vf_explained_var": 0.8990992307662964, "kl": 0.014990943484008312, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.003713497193530202, "total_loss": 28.31036376953125}, "sample_time_ms": 27425.878}, "training_iteration": 48, "hostname": "flow-main", "time_since_restore": 2163.2312602996826, "iterations_since_restore": 48, "timesteps_since_restore": 2851270, "date": "2019-05-23_05-50-05", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2851270, "num_metric_batches_dropped": 0, "time_total_s": 2163.2312602996826, "episode_reward_min": -1510.247526211584, "time_this_iter_s": 45.364524126052856, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7f98>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 24.384810173778046, "outflow_rate_min": 475.4385119415045, "cost1_max": 467.9281521097129, "system_level_velocity_min": 11.59155307685401, "cost2_min": -182.681401148832, "cost1_mean": 340.8441261635645, "system_level_velocity_mean": 13.68128112630609, "system_level_velocity_max": 18.703763655282806, "outflow_rate_mean": 1238.8058282681209, "outflow_rate_max": 1660.6903620214985, "cost2_mean": -149.7963824150408, "cost2_max": -25.77922547443354}, "episode_len_mean": 673.93}
{"episode_reward_max": -31.213438426398692, "episode_reward_mean": -1223.123532117075, "timestamp": 1558590652, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 29, "timesteps_this_iter": 61685, "pid": 31820, "done": false, "episodes_total": 1434, "info": {"load_time_ms": 9.76, "update_time_ms": 7.833, "num_steps_trained": 2912955, "grad_time_ms": 15407.39, "num_steps_sampled": 2912955, "default": {"vf_loss": 30.922832489013672, "cur_lr": 0.0005000000237487257, "entropy": 0.9626803398132324, "vf_explained_var": 0.8969210386276245, "kl": 0.013650407083332539, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.002536782529205084, "total_loss": 30.920978546142578}, "sample_time_ms": 27725.475}, "training_iteration": 49, "hostname": "flow-main", "time_since_restore": 2210.2085218429565, "iterations_since_restore": 49, "timesteps_since_restore": 2912955, "date": "2019-05-23_05-50-52", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2912955, "num_metric_batches_dropped": 0, "time_total_s": 2210.2085218429565, "episode_reward_min": -1596.5584692442394, "time_this_iter_s": 46.977261543273926, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee19b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daee1390>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 24.48834733941131, "outflow_rate_min": 475.4385119415045, "cost1_max": 467.9281521097129, "system_level_velocity_min": 11.203509631640053, "cost2_min": -183.10868935990692, "cost1_mean": 350.72680175982117, "system_level_velocity_mean": 13.707789507631695, "system_level_velocity_max": 18.703763655282806, "outflow_rate_mean": 1261.0065946122986, "outflow_rate_max": 1693.1662334789842, "cost2_mean": -157.9434771994458, "cost2_max": -26.236570297934144}, "episode_len_mean": 687.54}
{"episode_reward_max": -31.213438426398692, "episode_reward_mean": -1256.8754430907966, "timestamp": 1558590697, "experiment_id": "918b1504fd9b4d2ebf4b128ffbb6433b", "episodes_this_iter": 28, "timesteps_this_iter": 62107, "pid": 31820, "done": true, "episodes_total": 1462, "info": {"load_time_ms": 9.913, "update_time_ms": 7.976, "num_steps_trained": 2975062, "grad_time_ms": 15587.861, "num_steps_sampled": 2975062, "default": {"vf_loss": 25.787736892700195, "cur_lr": 0.0005000000237487257, "entropy": 0.9464137554168701, "vf_explained_var": 0.9093764424324036, "kl": 0.014800515957176685, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.004024020396173, "total_loss": 25.784456253051758}, "sample_time_ms": 28067.445}, "training_iteration": 50, "hostname": "flow-main", "time_since_restore": 2255.64591383934, "iterations_since_restore": 50, "timesteps_since_restore": 2975062, "date": "2019-05-23_05-51-37", "node_ip": "10.138.0.2", "policy_reward_mean": {}, "timesteps_total": 2975062, "num_metric_batches_dropped": 0, "time_total_s": 2255.64591383934, "episode_reward_min": -1674.6947964370377, "time_this_iter_s": 45.43739199638367, "config": {"input": "sampler", "output_compress_columns": ["obs", "new_obs"], "num_envs_per_worker": 1, "sample_batch_size": 750, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "horizon": 1500, "compress_observations": false, "vf_loss_coeff": 1.0, "input_evaluation": null, "gamma": 0.99, "optimizer": {}, "kl_target": 0.01, "entropy_coeff": 0.0, "num_gpus": 0, "sgd_minibatch_size": 128, "lr_schedule": null, "custom_resources_per_worker": {}, "kl_coeff": 0.2, "lambda": 0.97, "model": {"conv_filters": null, "channel_major": false, "framestack": true, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "squash_to_range": false, "conv_activation": "relu", "dim": 84, "custom_model": null, "custom_preprocessor": null, "fcnet_hiddens": [128, 64, 32], "use_lstm": false, "lstm_cell_size": 256, "free_log_std": false, "zero_mean": true, "custom_options": {}}, "vf_clip_param": 1000000.0, "clip_actions": false, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "monitor": false, "collect_metrics_timeout": 180, "output": null, "sample_async": false, "synchronize_filters": true, "tf_session_args": {"gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "output_max_file_size": 67108864, "num_workers": 20, "straggler_mitigation": false, "use_gae": true, "vf_share_layers": false, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed75f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f89daed7898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f89daf1da90>", "on_train_result": null, "on_sample_end": null}, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "clip_param": 0.3, "num_cpus_per_worker": 1, "log_level": "INFO", "observation_filter": "NoFilter", "lr": 0.0005, "num_sgd_iter": 10, "simple_optimizer": false, "train_batch_size": 30000, "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:10.0_buf_len: 1", "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "clip_rewards": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.05,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}}, "custom_metrics": {"cost1_min": 24.48834733941131, "outflow_rate_min": 475.4385119415045, "cost1_max": 467.6462749281112, "system_level_velocity_min": 10.930640783984634, "cost2_min": -188.9242560459426, "cost1_mean": 342.5340277161851, "system_level_velocity_mean": 13.548918413420786, "system_level_velocity_max": 18.703763655282806, "outflow_rate_mean": 1247.9965597528849, "outflow_rate_max": 1693.1662334789842, "cost2_mean": -161.28536730253097, "cost2_max": -26.236570297934144}, "episode_len_mean": 681.71}

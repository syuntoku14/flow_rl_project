{"training_iteration": 1, "time_since_restore": 77.64383316040039, "episode_reward_max": 578.7263302907047, "policy_reward_mean": {}, "timesteps_since_restore": 117381, "episode_len_mean": 700.0, "episode_reward_min": 337.65865909160345, "hostname": "flow-main", "time_this_iter_s": 77.64383316040039, "custom_metrics": {"cost2_mean": -48.60257281592621, "system_level_velocity_max": 9.184551286692031, "cost2_max": -28.528884536881193, "outflow_rate_max": 695.8951955039449, "cost2_min": -79.04846229083856, "cost1_mean": 202.35110722993358, "system_level_velocity_mean": 7.828155200919397, "outflow_rate_min": 573.5249076571405, "cost1_max": 234.39428635514622, "outflow_rate_mean": 611.7860499599084, "cost1_min": 180.4698183200453, "system_level_velocity_min": 7.051294473938838}, "episodes_total": 22, "timesteps_this_iter": 117381, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 1, "timesteps_total": 117381, "date": "2019-04-28_11-51-30", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 117381, "load_time_ms": 73.081, "grad_time_ms": 25168.433, "update_time_ms": 2618.271, "num_steps_trained": 117381, "default": {"total_loss": 2.157461643218994, "cur_lr": 0.0005000000237487257, "entropy": 1.4201785326004028, "vf_loss": 2.1575708389282227, "kl": 0.001177986734546721, "vf_explained_var": 0.8272854685783386, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0003448018978815526}, "sample_time_ms": 49523.768}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ab00>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a5c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a5f8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 22, "time_total_s": 77.64383316040039, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452290, "episode_reward_mean": 450.52887974918815}
{"training_iteration": 2, "time_since_restore": 118.85219717025757, "episode_reward_max": 676.7348202738242, "policy_reward_mean": {}, "timesteps_since_restore": 233729, "episode_len_mean": 700.0, "episode_reward_min": 326.4409394402246, "hostname": "flow-main", "time_this_iter_s": 41.20836400985718, "custom_metrics": {"cost2_mean": -52.089954658196575, "system_level_velocity_max": 9.28316961326276, "cost2_max": -28.528884536881193, "outflow_rate_max": 748.0725089710303, "cost2_min": -84.640643847785, "cost1_mean": 201.72674791026142, "system_level_velocity_mean": 7.788534617454068, "outflow_rate_min": 497.0334623607242, "cost1_max": 240.70983449699614, "outflow_rate_mean": 615.5311116132747, "cost1_min": 163.333053282293, "system_level_velocity_min": 6.33299149351182}, "episodes_total": 84, "timesteps_this_iter": 116348, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 2, "timesteps_total": 233729, "date": "2019-04-28_11-52-11", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 233729, "load_time_ms": 47.152, "grad_time_ms": 25628.408, "update_time_ms": 1315.008, "num_steps_trained": 233729, "default": {"total_loss": 2.532987594604492, "cur_lr": 0.0005000000237487257, "entropy": 1.4171801805496216, "vf_loss": 2.5353095531463623, "kl": 0.007902615703642368, "vf_explained_var": 0.8659748435020447, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.003112250939011574}, "sample_time_ms": 32195.861}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914beb8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b588>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 62, "time_total_s": 118.85219717025757, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452331, "episode_reward_mean": 470.83555191315844}
{"training_iteration": 3, "time_since_restore": 160.4504919052124, "episode_reward_max": 758.8550012695741, "policy_reward_mean": {}, "timesteps_since_restore": 350822, "episode_len_mean": 700.0, "episode_reward_min": 326.4409394402246, "hostname": "flow-main", "time_this_iter_s": 41.598294734954834, "custom_metrics": {"cost2_mean": -53.526442120515085, "system_level_velocity_max": 9.943980479482924, "cost2_max": -30.84248020693204, "outflow_rate_max": 812.8173668305457, "cost2_min": -84.78531968006583, "cost1_mean": 207.68903668060128, "system_level_velocity_mean": 7.9845211467426545, "outflow_rate_min": 461.44682905747914, "cost1_max": 261.7150718131875, "outflow_rate_mean": 639.073326543383, "cost1_min": 159.86439399850696, "system_level_velocity_min": 6.193234885658453}, "episodes_total": 133, "timesteps_this_iter": 117093, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 3, "timesteps_total": 350822, "date": "2019-04-28_11-52-53", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 350822, "load_time_ms": 37.997, "grad_time_ms": 25694.948, "update_time_ms": 880.261, "num_steps_trained": 350822, "default": {"total_loss": 5.3433098793029785, "cur_lr": 0.0005000000237487257, "entropy": 1.4049445390701294, "vf_loss": 5.345867156982422, "kl": 0.006765755824744701, "vf_explained_var": 0.8494736552238464, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0032339105382561684}, "sample_time_ms": 26638.823}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ef98>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ec88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ebe0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 49, "time_total_s": 160.4504919052124, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452373, "episode_reward_mean": 532.4066332718144}
{"training_iteration": 4, "time_since_restore": 201.50611901283264, "episode_reward_max": 919.8489391744703, "policy_reward_mean": {}, "timesteps_since_restore": 465739, "episode_len_mean": 700.0, "episode_reward_min": 410.250461548387, "hostname": "flow-main", "time_this_iter_s": 41.05562710762024, "custom_metrics": {"cost2_mean": -56.475450253699, "system_level_velocity_max": 11.381771318675531, "cost2_max": -31.09764024681004, "outflow_rate_max": 865.9524366845714, "cost2_min": -84.78531968006583, "cost1_mean": 235.12551448210488, "system_level_velocity_mean": 8.947258835963957, "outflow_rate_min": 461.44682905747914, "cost1_max": 301.7076564784028, "outflow_rate_mean": 722.3850058326286, "cost1_min": 159.86439399850696, "system_level_velocity_min": 6.193234885658453}, "episodes_total": 192, "timesteps_this_iter": 114917, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 4, "timesteps_total": 465739, "date": "2019-04-28_11-53-34", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 465739, "load_time_ms": 33.801, "grad_time_ms": 25580.469, "update_time_ms": 663.212, "num_steps_trained": 465739, "default": {"total_loss": 9.058764457702637, "cur_lr": 0.0005000000237487257, "entropy": 1.396124005317688, "vf_loss": 9.06131362915039, "kl": 0.0077153840102255344, "vf_explained_var": 0.7681542038917542, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.003319846000522375}, "sample_time_ms": 23871.812}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c278>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ca90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91444e0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 59, "time_total_s": 201.50611901283264, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452414, "episode_reward_mean": 707.4207145656075}
{"training_iteration": 5, "time_since_restore": 243.33856678009033, "episode_reward_max": 963.5753399241677, "policy_reward_mean": {}, "timesteps_since_restore": 581074, "episode_len_mean": 700.0, "episode_reward_min": 666.0091050902661, "hostname": "flow-main", "time_this_iter_s": 41.83244776725769, "custom_metrics": {"cost2_mean": -57.771090826718, "system_level_velocity_max": 11.48739737313469, "cost2_max": -48.2966526880724, "outflow_rate_max": 869.8619691906613, "cost2_min": -82.89108553532907, "cost1_min": 201.73528120383068, "system_level_velocity_mean": 9.78808560355324, "outflow_rate_min": 555.7137536995099, "cost1_max": 301.7076564784028, "outflow_rate_mean": 789.5141247138959, "cost1_mean": 258.77548967441777, "system_level_velocity_min": 7.720432841805941}, "episodes_total": 247, "timesteps_this_iter": 115335, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 5, "timesteps_total": 581074, "date": "2019-04-28_11-54-15", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 581074, "load_time_ms": 29.846, "grad_time_ms": 25606.213, "update_time_ms": 532.512, "num_steps_trained": 581074, "default": {"total_loss": 12.256841659545898, "cur_lr": 0.0005000000237487257, "entropy": 1.3913065195083618, "vf_loss": 12.257339477539062, "kl": 0.0043246932327747345, "vf_explained_var": 0.7194696068763733, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0009299952071160078}, "sample_time_ms": 22270.627}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148208>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148940>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 55, "time_total_s": 243.33856678009033, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452455, "episode_reward_mean": 842.9150465301734}
{"training_iteration": 6, "time_since_restore": 285.36366963386536, "episode_reward_max": 1054.2484254102533, "policy_reward_mean": {}, "timesteps_since_restore": 701939, "episode_len_mean": 700.0, "episode_reward_min": 725.1618416834118, "hostname": "flow-main", "time_this_iter_s": 42.025102853775024, "custom_metrics": {"cost2_mean": -55.734440568850545, "system_level_velocity_max": 12.189997427440142, "cost2_max": -44.37098298789208, "outflow_rate_max": 948.8839002280738, "cost2_min": -67.27551453462704, "cost1_mean": 267.824155286815, "system_level_velocity_mean": 10.095199778931859, "outflow_rate_min": 648.1999713110931, "cost1_max": 323.70045363343775, "outflow_rate_mean": 819.6935451428491, "cost1_min": 210.85779831819244, "system_level_velocity_min": 8.099984545701655}, "episodes_total": 293, "timesteps_this_iter": 120865, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 6, "timesteps_total": 701939, "date": "2019-04-28_11-54-58", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 701939, "load_time_ms": 27.187, "grad_time_ms": 25808.994, "update_time_ms": 446.625, "num_steps_trained": 701939, "default": {"total_loss": 11.557571411132812, "cur_lr": 0.0005000000237487257, "entropy": 1.396703839302063, "vf_loss": 11.558521270751953, "kl": 0.005148361437022686, "vf_explained_var": 0.7782893776893616, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0012067436473444104}, "sample_time_ms": 21047.787}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b5f8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b828>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 46, "time_total_s": 285.36366963386536, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452498, "episode_reward_mean": 906.0831152949447}
{"training_iteration": 7, "time_since_restore": 330.4031093120575, "episode_reward_max": 1056.1049447849896, "policy_reward_mean": {}, "timesteps_since_restore": 831256, "episode_len_mean": 693.35, "episode_reward_min": 49.07153595813406, "hostname": "flow-main", "time_this_iter_s": 45.03943967819214, "custom_metrics": {"cost2_mean": -57.28396340513298, "system_level_velocity_max": 17.626051064155938, "cost2_max": -20.90906394919406, "outflow_rate_max": 948.8839002280738, "cost2_min": -73.47533313587259, "cost1_mean": 259.7712687046435, "system_level_velocity_mean": 9.946170070338239, "outflow_rate_min": 470.9586080932736, "cost1_max": 323.70045363343775, "outflow_rate_mean": 812.4928416086248, "cost1_min": 22.12292550172538, "system_level_velocity_min": 6.915028031156396}, "episodes_total": 350, "timesteps_this_iter": 129317, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 7, "timesteps_total": 831256, "date": "2019-04-28_11-55-43", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 831256, "load_time_ms": 25.283, "grad_time_ms": 26127.835, "update_time_ms": 384.399, "num_steps_trained": 831256, "default": {"total_loss": 13.969365119934082, "cur_lr": 0.0005000000237487257, "entropy": 1.3871475458145142, "vf_loss": 13.97028636932373, "kl": 0.0059448061510920525, "vf_explained_var": 0.7797185778617859, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0012184388469904661}, "sample_time_ms": 20431.169}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914be48>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 57, "time_total_s": 330.4031093120575, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452543, "episode_reward_mean": 910.3813724275506}
{"training_iteration": 8, "time_since_restore": 376.3987054824829, "episode_reward_max": 1058.974309410719, "policy_reward_mean": {}, "timesteps_since_restore": 964355, "episode_len_mean": 693.35, "episode_reward_min": 49.07153595813406, "hostname": "flow-main", "time_this_iter_s": 45.995596170425415, "custom_metrics": {"cost2_mean": -59.576763155212, "system_level_velocity_max": 17.626051064155938, "cost2_max": -20.90906394919406, "outflow_rate_max": 966.0792959687619, "cost2_min": -73.47533313587259, "cost1_mean": 255.75525747626972, "system_level_velocity_mean": 9.7987243033428, "outflow_rate_min": 470.9586080932736, "cost1_max": 323.70045363343775, "outflow_rate_mean": 803.5936308416382, "cost1_min": 22.12292550172538, "system_level_velocity_min": 6.845035092876525}, "episodes_total": 375, "timesteps_this_iter": 133099, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 8, "timesteps_total": 964355, "date": "2019-04-28_11-56-29", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 964355, "load_time_ms": 25.051, "grad_time_ms": 26583.96, "update_time_ms": 337.497, "num_steps_trained": 964355, "default": {"total_loss": 7.927546501159668, "cur_lr": 0.0005000000237487257, "entropy": 1.3896658420562744, "vf_loss": 7.928354740142822, "kl": 0.005675493739545345, "vf_explained_var": 0.8895444273948669, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0010917226318269968}, "sample_time_ms": 19868.218}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148630>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 25, "time_total_s": 376.3987054824829, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452589, "episode_reward_mean": 907.0714527721716}
{"training_iteration": 9, "time_since_restore": 421.7583348751068, "episode_reward_max": 1081.9525604378775, "policy_reward_mean": {}, "timesteps_since_restore": 1094476, "episode_len_mean": 693.35, "episode_reward_min": 49.07153595813406, "hostname": "flow-main", "time_this_iter_s": 45.3596293926239, "custom_metrics": {"cost2_mean": -63.35699617666779, "system_level_velocity_max": 17.626051064155938, "cost2_max": -20.90906394919406, "outflow_rate_max": 966.0792959687619, "cost2_min": -77.04907719566445, "cost1_mean": 236.88249447532615, "system_level_velocity_mean": 9.097499367449164, "outflow_rate_min": 240.56629528606297, "cost1_max": 317.47456615684996, "outflow_rate_mean": 753.6165560842093, "cost1_min": 22.12292550172538, "system_level_velocity_min": 3.1045217961240477}, "episodes_total": 431, "timesteps_this_iter": 130121, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 9, "timesteps_total": 1094476, "date": "2019-04-28_11-57-14", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1094476, "load_time_ms": 23.665, "grad_time_ms": 26867.377, "update_time_ms": 301.212, "num_steps_trained": 1094476, "default": {"total_loss": 10.509077072143555, "cur_lr": 0.0005000000237487257, "entropy": 1.3861732482910156, "vf_loss": 10.510164260864258, "kl": 0.0072296615689992905, "vf_explained_var": 0.8776541352272034, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0014489918248727918}, "sample_time_ms": 19433.087}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ca90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148b38>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 56, "time_total_s": 421.7583348751068, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452634, "episode_reward_mean": 872.0400278964719}
{"training_iteration": 10, "time_since_restore": 467.15454483032227, "episode_reward_max": 1081.9525604378775, "policy_reward_mean": {}, "timesteps_since_restore": 1217505, "episode_len_mean": 700.0, "episode_reward_min": 450.61837646113224, "hostname": "flow-main", "time_this_iter_s": 45.396209955215454, "custom_metrics": {"cost2_mean": -60.39003603080213, "system_level_velocity_max": 11.324791586690816, "cost2_max": -48.82693554489437, "outflow_rate_max": 931.7357656355639, "cost2_min": -77.04907719566445, "cost1_min": 81.07935611055917, "system_level_velocity_mean": 8.654818492835522, "outflow_rate_min": 240.56629528606297, "cost1_max": 305.5298228543641, "outflow_rate_mean": 733.3309559484188, "cost1_mean": 230.00137547078523, "system_level_velocity_min": 3.1045217961240477}, "episodes_total": 481, "timesteps_this_iter": 123029, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 10, "timesteps_total": 1217505, "date": "2019-04-28_11-57-59", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1217505, "load_time_ms": 22.807, "grad_time_ms": 26976.727, "update_time_ms": 272.224, "num_steps_trained": 1217505, "default": {"total_loss": 11.315287590026855, "cur_lr": 0.0005000000237487257, "entropy": 1.3822416067123413, "vf_loss": 11.316363334655762, "kl": 0.007414793595671654, "vf_explained_var": 0.8667891621589661, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0014472684124484658}, "sample_time_ms": 19205.872}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9123438>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b710>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 50, "time_total_s": 467.15454483032227, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452679, "episode_reward_mean": 873.4964793553668}
{"training_iteration": 11, "time_since_restore": 508.5854170322418, "episode_reward_max": 1066.8472256502134, "policy_reward_mean": {}, "timesteps_since_restore": 1337358, "episode_len_mean": 700.0, "episode_reward_min": 546.038311351491, "hostname": "flow-main", "time_this_iter_s": 41.430872201919556, "custom_metrics": {"cost2_mean": -53.908618186868836, "system_level_velocity_max": 11.275478034044374, "cost2_max": -40.82454697390328, "outflow_rate_max": 919.1615767293302, "cost2_min": -69.95621847165715, "cost1_mean": 241.8028273590761, "system_level_velocity_mean": 9.069263015779907, "outflow_rate_min": 383.2415998003832, "cost1_max": 299.8950728980843, "outflow_rate_mean": 773.331681356813, "cost1_min": 144.86493004627357, "system_level_velocity_min": 5.626827989627449}, "episodes_total": 524, "timesteps_this_iter": 119853, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 11, "timesteps_total": 1337358, "date": "2019-04-28_11-58-41", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1337358, "load_time_ms": 17.686, "grad_time_ms": 27098.741, "update_time_ms": 11.51, "num_steps_trained": 1337358, "default": {"total_loss": 12.508502960205078, "cur_lr": 0.0005000000237487257, "entropy": 1.3489186763763428, "vf_loss": 12.50912857055664, "kl": 0.007385943550616503, "vf_explained_var": 0.761832058429718, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0009939534356817603}, "sample_time_ms": 15732.483}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e908>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915eac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9144dd8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 43, "time_total_s": 508.5854170322418, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452721, "episode_reward_mean": 920.4248714746283}
{"training_iteration": 12, "time_since_restore": 549.6343388557434, "episode_reward_max": 1066.8472256502134, "policy_reward_mean": {}, "timesteps_since_restore": 1457131, "episode_len_mean": 700.0, "episode_reward_min": 698.1042372505952, "hostname": "flow-main", "time_this_iter_s": 41.04892182350159, "custom_metrics": {"cost2_mean": -46.620014067376886, "system_level_velocity_max": 11.275478034044374, "cost2_max": -37.044554066738115, "outflow_rate_max": 906.9227959635497, "cost2_min": -58.44330521138974, "cost1_mean": 256.9228250697667, "system_level_velocity_mean": 9.610666155601468, "outflow_rate_min": 502.52819698031635, "cost1_max": 299.8950728980843, "outflow_rate_mean": 818.8232343696833, "cost1_min": 165.5608709441557, "system_level_velocity_min": 6.2006383081558205}, "episodes_total": 581, "timesteps_this_iter": 119773, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 12, "timesteps_total": 1457131, "date": "2019-04-28_11-59-22", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1457131, "load_time_ms": 17.812, "grad_time_ms": 27119.28, "update_time_ms": 11.386, "num_steps_trained": 1457131, "default": {"total_loss": 16.026033401489258, "cur_lr": 0.0005000000237487257, "entropy": 1.3264816999435425, "vf_loss": 16.026046752929688, "kl": 0.007350512780249119, "vf_explained_var": 0.6459210515022278, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0003803802246693522}, "sample_time_ms": 15695.41}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e630>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b668>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 57, "time_total_s": 549.6343388557434, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452762, "episode_reward_mean": 965.5790143437704}
{"training_iteration": 13, "time_since_restore": 590.7314245700836, "episode_reward_max": 1062.6522221549362, "policy_reward_mean": {}, "timesteps_since_restore": 1573418, "episode_len_mean": 700.0, "episode_reward_min": 762.8534427920697, "hostname": "flow-main", "time_this_iter_s": 41.09708571434021, "custom_metrics": {"cost2_mean": -43.60019144470611, "system_level_velocity_max": 11.918876093685602, "cost2_max": -37.044554066738115, "outflow_rate_max": 950.2586572772136, "cost2_min": -51.310039403005305, "cost1_mean": 259.99499174346175, "system_level_velocity_mean": 9.720717733887358, "outflow_rate_min": 548.0865428485976, "cost1_max": 320.24021862044617, "outflow_rate_mean": 824.6092252551452, "cost1_min": 165.5608709441557, "system_level_velocity_min": 6.2006383081558205}, "episodes_total": 623, "timesteps_this_iter": 116287, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 13, "timesteps_total": 1573418, "date": "2019-04-28_12-00-03", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1573418, "load_time_ms": 18.102, "grad_time_ms": 27104.072, "update_time_ms": 11.602, "num_steps_trained": 1573418, "default": {"total_loss": 13.812385559082031, "cur_lr": 0.0005000000237487257, "entropy": 1.3114227056503296, "vf_loss": 13.812378883361816, "kl": 0.006097417790442705, "vf_explained_var": 0.689796507358551, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.00029665467445738614}, "sample_time_ms": 15658.182}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ef60>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e9b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 42, "time_total_s": 590.7314245700836, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452803, "episode_reward_mean": 967.0127903719025}
{"training_iteration": 14, "time_since_restore": 633.4261269569397, "episode_reward_max": 1064.096316733227, "policy_reward_mean": {}, "timesteps_since_restore": 1689015, "episode_len_mean": 700.0, "episode_reward_min": 862.9458466735804, "hostname": "flow-main", "time_this_iter_s": 42.69470238685608, "custom_metrics": {"cost2_mean": -41.00060350381037, "system_level_velocity_max": 11.918876093685602, "cost2_max": -32.06750558383151, "outflow_rate_max": 950.2586572772136, "cost2_min": -47.05322223923413, "cost1_mean": 264.6993413873163, "system_level_velocity_mean": 9.868455752616903, "outflow_rate_min": 669.5293272255943, "cost1_max": 320.24021862044617, "outflow_rate_mean": 837.3179352469252, "cost1_min": 202.44237091462617, "system_level_velocity_min": 7.616151618687672}, "episodes_total": 684, "timesteps_this_iter": 115597, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 14, "timesteps_total": 1689015, "date": "2019-04-28_12-00-46", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1689015, "load_time_ms": 18.126, "grad_time_ms": 27144.179, "update_time_ms": 11.588, "num_steps_trained": 1689015, "default": {"total_loss": 20.76263999938965, "cur_lr": 0.0005000000237487257, "entropy": 1.2900575399398804, "vf_loss": 20.76249122619629, "kl": 0.006240895017981529, "vf_explained_var": 0.568530797958374, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.00016366617637686431}, "sample_time_ms": 15780.785}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e7b8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ecc0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 61, "time_total_s": 633.4261269569397, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452846, "episode_reward_mean": 976.7568142936908}
{"training_iteration": 15, "time_since_restore": 672.69699883461, "episode_reward_max": 1064.096316733227, "policy_reward_mean": {}, "timesteps_since_restore": 1802108, "episode_len_mean": 700.0, "episode_reward_min": 942.6674070568984, "hostname": "flow-main", "time_this_iter_s": 39.27087187767029, "custom_metrics": {"cost2_mean": -38.774910129565534, "system_level_velocity_max": 12.245146493118908, "cost2_max": -32.0430751743607, "outflow_rate_max": 942.2495546211811, "cost2_min": -46.19704324784101, "cost1_mean": 275.10372218907946, "system_level_velocity_mean": 10.257403979454956, "outflow_rate_min": 776.3259124378707, "cost1_max": 327.2406876522191, "outflow_rate_mean": 849.8849816159365, "cost1_min": 236.50860533162268, "system_level_velocity_min": 8.743697343615034}, "episodes_total": 738, "timesteps_this_iter": 113093, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 15, "timesteps_total": 1802108, "date": "2019-04-28_12-01-25", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1802108, "load_time_ms": 17.882, "grad_time_ms": 26954.383, "update_time_ms": 11.747, "num_steps_trained": 1802108, "default": {"total_loss": 20.480310440063477, "cur_lr": 0.0005000000237487257, "entropy": 1.2745699882507324, "vf_loss": 20.480470657348633, "kl": 0.0073898471891880035, "vf_explained_var": 0.5800169110298157, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0005312092835083604}, "sample_time_ms": 15715.241}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e860>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915eac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e278>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 54, "time_total_s": 672.69699883461, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452885, "episode_reward_mean": 989.3977502000863}
{"training_iteration": 16, "time_since_restore": 713.7186076641083, "episode_reward_max": 1087.8609061240022, "policy_reward_mean": {}, "timesteps_since_restore": 1916411, "episode_len_mean": 700.0, "episode_reward_min": 942.6674070568984, "hostname": "flow-main", "time_this_iter_s": 41.02160882949829, "custom_metrics": {"cost2_mean": -38.14072952794095, "system_level_velocity_max": 13.085550290470456, "cost2_max": -32.395280701688264, "outflow_rate_max": 985.2257580429963, "cost2_min": -44.724623302794754, "cost1_mean": 282.69499192351543, "system_level_velocity_mean": 10.540870225819338, "outflow_rate_min": 796.3746502172606, "cost1_max": 347.8232985315125, "outflow_rate_mean": 862.5525488887544, "cost1_min": 231.1539031356898, "system_level_velocity_min": 8.493522997058593}, "episodes_total": 798, "timesteps_this_iter": 114303, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 16, "timesteps_total": 1916411, "date": "2019-04-28_12-02-06", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1916411, "load_time_ms": 18.567, "grad_time_ms": 26774.857, "update_time_ms": 11.178, "num_steps_trained": 1916411, "default": {"total_loss": 22.12397003173828, "cur_lr": 0.0005000000237487257, "entropy": 1.2694785594940186, "vf_loss": 22.123573303222656, "kl": 0.006194991525262594, "vf_explained_var": 0.5429011583328247, "cur_kl_coeff": 0.05000000819563866, "policy_loss": 8.974000229500234e-05}, "sample_time_ms": 15794.896}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e4a8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e3c8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 60, "time_total_s": 713.7186076641083, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452926, "episode_reward_mean": 1001.4884161179257}
{"training_iteration": 17, "time_since_restore": 754.562177658081, "episode_reward_max": 1103.6249381345679, "policy_reward_mean": {}, "timesteps_since_restore": 2029741, "episode_len_mean": 700.0, "episode_reward_min": 950.0947718548756, "hostname": "flow-main", "time_this_iter_s": 40.84356999397278, "custom_metrics": {"cost2_mean": -39.680740181153325, "system_level_velocity_max": 13.415391664444687, "cost2_max": -33.38167230471133, "outflow_rate_max": 988.6850984396879, "cost2_min": -45.6796744877075, "cost1_min": 231.1539031356898, "system_level_velocity_mean": 10.895365878759446, "outflow_rate_min": 798.4659441950658, "cost1_max": 357.35928810906853, "outflow_rate_mean": 884.6429246244458, "cost1_mean": 292.20491234959985, "system_level_velocity_min": 8.493522997058593}, "episodes_total": 852, "timesteps_this_iter": 113330, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 17, "timesteps_total": 2029741, "date": "2019-04-28_12-02-47", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2029741, "load_time_ms": 18.356, "grad_time_ms": 26537.567, "update_time_ms": 11.318, "num_steps_trained": 2029741, "default": {"total_loss": 21.209121704101562, "cur_lr": 0.0005000000237487257, "entropy": 1.255434513092041, "vf_loss": 21.209985733032227, "kl": 0.0071079605259001255, "vf_explained_var": 0.599251389503479, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0012217822950333357}, "sample_time_ms": 15615.203}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ec88>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e908>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 54, "time_total_s": 754.562177658081, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556452967, "episode_reward_mean": 1019.7548163348815}
{"training_iteration": 18, "time_since_restore": 794.8919720649719, "episode_reward_max": 1088.0800697197014, "policy_reward_mean": {}, "timesteps_since_restore": 2143478, "episode_len_mean": 700.0, "episode_reward_min": 945.8454149731673, "hostname": "flow-main", "time_this_iter_s": 40.32979440689087, "custom_metrics": {"cost2_mean": -39.497985219132744, "system_level_velocity_max": 13.708225528583041, "cost2_max": -34.52545741516947, "outflow_rate_max": 984.8028027576576, "cost2_min": -45.6796744877075, "cost1_mean": 297.2542751229241, "system_level_velocity_mean": 11.090039383966815, "outflow_rate_min": 798.4659441950658, "cost1_max": 365.82424537811255, "outflow_rate_mean": 893.1944151254386, "cost1_min": 246.7110395506864, "system_level_velocity_min": 9.16872600049742}, "episodes_total": 904, "timesteps_this_iter": 113737, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 18, "timesteps_total": 2143478, "date": "2019-04-28_12-03-27", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2143478, "load_time_ms": 18.248, "grad_time_ms": 26071.27, "update_time_ms": 11.603, "num_steps_trained": 2143478, "default": {"total_loss": 22.138151168823242, "cur_lr": 0.0005000000237487257, "entropy": 1.2622606754302979, "vf_loss": 22.138050079345703, "kl": 0.006046684924513102, "vf_explained_var": 0.5793130993843079, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0001993774640141055}, "sample_time_ms": 15519.391}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e5c0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e630>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 52, "time_total_s": 794.8919720649719, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453007, "episode_reward_mean": 1023.8023681345691}
{"training_iteration": 19, "time_since_restore": 835.6508002281189, "episode_reward_max": 1093.5745012391026, "policy_reward_mean": {}, "timesteps_since_restore": 2257884, "episode_len_mean": 700.0, "episode_reward_min": 940.9197888451167, "hostname": "flow-main", "time_this_iter_s": 40.75882816314697, "custom_metrics": {"cost2_mean": -37.559519364693365, "system_level_velocity_max": 13.057761882169975, "cost2_max": -30.407208000634117, "outflow_rate_max": 983.1247806874924, "cost2_min": -45.32665682196086, "cost1_mean": 293.23962747536893, "system_level_velocity_mean": 10.950445622108738, "outflow_rate_min": 802.9895002041865, "cost1_max": 348.608675536104, "outflow_rate_mean": 882.9095911139735, "cost1_min": 239.74645393618147, "system_level_velocity_min": 8.884413764658108}, "episodes_total": 964, "timesteps_this_iter": 114406, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 19, "timesteps_total": 2257884, "date": "2019-04-28_12-04-08", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2257884, "load_time_ms": 18.169, "grad_time_ms": 25625.913, "update_time_ms": 11.598, "num_steps_trained": 2257884, "default": {"total_loss": 24.685501098632812, "cur_lr": 0.0005000000237487257, "entropy": 1.2597602605819702, "vf_loss": 24.68585968017578, "kl": 0.006321558263152838, "vf_explained_var": 0.5465452075004578, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0006783496937714517}, "sample_time_ms": 15507.053}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ba90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b358>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 60, "time_total_s": 835.6508002281189, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453048, "episode_reward_mean": 1012.4072479095922}
{"training_iteration": 20, "time_since_restore": 876.0710291862488, "episode_reward_max": 1134.1314396705425, "policy_reward_mean": {}, "timesteps_since_restore": 2371031, "episode_len_mean": 700.0, "episode_reward_min": 940.9197888451167, "hostname": "flow-main", "time_this_iter_s": 40.42022895812988, "custom_metrics": {"cost2_mean": -35.65115629113113, "system_level_velocity_max": 14.518679240076084, "cost2_max": -27.025468723744837, "outflow_rate_max": 999.2747853687288, "cost2_min": -42.76365514474783, "cost1_mean": 303.37829321951705, "system_level_velocity_mean": 11.344769615903607, "outflow_rate_min": 799.1867448885616, "cost1_max": 383.0721827175936, "outflow_rate_mean": 893.321659098705, "cost1_min": 239.74645393618147, "system_level_velocity_min": 8.884413764658108}, "episodes_total": 1012, "timesteps_this_iter": 113147, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 20, "timesteps_total": 2371031, "date": "2019-04-28_12-04-49", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2371031, "load_time_ms": 18.825, "grad_time_ms": 25345.296, "update_time_ms": 11.535, "num_steps_trained": 2371031, "default": {"total_loss": 22.82782554626465, "cur_lr": 0.0005000000237487257, "entropy": 1.2554824352264404, "vf_loss": 22.82882308959961, "kl": 0.007912822999060154, "vf_explained_var": 0.6069974899291992, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0013940681237727404}, "sample_time_ms": 15292.391}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e780>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ee48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ed68>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 48, "time_total_s": 876.0710291862488, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453089, "episode_reward_mean": 1022.0699153483688}
{"training_iteration": 21, "time_since_restore": 917.1507573127747, "episode_reward_max": 1134.1314396705425, "policy_reward_mean": {}, "timesteps_since_restore": 2483543, "episode_len_mean": 700.0, "episode_reward_min": 934.6300576613473, "hostname": "flow-main", "time_this_iter_s": 41.07972812652588, "custom_metrics": {"cost2_mean": -32.739403956488765, "system_level_velocity_max": 14.671294808733661, "cost2_max": -26.510071070783894, "outflow_rate_max": 1002.0498015689949, "cost2_min": -41.028413049173665, "cost1_mean": 306.4637591301713, "system_level_velocity_mean": 11.470827202844776, "outflow_rate_min": 799.1867448885616, "cost1_max": 388.2295473617466, "outflow_rate_mean": 889.3265338986494, "cost1_min": 251.36059234510017, "system_level_velocity_min": 9.340855617583156}, "episodes_total": 1076, "timesteps_this_iter": 112512, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 21, "timesteps_total": 2483543, "date": "2019-04-28_12-05-30", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2483543, "load_time_ms": 18.688, "grad_time_ms": 25209.657, "update_time_ms": 11.508, "num_steps_trained": 2483543, "default": {"total_loss": 28.38728904724121, "cur_lr": 0.0005000000237487257, "entropy": 1.2455551624298096, "vf_loss": 28.38779067993164, "kl": 0.006752838846296072, "vf_explained_var": 0.5875592827796936, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0008360707433894277}, "sample_time_ms": 15392.943}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ebe0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ef98>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 64, "time_total_s": 917.1507573127747, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453130, "episode_reward_mean": 1017.4797841603796}
{"training_iteration": 22, "time_since_restore": 957.0852012634277, "episode_reward_max": 1112.7333964239995, "policy_reward_mean": {}, "timesteps_since_restore": 2593926, "episode_len_mean": 700.0, "episode_reward_min": 934.6300576613473, "hostname": "flow-main", "time_this_iter_s": 39.934443950653076, "custom_metrics": {"cost2_mean": -30.741923454874723, "system_level_velocity_max": 15.035204599025723, "cost2_max": -26.78509348265549, "outflow_rate_max": 1010.3554726762172, "cost2_min": -40.96681547159756, "cost1_mean": 311.8567980136658, "system_level_velocity_mean": 11.687960339107851, "outflow_rate_min": 799.6428660519915, "cost1_max": 400.2719178043618, "outflow_rate_mean": 889.7317005550755, "cost1_min": 251.36059234510017, "system_level_velocity_min": 9.340855617583156}, "episodes_total": 1131, "timesteps_this_iter": 110383, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 22, "timesteps_total": 2593926, "date": "2019-04-28_12-06-10", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2593926, "load_time_ms": 17.67, "grad_time_ms": 25062.452, "update_time_ms": 11.547, "num_steps_trained": 2593926, "default": {"total_loss": 26.98027992248535, "cur_lr": 0.0005000000237487257, "entropy": 1.2441610097885132, "vf_loss": 26.980712890625, "kl": 0.006940639577805996, "vf_explained_var": 0.6470589637756348, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0007805264322087169}, "sample_time_ms": 15429.762}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e3c8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ef28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e7b8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 55, "time_total_s": 957.0852012634277, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453170, "episode_reward_mean": 1011.6185379790749}
{"training_iteration": 23, "time_since_restore": 997.7335524559021, "episode_reward_max": 1108.7167892677405, "policy_reward_mean": {}, "timesteps_since_restore": 2704692, "episode_len_mean": 700.0, "episode_reward_min": 928.6026874857016, "hostname": "flow-main", "time_this_iter_s": 40.648351192474365, "custom_metrics": {"cost2_mean": -28.817555631619793, "system_level_velocity_max": 15.305742974062007, "cost2_max": -23.660894663500713, "outflow_rate_max": 1010.3554726762172, "cost2_min": -34.47309402452656, "cost1_mean": 321.42735738264025, "system_level_velocity_mean": 12.080630382877093, "outflow_rate_min": 813.7455596569351, "cost1_max": 402.9233722663462, "outflow_rate_mean": 896.2563945906096, "cost1_min": 249.89451873896428, "system_level_velocity_min": 9.21207022292189}, "episodes_total": 1192, "timesteps_this_iter": 110766, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 23, "timesteps_total": 2704692, "date": "2019-04-28_12-06-50", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2704692, "load_time_ms": 16.615, "grad_time_ms": 24966.583, "update_time_ms": 11.531, "num_steps_trained": 2704692, "default": {"total_loss": 31.572059631347656, "cur_lr": 0.0005000000237487257, "entropy": 1.2486616373062134, "vf_loss": 31.572172164916992, "kl": 0.006972678005695343, "vf_explained_var": 0.618633508682251, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.000462966097984463}, "sample_time_ms": 15482.072}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e860>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915eeb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ca90>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 61, "time_total_s": 997.7335524559021, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453210, "episode_reward_mean": 1007.2678614221618}
{"training_iteration": 24, "time_since_restore": 1037.0648348331451, "episode_reward_max": 1093.8291554603286, "policy_reward_mean": {}, "timesteps_since_restore": 2813531, "episode_len_mean": 700.0, "episode_reward_min": 928.6026874857016, "hostname": "flow-main", "time_this_iter_s": 39.33128237724304, "custom_metrics": {"cost2_mean": -27.979372813682776, "system_level_velocity_max": 15.273496010796963, "cost2_max": -22.573919031537148, "outflow_rate_max": 1004.5285992123088, "cost2_min": -34.47309402452656, "cost1_mean": 325.4763771965872, "system_level_velocity_mean": 12.239596550841702, "outflow_rate_min": 813.2128910357688, "cost1_max": 402.9233722663462, "outflow_rate_mean": 890.8715372785367, "cost1_min": 249.89451873896428, "system_level_velocity_min": 9.21207022292189}, "episodes_total": 1249, "timesteps_this_iter": 108839, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 24, "timesteps_total": 2813531, "date": "2019-04-28_12-07-30", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2813531, "load_time_ms": 15.571, "grad_time_ms": 24809.92, "update_time_ms": 11.726, "num_steps_trained": 2813531, "default": {"total_loss": 32.98707580566406, "cur_lr": 0.0005000000237487257, "entropy": 1.2380454540252686, "vf_loss": 32.98721694946289, "kl": 0.0068671246990561485, "vf_explained_var": 0.6156191229820251, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00047637688112445176}, "sample_time_ms": 15303.633}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e550>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ee48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e630>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 57, "time_total_s": 1037.0648348331451, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453250, "episode_reward_mean": 997.4268287470658}
{"training_iteration": 25, "time_since_restore": 1077.1578006744385, "episode_reward_max": 1093.8291554603286, "policy_reward_mean": {}, "timesteps_since_restore": 2920411, "episode_len_mean": 693.37, "episode_reward_min": 54.32612074191389, "hostname": "flow-main", "time_this_iter_s": 40.092965841293335, "custom_metrics": {"cost2_mean": -27.15138674992853, "system_level_velocity_max": 17.7923627769908, "cost2_max": -15.1187181079076, "outflow_rate_max": 1015.7274415515402, "cost2_min": -33.93709179909442, "cost1_mean": 342.9509376054124, "system_level_velocity_mean": 13.097859388229057, "outflow_rate_min": 496.2871102902245, "cost1_max": 410.658564196366, "outflow_rate_mean": 894.7224239771843, "cost1_min": 23.249079107655174, "system_level_velocity_min": 9.970421125893267}, "episodes_total": 1315, "timesteps_this_iter": 106880, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 25, "timesteps_total": 2920411, "date": "2019-04-28_12-08-10", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2920411, "load_time_ms": 15.495, "grad_time_ms": 24885.463, "update_time_ms": 11.854, "num_steps_trained": 2920411, "default": {"total_loss": 38.01339340209961, "cur_lr": 0.0005000000237487257, "entropy": 1.2408244609832764, "vf_loss": 38.01435852050781, "kl": 0.008591393008828163, "vf_explained_var": 0.5004457235336304, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.001390468911267817}, "sample_time_ms": 15310.862}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e0f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e7f0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 66, "time_total_s": 1077.1578006744385, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453290, "episode_reward_mean": 976.1635245868569}
{"training_iteration": 26, "time_since_restore": 1114.9087817668915, "episode_reward_max": 1051.3173990748305, "policy_reward_mean": {}, "timesteps_since_restore": 3027364, "episode_len_mean": 693.37, "episode_reward_min": 54.32612074191389, "hostname": "flow-main", "time_this_iter_s": 37.750981092453, "custom_metrics": {"cost2_mean": -26.006996643364293, "system_level_velocity_max": 17.7923627769908, "cost2_max": -15.1187181079076, "outflow_rate_max": 1015.7274415515402, "cost2_min": -31.778010435078983, "cost1_mean": 338.7478118900614, "system_level_velocity_mean": 12.948015148694495, "outflow_rate_min": 496.2871102902245, "cost1_max": 414.1207744059015, "outflow_rate_mean": 876.3103982736691, "cost1_min": 23.249079107655174, "system_level_velocity_min": 9.970421125893267}, "episodes_total": 1375, "timesteps_this_iter": 106953, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 26, "timesteps_total": 3027364, "date": "2019-04-28_12-08-48", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3027364, "load_time_ms": 13.989, "grad_time_ms": 24717.088, "update_time_ms": 12.045, "num_steps_trained": 3027364, "default": {"total_loss": 35.38351058959961, "cur_lr": 0.0005000000237487257, "entropy": 1.244043231010437, "vf_loss": 35.384056091308594, "kl": 0.006791206076741219, "vf_explained_var": 0.4802993834018707, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0008875163621269166}, "sample_time_ms": 15155.075}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e5c0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ef28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e780>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 60, "time_total_s": 1114.9087817668915, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453328, "episode_reward_mean": 954.6808363607915}
{"training_iteration": 27, "time_since_restore": 1154.0679364204407, "episode_reward_max": 1055.9366247132516, "policy_reward_mean": {}, "timesteps_since_restore": 3133972, "episode_len_mean": 693.38, "episode_reward_min": 55.57243312089126, "hostname": "flow-main", "time_this_iter_s": 39.159154653549194, "custom_metrics": {"cost2_mean": -25.593296003976185, "system_level_velocity_max": 17.440674315983006, "cost2_max": -14.566328054132619, "outflow_rate_max": 981.8321422988926, "cost2_min": -30.37402026938159, "cost1_mean": 343.57997618480897, "system_level_velocity_mean": 13.14833242336207, "outflow_rate_min": 490.94743932065984, "cost1_max": 414.1207744059015, "outflow_rate_mean": 877.5620268995555, "cost1_min": 23.43375653275979, "system_level_velocity_min": 10.427526161582394}, "episodes_total": 1438, "timesteps_this_iter": 106608, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 27, "timesteps_total": 3133972, "date": "2019-04-28_12-09-27", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3133972, "load_time_ms": 14.841, "grad_time_ms": 24530.304, "update_time_ms": 11.995, "num_steps_trained": 3133972, "default": {"total_loss": 38.338157653808594, "cur_lr": 0.0005000000237487257, "entropy": 1.2203527688980103, "vf_loss": 38.33879852294922, "kl": 0.007500195875763893, "vf_explained_var": 0.4652317762374878, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0010163525585085154}, "sample_time_ms": 15171.036}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6080>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e2b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 63, "time_total_s": 1154.0679364204407, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453367, "episode_reward_mean": 960.6542965774205}
{"training_iteration": 28, "time_since_restore": 1192.1839592456818, "episode_reward_max": 1087.0729049051458, "policy_reward_mean": {}, "timesteps_since_restore": 3242414, "episode_len_mean": 686.76, "episode_reward_min": 55.0075083434786, "hostname": "flow-main", "time_this_iter_s": 38.11602282524109, "custom_metrics": {"cost2_mean": -27.13014524045843, "system_level_velocity_max": 17.55344184876235, "cost2_max": -14.566328054132619, "outflow_rate_max": 1003.6991335720129, "cost2_min": -39.72860442440446, "cost1_mean": 344.95372551011036, "system_level_velocity_mean": 13.363955694118523, "outflow_rate_min": 490.94743932065984, "cost1_max": 416.29911274285337, "outflow_rate_mean": 883.885110887128, "cost1_min": 23.43375653275979, "system_level_velocity_min": 10.649923364183893}, "episodes_total": 1501, "timesteps_this_iter": 108442, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 28, "timesteps_total": 3242414, "date": "2019-04-28_12-10-05", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3242414, "load_time_ms": 14.551, "grad_time_ms": 24329.226, "update_time_ms": 12.084, "num_steps_trained": 3242414, "default": {"total_loss": 39.080657958984375, "cur_lr": 0.0005000000237487257, "entropy": 1.190497875213623, "vf_loss": 39.08123016357422, "kl": 0.008121803402900696, "vf_explained_var": 0.5230706930160522, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0009735791827552021}, "sample_time_ms": 15150.867}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b898>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b278>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 63, "time_total_s": 1192.1839592456818, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453405, "episode_reward_mean": 965.8297572744558}
{"training_iteration": 29, "time_since_restore": 1231.8012976646423, "episode_reward_max": 1107.0342993291385, "policy_reward_mean": {}, "timesteps_since_restore": 3349940, "episode_len_mean": 693.38, "episode_reward_min": 55.0075083434786, "hostname": "flow-main", "time_this_iter_s": 39.61733841896057, "custom_metrics": {"cost2_mean": -30.457290406359565, "system_level_velocity_max": 17.55344184876235, "cost2_max": -15.015235872231152, "outflow_rate_max": 1009.1784757456365, "cost2_min": -49.78105046944387, "cost1_mean": 345.6753312355041, "system_level_velocity_mean": 13.220886331824824, "outflow_rate_min": 495.83754333076394, "cost1_max": 421.1730913680925, "outflow_rate_mean": 898.3296203631901, "cost1_min": 23.529658322225185, "system_level_velocity_min": 9.797122039751663}, "episodes_total": 1564, "timesteps_this_iter": 107526, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 29, "timesteps_total": 3349940, "date": "2019-04-28_12-10-45", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3349940, "load_time_ms": 14.545, "grad_time_ms": 24218.747, "update_time_ms": 12.099, "num_steps_trained": 3349940, "default": {"total_loss": 37.30742645263672, "cur_lr": 0.0005000000237487257, "entropy": 1.174999475479126, "vf_loss": 37.30787658691406, "kl": 0.007292190100997686, "vf_explained_var": 0.5900368094444275, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0008146807667799294}, "sample_time_ms": 15147.747}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e60f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e61d0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 63, "time_total_s": 1231.8012976646423, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453445, "episode_reward_mean": 982.3240479001848}
{"training_iteration": 30, "time_since_restore": 1271.0460259914398, "episode_reward_max": 1107.0342993291385, "policy_reward_mean": {}, "timesteps_since_restore": 3456586, "episode_len_mean": 700.0, "episode_reward_min": 879.7830223490798, "hostname": "flow-main", "time_this_iter_s": 39.244728326797485, "custom_metrics": {"cost2_mean": -30.29280934561921, "system_level_velocity_max": 16.092189733355497, "cost2_max": -24.40257477051251, "outflow_rate_max": 996.6742589344955, "cost2_min": -49.78105046944387, "cost1_mean": 350.7237796875668, "system_level_velocity_mean": 13.24828501152971, "outflow_rate_min": 815.4078740355292, "cost1_max": 413.4146644395749, "outflow_rate_mean": 903.9285434246826, "cost1_min": 260.6611388285289, "system_level_velocity_min": 9.797122039751663}, "episodes_total": 1629, "timesteps_this_iter": 106646, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 30, "timesteps_total": 3456586, "date": "2019-04-28_12-11-24", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3456586, "load_time_ms": 13.464, "grad_time_ms": 24083.099, "update_time_ms": 12.203, "num_steps_trained": 3456586, "default": {"total_loss": 38.056453704833984, "cur_lr": 0.0005000000237487257, "entropy": 1.1765739917755127, "vf_loss": 38.0570068359375, "kl": 0.008571527898311615, "vf_explained_var": 0.5455411076545715, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.000980993383564055}, "sample_time_ms": 15166.737}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e630>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e3c8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 65, "time_total_s": 1271.0460259914398, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453484, "episode_reward_mean": 987.9307608651498}
{"training_iteration": 31, "time_since_restore": 1310.3655271530151, "episode_reward_max": 1072.8166883134966, "policy_reward_mean": {}, "timesteps_since_restore": 3564422, "episode_len_mean": 700.0, "episode_reward_min": 895.170233845993, "hostname": "flow-main", "time_this_iter_s": 39.31950116157532, "custom_metrics": {"cost2_mean": -28.206389846885223, "system_level_velocity_max": 16.051124284728182, "cost2_max": -24.018858834201783, "outflow_rate_max": 994.0287621247222, "cost2_min": -38.415610271410664, "cost1_mean": 350.3541381074151, "system_level_velocity_mean": 13.224558206038749, "outflow_rate_min": 810.1900526884177, "cost1_max": 418.4190253441328, "outflow_rate_mean": 897.8802876731777, "cost1_min": 270.60368197712967, "system_level_velocity_min": 10.14505424338312}, "episodes_total": 1690, "timesteps_this_iter": 107836, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 31, "timesteps_total": 3564422, "date": "2019-04-28_12-12-03", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3564422, "load_time_ms": 12.642, "grad_time_ms": 23966.072, "update_time_ms": 12.249, "num_steps_trained": 3564422, "default": {"total_loss": 37.275672912597656, "cur_lr": 0.0005000000237487257, "entropy": 1.1672955751419067, "vf_loss": 37.276893615722656, "kl": 0.00844809040427208, "vf_explained_var": 0.5542258024215698, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00164358492475003}, "sample_time_ms": 15107.855}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e60b8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 61, "time_total_s": 1310.3655271530151, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453523, "episode_reward_mean": 983.6932447820352}
{"training_iteration": 32, "time_since_restore": 1349.391924381256, "episode_reward_max": 1072.8166883134966, "policy_reward_mean": {}, "timesteps_since_restore": 3671871, "episode_len_mean": 693.38, "episode_reward_min": 56.35384184985812, "hostname": "flow-main", "time_this_iter_s": 39.02639722824097, "custom_metrics": {"cost2_mean": -27.23750931328414, "system_level_velocity_max": 17.748985563627688, "cost2_max": -14.936342713680027, "outflow_rate_max": 987.2274866218338, "cost2_min": -35.80764242312888, "cost1_mean": 345.10798846625903, "system_level_velocity_mean": 13.186785596324349, "outflow_rate_min": 496.3206105869156, "cost1_max": 412.4814664434722, "outflow_rate_mean": 886.9752829533589, "cost1_min": 23.803111006759842, "system_level_velocity_min": 10.12585423312174}, "episodes_total": 1756, "timesteps_this_iter": 107449, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 32, "timesteps_total": 3671871, "date": "2019-04-28_12-12-42", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3671871, "load_time_ms": 13.469, "grad_time_ms": 23790.309, "update_time_ms": 12.377, "num_steps_trained": 3671871, "default": {"total_loss": 39.655067443847656, "cur_lr": 0.0005000000237487257, "entropy": 1.1747863292694092, "vf_loss": 39.65625, "kl": 0.008078997023403645, "vf_explained_var": 0.5422690510749817, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0015868498012423515}, "sample_time_ms": 15191.589}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e630>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e3c8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 66, "time_total_s": 1349.391924381256, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453562, "episode_reward_mean": 965.6821886657889}
{"training_iteration": 33, "time_since_restore": 1390.6143662929535, "episode_reward_max": 1073.183141949489, "policy_reward_mean": {}, "timesteps_since_restore": 3779437, "episode_len_mean": 693.38, "episode_reward_min": 56.35384184985812, "hostname": "flow-main", "time_this_iter_s": 41.22244191169739, "custom_metrics": {"cost2_mean": -27.46139500181765, "system_level_velocity_max": 17.748985563627688, "cost2_max": -14.936342713680027, "outflow_rate_max": 975.5831384428375, "cost2_min": -36.816471518225626, "cost1_mean": 332.85603047087267, "system_level_velocity_mean": 12.723131854982327, "outflow_rate_min": 496.3206105869156, "cost1_max": 412.46811770029797, "outflow_rate_mean": 874.6644714631303, "cost1_min": 23.803111006759842, "system_level_velocity_min": 10.12585423312174}, "episodes_total": 1819, "timesteps_this_iter": 107566, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 33, "timesteps_total": 3779437, "date": "2019-04-28_12-13-24", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3779437, "load_time_ms": 13.548, "grad_time_ms": 23921.192, "update_time_ms": 12.554, "num_steps_trained": 3779437, "default": {"total_loss": 38.713584899902344, "cur_lr": 0.0005000000237487257, "entropy": 1.1602908372879028, "vf_loss": 38.71420669555664, "kl": 0.006573710590600967, "vf_explained_var": 0.6099383234977722, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0009501204476691782}, "sample_time_ms": 15119.521}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e65f8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6748>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 63, "time_total_s": 1390.6143662929535, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453604, "episode_reward_mean": 961.7469100260054}
{"training_iteration": 34, "time_since_restore": 1430.1333620548248, "episode_reward_max": 1069.2137032217195, "policy_reward_mean": {}, "timesteps_since_restore": 3886628, "episode_len_mean": 700.0, "episode_reward_min": 909.691514668586, "hostname": "flow-main", "time_this_iter_s": 39.51899576187134, "custom_metrics": {"cost2_mean": -27.976251435016948, "system_level_velocity_max": 16.32807402045429, "cost2_max": -23.32653352011983, "outflow_rate_max": 992.8373763664966, "cost2_min": -39.15344704776305, "cost1_mean": 343.3321392268179, "system_level_velocity_mean": 12.968049486057264, "outflow_rate_min": 814.1395276058083, "cost1_max": 422.02554570800515, "outflow_rate_mean": 888.7260910511752, "cost1_min": 276.31350724721494, "system_level_velocity_min": 10.382315560986358}, "episodes_total": 1883, "timesteps_this_iter": 107191, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 34, "timesteps_total": 3886628, "date": "2019-04-28_12-14-03", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3886628, "load_time_ms": 13.489, "grad_time_ms": 23871.652, "update_time_ms": 12.695, "num_steps_trained": 3886628, "default": {"total_loss": 42.83867263793945, "cur_lr": 0.0005000000237487257, "entropy": 1.1711061000823975, "vf_loss": 42.83987808227539, "kl": 0.009292476810514927, "vf_explained_var": 0.5655198097229004, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0016667147865518928}, "sample_time_ms": 15187.858}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ee48>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915eba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ed68>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 64, "time_total_s": 1430.1333620548248, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453643, "episode_reward_mean": 978.2359248450257}
{"training_iteration": 35, "time_since_restore": 1470.1028184890747, "episode_reward_max": 1085.6896841062337, "policy_reward_mean": {}, "timesteps_since_restore": 3994400, "episode_len_mean": 700.0, "episode_reward_min": 908.6933620281349, "hostname": "flow-main", "time_this_iter_s": 39.96945643424988, "custom_metrics": {"cost2_mean": -28.9756373889754, "system_level_velocity_max": 16.244489495134445, "cost2_max": -23.718020486861832, "outflow_rate_max": 990.7307740291477, "cost2_min": -57.592060026235444, "cost1_mean": 353.29872722006, "system_level_velocity_mean": 13.36709039025965, "outflow_rate_min": 815.882076752367, "cost1_max": 418.7872387101802, "outflow_rate_mean": 903.7673254561709, "cost1_min": 269.5385524147214, "system_level_velocity_min": 10.16289312237533}, "episodes_total": 1945, "timesteps_this_iter": 107772, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 35, "timesteps_total": 3994400, "date": "2019-04-28_12-14-43", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3994400, "load_time_ms": 13.496, "grad_time_ms": 23823.41, "update_time_ms": 12.673, "num_steps_trained": 3994400, "default": {"total_loss": 40.13507843017578, "cur_lr": 0.0005000000237487257, "entropy": 1.1644924879074097, "vf_loss": 40.136253356933594, "kl": 0.008338875137269497, "vf_explained_var": 0.5658908486366272, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00159460271243006}, "sample_time_ms": 15223.754}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6e80>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e62b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6128>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 62, "time_total_s": 1470.1028184890747, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453683, "episode_reward_mean": 983.7425097565492}
{"training_iteration": 36, "time_since_restore": 1509.0680749416351, "episode_reward_max": 1085.6896841062337, "policy_reward_mean": {}, "timesteps_since_restore": 4100994, "episode_len_mean": 700.0, "episode_reward_min": 908.4484941137401, "hostname": "flow-main", "time_this_iter_s": 38.965256452560425, "custom_metrics": {"cost2_mean": -30.523873262797927, "system_level_velocity_max": 16.358175966478846, "cost2_max": -24.117059320334732, "outflow_rate_max": 995.599310624602, "cost2_min": -48.75694905923891, "cost1_mean": 348.94097405158317, "system_level_velocity_mean": 13.179233292649398, "outflow_rate_min": 818.5964330602776, "cost1_max": 425.38284515546894, "outflow_rate_mean": 901.1143194342397, "cost1_min": 276.0440763279016, "system_level_velocity_min": 10.33286419188589}, "episodes_total": 2009, "timesteps_this_iter": 106594, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 36, "timesteps_total": 4100994, "date": "2019-04-28_12-15-22", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4100994, "load_time_ms": 14.956, "grad_time_ms": 23841.018, "update_time_ms": 12.417, "num_steps_trained": 4100994, "default": {"total_loss": 40.96311569213867, "cur_lr": 0.0005000000237487257, "entropy": 1.1518350839614868, "vf_loss": 40.963951110839844, "kl": 0.008304169401526451, "vf_explained_var": 0.605160653591156, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0012467894703149796}, "sample_time_ms": 15326.046}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915eba8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ec88>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 64, "time_total_s": 1509.0680749416351, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453722, "episode_reward_mean": 981.5305056148811}
{"training_iteration": 37, "time_since_restore": 1546.6718599796295, "episode_reward_max": 1073.555007491945, "policy_reward_mean": {}, "timesteps_since_restore": 4205374, "episode_len_mean": 700.0, "episode_reward_min": 870.4088581220784, "hostname": "flow-main", "time_this_iter_s": 37.603785037994385, "custom_metrics": {"cost2_mean": -31.53675026388138, "system_level_velocity_max": 16.54496002041337, "cost2_max": -24.93973219093532, "outflow_rate_max": 1011.7042157120035, "cost2_min": -49.29205017704217, "cost1_mean": 359.72004251682125, "system_level_velocity_mean": 13.607403634373094, "outflow_rate_min": 818.5964330602776, "cost1_max": 427.9685338538803, "outflow_rate_mean": 908.5407712162804, "cost1_min": 276.93741622723144, "system_level_velocity_min": 10.394605517641557}, "episodes_total": 2075, "timesteps_this_iter": 104380, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 37, "timesteps_total": 4205374, "date": "2019-04-28_12-16-00", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4205374, "load_time_ms": 14.143, "grad_time_ms": 23720.087, "update_time_ms": 12.322, "num_steps_trained": 4205374, "default": {"total_loss": 45.98308181762695, "cur_lr": 0.0005000000237487257, "entropy": 1.1351109743118286, "vf_loss": 45.98411560058594, "kl": 0.009258869104087353, "vf_explained_var": 0.49281418323516846, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0014905149582773447}, "sample_time_ms": 15293.327}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6128>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e61d0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 66, "time_total_s": 1546.6718599796295, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453760, "episode_reward_mean": 975.2521465706071}
{"training_iteration": 38, "time_since_restore": 1585.449015378952, "episode_reward_max": 1071.2555599506861, "policy_reward_mean": {}, "timesteps_since_restore": 4311306, "episode_len_mean": 700.0, "episode_reward_min": 870.4088581220784, "hostname": "flow-main", "time_this_iter_s": 38.77715539932251, "custom_metrics": {"cost2_mean": -31.95899515299335, "system_level_velocity_max": 16.589264422395622, "cost2_max": -25.67061223201819, "outflow_rate_max": 999.7592906850774, "cost2_min": -49.29205017704217, "cost1_mean": 370.711499722683, "system_level_velocity_mean": 14.068345525716284, "outflow_rate_min": 819.8206199774744, "cost1_max": 427.2415139004444, "outflow_rate_mean": 915.3512800171713, "cost1_min": 285.99259941901056, "system_level_velocity_min": 10.748730760289586}, "episodes_total": 2141, "timesteps_this_iter": 105932, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 38, "timesteps_total": 4311306, "date": "2019-04-28_12-16-39", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4311306, "load_time_ms": 14.384, "grad_time_ms": 23676.548, "update_time_ms": 12.294, "num_steps_trained": 4311306, "default": {"total_loss": 46.41435623168945, "cur_lr": 0.0005000000237487257, "entropy": 1.1279363632202148, "vf_loss": 46.41606903076172, "kl": 0.011244351044297218, "vf_explained_var": 0.5118291974067688, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0022774250246584415}, "sample_time_ms": 15401.686}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e1d0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915eba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e978>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 66, "time_total_s": 1585.449015378952, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453799, "episode_reward_mean": 977.3870016019816}
{"training_iteration": 39, "time_since_restore": 1626.2475516796112, "episode_reward_max": 1099.1267838311198, "policy_reward_mean": {}, "timesteps_since_restore": 4420772, "episode_len_mean": 693.38, "episode_reward_min": 54.401353791053815, "hostname": "flow-main", "time_this_iter_s": 40.79853630065918, "custom_metrics": {"cost2_mean": -34.54037767098174, "system_level_velocity_max": 17.370337442194838, "cost2_max": -17.026702060822938, "outflow_rate_max": 1013.170678430974, "cost2_min": -62.36991256246567, "cost1_mean": 360.78311836400053, "system_level_velocity_mean": 13.824585808879585, "outflow_rate_min": 492.1257582523173, "cost1_max": 430.0021253103867, "outflow_rate_mean": 913.479136696274, "cost1_min": 23.475044950614986, "system_level_velocity_min": 10.268267985682009}, "episodes_total": 2205, "timesteps_this_iter": 109466, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 39, "timesteps_total": 4420772, "date": "2019-04-28_12-17-19", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4420772, "load_time_ms": 15.191, "grad_time_ms": 23777.86, "update_time_ms": 12.284, "num_steps_trained": 4420772, "default": {"total_loss": 42.194549560546875, "cur_lr": 0.0005000000237487257, "entropy": 1.1057610511779785, "vf_loss": 42.19565963745117, "kl": 0.008227327838540077, "vf_explained_var": 0.649813711643219, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.001523584476672113}, "sample_time_ms": 15417.37}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6908>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6550>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 64, "time_total_s": 1626.2475516796112, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453839, "episode_reward_mean": 981.8047570214254}
{"training_iteration": 40, "time_since_restore": 1665.655553817749, "episode_reward_max": 1099.1267838311198, "policy_reward_mean": {}, "timesteps_since_restore": 4528009, "episode_len_mean": 693.38, "episode_reward_min": 54.401353791053815, "hostname": "flow-main", "time_this_iter_s": 39.40800213813782, "custom_metrics": {"cost2_mean": -38.14921770428731, "system_level_velocity_max": 17.370337442194838, "cost2_max": -17.026702060822938, "outflow_rate_max": 1034.176828066744, "cost2_min": -78.40324913314771, "cost1_mean": 353.8391222020686, "system_level_velocity_mean": 13.506825433743751, "outflow_rate_min": 492.1257582523173, "cost1_max": 430.0021253103867, "outflow_rate_mean": 918.4583466436768, "cost1_min": 23.475044950614986, "system_level_velocity_min": 10.282872038800635}, "episodes_total": 2270, "timesteps_this_iter": 107237, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 40, "timesteps_total": 4528009, "date": "2019-04-28_12-17-59", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4528009, "load_time_ms": 16.018, "grad_time_ms": 23766.905, "update_time_ms": 12.284, "num_steps_trained": 4528009, "default": {"total_loss": 43.73989486694336, "cur_lr": 0.0005000000237487257, "entropy": 1.1112101078033447, "vf_loss": 43.74148178100586, "kl": 0.009802334010601044, "vf_explained_var": 0.6455591320991516, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00207573757506907}, "sample_time_ms": 15442.987}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e780>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ef98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e630>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 65, "time_total_s": 1665.655553817749, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453879, "episode_reward_mean": 997.6160014283023}
{"training_iteration": 41, "time_since_restore": 1706.4724378585815, "episode_reward_max": 1115.1473575675257, "policy_reward_mean": {}, "timesteps_since_restore": 4636204, "episode_len_mean": 700.0, "episode_reward_min": 876.2694506199202, "hostname": "flow-main", "time_this_iter_s": 40.81688404083252, "custom_metrics": {"cost2_mean": -39.89970957851786, "system_level_velocity_max": 16.44210618081016, "cost2_max": -27.829305507590895, "outflow_rate_max": 1028.4865867912092, "cost2_min": -78.40324913314771, "cost1_mean": 353.0837286395027, "system_level_velocity_mean": 13.291426596780536, "outflow_rate_min": 809.5981096278402, "cost1_max": 428.03696946219446, "outflow_rate_mean": 922.5007038269192, "cost1_min": 266.54704752706186, "system_level_velocity_min": 9.973834520557071}, "episodes_total": 2331, "timesteps_this_iter": 108195, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 41, "timesteps_total": 4636204, "date": "2019-04-28_12-18-40", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4636204, "load_time_ms": 16.827, "grad_time_ms": 23830.863, "update_time_ms": 12.631, "num_steps_trained": 4636204, "default": {"total_loss": 42.28294372558594, "cur_lr": 0.0005000000237487257, "entropy": 1.1009165048599243, "vf_loss": 42.28400421142578, "kl": 0.00868828222155571, "vf_explained_var": 0.6394115686416626, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0015023713931441307}, "sample_time_ms": 15527.859}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6748>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6e10>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 61, "time_total_s": 1706.4724378585815, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453920, "episode_reward_mean": 1009.5229129106546}
{"training_iteration": 42, "time_since_restore": 1746.1946697235107, "episode_reward_max": 1111.4221563754807, "policy_reward_mean": {}, "timesteps_since_restore": 4745011, "episode_len_mean": 700.0, "episode_reward_min": 899.5749935826284, "hostname": "flow-main", "time_this_iter_s": 39.7222318649292, "custom_metrics": {"cost2_mean": -38.55018479778806, "system_level_velocity_max": 16.278258027821618, "cost2_max": -26.777347659996227, "outflow_rate_max": 1042.166995598755, "cost2_min": -67.16988028787817, "cost1_mean": 359.5519378957781, "system_level_velocity_mean": 13.528376682032093, "outflow_rate_min": 826.8519457937018, "cost1_max": 428.8328264818215, "outflow_rate_mean": 933.8294551866653, "cost1_min": 272.42884412696844, "system_level_velocity_min": 10.216940756969747}, "episodes_total": 2393, "timesteps_this_iter": 108807, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 42, "timesteps_total": 4745011, "date": "2019-04-28_12-19-19", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4745011, "load_time_ms": 16.13, "grad_time_ms": 23928.581, "update_time_ms": 12.62, "num_steps_trained": 4745011, "default": {"total_loss": 41.53414535522461, "cur_lr": 0.0005000000237487257, "entropy": 1.0884321928024292, "vf_loss": 41.535430908203125, "kl": 0.00947586726397276, "vf_explained_var": 0.656157374382019, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0017587554175406694}, "sample_time_ms": 15501.115}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ec88>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ecf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e160>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 62, "time_total_s": 1746.1946697235107, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556453959, "episode_reward_mean": 1019.8518339820771}
{"training_iteration": 43, "time_since_restore": 1786.6211802959442, "episode_reward_max": 1111.4221563754807, "policy_reward_mean": {}, "timesteps_since_restore": 4853795, "episode_len_mean": 700.0, "episode_reward_min": 890.4213144235563, "hostname": "flow-main", "time_this_iter_s": 40.42651057243347, "custom_metrics": {"cost2_mean": -42.04781231564007, "system_level_velocity_max": 16.278258027821618, "cost2_max": -26.777347659996227, "outflow_rate_max": 1044.960034494689, "cost2_min": -84.8721653682595, "cost1_mean": 350.0058216307497, "system_level_velocity_mean": 13.16176946328463, "outflow_rate_min": 818.5304007193481, "cost1_max": 428.8328264818215, "outflow_rate_mean": 922.1205017548222, "cost1_min": 272.42884412696844, "system_level_velocity_min": 10.216940756969747}, "episodes_total": 2455, "timesteps_this_iter": 108784, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 43, "timesteps_total": 4853795, "date": "2019-04-28_12-20-00", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4853795, "load_time_ms": 17.223, "grad_time_ms": 23798.678, "update_time_ms": 12.358, "num_steps_trained": 4853795, "default": {"total_loss": 40.722450256347656, "cur_lr": 0.0005000000237487257, "entropy": 1.0884547233581543, "vf_loss": 40.723411560058594, "kl": 0.00839381292462349, "vf_explained_var": 0.6956680417060852, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.001383171183988452}, "sample_time_ms": 15550.48}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e63c8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e65f8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 62, "time_total_s": 1786.6211802959442, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556454000, "episode_reward_mean": 1013.7745207498807}
{"training_iteration": 44, "time_since_restore": 1827.250788450241, "episode_reward_max": 1107.346050123249, "policy_reward_mean": {}, "timesteps_since_restore": 4964391, "episode_len_mean": 700.0, "episode_reward_min": 890.4213144235563, "hostname": "flow-main", "time_this_iter_s": 40.629608154296875, "custom_metrics": {"cost2_mean": -48.26366832739228, "system_level_velocity_max": 16.292169997651907, "cost2_max": -29.7105747902146, "outflow_rate_max": 1044.960034494689, "cost2_min": -85.94316939009606, "cost1_mean": 346.7440740404831, "system_level_velocity_mean": 13.047846300525158, "outflow_rate_min": 817.4551678873074, "cost1_max": 428.0139389331964, "outflow_rate_mean": 924.513099969791, "cost1_min": 259.4917759198863, "system_level_velocity_min": 9.83869831478204}, "episodes_total": 2515, "timesteps_this_iter": 110596, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 44, "timesteps_total": 4964391, "date": "2019-04-28_12-20-41", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4964391, "load_time_ms": 18.538, "grad_time_ms": 23907.738, "update_time_ms": 11.944, "num_steps_trained": 4964391, "default": {"total_loss": 41.38425064086914, "cur_lr": 0.0005000000237487257, "entropy": 1.0845963954925537, "vf_loss": 41.385589599609375, "kl": 0.009158296510577202, "vf_explained_var": 0.733458936214447, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0017904734704643488}, "sample_time_ms": 15550.42}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e198>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915efd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915eba8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 60, "time_total_s": 1827.250788450241, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556454041, "episode_reward_mean": 1017.7442650837534}
{"training_iteration": 45, "time_since_restore": 1868.4240095615387, "episode_reward_max": 1123.376225861649, "policy_reward_mean": {}, "timesteps_since_restore": 5076080, "episode_len_mean": 700.0, "episode_reward_min": 908.8960596189067, "hostname": "flow-main", "time_this_iter_s": 41.17322111129761, "custom_metrics": {"cost2_mean": -51.298998123617274, "system_level_velocity_max": 16.35168087809793, "cost2_max": -30.783833590169152, "outflow_rate_max": 1052.0199241451298, "cost2_min": -87.2636433534706, "cost1_mean": 350.2223813419707, "system_level_velocity_mean": 13.17856316106472, "outflow_rate_min": 817.4551678873074, "cost1_max": 428.46050541520793, "outflow_rate_mean": 942.0826670090787, "cost1_min": 259.4917759198863, "system_level_velocity_min": 9.83869831478204}, "episodes_total": 2576, "timesteps_this_iter": 111689, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 45, "timesteps_total": 5076080, "date": "2019-04-28_12-21-22", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5076080, "load_time_ms": 19.804, "grad_time_ms": 24015.454, "update_time_ms": 12.12, "num_steps_trained": 5076080, "default": {"total_loss": 40.4815559387207, "cur_lr": 0.0005000000237487257, "entropy": 1.0798704624176025, "vf_loss": 40.48277282714844, "kl": 0.008512279950082302, "vf_explained_var": 0.7737619280815125, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.001638399320654571}, "sample_time_ms": 15560.835}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6278>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 61, "time_total_s": 1868.4240095615387, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556454082, "episode_reward_mean": 1034.573567994724}
{"training_iteration": 46, "time_since_restore": 1908.4294474124908, "episode_reward_max": 1111.9122338377836, "policy_reward_mean": {}, "timesteps_since_restore": 5185668, "episode_len_mean": 700.0, "episode_reward_min": 913.0804195000248, "hostname": "flow-main", "time_this_iter_s": 40.00543785095215, "custom_metrics": {"cost2_mean": -45.635526577985274, "system_level_velocity_max": 16.54910566740017, "cost2_max": -29.209268071339352, "outflow_rate_max": 1049.0650054707266, "cost2_min": -87.2636433534706, "cost1_mean": 348.303310886464, "system_level_velocity_mean": 13.112944941707957, "outflow_rate_min": 822.0782397159546, "cost1_max": 433.76332311240606, "outflow_rate_mean": 935.8160137532524, "cost1_min": 256.47250364920217, "system_level_velocity_min": 9.636423955658797}, "episodes_total": 2638, "timesteps_this_iter": 109588, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 46, "timesteps_total": 5185668, "date": "2019-04-28_12-22-02", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5185668, "load_time_ms": 19.146, "grad_time_ms": 24111.157, "update_time_ms": 12.189, "num_steps_trained": 5185668, "default": {"total_loss": 43.29515838623047, "cur_lr": 0.0005000000237487257, "entropy": 1.0803141593933105, "vf_loss": 43.29624557495117, "kl": 0.010073980316519737, "vf_explained_var": 0.7190380096435547, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0015920258592814207}, "sample_time_ms": 15569.727}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9123438>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914be48>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 62, "time_total_s": 1908.4294474124908, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556454122, "episode_reward_mean": 1027.8599383517444}
{"training_iteration": 47, "time_since_restore": 1948.543231010437, "episode_reward_max": 1107.7493844970807, "policy_reward_mean": {}, "timesteps_since_restore": 5296420, "episode_len_mean": 700.0, "episode_reward_min": 913.0804195000248, "hostname": "flow-main", "time_this_iter_s": 40.11378359794617, "custom_metrics": {"cost2_mean": -41.77606669620164, "system_level_velocity_max": 16.357949544475208, "cost2_max": -29.347721895288775, "outflow_rate_max": 1043.5408305265062, "cost2_min": -63.60525570145019, "cost1_mean": 346.41488621831553, "system_level_velocity_mean": 13.033047966617733, "outflow_rate_min": 814.5549558880795, "cost1_max": 430.3678874163712, "outflow_rate_mean": 927.3555146293502, "cost1_min": 256.47250364920217, "system_level_velocity_min": 9.636423955658797}, "episodes_total": 2698, "timesteps_this_iter": 110752, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 47, "timesteps_total": 5296420, "date": "2019-04-28_12-22-42", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5296420, "load_time_ms": 19.252, "grad_time_ms": 24314.387, "update_time_ms": 12.232, "num_steps_trained": 5296420, "default": {"total_loss": 42.075469970703125, "cur_lr": 0.0005000000237487257, "entropy": 1.0697849988937378, "vf_loss": 42.07610321044922, "kl": 0.010433832183480263, "vf_explained_var": 0.7100595831871033, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0011515612713992596}, "sample_time_ms": 15617.79}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6630>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e62b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 60, "time_total_s": 1948.543231010437, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556454162, "episode_reward_mean": 1018.7223501066184}
{"training_iteration": 48, "time_since_restore": 1989.4728093147278, "episode_reward_max": 1120.6165323717985, "policy_reward_mean": {}, "timesteps_since_restore": 5407627, "episode_len_mean": 700.0, "episode_reward_min": 912.3318609751329, "hostname": "flow-main", "time_this_iter_s": 40.92957830429077, "custom_metrics": {"cost2_mean": -42.58254811336707, "system_level_velocity_max": 16.421986911188416, "cost2_max": -30.73672041340442, "outflow_rate_max": 1045.6217825853212, "cost2_min": -61.65774331571653, "cost1_mean": 347.86065840222807, "system_level_velocity_mean": 13.086469073654593, "outflow_rate_min": 814.5549558880795, "cost1_max": 429.4555046953727, "outflow_rate_mean": 931.6543559698074, "cost1_min": 259.5658049366641, "system_level_velocity_min": 9.69032634593493}, "episodes_total": 2757, "timesteps_this_iter": 111207, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 48, "timesteps_total": 5407627, "date": "2019-04-28_12-23-23", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5407627, "load_time_ms": 18.256, "grad_time_ms": 24592.959, "update_time_ms": 12.109, "num_steps_trained": 5407627, "default": {"total_loss": 40.07367706298828, "cur_lr": 0.0005000000237487257, "entropy": 1.0622917413711548, "vf_loss": 40.074913024902344, "kl": 0.009387487545609474, "vf_explained_var": 0.7306313514709473, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0017032093601301312}, "sample_time_ms": 15553.286}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6a90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b320>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 59, "time_total_s": 1989.4728093147278, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556454203, "episode_reward_mean": 1024.3378315732296}
{"training_iteration": 49, "time_since_restore": 2030.1442070007324, "episode_reward_max": 1105.485069560714, "policy_reward_mean": {}, "timesteps_since_restore": 5518091, "episode_len_mean": 700.0, "episode_reward_min": 897.734452230227, "hostname": "flow-main", "time_this_iter_s": 40.67139768600464, "custom_metrics": {"cost2_mean": -42.82941823663141, "system_level_velocity_max": 16.30604896776165, "cost2_max": -31.27188047994028, "outflow_rate_max": 1025.4295696551083, "cost2_min": -60.89855523677053, "cost1_mean": 344.58133149055567, "system_level_velocity_mean": 12.973373105948315, "outflow_rate_min": 820.4667419319669, "cost1_max": 422.526438128839, "outflow_rate_mean": 924.7138851386477, "cost1_min": 253.61003082172988, "system_level_velocity_min": 9.493343909777185}, "episodes_total": 2818, "timesteps_this_iter": 110464, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 49, "timesteps_total": 5518091, "date": "2019-04-28_12-24-04", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5518091, "load_time_ms": 17.689, "grad_time_ms": 24600.843, "update_time_ms": 12.37, "num_steps_trained": 5518091, "default": {"total_loss": 39.95077896118164, "cur_lr": 0.0005000000237487257, "entropy": 1.0601686239242554, "vf_loss": 39.95235061645508, "kl": 0.011944282799959183, "vf_explained_var": 0.7289512753486633, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0021718009375035763}, "sample_time_ms": 15532.474}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6b70>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6940>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 61, "time_total_s": 2030.1442070007324, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556454244, "episode_reward_mean": 1014.3216627790102}
{"training_iteration": 50, "time_since_restore": 2071.190102338791, "episode_reward_max": 1090.4104914303127, "policy_reward_mean": {}, "timesteps_since_restore": 5630944, "episode_len_mean": 700.0, "episode_reward_min": 897.734452230227, "hostname": "flow-main", "time_this_iter_s": 41.04589533805847, "custom_metrics": {"cost2_mean": -45.43792873228552, "system_level_velocity_max": 16.084523647231972, "cost2_max": -28.56482495300458, "outflow_rate_max": 1005.7334475750029, "cost2_min": -61.44151391390468, "cost1_mean": 328.883350210018, "system_level_velocity_mean": 12.375378078309204, "outflow_rate_min": 805.3477582235777, "cost1_max": 420.5958143862226, "outflow_rate_mean": 904.273809998593, "cost1_min": 259.2492114971468, "system_level_velocity_min": 9.717056489189293}, "episodes_total": 2878, "timesteps_this_iter": 112853, "experiment_id": "fac9330d2b9c4ed89736c217e7875e38", "iterations_since_restore": 50, "timesteps_total": 5630944, "date": "2019-04-28_12-24-45", "num_metric_batches_dropped": 0, "done": true, "info": {"num_steps_sampled": 5630944, "load_time_ms": 17.118, "grad_time_ms": 24760.791, "update_time_ms": 12.285, "num_steps_trained": 5630944, "default": {"total_loss": 37.80611801147461, "cur_lr": 0.0005000000237487257, "entropy": 1.063476800918579, "vf_loss": 37.80750274658203, "kl": 0.0090100122615695, "vf_explained_var": 0.7542715072631836, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0018343478441238403}, "sample_time_ms": 15536.229}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b668>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bbe0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}, "episodes_this_iter": 60, "time_total_s": 2071.190102338791, "pid": 9780, "node_ip": "10.138.0.2", "timestamp": 1556454285, "episode_reward_mean": 999.8412857748134}

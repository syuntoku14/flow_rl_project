{"training_iteration": 1, "time_since_restore": 73.15065670013428, "episode_reward_max": 443.0575529706146, "policy_reward_mean": {}, "timesteps_since_restore": 117215, "episode_len_mean": 700.0, "episode_reward_min": 204.4358673084642, "hostname": "flow-main", "time_this_iter_s": 73.15065670013428, "custom_metrics": {"cost2_mean": -55.335689609202205, "system_level_velocity_max": 9.521417291489138, "cost2_max": -29.28486732493887, "outflow_rate_max": 706.0418245060101, "cost2_min": -85.72266556927133, "cost1_min": 140.0348437825852, "system_level_velocity_mean": 7.7745109049648855, "outflow_rate_min": 425.1576827749972, "cost1_max": 240.5754561766584, "outflow_rate_mean": 610.9124914275083, "cost1_mean": 200.74938943755998, "system_level_velocity_min": 5.32220178637233}, "episodes_total": 25, "timesteps_this_iter": 117215, "episodes_this_iter": 25, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 1, "timesteps_total": 117215, "date": "2019-04-28_08-25-05", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 117215, "load_time_ms": 59.876, "grad_time_ms": 25372.624, "sample_time_ms": 44460.963, "num_steps_trained": 117215, "update_time_ms": 3014.692, "default": {"total_loss": 1.377540111541748, "kl": 0.00040236132917925715, "entropy": 1.4178673028945923, "vf_loss": 1.377419114112854, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8833220601081848, "cur_kl_coeff": 0.20000003278255463, "policy_loss": 4.045458263135515e-05}}, "episode_reward_mean": 341.79719584770936, "pid": 519, "time_total_s": 73.15065670013428, "node_ip": "10.138.0.2", "timestamp": 1556439905, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c940>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cbe0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 2, "time_since_restore": 113.97990942001343, "episode_reward_max": 507.3921410407538, "policy_reward_mean": {}, "timesteps_since_restore": 236935, "episode_len_mean": 700.0, "episode_reward_min": 204.4358673084642, "hostname": "flow-main", "time_this_iter_s": 40.82925271987915, "custom_metrics": {"cost2_mean": -54.2644542192002, "system_level_velocity_max": 9.521417291489138, "cost2_max": -29.28486732493887, "outflow_rate_max": 776.4476202856346, "cost2_min": -85.72266556927133, "cost1_min": 64.43555841722414, "system_level_velocity_mean": 7.7054853366607885, "outflow_rate_min": 217.12200021275592, "cost1_max": 244.8230219836296, "outflow_rate_mean": 610.8878502628322, "cost1_mean": 199.74197151215944, "system_level_velocity_min": 2.469532290403318}, "episodes_total": 85, "timesteps_this_iter": 119720, "episodes_this_iter": 60, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 2, "timesteps_total": 236935, "date": "2019-04-28_08-25-46", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 236935, "load_time_ms": 41.087, "grad_time_ms": 25034.708, "sample_time_ms": 30172.13, "num_steps_trained": 236935, "update_time_ms": 1513.787, "default": {"total_loss": 1.4918551445007324, "kl": 0.006912485230714083, "entropy": 1.413918137550354, "vf_loss": 1.494398832321167, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9105600118637085, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.003234966192394495}}, "episode_reward_mean": 360.76237253479076, "pid": 519, "time_total_s": 113.97990942001343, "node_ip": "10.138.0.2", "timestamp": 1556439946, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984748>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99846d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99844e0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 3, "time_since_restore": 153.63316130638123, "episode_reward_max": 717.7810728775797, "policy_reward_mean": {}, "timesteps_since_restore": 353933, "episode_len_mean": 700.0, "episode_reward_min": 258.4792908253181, "hostname": "flow-main", "time_this_iter_s": 39.6532518863678, "custom_metrics": {"cost2_mean": -58.742153378197045, "system_level_velocity_max": 11.184496474572887, "cost2_max": -32.46728120216474, "outflow_rate_max": 927.3543387999979, "cost2_min": -112.15419338940376, "cost1_min": 160.60947058176913, "system_level_velocity_mean": 8.268022238198343, "outflow_rate_min": 473.42699286407696, "cost1_max": 296.7009048032073, "outflow_rate_mean": 652.5606178386581, "cost1_mean": 215.2953781827081, "system_level_velocity_min": 6.175878880620437}, "episodes_total": 135, "timesteps_this_iter": 116998, "episodes_this_iter": 50, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 3, "timesteps_total": 353933, "date": "2019-04-28_08-26-26", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 353933, "load_time_ms": 34.791, "grad_time_ms": 25014.943, "sample_time_ms": 24928.546, "num_steps_trained": 353933, "update_time_ms": 1012.539, "default": {"total_loss": 4.357585430145264, "kl": 0.007269412279129028, "entropy": 1.4112824201583862, "vf_loss": 4.360682964324951, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8725783228874207, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.003824353450909257}}, "episode_reward_mean": 437.1289500788933, "pid": 519, "time_total_s": 153.63316130638123, "node_ip": "10.138.0.2", "timestamp": 1556439986, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e550>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e278>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 4, "time_since_restore": 196.89225602149963, "episode_reward_max": 885.1612879577141, "policy_reward_mean": {}, "timesteps_since_restore": 472983, "episode_len_mean": 693.35, "episode_reward_min": 50.395222221581506, "hostname": "flow-main", "time_this_iter_s": 43.25909471511841, "custom_metrics": {"cost2_mean": -78.07470481823343, "system_level_velocity_max": 18.105238061753937, "cost2_max": -19.019284145468838, "outflow_rate_max": 1018.7948985592257, "cost2_min": -127.39063457906983, "cost1_min": 22.447820079073292, "system_level_velocity_mean": 9.746863698001597, "outflow_rate_min": 492.56204323113525, "cost1_max": 335.86635431601036, "outflow_rate_mean": 780.0651394379427, "cost1_mean": 251.77711019549213, "system_level_velocity_min": 6.486997290670326}, "episodes_total": 188, "timesteps_this_iter": 119050, "episodes_this_iter": 53, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 4, "timesteps_total": 472983, "date": "2019-04-28_08-27-09", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 472983, "load_time_ms": 31.678, "grad_time_ms": 25439.274, "sample_time_ms": 22768.361, "num_steps_trained": 472983, "update_time_ms": 761.98, "default": {"total_loss": 9.113174438476562, "kl": 0.0048745605163276196, "entropy": 1.4044641256332397, "vf_loss": 9.11444091796875, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8084210753440857, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0017531743505969644}}, "episode_reward_mean": 614.3119575455667, "pid": 519, "time_total_s": 196.89225602149963, "node_ip": "10.138.0.2", "timestamp": 1556440029, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984400>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99843c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984438>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 5, "time_since_restore": 237.0069830417633, "episode_reward_max": 930.5822145779746, "policy_reward_mean": {}, "timesteps_since_restore": 596338, "episode_len_mean": 686.7, "episode_reward_min": 49.19531204251623, "hostname": "flow-main", "time_this_iter_s": 40.11472702026367, "custom_metrics": {"cost2_mean": -98.92943796601269, "system_level_velocity_max": 18.211795404531543, "cost2_max": -19.019284145468838, "outflow_rate_max": 1055.720165908784, "cost2_min": -139.1725766997162, "cost1_min": 22.447820079073292, "system_level_velocity_mean": 11.126621248941133, "outflow_rate_min": 486.33929757591704, "cost1_max": 343.56039979800823, "outflow_rate_mean": 909.181806810578, "cost1_mean": 285.8530178054032, "system_level_velocity_min": 7.648988371492704}, "episodes_total": 240, "timesteps_this_iter": 123355, "episodes_this_iter": 52, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 5, "timesteps_total": 596338, "date": "2019-04-28_08-27-49", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 596338, "load_time_ms": 30.075, "grad_time_ms": 25317.109, "sample_time_ms": 21217.598, "num_steps_trained": 596338, "update_time_ms": 611.802, "default": {"total_loss": 9.587727546691895, "kl": 0.0038975283969193697, "entropy": 1.4082731008529663, "vf_loss": 9.588334083557129, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8140235543251038, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0008010785095393658}}, "episode_reward_mean": 762.7239370841268, "pid": 519, "time_total_s": 237.0069830417633, "node_ip": "10.138.0.2", "timestamp": 1556440069, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912eac8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912eeb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ebe0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 6, "time_since_restore": 275.3802342414856, "episode_reward_max": 968.9409197105703, "policy_reward_mean": {}, "timesteps_since_restore": 716762, "episode_len_mean": 686.7, "episode_reward_min": 49.19531204251623, "hostname": "flow-main", "time_this_iter_s": 38.37325119972229, "custom_metrics": {"cost2_mean": -107.75351432163362, "system_level_velocity_max": 18.211795404531543, "cost2_max": -19.019284145468838, "outflow_rate_max": 1078.3790852047987, "cost2_min": -141.3961099903837, "cost1_min": 22.447820079073292, "system_level_velocity_mean": 11.324194911439136, "outflow_rate_min": 486.33929757591704, "cost1_max": 352.73343436404616, "outflow_rate_mean": 937.1648923215394, "cost1_mean": 291.8191345086733, "system_level_velocity_min": 7.648988371492704}, "episodes_total": 277, "timesteps_this_iter": 120424, "episodes_this_iter": 37, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 6, "timesteps_total": 716762, "date": "2019-04-28_08-28-28", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 716762, "load_time_ms": 29.045, "grad_time_ms": 25038.171, "sample_time_ms": 20095.511, "num_steps_trained": 716762, "update_time_ms": 511.521, "default": {"total_loss": 9.37717342376709, "kl": 0.005118676461279392, "entropy": 1.4026259183883667, "vf_loss": 9.378271102905273, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8290303945541382, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.00122528662905097}}, "episode_reward_mean": 796.1918043211235, "pid": 519, "time_total_s": 275.3802342414856, "node_ip": "10.138.0.2", "timestamp": 1556440108, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984208>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99847f0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 7, "time_since_restore": 317.4507920742035, "episode_reward_max": 968.9409197105703, "policy_reward_mean": {}, "timesteps_since_restore": 831523, "episode_len_mean": 700.0, "episode_reward_min": 631.0451092776397, "hostname": "flow-main", "time_this_iter_s": 42.070557832717896, "custom_metrics": {"cost2_mean": -108.78547908854149, "system_level_velocity_max": 13.410771998291109, "cost2_max": -58.14277534580862, "outflow_rate_max": 1078.3790852047987, "cost2_min": -152.9796481023329, "cost1_min": 194.9115601952602, "system_level_velocity_mean": 11.360316837316732, "outflow_rate_min": 708.4295285757295, "cost1_max": 352.73343436404616, "outflow_rate_mean": 958.7868616081591, "cost1_mean": 302.28107467554327, "system_level_velocity_min": 7.404026404496808}, "episodes_total": 338, "timesteps_this_iter": 114761, "episodes_this_iter": 61, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 7, "timesteps_total": 831523, "date": "2019-04-28_08-29-10", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 831523, "load_time_ms": 28.375, "grad_time_ms": 25116.973, "sample_time_ms": 19544.391, "num_steps_trained": 831523, "update_time_ms": 440.014, "default": {"total_loss": 12.267464637756348, "kl": 0.007626242935657501, "entropy": 1.3787671327590942, "vf_loss": 12.268494606018066, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7575324177742004, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0012221757788211107}}, "episode_reward_mean": 833.2858425956875, "pid": 519, "time_total_s": 317.4507920742035, "node_ip": "10.138.0.2", "timestamp": 1556440150, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ebe0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e898>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 8, "time_since_restore": 357.7873110771179, "episode_reward_max": 924.4647981277849, "policy_reward_mean": {}, "timesteps_since_restore": 944296, "episode_len_mean": 693.35, "episode_reward_min": 50.153831806287926, "hostname": "flow-main", "time_this_iter_s": 40.33651900291443, "custom_metrics": {"cost2_mean": -92.12845595564796, "system_level_velocity_max": 18.028268627944737, "cost2_max": -22.257539952126677, "outflow_rate_max": 1047.6045126653528, "cost2_min": -151.94333215629806, "cost1_min": 22.49105283177456, "system_level_velocity_mean": 11.60541735273083, "outflow_rate_min": 467.21399731799954, "cost1_max": 352.64503428425974, "outflow_rate_mean": 945.9464236108034, "cost1_mean": 304.2604883537635, "system_level_velocity_min": 7.404026404496808}, "episodes_total": 398, "timesteps_this_iter": 112773, "episodes_this_iter": 60, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 8, "timesteps_total": 944296, "date": "2019-04-28_08-29-50", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 944296, "load_time_ms": 27.584, "grad_time_ms": 24998.274, "sample_time_ms": 19094.386, "num_steps_trained": 944296, "update_time_ms": 386.83, "default": {"total_loss": 13.446758270263672, "kl": 0.0060976725071668625, "entropy": 1.3692295551300049, "vf_loss": 13.447188377380371, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7443304657936096, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0005815045442432165}}, "episode_reward_mean": 832.8005581638522, "pid": 519, "time_total_s": 357.7873110771179, "node_ip": "10.138.0.2", "timestamp": 1556440190, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99845c0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984710>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 9, "time_since_restore": 400.6368820667267, "episode_reward_max": 926.2837984935696, "policy_reward_mean": {}, "timesteps_since_restore": 1058605, "episode_len_mean": 686.7, "episode_reward_min": 49.76291313629518, "hostname": "flow-main", "time_this_iter_s": 42.849570989608765, "custom_metrics": {"cost2_mean": -81.22379756811615, "system_level_velocity_max": 18.028268627944737, "cost2_max": -22.257539952126677, "outflow_rate_max": 1029.3589182013798, "cost2_min": -127.15796997187269, "cost1_min": 22.333391324560562, "system_level_velocity_mean": 12.013302340146993, "outflow_rate_min": 467.21399731799954, "cost1_max": 345.0538917972416, "outflow_rate_mean": 950.995719345235, "cost1_mean": 311.1858684712159, "system_level_velocity_min": 9.608069020450309}, "episodes_total": 459, "timesteps_this_iter": 114309, "episodes_this_iter": 61, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 9, "timesteps_total": 1058605, "date": "2019-04-28_08-30-33", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1058605, "load_time_ms": 27.196, "grad_time_ms": 25186.293, "sample_time_ms": 18739.266, "num_steps_trained": 1058605, "update_time_ms": 345.002, "default": {"total_loss": 14.86512279510498, "kl": 0.005987809505313635, "entropy": 1.3581113815307617, "vf_loss": 14.86571979522705, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7070819735527039, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0007469934644177556}}, "episode_reward_mean": 844.7018296839476, "pid": 519, "time_total_s": 400.6368820667267, "node_ip": "10.138.0.2", "timestamp": 1556440233, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ee10>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e898>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 10, "time_since_restore": 440.3183138370514, "episode_reward_max": 926.9517778836861, "policy_reward_mean": {}, "timesteps_since_restore": 1171699, "episode_len_mean": 693.35, "episode_reward_min": 49.76291313629518, "hostname": "flow-main", "time_this_iter_s": 39.68143177032471, "custom_metrics": {"cost2_mean": -84.88393820391957, "system_level_velocity_max": 17.796864058169167, "cost2_max": -22.333776653959884, "outflow_rate_max": 1041.1647904940367, "cost2_min": -128.84498674094738, "cost1_min": 22.333391324560562, "system_level_velocity_mean": 12.133383105195193, "outflow_rate_min": 468.16108553543756, "cost1_max": 353.1929935635282, "outflow_rate_mean": 971.8968442485083, "cost1_mean": 319.1450872360477, "system_level_velocity_min": 9.810844727224493}, "episodes_total": 513, "timesteps_this_iter": 113094, "episodes_this_iter": 54, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 10, "timesteps_total": 1171699, "date": "2019-04-28_08-31-13", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1171699, "load_time_ms": 26.666, "grad_time_ms": 25086.794, "sample_time_ms": 18389.531, "num_steps_trained": 1171699, "update_time_ms": 311.575, "default": {"total_loss": 15.381973266601562, "kl": 0.006052830256521702, "entropy": 1.3466260433197021, "vf_loss": 15.382410049438477, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7234125733375549, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0005876507493667305}}, "episode_reward_mean": 863.0680406029448, "pid": 519, "time_total_s": 440.3183138370514, "node_ip": "10.138.0.2", "timestamp": 1556440273, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984400>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99843c8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 11, "time_since_restore": 481.1812777519226, "episode_reward_max": 945.0433252144594, "policy_reward_mean": {}, "timesteps_since_restore": 1286313, "episode_len_mean": 700.0, "episode_reward_min": 769.3963868321305, "hostname": "flow-main", "time_this_iter_s": 40.862963914871216, "custom_metrics": {"cost2_mean": -90.66032891916015, "system_level_velocity_max": 13.265033972427727, "cost2_max": -57.713068292703014, "outflow_rate_max": 1047.1086240813863, "cost2_min": -128.84498674094738, "cost1_min": 255.64521660992727, "system_level_velocity_mean": 11.919430919533083, "outflow_rate_min": 847.7864021521692, "cost1_max": 353.1929935635282, "outflow_rate_mean": 974.9310038885355, "cost1_mean": 318.4055607488058, "system_level_velocity_min": 9.549917847417367}, "episodes_total": 572, "timesteps_this_iter": 114614, "episodes_this_iter": 59, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 11, "timesteps_total": 1286313, "date": "2019-04-28_08-31-54", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1286313, "load_time_ms": 22.891, "grad_time_ms": 25034.271, "sample_time_ms": 15521.701, "num_steps_trained": 1286313, "update_time_ms": 11.301, "default": {"total_loss": 16.507856369018555, "kl": 0.006231699138879776, "entropy": 1.3467888832092285, "vf_loss": 16.508556365966797, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6582462191581726, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0008555595995858312}}, "episode_reward_mean": 870.4347862949838, "pid": 519, "time_total_s": 481.1812777519226, "node_ip": "10.138.0.2", "timestamp": 1556440314, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ee10>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ee80>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 12, "time_since_restore": 522.0268552303314, "episode_reward_max": 945.0433252144594, "policy_reward_mean": {}, "timesteps_since_restore": 1402428, "episode_len_mean": 700.0, "episode_reward_min": 773.9828689378729, "hostname": "flow-main", "time_this_iter_s": 40.84557747840881, "custom_metrics": {"cost2_mean": -92.19651518199167, "system_level_velocity_max": 12.969305935585828, "cost2_max": -58.88073224821701, "outflow_rate_max": 1047.1086240813863, "cost2_min": -127.31805923953537, "cost1_min": 255.64521660992727, "system_level_velocity_mean": 11.770009060953255, "outflow_rate_min": 847.7864021521692, "cost1_max": 347.5588392660103, "outflow_rate_mean": 971.6052205199901, "cost1_mean": 315.23820993880594, "system_level_velocity_min": 9.549917847417367}, "episodes_total": 622, "timesteps_this_iter": 116115, "episodes_this_iter": 50, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 12, "timesteps_total": 1402428, "date": "2019-04-28_08-32-34", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1402428, "load_time_ms": 23.18, "grad_time_ms": 25086.206, "sample_time_ms": 15470.226, "num_steps_trained": 1402428, "update_time_ms": 11.102, "default": {"total_loss": 14.428149223327637, "kl": 0.0059456792660057545, "entropy": 1.3357447385787964, "vf_loss": 14.428552627563477, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6516427993774414, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0005531302304007113}}, "episode_reward_mean": 872.8833577403973, "pid": 519, "time_total_s": 522.0268552303314, "node_ip": "10.138.0.2", "timestamp": 1556440354, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984208>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99840f0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 13, "time_since_restore": 561.751077413559, "episode_reward_max": 935.5842153093084, "policy_reward_mean": {}, "timesteps_since_restore": 1518030, "episode_len_mean": 700.0, "episode_reward_min": 783.7756317792058, "hostname": "flow-main", "time_this_iter_s": 39.72422218322754, "custom_metrics": {"cost2_mean": -90.79223206232663, "system_level_velocity_max": 13.07544775135704, "cost2_max": -66.08569546977348, "outflow_rate_max": 1029.060828149441, "cost2_min": -127.31805923953537, "cost1_min": 263.4241374595858, "system_level_velocity_mean": 11.774513980630307, "outflow_rate_min": 869.6131781607475, "cost1_max": 348.77737719884453, "outflow_rate_mean": 974.6945115990193, "cost1_mean": 316.03431825882654, "system_level_velocity_min": 9.726546219573462}, "episodes_total": 667, "timesteps_this_iter": 115602, "episodes_this_iter": 45, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 13, "timesteps_total": 1518030, "date": "2019-04-28_08-33-14", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1518030, "load_time_ms": 23.248, "grad_time_ms": 25009.771, "sample_time_ms": 15551.177, "num_steps_trained": 1518030, "update_time_ms": 11.136, "default": {"total_loss": 14.200827598571777, "kl": 0.007691051810979843, "entropy": 1.330635905265808, "vf_loss": 14.201905250549316, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6503854990005493, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0012700505321845412}}, "episode_reward_mean": 878.1820145982872, "pid": 519, "time_total_s": 561.751077413559, "node_ip": "10.138.0.2", "timestamp": 1556440394, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912eeb8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912eba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ee10>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 14, "time_since_restore": 602.2633101940155, "episode_reward_max": 932.1666151833408, "policy_reward_mean": {}, "timesteps_since_restore": 1633279, "episode_len_mean": 700.0, "episode_reward_min": 752.9455379595554, "hostname": "flow-main", "time_this_iter_s": 40.51223278045654, "custom_metrics": {"cost2_mean": -89.5758247312252, "system_level_velocity_max": 13.07544775135704, "cost2_max": -66.08569546977348, "outflow_rate_max": 1029.060828149441, "cost2_min": -116.89356009346226, "cost1_min": 262.9190582906946, "system_level_velocity_mean": 11.67034755437742, "outflow_rate_min": 852.4655334532523, "cost1_max": 348.77737719884453, "outflow_rate_mean": 969.1887382257592, "cost1_mean": 313.1469823609674, "system_level_velocity_min": 9.726546219573462}, "episodes_total": 722, "timesteps_this_iter": 115249, "episodes_this_iter": 55, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 14, "timesteps_total": 1633279, "date": "2019-04-28_08-33-55", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1633279, "load_time_ms": 23.114, "grad_time_ms": 24815.344, "sample_time_ms": 15471.731, "num_steps_trained": 1633279, "update_time_ms": 11.229, "default": {"total_loss": 16.42669677734375, "kl": 0.007242442574352026, "entropy": 1.3290741443634033, "vf_loss": 16.427593231201172, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.633795976638794, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.00107882812153548}}, "episode_reward_mean": 873.9612719561836, "pid": 519, "time_total_s": 602.2633101940155, "node_ip": "10.138.0.2", "timestamp": 1556440435, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984a90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99845c0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 15, "time_since_restore": 642.8504722118378, "episode_reward_max": 948.7817534299328, "policy_reward_mean": {}, "timesteps_since_restore": 1748889, "episode_len_mean": 700.0, "episode_reward_min": 732.1050929605425, "hostname": "flow-main", "time_this_iter_s": 40.587162017822266, "custom_metrics": {"cost2_mean": -91.76153416454761, "system_level_velocity_max": 12.76313158538446, "cost2_max": -72.19890614027092, "outflow_rate_max": 1040.6274235383905, "cost2_min": -114.54734873584547, "cost1_min": 249.97726210955344, "system_level_velocity_mean": 11.58688965649397, "outflow_rate_min": 837.3684418595363, "cost1_max": 343.78250535593895, "outflow_rate_mean": 970.3817014154333, "cost1_mean": 311.14633830088934, "system_level_velocity_min": 9.410192956581318}, "episodes_total": 774, "timesteps_this_iter": 115610, "episodes_this_iter": 52, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 15, "timesteps_total": 1748889, "date": "2019-04-28_08-34-35", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1748889, "load_time_ms": 23.175, "grad_time_ms": 24832.676, "sample_time_ms": 15503.654, "num_steps_trained": 1748889, "update_time_ms": 11.275, "default": {"total_loss": 15.607626914978027, "kl": 0.006990018766373396, "entropy": 1.3265762329101562, "vf_loss": 15.608542442321777, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6559584140777588, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0010895481100305915}}, "episode_reward_mean": 873.0575421781685, "pid": 519, "time_total_s": 642.8504722118378, "node_ip": "10.138.0.2", "timestamp": 1556440475, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e048>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ef60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912eeb8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 16, "time_since_restore": 683.0079946517944, "episode_reward_max": 959.5762456396814, "policy_reward_mean": {}, "timesteps_since_restore": 1863144, "episode_len_mean": 700.0, "episode_reward_min": 732.1050929605425, "hostname": "flow-main", "time_this_iter_s": 40.157522439956665, "custom_metrics": {"cost2_mean": -94.82607267068683, "system_level_velocity_max": 13.181754749709073, "cost2_max": -76.906170897396, "outflow_rate_max": 1068.64477898966, "cost2_min": -120.50776624276065, "cost1_min": 249.97726210955344, "system_level_velocity_mean": 11.65385691201048, "outflow_rate_min": 837.3684418595363, "cost1_max": 352.9135894140468, "outflow_rate_mean": 981.4265518586519, "cost1_mean": 313.44946910661804, "system_level_velocity_min": 9.410192956581318}, "episodes_total": 832, "timesteps_this_iter": 114255, "episodes_this_iter": 58, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 16, "timesteps_total": 1863144, "date": "2019-04-28_08-35-16", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1863144, "load_time_ms": 23.098, "grad_time_ms": 24916.493, "sample_time_ms": 15597.244, "num_steps_trained": 1863144, "update_time_ms": 11.369, "default": {"total_loss": 18.802024841308594, "kl": 0.00693601556122303, "entropy": 1.3351993560791016, "vf_loss": 18.802974700927734, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6201251149177551, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0011208445066586137}}, "episode_reward_mean": 880.261665214275, "pid": 519, "time_total_s": 683.0079946517944, "node_ip": "10.138.0.2", "timestamp": 1556440516, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99845c0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99845f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99844e0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 17, "time_since_restore": 722.2282514572144, "episode_reward_max": 959.5762456396814, "policy_reward_mean": {}, "timesteps_since_restore": 1975518, "episode_len_mean": 700.0, "episode_reward_min": 782.6552728454942, "hostname": "flow-main", "time_this_iter_s": 39.22025680541992, "custom_metrics": {"cost2_mean": -91.50977698676735, "system_level_velocity_max": 13.226246312514622, "cost2_max": -68.63320052196808, "outflow_rate_max": 1068.64477898966, "cost2_min": -120.50776624276065, "cost1_min": 268.2237826820359, "system_level_velocity_mean": 12.017077226000264, "outflow_rate_min": 886.5084961797605, "cost1_max": 355.2739722624606, "outflow_rate_mean": 1000.9666464763675, "cost1_mean": 323.0732357229762, "system_level_velocity_min": 10.071293217517864}, "episodes_total": 892, "timesteps_this_iter": 112374, "episodes_this_iter": 60, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 17, "timesteps_total": 1975518, "date": "2019-04-28_08-35-55", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1975518, "load_time_ms": 22.91, "grad_time_ms": 24660.056, "sample_time_ms": 15568.137, "num_steps_trained": 1975518, "update_time_ms": 11.472, "default": {"total_loss": 20.345233917236328, "kl": 0.006864875089377165, "entropy": 1.3265056610107422, "vf_loss": 20.345754623413086, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.523941695690155, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0006911933305673301}}, "episode_reward_mean": 893.2966554135589, "pid": 519, "time_total_s": 722.2282514572144, "node_ip": "10.138.0.2", "timestamp": 1556440555, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912eb00>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ee80>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 18, "time_since_restore": 761.8965821266174, "episode_reward_max": 949.5293389911049, "policy_reward_mean": {}, "timesteps_since_restore": 2088488, "episode_len_mean": 700.0, "episode_reward_min": 767.0275448746052, "hostname": "flow-main", "time_this_iter_s": 39.668330669403076, "custom_metrics": {"cost2_mean": -85.84469119266052, "system_level_velocity_max": 13.226246312514622, "cost2_max": -66.72705416868686, "outflow_rate_max": 1055.4100533582075, "cost2_min": -117.96400400928927, "cost1_min": 251.55539104492502, "system_level_velocity_mean": 11.783874717412083, "outflow_rate_min": 860.672453782671, "cost1_max": 355.2739722624606, "outflow_rate_mean": 981.3294666320054, "cost1_mean": 316.704312893497, "system_level_velocity_min": 9.259052075035536}, "episodes_total": 952, "timesteps_this_iter": 112970, "episodes_this_iter": 60, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 18, "timesteps_total": 2088488, "date": "2019-04-28_08-36-34", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2088488, "load_time_ms": 22.983, "grad_time_ms": 24612.55, "sample_time_ms": 15544.204, "num_steps_trained": 2088488, "update_time_ms": 11.35, "default": {"total_loss": 19.688013076782227, "kl": 0.007977300323545933, "entropy": 1.3143935203552246, "vf_loss": 19.688488006591797, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5053552985191345, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0006698057986795902}}, "episode_reward_mean": 880.3208302579187, "pid": 519, "time_total_s": 761.8965821266174, "node_ip": "10.138.0.2", "timestamp": 1556440594, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984dd8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984438>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 19, "time_since_restore": 800.6767287254333, "episode_reward_max": 943.2258382027827, "policy_reward_mean": {}, "timesteps_since_restore": 2202786, "episode_len_mean": 700.0, "episode_reward_min": 767.0275448746052, "hostname": "flow-main", "time_this_iter_s": 38.78014659881592, "custom_metrics": {"cost2_mean": -83.68707732968562, "system_level_velocity_max": 13.042551452583398, "cost2_max": -66.72705416868686, "outflow_rate_max": 1041.7878394266763, "cost2_min": -104.89518861622986, "cost1_min": 251.55539104492502, "system_level_velocity_mean": 11.507871357710387, "outflow_rate_min": 860.672453782671, "cost1_max": 348.49527793969776, "outflow_rate_mean": 962.6295179338709, "cost1_mean": 309.2915907376222, "system_level_velocity_min": 9.259052075035536}, "episodes_total": 997, "timesteps_this_iter": 114298, "episodes_this_iter": 45, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 19, "timesteps_total": 2202786, "date": "2019-04-28_08-37-13", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2202786, "load_time_ms": 22.748, "grad_time_ms": 24267.644, "sample_time_ms": 15481.37, "num_steps_trained": 2202786, "update_time_ms": 11.504, "default": {"total_loss": 16.57602310180664, "kl": 0.006815997883677483, "entropy": 1.304686188697815, "vf_loss": 16.576562881469727, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.519171953201294, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.000711417815182358}}, "episode_reward_mean": 872.3782419854689, "pid": 519, "time_total_s": 800.6767287254333, "node_ip": "10.138.0.2", "timestamp": 1556440633, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e860>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912eb00>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 20, "time_since_restore": 841.0942797660828, "episode_reward_max": 954.9299557796248, "policy_reward_mean": {}, "timesteps_since_restore": 2317536, "episode_len_mean": 700.0, "episode_reward_min": 783.5968571488417, "hostname": "flow-main", "time_this_iter_s": 40.417551040649414, "custom_metrics": {"cost2_mean": -85.67405756025987, "system_level_velocity_max": 12.570466590019688, "cost2_max": -69.21004741493799, "outflow_rate_max": 1041.4444199064556, "cost2_min": -104.38521071368837, "cost1_min": 263.02463550867617, "system_level_velocity_mean": 11.632642003039692, "outflow_rate_min": 867.6033828473925, "cost1_max": 339.58786005339465, "outflow_rate_mean": 973.0342563614581, "cost1_mean": 312.8233144514712, "system_level_velocity_min": 9.699260714575512}, "episodes_total": 1045, "timesteps_this_iter": 114750, "episodes_this_iter": 48, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 20, "timesteps_total": 2317536, "date": "2019-04-28_08-37-54", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2317536, "load_time_ms": 22.954, "grad_time_ms": 24309.032, "sample_time_ms": 15513.834, "num_steps_trained": 2317536, "update_time_ms": 11.67, "default": {"total_loss": 17.09206199645996, "kl": 0.007779822219163179, "entropy": 1.2967649698257446, "vf_loss": 17.09259605407715, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.539316713809967, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0007288610213436186}}, "episode_reward_mean": 882.1189065805836, "pid": 519, "time_total_s": 841.0942797660828, "node_ip": "10.138.0.2", "timestamp": 1556440674, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984710>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984160>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 21, "time_since_restore": 881.5631549358368, "episode_reward_max": 954.9299557796248, "policy_reward_mean": {}, "timesteps_since_restore": 2433634, "episode_len_mean": 700.0, "episode_reward_min": 789.1754692750753, "hostname": "flow-main", "time_this_iter_s": 40.46887516975403, "custom_metrics": {"cost2_mean": -89.24949682235025, "system_level_velocity_max": 12.612890149631374, "cost2_max": -75.6982229309177, "outflow_rate_max": 1036.1564173030984, "cost2_min": -109.94894433536084, "cost1_min": 232.49562418646568, "system_level_velocity_mean": 11.476754577254669, "outflow_rate_min": 831.6165217563254, "cost1_max": 340.5179966146863, "outflow_rate_mean": 970.2056027260729, "cost1_mean": 308.75639473560483, "system_level_velocity_min": 8.557411360286524}, "episodes_total": 1098, "timesteps_this_iter": 116098, "episodes_this_iter": 53, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 21, "timesteps_total": 2433634, "date": "2019-04-28_08-38-34", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2433634, "load_time_ms": 23.006, "grad_time_ms": 24312.641, "sample_time_ms": 15470.269, "num_steps_trained": 2433634, "update_time_ms": 11.595, "default": {"total_loss": 17.640592575073242, "kl": 0.007214860990643501, "entropy": 1.2811663150787354, "vf_loss": 17.64092445373535, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5397987365722656, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0005121615249663591}}, "episode_reward_mean": 875.2110112410084, "pid": 519, "time_total_s": 881.5631549358368, "node_ip": "10.138.0.2", "timestamp": 1556440714, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e278>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e860>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 22, "time_since_restore": 921.8462479114532, "episode_reward_max": 942.3957256556511, "policy_reward_mean": {}, "timesteps_since_restore": 2548673, "episode_len_mean": 700.0, "episode_reward_min": 789.7867844282973, "hostname": "flow-main", "time_this_iter_s": 40.283092975616455, "custom_metrics": {"cost2_mean": -91.74696069286429, "system_level_velocity_max": 12.612890149631374, "cost2_max": -75.96436453391246, "outflow_rate_max": 1030.6012280088748, "cost2_min": -109.94894433536084, "cost1_min": 232.49562418646568, "system_level_velocity_mean": 11.285130703147134, "outflow_rate_min": 831.6165217563254, "cost1_max": 340.5179966146863, "outflow_rate_mean": 964.3163337149828, "cost1_mean": 303.8087722016499, "system_level_velocity_min": 8.557411360286524}, "episodes_total": 1147, "timesteps_this_iter": 115039, "episodes_this_iter": 49, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 22, "timesteps_total": 2548673, "date": "2019-04-28_08-39-15", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2548673, "load_time_ms": 22.555, "grad_time_ms": 24262.38, "sample_time_ms": 15464.674, "num_steps_trained": 2548673, "update_time_ms": 11.612, "default": {"total_loss": 17.62397575378418, "kl": 0.009278731420636177, "entropy": 1.2584619522094727, "vf_loss": 17.625408172607422, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5168737769126892, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0016641152324154973}}, "episode_reward_mean": 870.208908933356, "pid": 519, "time_total_s": 921.8462479114532, "node_ip": "10.138.0.2", "timestamp": 1556440755, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984dd8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984f28>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 23, "time_since_restore": 961.121372461319, "episode_reward_max": 937.3123268489117, "policy_reward_mean": {}, "timesteps_since_restore": 2663321, "episode_len_mean": 700.0, "episode_reward_min": 789.7867844282973, "hostname": "flow-main", "time_this_iter_s": 39.27512454986572, "custom_metrics": {"cost2_mean": -94.29323277739742, "system_level_velocity_max": 12.61960372814272, "cost2_max": -81.37443261888163, "outflow_rate_max": 1031.1990311402599, "cost2_min": -109.51156797340832, "cost1_min": 250.80627470269135, "system_level_velocity_mean": 11.30522064630965, "outflow_rate_min": 856.8760538930976, "cost1_max": 337.790246895092, "outflow_rate_mean": 967.967766066452, "cost1_mean": 304.5604998298367, "system_level_velocity_min": 9.271151343200387}, "episodes_total": 1205, "timesteps_this_iter": 114648, "episodes_this_iter": 58, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 23, "timesteps_total": 2663321, "date": "2019-04-28_08-39-54", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2663321, "load_time_ms": 22.451, "grad_time_ms": 24187.324, "sample_time_ms": 15495.432, "num_steps_trained": 2663321, "update_time_ms": 11.723, "default": {"total_loss": 21.25552749633789, "kl": 0.009228751994669437, "entropy": 1.2450284957885742, "vf_loss": 21.256235122680664, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.466745525598526, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0009389870683662593}}, "episode_reward_mean": 880.2534919555779, "pid": 519, "time_total_s": 961.121372461319, "node_ip": "10.138.0.2", "timestamp": 1556440794, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ee80>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e278>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 24, "time_since_restore": 999.6862988471985, "episode_reward_max": 940.2608442700191, "policy_reward_mean": {}, "timesteps_since_restore": 2777040, "episode_len_mean": 700.0, "episode_reward_min": 804.4132142385115, "hostname": "flow-main", "time_this_iter_s": 38.56492638587952, "custom_metrics": {"cost2_mean": -97.54484077725749, "system_level_velocity_max": 12.627650633918076, "cost2_max": -82.37996370491314, "outflow_rate_max": 1034.3307337072392, "cost2_min": -114.78477128564845, "cost1_min": 246.4171980175766, "system_level_velocity_mean": 11.298152383794454, "outflow_rate_min": 852.0632760675743, "cost1_max": 337.790246895092, "outflow_rate_mean": 969.9897243887644, "cost1_mean": 304.2666390359973, "system_level_velocity_min": 9.140579510448433}, "episodes_total": 1263, "timesteps_this_iter": 113719, "episodes_this_iter": 58, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 24, "timesteps_total": 2777040, "date": "2019-04-28_08-40-32", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2777040, "load_time_ms": 22.392, "grad_time_ms": 23994.363, "sample_time_ms": 15493.045, "num_steps_trained": 2777040, "update_time_ms": 11.883, "default": {"total_loss": 22.074235916137695, "kl": 0.008263267576694489, "entropy": 1.2448092699050903, "vf_loss": 22.074811935424805, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5130640864372253, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.000784915464464575}}, "episode_reward_mean": 882.6702698827348, "pid": 519, "time_total_s": 999.6862988471985, "node_ip": "10.138.0.2", "timestamp": 1556440832, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984208>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984d68>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 25, "time_since_restore": 1039.3058698177338, "episode_reward_max": 940.4517922270776, "policy_reward_mean": {}, "timesteps_since_restore": 2891371, "episode_len_mean": 700.0, "episode_reward_min": 804.4132142385115, "hostname": "flow-main", "time_this_iter_s": 39.61957097053528, "custom_metrics": {"cost2_mean": -99.55466049651423, "system_level_velocity_max": 12.627650633918076, "cost2_max": -85.68475949183508, "outflow_rate_max": 1034.3307337072392, "cost2_min": -119.71638522887237, "cost1_min": 255.3896928105557, "system_level_velocity_mean": 11.474470591088465, "outflow_rate_min": 884.5302158272423, "cost1_max": 337.42417688401935, "outflow_rate_mean": 979.7656553000661, "cost1_mean": 308.4751153292066, "system_level_velocity_min": 9.365219064812212}, "episodes_total": 1323, "timesteps_this_iter": 114331, "episodes_this_iter": 60, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 25, "timesteps_total": 2891371, "date": "2019-04-28_08-41-12", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2891371, "load_time_ms": 22.209, "grad_time_ms": 23800.273, "sample_time_ms": 15591.142, "num_steps_trained": 2891371, "update_time_ms": 11.86, "default": {"total_loss": 22.52773666381836, "kl": 0.00887871254235506, "entropy": 1.2390962839126587, "vf_loss": 22.5291805267334, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5038924217224121, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0016642860136926174}}, "episode_reward_mean": 884.0585112359265, "pid": 519, "time_total_s": 1039.3058698177338, "node_ip": "10.138.0.2", "timestamp": 1556440872, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912eb00>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ee80>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 26, "time_since_restore": 1079.6821594238281, "episode_reward_max": 949.5150589702611, "policy_reward_mean": {}, "timesteps_since_restore": 3006848, "episode_len_mean": 700.0, "episode_reward_min": 811.3510946594498, "hostname": "flow-main", "time_this_iter_s": 40.37628960609436, "custom_metrics": {"cost2_mean": -100.06767620503635, "system_level_velocity_max": 13.001193130841239, "cost2_max": -83.31440311042809, "outflow_rate_max": 1049.9329381585158, "cost2_min": -122.5871833159861, "cost1_min": 269.5593233590123, "system_level_velocity_mean": 11.710555097607374, "outflow_rate_min": 889.2253060357791, "cost1_max": 345.38674789013686, "outflow_rate_mean": 991.6896849398, "cost1_mean": 314.24881118143367, "system_level_velocity_min": 10.013633341027788}, "episodes_total": 1370, "timesteps_this_iter": 115477, "episodes_this_iter": 47, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 26, "timesteps_total": 3006848, "date": "2019-04-28_08-41-52", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3006848, "load_time_ms": 22.385, "grad_time_ms": 23833.853, "sample_time_ms": 15579.66, "num_steps_trained": 3006848, "update_time_ms": 11.788, "default": {"total_loss": 18.40367889404297, "kl": 0.008712184615433216, "entropy": 1.2431058883666992, "vf_loss": 18.40459442138672, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5750163793563843, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0011305880034342408}}, "episode_reward_mean": 889.1396057079747, "pid": 519, "time_total_s": 1079.6821594238281, "node_ip": "10.138.0.2", "timestamp": 1556440912, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984d68>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984358>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 27, "time_since_restore": 1121.8968515396118, "episode_reward_max": 975.0401011971644, "policy_reward_mean": {}, "timesteps_since_restore": 3124793, "episode_len_mean": 700.0, "episode_reward_min": 782.1644036956193, "hostname": "flow-main", "time_this_iter_s": 42.21469211578369, "custom_metrics": {"cost2_mean": -108.57342801551556, "system_level_velocity_max": 13.059941341546965, "cost2_max": -83.31440311042809, "outflow_rate_max": 1070.573808403744, "cost2_min": -157.66323991380048, "cost1_min": 242.86822522806932, "system_level_velocity_mean": 11.724273556349722, "outflow_rate_min": 853.23479407793, "cost1_max": 349.3189908258746, "outflow_rate_mean": 996.648465352035, "cost1_mean": 314.6686288370502, "system_level_velocity_min": 9.04200596993906}, "episodes_total": 1415, "timesteps_this_iter": 117945, "episodes_this_iter": 45, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 27, "timesteps_total": 3124793, "date": "2019-04-28_08-42-35", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3124793, "load_time_ms": 22.734, "grad_time_ms": 24163.995, "sample_time_ms": 15546.13, "num_steps_trained": 3124793, "update_time_ms": 11.801, "default": {"total_loss": 19.831268310546875, "kl": 0.007524118758738041, "entropy": 1.2463246583938599, "vf_loss": 19.832239151000977, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6378519535064697, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0011598170967772603}}, "episode_reward_mean": 893.5402463946443, "pid": 519, "time_total_s": 1121.8968515396118, "node_ip": "10.138.0.2", "timestamp": 1556440955, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984b00>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99844a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99845c0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 28, "time_since_restore": 1163.2775466442108, "episode_reward_max": 982.9523947294635, "policy_reward_mean": {}, "timesteps_since_restore": 3241891, "episode_len_mean": 700.0, "episode_reward_min": 782.1644036956193, "hostname": "flow-main", "time_this_iter_s": 41.380695104599, "custom_metrics": {"cost2_mean": -122.17559613005317, "system_level_velocity_max": 13.198494975223054, "cost2_max": -90.56660228444105, "outflow_rate_max": 1081.8882541624614, "cost2_min": -157.66323991380048, "cost1_min": 242.86822522806932, "system_level_velocity_mean": 11.750283941128437, "outflow_rate_min": 853.23479407793, "cost1_max": 354.41924599606546, "outflow_rate_mean": 1009.0657210371819, "cost1_mean": 315.2802215649708, "system_level_velocity_min": 9.04200596993906}, "episodes_total": 1465, "timesteps_this_iter": 117098, "episodes_this_iter": 50, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 28, "timesteps_total": 3241891, "date": "2019-04-28_08-43-16", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3241891, "load_time_ms": 22.815, "grad_time_ms": 24378.579, "sample_time_ms": 15502.848, "num_steps_trained": 3241891, "update_time_ms": 11.705, "default": {"total_loss": 22.64863395690918, "kl": 0.0072878384962677956, "entropy": 1.2302311658859253, "vf_loss": 22.649587631225586, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6093132495880127, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0011348776752129197}}, "episode_reward_mean": 898.34379625313, "pid": 519, "time_total_s": 1163.2775466442108, "node_ip": "10.138.0.2", "timestamp": 1556440996, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99843c8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 29, "time_since_restore": 1204.4286317825317, "episode_reward_max": 992.1494014336889, "policy_reward_mean": {}, "timesteps_since_restore": 3358718, "episode_len_mean": 693.35, "episode_reward_min": 47.92263686044441, "hostname": "flow-main", "time_this_iter_s": 41.15108513832092, "custom_metrics": {"cost2_mean": -125.62552033108427, "system_level_velocity_max": 18.13009797698478, "cost2_max": -20.85953702809037, "outflow_rate_max": 1084.5051193091651, "cost2_min": -157.5788648610545, "cost1_min": 22.602022519836403, "system_level_velocity_mean": 12.02000071973208, "outflow_rate_min": 500.8146235931583, "cost1_max": 354.41924599606546, "outflow_rate_mean": 1021.8908749891397, "cost1_mean": 317.6483499388576, "system_level_velocity_min": 10.165656437207947}, "episodes_total": 1517, "timesteps_this_iter": 116827, "episodes_this_iter": 52, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 29, "timesteps_total": 3358718, "date": "2019-04-28_08-43-57", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3358718, "load_time_ms": 23.091, "grad_time_ms": 24599.783, "sample_time_ms": 15519.013, "num_steps_trained": 3358718, "update_time_ms": 11.614, "default": {"total_loss": 23.705780029296875, "kl": 0.008166814222931862, "entropy": 1.2227301597595215, "vf_loss": 23.706527709960938, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6205400228500366, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0009496572893112898}}, "episode_reward_mean": 900.9297112089947, "pid": 519, "time_total_s": 1204.4286317825317, "node_ip": "10.138.0.2", "timestamp": 1556441037, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984cf8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99842b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984da0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 30, "time_since_restore": 1244.207424879074, "episode_reward_max": 992.1494014336889, "policy_reward_mean": {}, "timesteps_since_restore": 3476161, "episode_len_mean": 693.35, "episode_reward_min": 47.92263686044441, "hostname": "flow-main", "time_this_iter_s": 39.77879309654236, "custom_metrics": {"cost2_mean": -126.92369546580395, "system_level_velocity_max": 18.13009797698478, "cost2_max": -20.85953702809037, "outflow_rate_max": 1084.5051193091651, "cost2_min": -165.23621174420293, "cost1_min": 22.602022519836403, "system_level_velocity_mean": 11.94550684445413, "outflow_rate_min": 500.8146235931583, "cost1_max": 349.34605923476045, "outflow_rate_mean": 1019.3787223226261, "cost1_mean": 315.79448099702057, "system_level_velocity_min": 9.991043844208097}, "episodes_total": 1571, "timesteps_this_iter": 117443, "episodes_this_iter": 54, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 30, "timesteps_total": 3476161, "date": "2019-04-28_08-44-37", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3476161, "load_time_ms": 23.283, "grad_time_ms": 24667.381, "sample_time_ms": 15385.607, "num_steps_trained": 3476161, "update_time_ms": 11.57, "default": {"total_loss": 23.26772117614746, "kl": 0.009333711117506027, "entropy": 1.2261961698532104, "vf_loss": 23.268789291381836, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6377254128456116, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0013012588024139404}}, "episode_reward_mean": 896.7930959612128, "pid": 519, "time_total_s": 1244.207424879074, "node_ip": "10.138.0.2", "timestamp": 1556441077, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984160>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984048>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 31, "time_since_restore": 1284.7699477672577, "episode_reward_max": 968.368762158728, "policy_reward_mean": {}, "timesteps_since_restore": 3596390, "episode_len_mean": 700.0, "episode_reward_min": 764.6868477114272, "hostname": "flow-main", "time_this_iter_s": 40.562522888183594, "custom_metrics": {"cost2_mean": -136.8151330454238, "system_level_velocity_max": 12.860792894161388, "cost2_max": -101.25466053275227, "outflow_rate_max": 1081.4798294445714, "cost2_min": -167.10147590453258, "cost1_min": 251.41255731379536, "system_level_velocity_mean": 11.602522206478817, "outflow_rate_min": 891.1082945710365, "cost1_max": 343.7190463116349, "outflow_rate_mean": 1014.3145678365312, "cost1_mean": 311.1610402886351, "system_level_velocity_min": 9.667696595109584}, "episodes_total": 1623, "timesteps_this_iter": 120229, "episodes_this_iter": 52, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 31, "timesteps_total": 3596390, "date": "2019-04-28_08-45-18", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3596390, "load_time_ms": 23.392, "grad_time_ms": 24766.442, "sample_time_ms": 15292.914, "num_steps_trained": 3596390, "update_time_ms": 11.56, "default": {"total_loss": 23.451162338256836, "kl": 0.011563243344426155, "entropy": 1.225049376487732, "vf_loss": 23.452301025390625, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6851941347122192, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0014259604504331946}}, "episode_reward_mean": 893.4596862474382, "pid": 519, "time_total_s": 1284.7699477672577, "node_ip": "10.138.0.2", "timestamp": 1556441118, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e240>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ef28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f518>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 32, "time_since_restore": 1328.3256859779358, "episode_reward_max": 966.5290800955488, "policy_reward_mean": {}, "timesteps_since_restore": 3716574, "episode_len_mean": 700.0, "episode_reward_min": 702.5754939363793, "hostname": "flow-main", "time_this_iter_s": 43.5557382106781, "custom_metrics": {"cost2_mean": -149.20367433525232, "system_level_velocity_max": 12.396405218686951, "cost2_max": -112.17869028402004, "outflow_rate_max": 1076.8861664873366, "cost2_min": -179.29417763230313, "cost1_min": 219.295759669394, "system_level_velocity_mean": 11.23201509217631, "outflow_rate_min": 827.5090445703258, "cost1_max": 334.62305294099116, "outflow_rate_mean": 1001.3728850882273, "cost1_mean": 301.0662391702084, "system_level_velocity_min": 8.337651652613028}, "episodes_total": 1676, "timesteps_this_iter": 120184, "episodes_this_iter": 53, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 32, "timesteps_total": 3716574, "date": "2019-04-28_08-46-01", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3716574, "load_time_ms": 23.803, "grad_time_ms": 25089.208, "sample_time_ms": 15297.614, "num_steps_trained": 3716574, "update_time_ms": 11.557, "default": {"total_loss": 22.691957473754883, "kl": 0.00888074655085802, "entropy": 1.2222050428390503, "vf_loss": 22.693010330200195, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6500017642974854, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.00127410760615021}}, "episode_reward_mean": 877.1672976247688, "pid": 519, "time_total_s": 1328.3256859779358, "node_ip": "10.138.0.2", "timestamp": 1556441161, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984320>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984eb8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 33, "time_since_restore": 1370.3730671405792, "episode_reward_max": 949.4683788792321, "policy_reward_mean": {}, "timesteps_since_restore": 3837875, "episode_len_mean": 700.0, "episode_reward_min": 702.5754939363793, "hostname": "flow-main", "time_this_iter_s": 42.04738116264343, "custom_metrics": {"cost2_mean": -152.44402518009682, "system_level_velocity_max": 12.224087724213241, "cost2_max": -122.41203588006121, "outflow_rate_max": 1060.0406023125254, "cost2_min": -179.29417763230313, "cost1_min": 219.295759669394, "system_level_velocity_mean": 11.01613989218373, "outflow_rate_min": 827.5090445703258, "cost1_max": 327.9662767971139, "outflow_rate_mean": 990.0473174856181, "cost1_mean": 295.25585302429533, "system_level_velocity_min": 8.337651652613028}, "episodes_total": 1717, "timesteps_this_iter": 121301, "episodes_this_iter": 41, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 33, "timesteps_total": 3837875, "date": "2019-04-28_08-46-43", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3837875, "load_time_ms": 24.08, "grad_time_ms": 25437.371, "sample_time_ms": 15225.294, "num_steps_trained": 3837875, "update_time_ms": 11.524, "default": {"total_loss": 18.544551849365234, "kl": 0.009748243726789951, "entropy": 1.2065720558166504, "vf_loss": 18.54566192626953, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7008838057518005, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0013547278940677643}}, "episode_reward_mean": 863.7948486785303, "pid": 519, "time_total_s": 1370.3730671405792, "node_ip": "10.138.0.2", "timestamp": 1556441203, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e630>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e6a0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 34, "time_since_restore": 1412.0755288600922, "episode_reward_max": 972.4550128633716, "policy_reward_mean": {}, "timesteps_since_restore": 3960065, "episode_len_mean": 700.0, "episode_reward_min": 744.7968161127466, "hostname": "flow-main", "time_this_iter_s": 41.70246171951294, "custom_metrics": {"cost2_mean": -154.09875692289353, "system_level_velocity_max": 12.569546181122595, "cost2_max": -128.12704298966653, "outflow_rate_max": 1078.63658892806, "cost2_min": -183.9119305355771, "cost1_min": 242.077658884735, "system_level_velocity_mean": 11.143501227104775, "outflow_rate_min": 862.1167977439333, "cost1_max": 339.1102137277654, "outflow_rate_mean": 996.5898639680265, "cost1_mean": 298.86229143960355, "system_level_velocity_min": 9.265165146172954}, "episodes_total": 1761, "timesteps_this_iter": 122190, "episodes_this_iter": 44, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 34, "timesteps_total": 3960065, "date": "2019-04-28_08-47-25", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3960065, "load_time_ms": 24.424, "grad_time_ms": 25800.096, "sample_time_ms": 15176.423, "num_steps_trained": 3960065, "update_time_ms": 11.322, "default": {"total_loss": 19.44180679321289, "kl": 0.009343087673187256, "entropy": 1.207274317741394, "vf_loss": 19.44288444519043, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7175754904747009, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0013098911149427295}}, "episode_reward_mean": 872.0624628921876, "pid": 519, "time_total_s": 1412.0755288600922, "node_ip": "10.138.0.2", "timestamp": 1556441245, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984080>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99689b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99843c8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 35, "time_since_restore": 1455.1455564498901, "episode_reward_max": 984.0547589991104, "policy_reward_mean": {}, "timesteps_since_restore": 4085980, "episode_len_mean": 700.0, "episode_reward_min": 771.286987278648, "hostname": "flow-main", "time_this_iter_s": 43.070027589797974, "custom_metrics": {"cost2_mean": -160.8224235694793, "system_level_velocity_max": 12.569546181122595, "cost2_max": -135.80679847156577, "outflow_rate_max": 1080.9020221399544, "cost2_min": -192.63242077924434, "cost1_min": 238.98605159154937, "system_level_velocity_mean": 11.183893618830956, "outflow_rate_min": 860.1627118570872, "cost1_max": 339.1102137277654, "outflow_rate_mean": 1002.5360715671486, "cost1_mean": 299.7335174823672, "system_level_velocity_min": 8.7823813967491}, "episodes_total": 1813, "timesteps_this_iter": 125915, "episodes_this_iter": 52, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 35, "timesteps_total": 4085980, "date": "2019-04-28_08-48-08", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4085980, "load_time_ms": 24.917, "grad_time_ms": 26250.295, "sample_time_ms": 15068.361, "num_steps_trained": 4085980, "update_time_ms": 11.444, "default": {"total_loss": 21.85969352722168, "kl": 0.009408698417246342, "entropy": 1.188155174255371, "vf_loss": 21.860538482666016, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7244390249252319, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0010818085866048932}}, "episode_reward_mean": 873.5879504026872, "pid": 519, "time_total_s": 1455.1455564498901, "node_ip": "10.138.0.2", "timestamp": 1556441288, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ef28>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912eda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e4e0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 36, "time_since_restore": 1497.0278334617615, "episode_reward_max": 984.0547589991104, "policy_reward_mean": {}, "timesteps_since_restore": 4208994, "episode_len_mean": 693.4, "episode_reward_min": 53.203528660231676, "hostname": "flow-main", "time_this_iter_s": 41.88227701187134, "custom_metrics": {"cost2_mean": -164.53045253601888, "system_level_velocity_max": 17.736107527701094, "cost2_max": -20.630923780481258, "outflow_rate_max": 1080.9020221399544, "cost2_min": -192.63242077924434, "cost1_min": 25.28290096273995, "system_level_velocity_mean": 11.093628948405744, "outflow_rate_min": 511.5762559654078, "cost1_max": 335.75633351434215, "outflow_rate_mean": 991.5227712889656, "cost1_mean": 291.7372040210091, "system_level_velocity_min": 8.7823813967491}, "episodes_total": 1863, "timesteps_this_iter": 123014, "episodes_this_iter": 50, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 36, "timesteps_total": 4208994, "date": "2019-04-28_08-48-50", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4208994, "load_time_ms": 25.007, "grad_time_ms": 26418.067, "sample_time_ms": 15049.384, "num_steps_trained": 4208994, "update_time_ms": 11.583, "default": {"total_loss": 21.155330657958984, "kl": 0.00905945897102356, "entropy": 1.1999316215515137, "vf_loss": 21.156618118286133, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7355858087539673, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0015129802050068974}}, "episode_reward_mean": 846.6924357937663, "pid": 519, "time_total_s": 1497.0278334617615, "node_ip": "10.138.0.2", "timestamp": 1556441330, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984160>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 37, "time_since_restore": 1539.0887053012848, "episode_reward_max": 970.0676190232763, "policy_reward_mean": {}, "timesteps_since_restore": 4332095, "episode_len_mean": 693.4, "episode_reward_min": 53.203528660231676, "hostname": "flow-main", "time_this_iter_s": 42.060871839523315, "custom_metrics": {"cost2_mean": -165.64500081648944, "system_level_velocity_max": 17.736107527701094, "cost2_max": -20.630923780481258, "outflow_rate_max": 1079.8447681318225, "cost2_min": -182.59531309933317, "cost1_min": 25.28290096273995, "system_level_velocity_mean": 11.078589206483617, "outflow_rate_min": 511.5762559654078, "cost1_max": 332.09590978828834, "outflow_rate_mean": 988.5379965308725, "cost1_mean": 290.20178759302695, "system_level_velocity_min": 9.121454538481894}, "episodes_total": 1918, "timesteps_this_iter": 123101, "episodes_this_iter": 55, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 37, "timesteps_total": 4332095, "date": "2019-04-28_08-49-32", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4332095, "load_time_ms": 24.025, "grad_time_ms": 26482.725, "sample_time_ms": 14970.964, "num_steps_trained": 4332095, "update_time_ms": 11.518, "default": {"total_loss": 23.158584594726562, "kl": 0.008654415607452393, "entropy": 1.1836440563201904, "vf_loss": 23.15937614440918, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7171499133110046, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0010086538968607783}}, "episode_reward_mean": 841.561556075869, "pid": 519, "time_total_s": 1539.0887053012848, "node_ip": "10.138.0.2", "timestamp": 1556441372, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e9e8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e240>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 38, "time_since_restore": 1581.2447969913483, "episode_reward_max": 964.5948403160045, "policy_reward_mean": {}, "timesteps_since_restore": 4455030, "episode_len_mean": 700.0, "episode_reward_min": 746.7015487870051, "hostname": "flow-main", "time_this_iter_s": 42.15609169006348, "custom_metrics": {"cost2_mean": -168.23464335957453, "system_level_velocity_max": 12.342272976745912, "cost2_max": -152.42164970036237, "outflow_rate_max": 1078.3430594764645, "cost2_min": -185.4165181877517, "cost1_min": 235.3621820937498, "system_level_velocity_mean": 11.047953343484608, "outflow_rate_min": 866.6149663939551, "cost1_max": 332.09590978828834, "outflow_rate_mean": 995.4047675087571, "cost1_mean": 293.6267740251249, "system_level_velocity_min": 9.121454538481894}, "episodes_total": 1964, "timesteps_this_iter": 122935, "episodes_this_iter": 46, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 38, "timesteps_total": 4455030, "date": "2019-04-28_08-50-14", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4455030, "load_time_ms": 24.456, "grad_time_ms": 26601.382, "sample_time_ms": 14927.699, "num_steps_trained": 4455030, "update_time_ms": 11.347, "default": {"total_loss": 20.16588592529297, "kl": 0.009426292032003403, "entropy": 1.183069109916687, "vf_loss": 20.16741371154785, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7491070032119751, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0017622408922761679}}, "episode_reward_mean": 850.0137199833334, "pid": 519, "time_total_s": 1581.2447969913483, "node_ip": "10.138.0.2", "timestamp": 1556441414, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984eb8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99845f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99846d8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 39, "time_since_restore": 1623.6894192695618, "episode_reward_max": 959.4416335593897, "policy_reward_mean": {}, "timesteps_since_restore": 4576607, "episode_len_mean": 700.0, "episode_reward_min": 759.7825890222225, "hostname": "flow-main", "time_this_iter_s": 42.4446222782135, "custom_metrics": {"cost2_mean": -164.7174854646658, "system_level_velocity_max": 12.161115255420066, "cost2_max": -142.60930332791955, "outflow_rate_max": 1071.2638260285223, "cost2_min": -185.4165181877517, "cost1_min": 251.1925122072907, "system_level_velocity_mean": 10.99625930698877, "outflow_rate_min": 901.1307259943096, "cost1_max": 326.19465189704596, "outflow_rate_mean": 989.4366958704791, "cost1_mean": 292.1473957927985, "system_level_velocity_min": 9.63821196230444}, "episodes_total": 2010, "timesteps_this_iter": 121577, "episodes_this_iter": 46, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 39, "timesteps_total": 4576607, "date": "2019-04-28_08-50-57", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4576607, "load_time_ms": 24.695, "grad_time_ms": 26752.56, "sample_time_ms": 14903.588, "num_steps_trained": 4576607, "update_time_ms": 11.35, "default": {"total_loss": 19.903413772583008, "kl": 0.011195519007742405, "entropy": 1.1912860870361328, "vf_loss": 19.905275344848633, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7526425123214722, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.002141680335626006}}, "episode_reward_mean": 844.9097325199167, "pid": 519, "time_total_s": 1623.6894192695618, "node_ip": "10.138.0.2", "timestamp": 1556441457, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99844e0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99845c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99842b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 40, "time_since_restore": 1665.4683845043182, "episode_reward_max": 969.522617026178, "policy_reward_mean": {}, "timesteps_since_restore": 4698811, "episode_len_mean": 700.0, "episode_reward_min": 759.2984808642816, "hostname": "flow-main", "time_this_iter_s": 41.77896523475647, "custom_metrics": {"cost2_mean": -157.6323175010355, "system_level_velocity_max": 12.20703245460803, "cost2_max": -138.0539714162358, "outflow_rate_max": 1074.2429820039201, "cost2_min": -184.57149665316405, "cost1_min": 229.49288023215007, "system_level_velocity_mean": 10.871443637051371, "outflow_rate_min": 864.8390672458446, "cost1_max": 328.72322804680505, "outflow_rate_mean": 975.636338509571, "cost1_mean": 289.25702989047, "system_level_velocity_min": 8.623692837682729}, "episodes_total": 2059, "timesteps_this_iter": 122204, "episodes_this_iter": 49, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 40, "timesteps_total": 4698811, "date": "2019-04-28_08-51-39", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4698811, "load_time_ms": 24.605, "grad_time_ms": 26854.282, "sample_time_ms": 15000.335, "num_steps_trained": 4698811, "update_time_ms": 11.376, "default": {"total_loss": 20.939207077026367, "kl": 0.008947213180363178, "entropy": 1.181459903717041, "vf_loss": 20.94055938720703, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7193143367767334, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0015737578505650163}}, "episode_reward_mean": 844.6808002018822, "pid": 519, "time_total_s": 1665.4683845043182, "node_ip": "10.138.0.2", "timestamp": 1556441499, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984d30>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99842e8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 41, "time_since_restore": 1707.8313088417053, "episode_reward_max": 969.522617026178, "policy_reward_mean": {}, "timesteps_since_restore": 4821400, "episode_len_mean": 700.0, "episode_reward_min": 759.2984808642816, "hostname": "flow-main", "time_this_iter_s": 42.362924337387085, "custom_metrics": {"cost2_mean": -155.7210503982901, "system_level_velocity_max": 12.20703245460803, "cost2_max": -138.0539714162358, "outflow_rate_max": 1074.2429820039201, "cost2_min": -173.97195671483593, "cost1_min": 229.49288023215007, "system_level_velocity_mean": 10.782402537723744, "outflow_rate_min": 864.8390672458446, "cost1_max": 328.72322804680505, "outflow_rate_mean": 966.1151281237167, "cost1_mean": 286.847658980724, "system_level_velocity_min": 8.623692837682729}, "episodes_total": 2106, "timesteps_this_iter": 122589, "episodes_this_iter": 47, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 41, "timesteps_total": 4821400, "date": "2019-04-28_08-52-21", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4821400, "load_time_ms": 24.862, "grad_time_ms": 26985.695, "sample_time_ms": 15047.142, "num_steps_trained": 4821400, "update_time_ms": 11.29, "default": {"total_loss": 21.23770523071289, "kl": 0.010292107239365578, "entropy": 1.1664307117462158, "vf_loss": 21.23952293395996, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7390122413635254, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0020732609555125237}}, "episode_reward_mean": 843.5060764810883, "pid": 519, "time_total_s": 1707.8313088417053, "node_ip": "10.138.0.2", "timestamp": 1556441541, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e438>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ee48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e518>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 42, "time_since_restore": 1749.502771139145, "episode_reward_max": 950.5136734901172, "policy_reward_mean": {}, "timesteps_since_restore": 4942959, "episode_len_mean": 700.0, "episode_reward_min": 747.4704538490985, "hostname": "flow-main", "time_this_iter_s": 41.671462297439575, "custom_metrics": {"cost2_mean": -156.05151895049733, "system_level_velocity_max": 12.400412437310164, "cost2_max": -134.0088674456398, "outflow_rate_max": 1079.6901617107803, "cost2_min": -184.29498958110958, "cost1_min": 235.30120817063323, "system_level_velocity_mean": 10.773264392635383, "outflow_rate_min": 873.1963786422956, "cost1_max": 331.2231066105154, "outflow_rate_mean": 965.046965324472, "cost1_mean": 286.277519139744, "system_level_velocity_min": 8.930929409380097}, "episodes_total": 2160, "timesteps_this_iter": 121559, "episodes_this_iter": 54, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 42, "timesteps_total": 4942959, "date": "2019-04-28_08-53-03", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4942959, "load_time_ms": 24.744, "grad_time_ms": 26838.404, "sample_time_ms": 15003.322, "num_steps_trained": 4942959, "update_time_ms": 11.312, "default": {"total_loss": 22.200458526611328, "kl": 0.011227129958570004, "entropy": 1.1543182134628296, "vf_loss": 22.202800750732422, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7260921597480774, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.002620381535962224}}, "episode_reward_mean": 841.6348471871602, "pid": 519, "time_total_s": 1749.502771139145, "node_ip": "10.138.0.2", "timestamp": 1556441583, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984320>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99847f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984160>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 43, "time_since_restore": 1790.5072650909424, "episode_reward_max": 931.7823696777522, "policy_reward_mean": {}, "timesteps_since_restore": 5064613, "episode_len_mean": 700.0, "episode_reward_min": 747.4704538490985, "hostname": "flow-main", "time_this_iter_s": 41.004493951797485, "custom_metrics": {"cost2_mean": -154.22527247349805, "system_level_velocity_max": 12.400412437310164, "cost2_max": -134.0088674456398, "outflow_rate_max": 1079.6901617107803, "cost2_min": -184.29498958110958, "cost1_min": 235.30120817063323, "system_level_velocity_mean": 10.923288253196127, "outflow_rate_min": 873.1963786422956, "cost1_max": 331.2231066105154, "outflow_rate_mean": 975.216020301596, "cost1_mean": 290.15317610700015, "system_level_velocity_min": 8.930929409380097}, "episodes_total": 2208, "timesteps_this_iter": 121654, "episodes_this_iter": 48, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 43, "timesteps_total": 5064613, "date": "2019-04-28_08-53-44", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5064613, "load_time_ms": 24.813, "grad_time_ms": 26779.825, "sample_time_ms": 14956.363, "num_steps_trained": 5064613, "update_time_ms": 11.786, "default": {"total_loss": 20.081064224243164, "kl": 0.01177450455725193, "entropy": 1.1431987285614014, "vf_loss": 20.082956314086914, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7494425773620605, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0021849763579666615}}, "episode_reward_mean": 846.2528777920354, "pid": 519, "time_total_s": 1790.5072650909424, "node_ip": "10.138.0.2", "timestamp": 1556441624, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e438>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ee48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e518>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 44, "time_since_restore": 1831.2610664367676, "episode_reward_max": 914.4097589706561, "policy_reward_mean": {}, "timesteps_since_restore": 5185842, "episode_len_mean": 686.72, "episode_reward_min": 50.83795983877824, "hostname": "flow-main", "time_this_iter_s": 40.753801345825195, "custom_metrics": {"cost2_mean": -150.2799648311958, "system_level_velocity_max": 17.879004515622604, "cost2_max": -18.012603708666592, "outflow_rate_max": 1060.1745854914036, "cost2_min": -173.58398762793735, "cost1_min": 22.02385237314817, "system_level_velocity_mean": 11.080307780388651, "outflow_rate_min": 477.7122185428224, "cost1_max": 323.8907281593323, "outflow_rate_mean": 966.6573511173451, "cost1_mean": 285.29105611665045, "system_level_velocity_min": 8.584180457678293}, "episodes_total": 2260, "timesteps_this_iter": 121229, "episodes_this_iter": 52, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 44, "timesteps_total": 5185842, "date": "2019-04-28_08-54-25", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5185842, "load_time_ms": 24.667, "grad_time_ms": 26728.883, "sample_time_ms": 14913.011, "num_steps_trained": 5185842, "update_time_ms": 11.918, "default": {"total_loss": 22.0418643951416, "kl": 0.01168642845004797, "entropy": 1.1311181783676147, "vf_loss": 22.043472290039062, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7289270758628845, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0018982270266860723}}, "episode_reward_mean": 828.5771248587376, "pid": 519, "time_total_s": 1831.2610664367676, "node_ip": "10.138.0.2", "timestamp": 1556441665, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984f28>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99846d8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 45, "time_since_restore": 1872.1499440670013, "episode_reward_max": 914.4097589706561, "policy_reward_mean": {}, "timesteps_since_restore": 5307077, "episode_len_mean": 686.72, "episode_reward_min": 50.83795983877824, "hostname": "flow-main", "time_this_iter_s": 40.888877630233765, "custom_metrics": {"cost2_mean": -148.96398734433075, "system_level_velocity_max": 17.879004515622604, "cost2_max": -18.012603708666592, "outflow_rate_max": 1053.1270474621606, "cost2_min": -170.53847389460248, "cost1_min": 22.02385237314817, "system_level_velocity_mean": 10.984483745697998, "outflow_rate_min": 477.7122185428224, "cost1_max": 323.8907281593323, "outflow_rate_mean": 960.422148919537, "cost1_mean": 282.442752033688, "system_level_velocity_min": 8.584180457678293}, "episodes_total": 2308, "timesteps_this_iter": 121235, "episodes_this_iter": 48, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 45, "timesteps_total": 5307077, "date": "2019-04-28_08-55-06", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5307077, "load_time_ms": 23.735, "grad_time_ms": 26596.881, "sample_time_ms": 14827.184, "num_steps_trained": 5307077, "update_time_ms": 12.178, "default": {"total_loss": 19.135374069213867, "kl": 0.010703539475798607, "entropy": 1.119005560874939, "vf_loss": 19.13698387145996, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7526602149009705, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0018779173260554671}}, "episode_reward_mean": 821.7365962858295, "pid": 519, "time_total_s": 1872.1499440670013, "node_ip": "10.138.0.2", "timestamp": 1556441706, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9123198>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9964898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984c50>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 46, "time_since_restore": 1912.5248003005981, "episode_reward_max": 914.4097589706561, "policy_reward_mean": {}, "timesteps_since_restore": 5427542, "episode_len_mean": 680.05, "episode_reward_min": 47.24440623918829, "hostname": "flow-main", "time_this_iter_s": 40.3748562335968, "custom_metrics": {"cost2_mean": -147.00458849232868, "system_level_velocity_max": 17.739715407149486, "cost2_max": -17.443668924889614, "outflow_rate_max": 1053.1270474621606, "cost2_min": -168.01854665603713, "cost1_min": 21.81044148255942, "system_level_velocity_mean": 11.010158085483443, "outflow_rate_min": 491.0818408308928, "cost1_max": 321.16017034852814, "outflow_rate_mean": 954.806708051527, "cost1_mean": 278.33063848903134, "system_level_velocity_min": 9.374478081947785}, "episodes_total": 2357, "timesteps_this_iter": 120465, "episodes_this_iter": 49, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 46, "timesteps_total": 5427542, "date": "2019-04-28_08-55-46", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5427542, "load_time_ms": 23.495, "grad_time_ms": 26502.657, "sample_time_ms": 14772.127, "num_steps_trained": 5427542, "update_time_ms": 12.192, "default": {"total_loss": 19.545949935913086, "kl": 0.012877839617431164, "entropy": 1.095621943473816, "vf_loss": 19.547739028930664, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7562407851219177, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0021096442360430956}}, "episode_reward_mean": 811.2681046256029, "pid": 519, "time_total_s": 1912.5248003005981, "node_ip": "10.138.0.2", "timestamp": 1556441746, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91230b8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912eda0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 47, "time_since_restore": 1956.377034187317, "episode_reward_max": 917.808269657268, "policy_reward_mean": {}, "timesteps_since_restore": 5549399, "episode_len_mean": 686.7, "episode_reward_min": 47.24440623918829, "hostname": "flow-main", "time_this_iter_s": 43.85223388671875, "custom_metrics": {"cost2_mean": -149.05083098674925, "system_level_velocity_max": 17.739715407149486, "cost2_max": -17.443668924889614, "outflow_rate_max": 1048.7700263729673, "cost2_min": -172.63918930263742, "cost1_min": 21.81044148255942, "system_level_velocity_mean": 10.900655322088376, "outflow_rate_min": 492.665104950494, "cost1_max": 321.2366190902286, "outflow_rate_mean": 959.3426535216469, "cost1_mean": 280.5257814163358, "system_level_velocity_min": 9.425237038939992}, "episodes_total": 2408, "timesteps_this_iter": 121857, "episodes_this_iter": 51, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 47, "timesteps_total": 5549399, "date": "2019-04-28_08-56-30", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5549399, "load_time_ms": 24.309, "grad_time_ms": 26679.505, "sample_time_ms": 14774.543, "num_steps_trained": 5549399, "update_time_ms": 12.212, "default": {"total_loss": 19.240854263305664, "kl": 0.011615780182182789, "entropy": 1.0860826969146729, "vf_loss": 19.24246597290039, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7626122832298279, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.001903890515677631}}, "episode_reward_mean": 818.9533542349033, "pid": 519, "time_total_s": 1956.377034187317, "node_ip": "10.138.0.2", "timestamp": 1556441790, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9123c88>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9123550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9123b70>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 48, "time_since_restore": 1998.7604932785034, "episode_reward_max": 917.808269657268, "policy_reward_mean": {}, "timesteps_since_restore": 5672596, "episode_len_mean": 700.0, "episode_reward_min": 777.3274722622268, "hostname": "flow-main", "time_this_iter_s": 42.38345909118652, "custom_metrics": {"cost2_mean": -152.49554354925934, "system_level_velocity_max": 11.991258047707534, "cost2_max": -128.0572551633494, "outflow_rate_max": 1048.7700263729673, "cost2_min": -172.63918930263742, "cost1_min": 250.1823921934968, "system_level_velocity_mean": 10.771586695758355, "outflow_rate_min": 882.5631070853839, "cost1_max": 321.2366190902286, "outflow_rate_mean": 969.4221847368781, "cost1_mean": 286.21745196365146, "system_level_velocity_min": 9.332797784206099}, "episodes_total": 2454, "timesteps_this_iter": 123197, "episodes_this_iter": 46, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 48, "timesteps_total": 5672596, "date": "2019-04-28_08-57-12", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5672596, "load_time_ms": 24.157, "grad_time_ms": 26658.726, "sample_time_ms": 14819.814, "num_steps_trained": 5672596, "update_time_ms": 12.324, "default": {"total_loss": 17.932083129882812, "kl": 0.013501960784196854, "entropy": 1.0841211080551147, "vf_loss": 17.934247970581055, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7811866402626038, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.002502261893823743}}, "episode_reward_mean": 835.9446113237332, "pid": 519, "time_total_s": 1998.7604932785034, "node_ip": "10.138.0.2", "timestamp": 1556441832, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984908>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99840f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984208>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 49, "time_since_restore": 2040.3380584716797, "episode_reward_max": 893.3764143750611, "policy_reward_mean": {}, "timesteps_since_restore": 5794979, "episode_len_mean": 693.35, "episode_reward_min": 47.70833372563406, "hostname": "flow-main", "time_this_iter_s": 41.57756519317627, "custom_metrics": {"cost2_mean": -153.68801368476144, "system_level_velocity_max": 18.012319708730125, "cost2_max": -19.29639348026468, "outflow_rate_max": 1047.1801108113668, "cost2_min": -169.27465894060944, "cost1_min": 22.333652937701977, "system_level_velocity_mean": 10.78761507067921, "outflow_rate_min": 506.069524914099, "cost1_max": 312.80649845453536, "outflow_rate_mean": 965.6172525470644, "cost1_mean": 281.9085439758222, "system_level_velocity_min": 8.774108131575243}, "episodes_total": 2508, "timesteps_this_iter": 122383, "episodes_this_iter": 54, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 49, "timesteps_total": 5794979, "date": "2019-04-28_08-57-54", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5794979, "load_time_ms": 24.116, "grad_time_ms": 26635.334, "sample_time_ms": 14757.454, "num_steps_trained": 5794979, "update_time_ms": 12.296, "default": {"total_loss": 20.16918182373047, "kl": 0.012743841856718063, "entropy": 1.073348879814148, "vf_loss": 20.170930862426758, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7759472131729126, "cur_kl_coeff": 0.025000005960464478, "policy_loss": -0.0020667666103690863}}, "episode_reward_mean": 824.8608264818669, "pid": 519, "time_total_s": 2040.3380584716797, "node_ip": "10.138.0.2", "timestamp": 1556441874, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9123da0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91232e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9123160>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 50, "time_since_restore": 2081.7117676734924, "episode_reward_max": 902.7998453782253, "policy_reward_mean": {}, "timesteps_since_restore": 5915774, "episode_len_mean": 686.76, "episode_reward_min": 47.70833372563406, "hostname": "flow-main", "time_this_iter_s": 41.373709201812744, "custom_metrics": {"cost2_mean": -149.82932957409764, "system_level_velocity_max": 18.012319708730125, "cost2_max": -19.29639348026468, "outflow_rate_max": 1048.956367595694, "cost2_min": -169.44970918745284, "cost1_min": 22.333652937701977, "system_level_velocity_mean": 10.946199859841153, "outflow_rate_min": 496.56000254389204, "cost1_max": 315.35678693421977, "outflow_rate_mean": 966.3798184464197, "cost1_mean": 282.0271904336053, "system_level_velocity_min": 8.774108131575243}, "episodes_total": 2562, "timesteps_this_iter": 120795, "episodes_this_iter": 54, "experiment_id": "801840af3cae49fb949cf6ac47d149e7", "iterations_since_restore": 50, "timesteps_total": 5915774, "date": "2019-04-28_08-58-35", "done": true, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5915774, "load_time_ms": 24.486, "grad_time_ms": 26635.912, "sample_time_ms": 14717.293, "num_steps_trained": 5915774, "update_time_ms": 12.116, "default": {"total_loss": 18.616586685180664, "kl": 0.011124684475362301, "entropy": 1.0651723146438599, "vf_loss": 18.61825180053711, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7964193224906921, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -0.0019455833826214075}}, "episode_reward_mean": 815.6032539643975, "pid": 519, "time_total_s": 2081.7117676734924, "node_ip": "10.138.0.2", "timestamp": 1556441915, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984240>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984400>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "dim": 84, "custom_options": {}, "conv_filters": null, "zero_mean": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "lstm_cell_size": 256, "free_log_std": false, "grayscale": false, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "framestack": true}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:10.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "optimizer": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}

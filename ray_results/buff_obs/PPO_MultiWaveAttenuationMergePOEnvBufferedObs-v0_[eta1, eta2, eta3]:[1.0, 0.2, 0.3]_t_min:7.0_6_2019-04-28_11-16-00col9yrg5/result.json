{"training_iteration": 1, "time_since_restore": 42.747759103775024, "episode_reward_max": 516.6251310413877, "policy_reward_mean": {}, "timesteps_since_restore": 121012, "episode_len_mean": 655.6666666666666, "episode_reward_min": 47.15616515538296, "hostname": "flow-main", "time_this_iter_s": 42.747759103775024, "custom_metrics": {"cost2_mean": -31.530100377985494, "system_level_velocity_max": 17.641362772773803, "cost2_max": -16.377076395792557, "outflow_rate_max": 687.0122095224774, "system_level_velocity_mean": 8.533086340019837, "cost1_min": 22.395840027649342, "cost2_min": -43.08140464577825, "outflow_rate_min": 496.97753063255885, "cost1_max": 224.4670224628373, "outflow_rate_mean": 606.0022084650259, "cost1_mean": 190.3328343551661, "system_level_velocity_min": 6.931658535489777}, "episodes_total": 15, "timesteps_this_iter": 121012, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 1, "timesteps_total": 121012, "date": "2019-04-28_11-16-54", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 121012, "num_steps_trained": 121012, "load_time_ms": 78.611, "grad_time_ms": 27019.305, "sample_time_ms": 14641.329, "default": {"total_loss": 1.9509766101837158, "cur_lr": 0.0005000000237487257, "entropy": 1.4192804098129272, "vf_loss": 1.9510245323181152, "cur_kl_coeff": 0.20000003278255463, "vf_explained_var": 0.8340030908584595, "kl": 0.001312381005845964, "policy_loss": -0.000310342526063323}, "update_time_ms": 726.647}, "episode_reward_mean": 379.53914390557526, "episodes_this_iter": 15, "time_total_s": 42.747759103775024, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450214, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99647f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9964ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99642b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 2, "time_since_restore": 85.18283295631409, "episode_reward_max": 650.3153585253933, "policy_reward_mean": {}, "timesteps_since_restore": 241533, "episode_len_mean": 691.474358974359, "episode_reward_min": 47.15616515538296, "hostname": "flow-main", "time_this_iter_s": 42.43507385253906, "custom_metrics": {"cost2_mean": -37.69797264128157, "system_level_velocity_max": 17.641362772773803, "cost2_max": -16.377076395792557, "outflow_rate_max": 750.8949480830946, "system_level_velocity_mean": 7.725878075585767, "cost1_min": 22.395840027649342, "cost2_min": -62.6100230638929, "outflow_rate_min": 496.97753063255885, "cost1_max": 243.5844358719053, "outflow_rate_mean": 603.68211816002, "cost1_mean": 194.25084529364898, "system_level_velocity_min": 6.259859071830668}, "episodes_total": 78, "timesteps_this_iter": 120521, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 2, "timesteps_total": 241533, "date": "2019-04-28_11-17-37", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 241533, "num_steps_trained": 241533, "load_time_ms": 50.719, "grad_time_ms": 26657.205, "sample_time_ms": 15253.105, "default": {"total_loss": 2.3764431476593018, "cur_lr": 0.0005000000237487257, "entropy": 1.4014791250228882, "vf_loss": 2.378065347671509, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.8816131949424744, "kl": 0.006303450558334589, "policy_loss": -0.0022528404369950294}, "update_time_ms": 369.784}, "episode_reward_mean": 461.78261695616504, "episodes_this_iter": 63, "time_total_s": 85.18283295631409, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450257, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91480f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148f28>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 3, "time_since_restore": 124.55356740951538, "episode_reward_max": 731.4467965783545, "policy_reward_mean": {}, "timesteps_since_restore": 355948, "episode_len_mean": 693.35, "episode_reward_min": 49.88422427632035, "hostname": "flow-main", "time_this_iter_s": 39.370734453201294, "custom_metrics": {"cost2_mean": -39.18500318532541, "system_level_velocity_max": 17.680250841269295, "cost2_max": -15.687198212367182, "outflow_rate_max": 793.7722965814751, "system_level_velocity_mean": 7.8552438595183744, "cost1_min": 21.906779934932235, "cost2_min": -67.2565853974282, "outflow_rate_min": 411.96349747650174, "cost1_max": 265.31259397130094, "outflow_rate_mean": 613.3502150193552, "cost1_mean": 199.2749880847134, "system_level_velocity_min": 6.232771036055791}, "episodes_total": 132, "timesteps_this_iter": 114415, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 3, "timesteps_total": 355948, "date": "2019-04-28_11-18-16", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 355948, "num_steps_trained": 355948, "load_time_ms": 38.207, "grad_time_ms": 25922.747, "sample_time_ms": 15055.044, "default": {"total_loss": 5.116552352905273, "cur_lr": 0.0005000000237487257, "entropy": 1.3834120035171509, "vf_loss": 5.119612693786621, "cur_kl_coeff": 0.10000002384185791, "vf_explained_var": 0.8816971778869629, "kl": 0.008046118542551994, "policy_loss": -0.0038646904285997152}, "update_time_ms": 250.084}, "episode_reward_mean": 502.8249094187941, "episodes_this_iter": 54, "time_total_s": 124.55356740951538, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450296, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a3c8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a5c0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 4, "time_since_restore": 165.82822966575623, "episode_reward_max": 965.2609572285998, "policy_reward_mean": {}, "timesteps_since_restore": 470850, "episode_len_mean": 686.62, "episode_reward_min": 39.9910390204033, "hostname": "flow-main", "time_this_iter_s": 41.274662256240845, "custom_metrics": {"cost2_mean": -41.9327205470137, "system_level_velocity_max": 18.189185602975968, "cost2_max": -14.784400067635078, "outflow_rate_max": 882.3671791220393, "system_level_velocity_mean": 9.158503458788896, "cost1_min": 17.282059756608714, "cost2_min": -67.2565853974282, "outflow_rate_min": 432.5705924699819, "cost1_max": 303.6596714850182, "outflow_rate_mean": 702.4496933549459, "cost1_mean": 230.64655749176444, "system_level_velocity_min": 6.232771036055791}, "episodes_total": 193, "timesteps_this_iter": 114902, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 4, "timesteps_total": 470850, "date": "2019-04-28_11-18-57", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 470850, "num_steps_trained": 470850, "load_time_ms": 31.703, "grad_time_ms": 25821.894, "sample_time_ms": 15166.176, "default": {"total_loss": 10.657939910888672, "cur_lr": 0.0005000000237487257, "entropy": 1.3706543445587158, "vf_loss": 10.660377502441406, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7710882425308228, "kl": 0.007203353103250265, "policy_loss": -0.0031576608307659626}, "update_time_ms": 190.663}, "episode_reward_mean": 664.9767667026695, "episodes_this_iter": 61, "time_total_s": 165.82822966575623, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450337, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148b38>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148630>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 5, "time_since_restore": 206.16372227668762, "episode_reward_max": 1027.9067465063388, "policy_reward_mean": {}, "timesteps_since_restore": 582952, "episode_len_mean": 693.27, "episode_reward_min": 39.9910390204033, "hostname": "flow-main", "time_this_iter_s": 40.3354926109314, "custom_metrics": {"cost2_mean": -46.90609506710501, "system_level_velocity_max": 18.189185602975968, "cost2_max": -14.784400067635078, "outflow_rate_max": 964.7865122664281, "system_level_velocity_mean": 10.365617913696502, "cost1_min": 17.282059756608714, "cost2_min": -61.34521498571064, "outflow_rate_min": 454.1881787896761, "cost1_max": 327.1025571021029, "outflow_rate_mean": 813.8123918242071, "cost1_mean": 269.3898512137454, "system_level_velocity_min": 7.389978363931547}, "episodes_total": 249, "timesteps_this_iter": 112102, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 5, "timesteps_total": 582952, "date": "2019-04-28_11-19-38", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 582952, "num_steps_trained": 582952, "load_time_ms": 27.858, "grad_time_ms": 25555.178, "sample_time_ms": 15255.637, "default": {"total_loss": 14.590984344482422, "cur_lr": 0.0005000000237487257, "entropy": 1.359052062034607, "vf_loss": 14.591684341430664, "cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.7217211127281189, "kl": 0.004346628673374653, "policy_loss": -0.0011353851296007633}, "update_time_ms": 154.58}, "episode_reward_mean": 864.7760883952993, "episodes_this_iter": 56, "time_total_s": 206.16372227668762, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450378, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a5f8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914aef0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 6, "time_since_restore": 247.755441904068, "episode_reward_max": 1049.0168927086547, "policy_reward_mean": {}, "timesteps_since_restore": 695136, "episode_len_mean": 693.27, "episode_reward_min": 38.63705662529631, "hostname": "flow-main", "time_this_iter_s": 41.59171962738037, "custom_metrics": {"cost2_mean": -47.166102781071906, "system_level_velocity_max": 17.311057780332245, "cost2_max": -14.638132835367722, "outflow_rate_max": 964.7865122664281, "system_level_velocity_mean": 11.046555085370798, "cost1_min": 17.618338150901746, "cost2_min": -62.58161755042483, "outflow_rate_min": 487.8590816741719, "cost1_max": 327.6556457419784, "outflow_rate_mean": 876.9401784016424, "cost1_mean": 289.4092747116709, "system_level_velocity_min": 8.432651552194422}, "episodes_total": 311, "timesteps_this_iter": 112184, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 6, "timesteps_total": 695136, "date": "2019-04-28_11-20-19", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 695136, "num_steps_trained": 695136, "load_time_ms": 26.847, "grad_time_ms": 25524.746, "sample_time_ms": 15372.96, "default": {"total_loss": 16.998958587646484, "cur_lr": 0.0005000000237487257, "entropy": 1.3465460538864136, "vf_loss": 16.999929428100586, "cur_kl_coeff": 0.05000000819563866, "vf_explained_var": 0.685062050819397, "kl": 0.006471842993050814, "policy_loss": -0.0012939159059897065}, "update_time_ms": 130.629}, "episode_reward_mean": 969.8905052935733, "episodes_this_iter": 62, "time_total_s": 247.755441904068, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450419, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148eb8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148d68>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 7, "time_since_restore": 288.8328182697296, "episode_reward_max": 1052.0999803933132, "policy_reward_mean": {}, "timesteps_since_restore": 810106, "episode_len_mean": 700.0, "episode_reward_min": 925.1725077183808, "hostname": "flow-main", "time_this_iter_s": 41.07737636566162, "custom_metrics": {"cost2_mean": -45.040110979079934, "system_level_velocity_max": 12.461246780268116, "cost2_max": -33.362207117029854, "outflow_rate_max": 951.6727576093534, "system_level_velocity_mean": 11.013072856910467, "cost1_min": 226.1050652465814, "cost2_min": -62.58161755042483, "outflow_rate_min": 801.3059513326654, "cost1_max": 328.4066667911661, "outflow_rate_mean": 885.9010881015793, "cost1_mean": 293.5598833676479, "system_level_velocity_min": 8.432651552194422}, "episodes_total": 370, "timesteps_this_iter": 114970, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 7, "timesteps_total": 810106, "date": "2019-04-28_11-21-00", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 810106, "num_steps_trained": 810106, "load_time_ms": 26.276, "grad_time_ms": 25436.278, "sample_time_ms": 15448.191, "default": {"total_loss": 17.033187866210938, "cur_lr": 0.0005000000237487257, "entropy": 1.348189353942871, "vf_loss": 17.033796310424805, "cur_kl_coeff": 0.050000011920928955, "vf_explained_var": 0.675902247428894, "kl": 0.0048520611599087715, "policy_loss": -0.0008508751634508371}, "update_time_ms": 114.275}, "episode_reward_mean": 994.4005716373628, "episodes_this_iter": 59, "time_total_s": 288.8328182697296, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450460, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91237f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914af98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a9b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 8, "time_since_restore": 330.8778417110443, "episode_reward_max": 1052.0999803933132, "policy_reward_mean": {}, "timesteps_since_restore": 927276, "episode_len_mean": 693.37, "episode_reward_min": 52.242473115194, "hostname": "flow-main", "time_this_iter_s": 42.0450234413147, "custom_metrics": {"cost2_mean": -43.715582320742804, "system_level_velocity_max": 18.129166086111425, "cost2_max": -16.87571079177031, "outflow_rate_max": 947.0485327482385, "system_level_velocity_mean": 10.922425096274214, "cost1_min": 23.897537340223714, "cost2_min": -60.515550132126094, "outflow_rate_min": 494.28103892319024, "cost1_max": 328.4066667911661, "outflow_rate_mean": 869.3252606437932, "cost1_mean": 286.63466850644204, "system_level_velocity_min": 8.858702674657534}, "episodes_total": 409, "timesteps_this_iter": 117170, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 8, "timesteps_total": 927276, "date": "2019-04-28_11-21-42", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 927276, "num_steps_trained": 927276, "load_time_ms": 25.836, "grad_time_ms": 25553.45, "sample_time_ms": 15443.662, "default": {"total_loss": 13.2130765914917, "cur_lr": 0.0005000000237487257, "entropy": 1.3346543312072754, "vf_loss": 13.213604927062988, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7743139863014221, "kl": 0.00538985850289464, "policy_loss": -0.0006634726305492222}, "update_time_ms": 101.393}, "episode_reward_mean": 977.409065394412, "episodes_this_iter": 39, "time_total_s": 330.8778417110443, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450502, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148d30>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148ba8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 9, "time_since_restore": 373.6740584373474, "episode_reward_max": 1037.5535301839452, "policy_reward_mean": {}, "timesteps_since_restore": 1046046, "episode_len_mean": 693.37, "episode_reward_min": 52.242473115194, "hostname": "flow-main", "time_this_iter_s": 42.7962167263031, "custom_metrics": {"cost2_mean": -42.12038173712317, "system_level_velocity_max": 18.129166086111425, "cost2_max": -16.87571079177031, "outflow_rate_max": 938.0170575522105, "system_level_velocity_mean": 10.552448556050798, "cost1_min": 23.897537340223714, "cost2_min": -57.53781361447261, "outflow_rate_min": 494.28103892319024, "cost1_max": 328.282404004604, "outflow_rate_mean": 846.4880319709343, "cost1_mean": 276.6331470313323, "system_level_velocity_min": 8.077375891408304}, "episodes_total": 465, "timesteps_this_iter": 118770, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 9, "timesteps_total": 1046046, "date": "2019-04-28_11-22-25", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1046046, "num_steps_trained": 1046046, "load_time_ms": 25.433, "grad_time_ms": 25661.838, "sample_time_ms": 15505.2, "default": {"total_loss": 17.15804100036621, "cur_lr": 0.0005000000237487257, "entropy": 1.3255993127822876, "vf_loss": 17.15871238708496, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7220438122749329, "kl": 0.0062878988683223724, "policy_loss": -0.0008266604854725301}, "update_time_ms": 91.134}, "episode_reward_mean": 962.4593238191525, "episodes_this_iter": 56, "time_total_s": 373.6740584373474, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450545, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a2b0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a208>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 10, "time_since_restore": 414.98059606552124, "episode_reward_max": 1088.1313979100332, "policy_reward_mean": {}, "timesteps_since_restore": 1162806, "episode_len_mean": 700.0, "episode_reward_min": 821.7562265175936, "hostname": "flow-main", "time_this_iter_s": 41.30653762817383, "custom_metrics": {"cost2_mean": -40.63566958123286, "system_level_velocity_max": 12.229684964625756, "cost2_max": -31.569348324869523, "outflow_rate_max": 963.507311113664, "system_level_velocity_mean": 10.435264106347931, "cost1_min": 214.53448538575765, "cost2_min": -55.0710063410084, "outflow_rate_min": 732.0726310618854, "cost1_max": 326.1756665714005, "outflow_rate_mean": 852.6055179742341, "cost1_mean": 278.6242351171049, "system_level_velocity_min": 8.077375891408304}, "episodes_total": 513, "timesteps_this_iter": 116760, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 10, "timesteps_total": 1162806, "date": "2019-04-28_11-23-07", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1162806, "num_steps_trained": 1162806, "load_time_ms": 25.063, "grad_time_ms": 25684.86, "sample_time_ms": 15470.026, "default": {"total_loss": 16.050086975097656, "cur_lr": 0.0005000000237487257, "entropy": 1.311428189277649, "vf_loss": 16.051408767700195, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7603585124015808, "kl": 0.007627625018358231, "policy_loss": -0.0015126949874684215}, "update_time_ms": 83.111}, "episode_reward_mean": 981.7642866587423, "episodes_this_iter": 48, "time_total_s": 414.98059606552124, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450587, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148080>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 11, "time_since_restore": 456.7994327545166, "episode_reward_max": 1121.5483705212196, "policy_reward_mean": {}, "timesteps_since_restore": 1280402, "episode_len_mean": 693.37, "episode_reward_min": 54.721575592748536, "hostname": "flow-main", "time_this_iter_s": 41.81883668899536, "custom_metrics": {"cost2_mean": -39.02466826910406, "system_level_velocity_max": 18.013721404982594, "cost2_max": -14.156506269682488, "outflow_rate_max": 963.507311113664, "system_level_velocity_mean": 10.915648486284944, "cost1_min": 23.570391886161207, "cost2_min": -59.81618843598694, "outflow_rate_min": 495.99784868927117, "cost1_max": 330.73074886777135, "outflow_rate_mean": 876.5978601732885, "cost1_mean": 287.4810893973082, "system_level_velocity_min": 8.157110597158406}, "episodes_total": 570, "timesteps_this_iter": 117596, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 11, "timesteps_total": 1280402, "date": "2019-04-28_11-23-48", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1280402, "num_steps_trained": 1280402, "load_time_ms": 19.484, "grad_time_ms": 25510.7, "sample_time_ms": 15634.073, "default": {"total_loss": 19.588695526123047, "cur_lr": 0.0005000000237487257, "entropy": 1.3054052591323853, "vf_loss": 19.589317321777344, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7061464786529541, "kl": 0.006101373583078384, "policy_loss": -0.0007767966599203646}, "update_time_ms": 11.503}, "episode_reward_mean": 1012.5726121527505, "episodes_this_iter": 57, "time_total_s": 456.7994327545166, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450628, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ae10>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a240>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 12, "time_since_restore": 497.2634861469269, "episode_reward_max": 1165.319067444349, "policy_reward_mean": {}, "timesteps_since_restore": 1395230, "episode_len_mean": 693.37, "episode_reward_min": 54.721575592748536, "hostname": "flow-main", "time_this_iter_s": 40.46405339241028, "custom_metrics": {"cost2_mean": -38.61184369270673, "system_level_velocity_max": 18.013721404982594, "cost2_max": -14.156506269682488, "outflow_rate_max": 999.3661461086973, "system_level_velocity_mean": 11.156808929538581, "cost1_min": 23.570391886161207, "cost2_min": -57.32223008575177, "outflow_rate_min": 495.99784868927117, "cost1_max": 343.93808026382135, "outflow_rate_mean": 897.495296852427, "cost1_mean": 294.5800604746753, "system_level_velocity_min": 8.157110597158406}, "episodes_total": 621, "timesteps_this_iter": 114828, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 12, "timesteps_total": 1395230, "date": "2019-04-28_11-24-29", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1395230, "num_steps_trained": 1395230, "load_time_ms": 19.557, "grad_time_ms": 25377.077, "sample_time_ms": 15571.606, "default": {"total_loss": 19.67340660095215, "cur_lr": 0.0005000000237487257, "entropy": 1.2795233726501465, "vf_loss": 19.67427635192871, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6664414405822754, "kl": 0.006930692587047815, "policy_loss": -0.0010415141005069017}, "update_time_ms": 11.326}, "episode_reward_mean": 1048.2332483676742, "episodes_this_iter": 51, "time_total_s": 497.2634861469269, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450669, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148f28>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 13, "time_since_restore": 538.5072021484375, "episode_reward_max": 1181.8341776502998, "policy_reward_mean": {}, "timesteps_since_restore": 1509151, "episode_len_mean": 700.0, "episode_reward_min": 946.5951539408599, "hostname": "flow-main", "time_this_iter_s": 41.24371600151062, "custom_metrics": {"cost2_mean": -38.49935702505461, "system_level_velocity_max": 13.482451575832767, "cost2_max": -30.557099088162467, "outflow_rate_max": 1037.7734076345062, "system_level_velocity_mean": 11.246753212910743, "cost1_min": 213.96706550141337, "cost2_min": -58.5671050736741, "outflow_rate_min": 784.1842808113196, "cost1_max": 362.01079275454583, "outflow_rate_mean": 914.3305583075725, "cost1_mean": 302.29359914932485, "system_level_velocity_min": 7.881985394865167}, "episodes_total": 682, "timesteps_this_iter": 113921, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 13, "timesteps_total": 1509151, "date": "2019-04-28_11-25-10", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1509151, "num_steps_trained": 1509151, "load_time_ms": 20.461, "grad_time_ms": 25441.432, "sample_time_ms": 15693.762, "default": {"total_loss": 24.23904037475586, "cur_lr": 0.0005000000237487257, "entropy": 1.266241431236267, "vf_loss": 24.24053192138672, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6493872404098511, "kl": 0.008004272356629372, "policy_loss": -0.0016920012421905994}, "update_time_ms": 11.348}, "episode_reward_mean": 1077.9104701333436, "episodes_this_iter": 61, "time_total_s": 538.5072021484375, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450710, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a240>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a400>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 14, "time_since_restore": 578.6869869232178, "episode_reward_max": 1203.0254913482263, "policy_reward_mean": {}, "timesteps_since_restore": 1623589, "episode_len_mean": 700.0, "episode_reward_min": 946.5951539408599, "hostname": "flow-main", "time_this_iter_s": 40.17978477478027, "custom_metrics": {"cost2_mean": -35.512964852104425, "system_level_velocity_max": 14.140584623644378, "cost2_max": -26.069009106921584, "outflow_rate_max": 1048.338481508903, "system_level_velocity_mean": 11.699683556790246, "cost1_min": 213.96706550141337, "cost2_min": -58.5671050736741, "outflow_rate_min": 784.1842808113196, "cost1_max": 376.98081571032924, "outflow_rate_mean": 935.3590327356987, "cost1_mean": 314.22353902433025, "system_level_velocity_min": 7.881985394865167}, "episodes_total": 740, "timesteps_this_iter": 114438, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 14, "timesteps_total": 1623589, "date": "2019-04-28_11-25-50", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1623589, "num_steps_trained": 1623589, "load_time_ms": 20.467, "grad_time_ms": 25300.601, "sample_time_ms": 15725.743, "default": {"total_loss": 24.718029022216797, "cur_lr": 0.0005000000237487257, "entropy": 1.2618790864944458, "vf_loss": 24.719181060791016, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6484780311584473, "kl": 0.007395006250590086, "policy_loss": -0.0013367702485993505}, "update_time_ms": 11.215}, "episode_reward_mean": 1097.1105820674904, "episodes_this_iter": 58, "time_total_s": 578.6869869232178, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450750, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148a58>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91480f0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 15, "time_since_restore": 620.6773598194122, "episode_reward_max": 1188.1352276694008, "policy_reward_mean": {}, "timesteps_since_restore": 1736066, "episode_len_mean": 700.0, "episode_reward_min": 967.4763986868916, "hostname": "flow-main", "time_this_iter_s": 41.99037289619446, "custom_metrics": {"cost2_mean": -31.849531101184922, "system_level_velocity_max": 14.726562784259835, "cost2_max": -23.3288362212083, "outflow_rate_max": 1048.338481508903, "system_level_velocity_mean": 12.324797557247587, "cost1_min": 262.8452985525141, "cost2_min": -43.72240240410472, "outflow_rate_min": 826.5052175908771, "cost1_max": 392.12285505922586, "outflow_rate_mean": 955.7845887840181, "cost1_mean": 330.5130639480911, "system_level_velocity_min": 9.860348051174952}, "episodes_total": 794, "timesteps_this_iter": 112477, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 15, "timesteps_total": 1736066, "date": "2019-04-28_11-26-32", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1736066, "num_steps_trained": 1736066, "load_time_ms": 21.353, "grad_time_ms": 25505.858, "sample_time_ms": 15682.898, "default": {"total_loss": 27.266399383544922, "cur_lr": 0.0005000000237487257, "entropy": 1.2490415573120117, "vf_loss": 27.26728057861328, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.6373499035835266, "kl": 0.007929005660116673, "policy_loss": -0.0010807752842083573}, "update_time_ms": 11.241}, "episode_reward_mean": 1109.535449788352, "episodes_this_iter": 54, "time_total_s": 620.6773598194122, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450792, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148ac8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148550>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 16, "time_since_restore": 660.8962841033936, "episode_reward_max": 1173.1456439055041, "policy_reward_mean": {}, "timesteps_since_restore": 1845856, "episode_len_mean": 700.0, "episode_reward_min": 901.6292347737809, "hostname": "flow-main", "time_this_iter_s": 40.21892428398132, "custom_metrics": {"cost2_mean": -29.025849568796733, "system_level_velocity_max": 15.137351860041028, "cost2_max": -22.10000698528352, "outflow_rate_max": 1044.4188026188044, "system_level_velocity_mean": 12.462729286385501, "cost1_min": 267.44414601290765, "cost2_min": -40.42691975578852, "outflow_rate_min": 815.209849763391, "cost1_max": 398.00064220582885, "outflow_rate_mean": 940.428916907783, "cost1_mean": 333.56143497361586, "system_level_velocity_min": 9.978719989796222}, "episodes_total": 857, "timesteps_this_iter": 109790, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 16, "timesteps_total": 1845856, "date": "2019-04-28_11-27-13", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1845856, "num_steps_trained": 1845856, "load_time_ms": 20.337, "grad_time_ms": 25410.426, "sample_time_ms": 15642.47, "default": {"total_loss": 32.95502471923828, "cur_lr": 0.0005000000237487257, "entropy": 1.2288700342178345, "vf_loss": 32.95518493652344, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.5416726469993591, "kl": 0.008325107395648956, "policy_loss": -0.0003709784068632871}, "update_time_ms": 11.22}, "episode_reward_mean": 1075.9306035132304, "episodes_this_iter": 63, "time_total_s": 660.8962841033936, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450833, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ab38>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e048>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 17, "time_since_restore": 699.4539773464203, "episode_reward_max": 1147.588700566193, "policy_reward_mean": {}, "timesteps_since_restore": 1954269, "episode_len_mean": 700.0, "episode_reward_min": 901.6292347737809, "hostname": "flow-main", "time_this_iter_s": 38.55769324302673, "custom_metrics": {"cost2_mean": -25.34127695662992, "system_level_velocity_max": 15.137351860041028, "cost2_max": -20.20910941355119, "outflow_rate_max": 1044.4188026188044, "system_level_velocity_mean": 12.742506819257555, "cost1_min": 256.92067406543777, "cost2_min": -40.33836287905463, "outflow_rate_min": 814.351241691518, "cost1_max": 398.00064220582885, "outflow_rate_mean": 929.7333160348558, "cost1_mean": 340.6693144933244, "system_level_velocity_min": 9.534445575148245}, "episodes_total": 917, "timesteps_this_iter": 108413, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 17, "timesteps_total": 1954269, "date": "2019-04-28_11-27-51", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1954269, "num_steps_trained": 1954269, "load_time_ms": 20.15, "grad_time_ms": 25277.302, "sample_time_ms": 15526.085, "default": {"total_loss": 31.42609977722168, "cur_lr": 0.0005000000237487257, "entropy": 1.2237389087677002, "vf_loss": 31.426422119140625, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.5234377980232239, "kl": 0.008756187744438648, "policy_loss": -0.0005427376599982381}, "update_time_ms": 10.704}, "episode_reward_mean": 1048.5374299470463, "episodes_this_iter": 60, "time_total_s": 699.4539773464203, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450871, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a3c8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914aef0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 18, "time_since_restore": 738.6545083522797, "episode_reward_max": 1131.9990557051005, "policy_reward_mean": {}, "timesteps_since_restore": 2062440, "episode_len_mean": 700.0, "episode_reward_min": 744.7760495637604, "hostname": "flow-main", "time_this_iter_s": 39.200531005859375, "custom_metrics": {"cost2_mean": -23.56179651104083, "system_level_velocity_max": 14.84496070104873, "cost2_max": -18.474879620527503, "outflow_rate_max": 1006.1733581544496, "system_level_velocity_mean": 12.613852666110512, "cost1_min": 255.16244966021858, "cost2_min": -29.077630698516334, "outflow_rate_min": 728.8800419459752, "cost1_max": 394.474778508536, "outflow_rate_mean": 909.8372179042727, "cost1_mean": 337.5142869935442, "system_level_velocity_min": 9.517710865329898}, "episodes_total": 978, "timesteps_this_iter": 108171, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 18, "timesteps_total": 2062440, "date": "2019-04-28_11-28-30", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2062440, "num_steps_trained": 2062440, "load_time_ms": 19.759, "grad_time_ms": 25013.805, "sample_time_ms": 15506.626, "default": {"total_loss": 29.670085906982422, "cur_lr": 0.0005000000237487257, "entropy": 1.2214462757110596, "vf_loss": 29.671096801757812, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.4867456555366516, "kl": 0.009160839952528477, "policy_loss": -0.0012391539057716727}, "update_time_ms": 10.698}, "episode_reward_mean": 1001.1539285493396, "episodes_this_iter": 61, "time_total_s": 738.6545083522797, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450910, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148ef0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148a90>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 19, "time_since_restore": 778.1775522232056, "episode_reward_max": 1130.6879112696156, "policy_reward_mean": {}, "timesteps_since_restore": 2170483, "episode_len_mean": 700.0, "episode_reward_min": 771.5704259108609, "hostname": "flow-main", "time_this_iter_s": 39.5230438709259, "custom_metrics": {"cost2_mean": -23.375712906663082, "system_level_velocity_max": 14.383338036413619, "cost2_max": -18.474879620527503, "outflow_rate_max": 996.1666296077433, "system_level_velocity_mean": 12.726913248019532, "cost1_min": 255.16244966021858, "cost2_min": -30.448483768392904, "outflow_rate_min": 795.1128830766193, "cost1_max": 386.3533326089524, "outflow_rate_mean": 909.1412856102346, "cost1_mean": 340.7099746674518, "system_level_velocity_min": 9.517710865329898}, "episodes_total": 1039, "timesteps_this_iter": 108043, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 19, "timesteps_total": 2170483, "date": "2019-04-28_11-29-10", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2170483, "num_steps_trained": 2170483, "load_time_ms": 19.704, "grad_time_ms": 24760.942, "sample_time_ms": 15432.304, "default": {"total_loss": 33.94468688964844, "cur_lr": 0.0005000000237487257, "entropy": 1.2154821157455444, "vf_loss": 33.94622039794922, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.4624631702899933, "kl": 0.009272471070289612, "policy_loss": -0.0017634570831432939}, "update_time_ms": 11.309}, "episode_reward_mean": 997.057764593395, "episodes_this_iter": 61, "time_total_s": 778.1775522232056, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450950, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a240>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a400>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 20, "time_since_restore": 815.7976849079132, "episode_reward_max": 1112.213576944377, "policy_reward_mean": {}, "timesteps_since_restore": 2277612, "episode_len_mean": 700.0, "episode_reward_min": 810.2879692376324, "hostname": "flow-main", "time_this_iter_s": 37.62013268470764, "custom_metrics": {"cost2_mean": -24.787348918074432, "system_level_velocity_max": 14.620930522117025, "cost2_max": -19.37622411015412, "outflow_rate_max": 1020.8028154316189, "system_level_velocity_mean": 12.914756098018936, "cost1_min": 262.6327556344453, "cost2_min": -33.433380243603494, "outflow_rate_min": 818.3922202007737, "cost1_max": 391.0619541616052, "outflow_rate_mean": 919.7339029469784, "cost1_mean": 345.39186783644635, "system_level_velocity_min": 9.74457101067059}, "episodes_total": 1100, "timesteps_this_iter": 107129, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 20, "timesteps_total": 2277612, "date": "2019-04-28_11-29-48", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2277612, "num_steps_trained": 2277612, "load_time_ms": 19.428, "grad_time_ms": 24435.66, "sample_time_ms": 15391.148, "default": {"total_loss": 35.28090286254883, "cur_lr": 0.0005000000237487257, "entropy": 1.2122607231140137, "vf_loss": 35.2818489074707, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.48911523818969727, "kl": 0.008954133838415146, "policy_loss": -0.001169197028502822}, "update_time_ms": 11.327}, "episode_reward_mean": 1016.4551359192242, "episodes_this_iter": 61, "time_total_s": 815.7976849079132, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556450988, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148a90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91488d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148710>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 21, "time_since_restore": 854.6748263835907, "episode_reward_max": 1117.6387585086861, "policy_reward_mean": {}, "timesteps_since_restore": 2385572, "episode_len_mean": 700.0, "episode_reward_min": 770.8542772085221, "hostname": "flow-main", "time_this_iter_s": 38.87714147567749, "custom_metrics": {"cost2_mean": -27.113109633473318, "system_level_velocity_max": 15.161785702151985, "cost2_max": -19.82140707273223, "outflow_rate_max": 1020.8028154316189, "system_level_velocity_mean": 13.411221293433924, "cost1_min": 264.0522970169019, "cost2_min": -43.98091768517616, "outflow_rate_min": 751.45508652658, "cost1_max": 403.21101459076175, "outflow_rate_mean": 939.4768426843573, "cost1_mean": 357.36344052684365, "system_level_velocity_min": 9.899367480256355}, "episodes_total": 1159, "timesteps_this_iter": 107960, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 21, "timesteps_total": 2385572, "date": "2019-04-28_11-30-27", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2385572, "num_steps_trained": 2385572, "load_time_ms": 19.451, "grad_time_ms": 24337.571, "sample_time_ms": 15195.261, "default": {"total_loss": 37.16122055053711, "cur_lr": 0.0005000000237487257, "entropy": 1.2013962268829346, "vf_loss": 37.16225051879883, "cur_kl_coeff": 0.025000005960464478, "vf_explained_var": 0.48104724287986755, "kl": 0.00918652769178152, "policy_loss": -0.0012626483803614974}, "update_time_ms": 11.253}, "episode_reward_mean": 1036.0755980323397, "episodes_this_iter": 59, "time_total_s": 854.6748263835907, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451027, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a400>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a320>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 22, "time_since_restore": 893.7554154396057, "episode_reward_max": 1187.8430220203963, "policy_reward_mean": {}, "timesteps_since_restore": 2494265, "episode_len_mean": 700.0, "episode_reward_min": 770.8542772085221, "hostname": "flow-main", "time_this_iter_s": 39.080589056015015, "custom_metrics": {"cost2_mean": -29.376977096041678, "system_level_velocity_max": 15.87881212849566, "cost2_max": -20.384680170555804, "outflow_rate_max": 1062.259981712285, "system_level_velocity_mean": 13.719966093536529, "cost1_min": 264.0522970169019, "cost2_min": -45.83073809326802, "outflow_rate_min": 751.45508652658, "cost1_max": 423.03773841280815, "outflow_rate_mean": 960.6807277990541, "cost1_mean": 365.1568111792524, "system_level_velocity_min": 9.899367480256355}, "episodes_total": 1221, "timesteps_this_iter": 108693, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 22, "timesteps_total": 2494265, "date": "2019-04-28_11-31-06", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2494265, "num_steps_trained": 2494265, "load_time_ms": 19.31, "grad_time_ms": 24226.082, "sample_time_ms": 15168.583, "default": {"total_loss": 38.29923629760742, "cur_lr": 0.0005000000237487257, "entropy": 1.201170563697815, "vf_loss": 38.299713134765625, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.5333263278007507, "kl": 0.008329302072525024, "policy_loss": -0.0006867485935799778}, "update_time_ms": 11.228}, "episode_reward_mean": 1066.011633656155, "episodes_this_iter": 62, "time_total_s": 893.7554154396057, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451066, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ab38>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a6a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914afd0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 23, "time_since_restore": 934.7324907779694, "episode_reward_max": 1187.8430220203963, "policy_reward_mean": {}, "timesteps_since_restore": 2602079, "episode_len_mean": 700.0, "episode_reward_min": 797.4377779181015, "hostname": "flow-main", "time_this_iter_s": 40.97707533836365, "custom_metrics": {"cost2_mean": -32.92511811574649, "system_level_velocity_max": 16.075600624769727, "cost2_max": -20.91741632123533, "outflow_rate_max": 1062.259981712285, "system_level_velocity_mean": 13.831261582411928, "cost1_min": 266.92309426985486, "cost2_min": -55.82839281119529, "outflow_rate_min": 823.8012674026472, "cost1_max": 424.95352944248503, "outflow_rate_mean": 979.902534673047, "cost1_mean": 367.45397761415495, "system_level_velocity_min": 10.037925159927802}, "episodes_total": 1282, "timesteps_this_iter": 107814, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 23, "timesteps_total": 2602079, "date": "2019-04-28_11-31-47", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2602079, "num_steps_trained": 2602079, "load_time_ms": 18.311, "grad_time_ms": 24258.385, "sample_time_ms": 15111.435, "default": {"total_loss": 40.40622329711914, "cur_lr": 0.0005000000237487257, "entropy": 1.1929497718811035, "vf_loss": 40.40729904174805, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.5412169098854065, "kl": 0.009624985978007317, "policy_loss": -0.0013163079274818301}, "update_time_ms": 11.349}, "episode_reward_mean": 1096.7152850091015, "episodes_this_iter": 61, "time_total_s": 934.7324907779694, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451107, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914add8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a0b8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 24, "time_since_restore": 973.5792303085327, "episode_reward_max": 1179.011340299632, "policy_reward_mean": {}, "timesteps_since_restore": 2709319, "episode_len_mean": 693.35, "episode_reward_min": 52.56768786788453, "hostname": "flow-main", "time_this_iter_s": 38.846739530563354, "custom_metrics": {"cost2_mean": -30.86598880088724, "system_level_velocity_max": 17.5871965673374, "cost2_max": -11.967017381058977, "outflow_rate_max": 1065.0004630104352, "system_level_velocity_mean": 14.326132531169668, "cost1_min": 21.81906971559776, "cost2_min": -53.6807903406259, "outflow_rate_min": 483.59628932995435, "cost1_max": 426.64374748695883, "outflow_rate_mean": 996.7737530058637, "cost1_mean": 376.1645115592024, "system_level_velocity_min": 10.53766414617803}, "episodes_total": 1345, "timesteps_this_iter": 107240, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 24, "timesteps_total": 2709319, "date": "2019-04-28_11-32-26", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2709319, "num_steps_trained": 2709319, "load_time_ms": 19.159, "grad_time_ms": 24177.3, "sample_time_ms": 15058.32, "default": {"total_loss": 43.602813720703125, "cur_lr": 0.0005000000237487257, "entropy": 1.1799063682556152, "vf_loss": 43.603206634521484, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.45072340965270996, "kl": 0.009042163379490376, "policy_loss": -0.0006156950257718563}, "update_time_ms": 11.234}, "episode_reward_mean": 1107.129982522277, "episodes_this_iter": 63, "time_total_s": 973.5792303085327, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451146, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cf98>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ce80>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 25, "time_since_restore": 1012.6603534221649, "episode_reward_max": 1183.9172913145176, "policy_reward_mean": {}, "timesteps_since_restore": 2818017, "episode_len_mean": 700.0, "episode_reward_min": 1040.8899689124207, "hostname": "flow-main", "time_this_iter_s": 39.0811231136322, "custom_metrics": {"cost2_mean": -29.554031011044163, "system_level_velocity_max": 16.079252136394533, "cost2_max": -22.016950147487975, "outflow_rate_max": 1064.6997479241666, "system_level_velocity_mean": 14.266072139025436, "cost1_min": 299.7992926136386, "cost2_min": -43.19555595997386, "outflow_rate_min": 883.263293857811, "cost1_max": 422.2814429967448, "outflow_rate_mean": 998.6092641361612, "cost1_mean": 379.27461430005036, "system_level_velocity_min": 11.211816144143382}, "episodes_total": 1407, "timesteps_this_iter": 108698, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 25, "timesteps_total": 2818017, "date": "2019-04-28_11-33-05", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2818017, "num_steps_trained": 2818017, "load_time_ms": 19.027, "grad_time_ms": 23855.153, "sample_time_ms": 15089.901, "default": {"total_loss": 44.59907913208008, "cur_lr": 0.0005000000237487257, "entropy": 1.1799321174621582, "vf_loss": 44.59966278076172, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.4624808430671692, "kl": 0.0093936612829566, "policy_loss": -0.0008240495226345956}, "update_time_ms": 11.459}, "episode_reward_mean": 1122.7684493494137, "episodes_this_iter": 62, "time_total_s": 1012.6603534221649, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451185, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a320>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a4e0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 26, "time_since_restore": 1052.9392895698547, "episode_reward_max": 1199.777720920107, "policy_reward_mean": {}, "timesteps_since_restore": 2928819, "episode_len_mean": 700.0, "episode_reward_min": 1018.0313449526973, "hostname": "flow-main", "time_this_iter_s": 40.27893614768982, "custom_metrics": {"cost2_mean": -32.540399995654866, "system_level_velocity_max": 16.259660419983426, "cost2_max": -23.36272766129381, "outflow_rate_max": 1071.8647803558408, "system_level_velocity_mean": 14.056968441662924, "cost1_min": 281.4635823609143, "cost2_min": -62.55989850143318, "outflow_rate_min": 851.304698042218, "cost1_max": 427.32036197417415, "outflow_rate_mean": 997.1626644773481, "cost1_mean": 373.4688029343272, "system_level_velocity_min": 10.675435733665273}, "episodes_total": 1467, "timesteps_this_iter": 110802, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 26, "timesteps_total": 2928819, "date": "2019-04-28_11-33-45", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2928819, "num_steps_trained": 2928819, "load_time_ms": 19.923, "grad_time_ms": 23838.709, "sample_time_ms": 15111.43, "default": {"total_loss": 43.548980712890625, "cur_lr": 0.0005000000237487257, "entropy": 1.1799132823944092, "vf_loss": 43.5498046875, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.5860766768455505, "kl": 0.008412058465182781, "policy_loss": -0.0010354658588767052}, "update_time_ms": 11.449}, "episode_reward_mean": 1127.6868820628376, "episodes_this_iter": 60, "time_total_s": 1052.9392895698547, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451225, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c2b0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ce80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cf98>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 27, "time_since_restore": 1093.3719992637634, "episode_reward_max": 1199.777720920107, "policy_reward_mean": {}, "timesteps_since_restore": 3039876, "episode_len_mean": 693.27, "episode_reward_min": 39.46737694039437, "hostname": "flow-main", "time_this_iter_s": 40.43270969390869, "custom_metrics": {"cost2_mean": -38.591531294127755, "system_level_velocity_max": 17.017255718064888, "cost2_max": -13.090625340333284, "outflow_rate_max": 1085.5339340273654, "system_level_velocity_mean": 14.052720959177206, "cost1_min": 17.396452299474525, "cost2_min": -68.05591985191563, "outflow_rate_min": 482.98942322601164, "cost1_max": 429.9572007279259, "outflow_rate_mean": 999.7744673505309, "cost1_mean": 367.5286473933336, "system_level_velocity_min": 9.522815217721275}, "episodes_total": 1526, "timesteps_this_iter": 111057, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 27, "timesteps_total": 3039876, "date": "2019-04-28_11-34-25", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3039876, "num_steps_trained": 3039876, "load_time_ms": 19.975, "grad_time_ms": 23913.626, "sample_time_ms": 15222.018, "default": {"total_loss": 41.72148132324219, "cur_lr": 0.0005000000237487257, "entropy": 1.183740496635437, "vf_loss": 41.722599029541016, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6735685467720032, "kl": 0.008165446110069752, "policy_loss": -0.0013221451081335545}, "update_time_ms": 11.606}, "episode_reward_mean": 1112.1767954747693, "episodes_this_iter": 59, "time_total_s": 1093.3719992637634, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451265, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7b8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 28, "time_since_restore": 1133.65767288208, "episode_reward_max": 1207.4938091932388, "policy_reward_mean": {}, "timesteps_since_restore": 3151234, "episode_len_mean": 700.0, "episode_reward_min": 1002.6731357472167, "hostname": "flow-main", "time_this_iter_s": 40.28567361831665, "custom_metrics": {"cost2_mean": -40.04714590493207, "system_level_velocity_max": 16.58883769340093, "cost2_max": -24.759524096412875, "outflow_rate_max": 1108.2440007782732, "system_level_velocity_mean": 14.001787172472875, "cost1_min": 281.4407043744476, "cost2_min": -66.16491676000251, "outflow_rate_min": 877.6293597192841, "cost1_max": 436.3431055327175, "outflow_rate_mean": 1008.3909899168374, "cost1_mean": 369.62108235708433, "system_level_velocity_min": 10.596900370556233}, "episodes_total": 1586, "timesteps_this_iter": 111358, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 28, "timesteps_total": 3151234, "date": "2019-04-28_11-35-06", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3151234, "num_steps_trained": 3151234, "load_time_ms": 19.256, "grad_time_ms": 24000.32, "sample_time_ms": 15242.427, "default": {"total_loss": 40.7825813293457, "cur_lr": 0.0005000000237487257, "entropy": 1.1866248846054077, "vf_loss": 40.78304672241211, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.6543963551521301, "kl": 0.007988792844116688, "policy_loss": -0.000666034989990294}, "update_time_ms": 11.85}, "episode_reward_mean": 1123.1879163373562, "episodes_this_iter": 60, "time_total_s": 1133.65767288208, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451306, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b048>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148b38>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 29, "time_since_restore": 1173.4134702682495, "episode_reward_max": 1211.495459971268, "policy_reward_mean": {}, "timesteps_since_restore": 3260416, "episode_len_mean": 693.37, "episode_reward_min": 57.29623361438168, "hostname": "flow-main", "time_this_iter_s": 39.755797386169434, "custom_metrics": {"cost2_mean": -34.61726481250282, "system_level_velocity_max": 17.90487041608816, "cost2_max": -11.04243302651915, "outflow_rate_max": 1099.1868626013302, "system_level_velocity_mean": 14.071041890895614, "cost1_min": 23.380170453435216, "cost2_min": -65.1230578269353, "outflow_rate_min": 494.720681943273, "cost1_max": 440.7617097872863, "outflow_rate_mean": 1005.1686575817282, "cost1_mean": 367.5411697820684, "system_level_velocity_min": 10.596900370556233}, "episodes_total": 1648, "timesteps_this_iter": 109182, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 29, "timesteps_total": 3260416, "date": "2019-04-28_11-35-46", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3260416, "num_steps_trained": 3260416, "load_time_ms": 18.259, "grad_time_ms": 24013.009, "sample_time_ms": 15255.125, "default": {"total_loss": 43.828060150146484, "cur_lr": 0.0005000000237487257, "entropy": 1.1819863319396973, "vf_loss": 43.8288688659668, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6037079691886902, "kl": 0.008126495406031609, "policy_loss": -0.0010089840507134795}, "update_time_ms": 11.593}, "episode_reward_mean": 1122.7953296724775, "episodes_this_iter": 62, "time_total_s": 1173.4134702682495, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451346, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ef98>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bb38>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 30, "time_since_restore": 1213.5329797267914, "episode_reward_max": 1211.495459971268, "policy_reward_mean": {}, "timesteps_since_restore": 3371540, "episode_len_mean": 700.0, "episode_reward_min": 1038.2091073140198, "hostname": "flow-main", "time_this_iter_s": 40.11950945854187, "custom_metrics": {"cost2_mean": -33.25716683372789, "system_level_velocity_max": 16.987085079657128, "cost2_max": -22.622475636381566, "outflow_rate_max": 1099.1868626013302, "system_level_velocity_mean": 13.94816425216053, "cost1_min": 278.3523847407499, "cost2_min": -53.90075734731925, "outflow_rate_min": 866.6943287974589, "cost1_max": 440.7617097872863, "outflow_rate_mean": 1005.7533590128531, "cost1_mean": 368.90583098747885, "system_level_velocity_min": 10.670959108100467}, "episodes_total": 1709, "timesteps_this_iter": 111124, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 30, "timesteps_total": 3371540, "date": "2019-04-28_11-36-26", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3371540, "num_steps_trained": 3371540, "load_time_ms": 18.511, "grad_time_ms": 24179.646, "sample_time_ms": 15335.083, "default": {"total_loss": 43.29864501953125, "cur_lr": 0.0005000000237487257, "entropy": 1.182251214981079, "vf_loss": 43.299957275390625, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.6300123333930969, "kl": 0.009760947898030281, "policy_loss": -0.0015588412061333656}, "update_time_ms": 11.627}, "episode_reward_mean": 1131.6674253712847, "episodes_this_iter": 61, "time_total_s": 1213.5329797267914, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451386, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b160>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b128>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 31, "time_since_restore": 1254.1281516551971, "episode_reward_max": 1210.102084014278, "policy_reward_mean": {}, "timesteps_since_restore": 3481286, "episode_len_mean": 700.0, "episode_reward_min": 1024.2775436798504, "hostname": "flow-main", "time_this_iter_s": 40.59517192840576, "custom_metrics": {"cost2_mean": -37.19725683691396, "system_level_velocity_max": 17.078326955235767, "cost2_max": -22.371164335522636, "outflow_rate_max": 1101.8133379485928, "system_level_velocity_mean": 14.066470754193553, "cost1_min": 278.3523847407499, "cost2_min": -55.30843675773408, "outflow_rate_min": 866.6943287974589, "cost1_max": 441.0360371579023, "outflow_rate_mean": 1009.9099167474051, "cost1_mean": 370.6550002265319, "system_level_velocity_min": 10.670959108100467}, "episodes_total": 1767, "timesteps_this_iter": 109746, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 31, "timesteps_total": 3481286, "date": "2019-04-28_11-37-06", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3481286, "num_steps_trained": 3481286, "load_time_ms": 18.509, "grad_time_ms": 24302.41, "sample_time_ms": 15383.14, "default": {"total_loss": 45.58230972290039, "cur_lr": 0.0005000000237487257, "entropy": 1.172960638999939, "vf_loss": 45.58334732055664, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6335137486457825, "kl": 0.009179933927953243, "policy_loss": -0.0012729286681860685}, "update_time_ms": 11.818}, "episode_reward_mean": 1125.821929165731, "episodes_this_iter": 58, "time_total_s": 1254.1281516551971, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451426, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bdd8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 32, "time_since_restore": 1292.9148411750793, "episode_reward_max": 1179.5246608155917, "policy_reward_mean": {}, "timesteps_since_restore": 3591577, "episode_len_mean": 700.0, "episode_reward_min": 1024.2775436798504, "hostname": "flow-main", "time_this_iter_s": 38.7866895198822, "custom_metrics": {"cost2_mean": -39.65617425859053, "system_level_velocity_max": 17.226444123041105, "cost2_max": -22.371164335522636, "outflow_rate_max": 1111.5859372386387, "system_level_velocity_mean": 14.325257410361829, "cost1_min": 288.4744036486551, "cost2_min": -54.936546895128, "outflow_rate_min": 889.2204375169964, "cost1_max": 445.60041088220095, "outflow_rate_mean": 1019.3608841563433, "cost1_mean": 375.5715712409409, "system_level_velocity_min": 11.098517948332908}, "episodes_total": 1827, "timesteps_this_iter": 110291, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 32, "timesteps_total": 3591577, "date": "2019-04-28_11-37-45", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3591577, "num_steps_trained": 3591577, "load_time_ms": 18.466, "grad_time_ms": 24281.27, "sample_time_ms": 15374.902, "default": {"total_loss": 45.5799560546875, "cur_lr": 0.0005000000237487257, "entropy": 1.164719820022583, "vf_loss": 45.58144760131836, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6421164870262146, "kl": 0.009392625652253628, "policy_loss": -0.0017193835228681564}, "update_time_ms": 12.159}, "episode_reward_mean": 1118.2217884612462, "episodes_this_iter": 60, "time_total_s": 1292.9148411750793, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451465, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b550>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bb70>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 33, "time_since_restore": 1332.198350429535, "episode_reward_max": 1191.2062507215187, "policy_reward_mean": {}, "timesteps_since_restore": 3700506, "episode_len_mean": 700.0, "episode_reward_min": 995.10885610148, "hostname": "flow-main", "time_this_iter_s": 39.283509254455566, "custom_metrics": {"cost2_mean": -38.045866307622056, "system_level_velocity_max": 17.320677518095362, "cost2_max": -22.305861793767157, "outflow_rate_max": 1107.0247271925407, "system_level_velocity_mean": 14.756472012813498, "cost1_min": 288.66464750829357, "cost2_min": -54.936546895128, "outflow_rate_min": 883.4422066071711, "cost1_max": 445.8010564824764, "outflow_rate_mean": 1034.4319650412524, "cost1_mean": 386.2427286055578, "system_level_velocity_min": 10.994967345573066}, "episodes_total": 1887, "timesteps_this_iter": 108929, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 33, "timesteps_total": 3700506, "date": "2019-04-28_11-38-24", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3700506, "num_steps_trained": 3700506, "load_time_ms": 19.25, "grad_time_ms": 24104.069, "sample_time_ms": 15381.353, "default": {"total_loss": 47.83522415161133, "cur_lr": 0.0005000000237487257, "entropy": 1.1588600873947144, "vf_loss": 47.836368560791016, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.5976917743682861, "kl": 0.008268347010016441, "policy_loss": -0.001350283739157021}, "update_time_ms": 12.374}, "episode_reward_mean": 1124.7536768975133, "episodes_this_iter": 60, "time_total_s": 1332.198350429535, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451504, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b940>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b710>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 34, "time_since_restore": 1372.998337507248, "episode_reward_max": 1193.2366567221557, "policy_reward_mean": {}, "timesteps_since_restore": 3811538, "episode_len_mean": 700.0, "episode_reward_min": 980.4780727533528, "hostname": "flow-main", "time_this_iter_s": 40.79998707771301, "custom_metrics": {"cost2_mean": -36.58137531345678, "system_level_velocity_max": 17.320677518095362, "cost2_max": -22.305861793767157, "outflow_rate_max": 1106.7522742429176, "system_level_velocity_mean": 14.382886920076448, "cost1_min": 284.9550578458546, "cost2_min": -51.882717733197424, "outflow_rate_min": 863.3604258390446, "cost1_max": 445.8010564824764, "outflow_rate_mean": 1021.4092305248586, "cost1_mean": 376.8612323294925, "system_level_velocity_min": 10.953634230586868}, "episodes_total": 1949, "timesteps_this_iter": 111032, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 34, "timesteps_total": 3811538, "date": "2019-04-28_11-39-05", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3811538, "num_steps_trained": 3811538, "load_time_ms": 19.358, "grad_time_ms": 24248.853, "sample_time_ms": 15430.487, "default": {"total_loss": 45.90945816040039, "cur_lr": 0.0005000000237487257, "entropy": 1.171851634979248, "vf_loss": 45.91063690185547, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6335760951042175, "kl": 0.009221246466040611, "policy_loss": -0.0014064796268939972}, "update_time_ms": 12.7}, "episode_reward_mean": 1115.5669679799585, "episodes_this_iter": 62, "time_total_s": 1372.998337507248, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451545, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bfd0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 35, "time_since_restore": 1412.292100906372, "episode_reward_max": 1193.2366567221557, "policy_reward_mean": {}, "timesteps_since_restore": 3921298, "episode_len_mean": 700.0, "episode_reward_min": 964.36658386962, "hostname": "flow-main", "time_this_iter_s": 39.293763399124146, "custom_metrics": {"cost2_mean": -34.81275446764736, "system_level_velocity_max": 17.03544043893315, "cost2_max": -23.50933902327597, "outflow_rate_max": 1099.4966032470097, "system_level_velocity_mean": 13.899891750659378, "cost1_min": 267.2837754713633, "cost2_min": -50.07719573429906, "outflow_rate_min": 839.7149193526031, "cost1_max": 440.74077723596065, "outflow_rate_mean": 998.908390181944, "cost1_mean": 365.0727832468264, "system_level_velocity_min": 10.223763975900814}, "episodes_total": 2008, "timesteps_this_iter": 109760, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 35, "timesteps_total": 3921298, "date": "2019-04-28_11-39-45", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3921298, "num_steps_trained": 3921298, "load_time_ms": 19.493, "grad_time_ms": 24307.115, "sample_time_ms": 15394.062, "default": {"total_loss": 45.12685012817383, "cur_lr": 0.0005000000237487257, "entropy": 1.177091121673584, "vf_loss": 45.12767028808594, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6438869833946228, "kl": 0.008481301367282867, "policy_loss": -0.0010379186132922769}, "update_time_ms": 12.608}, "episode_reward_mean": 1098.35911470468, "episodes_this_iter": 59, "time_total_s": 1412.292100906372, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451585, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b940>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7f0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 36, "time_since_restore": 1452.1841547489166, "episode_reward_max": 1180.1976473929872, "policy_reward_mean": {}, "timesteps_since_restore": 4030915, "episode_len_mean": 693.35, "episode_reward_min": 51.75597876751335, "hostname": "flow-main", "time_this_iter_s": 39.892053842544556, "custom_metrics": {"cost2_mean": -35.45505411858025, "system_level_velocity_max": 17.896704963251427, "cost2_max": -11.484205596004003, "outflow_rate_max": 1104.053125278483, "system_level_velocity_mean": 14.009918664551014, "cost1_min": 22.06780475070861, "cost2_min": -51.33169869932079, "outflow_rate_min": 492.7214808653421, "cost1_max": 443.2716749626308, "outflow_rate_mean": 991.8547356894312, "cost1_mean": 363.43838980187326, "system_level_velocity_min": 10.223763975900814}, "episodes_total": 2069, "timesteps_this_iter": 109617, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 36, "timesteps_total": 4030915, "date": "2019-04-28_11-40-25", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4030915, "num_steps_trained": 4030915, "load_time_ms": 19.613, "grad_time_ms": 24315.651, "sample_time_ms": 15346.15, "default": {"total_loss": 51.46506118774414, "cur_lr": 0.0005000000237487257, "entropy": 1.1546341180801392, "vf_loss": 51.46696472167969, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.5867186784744263, "kl": 0.010831371881067753, "policy_loss": -0.0021737241186201572}, "update_time_ms": 12.555}, "episode_reward_mean": 1085.6609059642246, "episodes_this_iter": 61, "time_total_s": 1452.1841547489166, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451625, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b0b8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 37, "time_since_restore": 1493.580914735794, "episode_reward_max": 1186.3809723799397, "policy_reward_mean": {}, "timesteps_since_restore": 4142059, "episode_len_mean": 683.57, "episode_reward_min": 49.77094944393038, "hostname": "flow-main", "time_this_iter_s": 41.39675998687744, "custom_metrics": {"cost2_mean": -38.1999656606557, "system_level_velocity_max": 18.01004209825785, "cost2_max": -11.484205596004003, "outflow_rate_max": 1099.9406314444993, "system_level_velocity_mean": 13.972037922665047, "cost1_min": 22.06780475070861, "cost2_min": -54.1956039169763, "outflow_rate_min": 492.7214808653421, "cost1_max": 437.27238226645045, "outflow_rate_mean": 988.0016632751284, "cost1_mean": 355.5344522388692, "system_level_velocity_min": 9.931803640207779}, "episodes_total": 2128, "timesteps_this_iter": 111144, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 37, "timesteps_total": 4142059, "date": "2019-04-28_11-41-06", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4142059, "num_steps_trained": 4142059, "load_time_ms": 19.702, "grad_time_ms": 24331.304, "sample_time_ms": 15426.305, "default": {"total_loss": 43.79387664794922, "cur_lr": 0.0005000000237487257, "entropy": 1.1476292610168457, "vf_loss": 43.79534149169922, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.6593565940856934, "kl": 0.011277851648628712, "policy_loss": -0.0017442101379856467}, "update_time_ms": 12.454}, "episode_reward_mean": 1070.915325122213, "episodes_this_iter": 59, "time_total_s": 1493.580914735794, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451666, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b588>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b2e8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 38, "time_since_restore": 1533.1522462368011, "episode_reward_max": 1166.5599801215733, "policy_reward_mean": {}, "timesteps_since_restore": 4252784, "episode_len_mean": 686.62, "episode_reward_min": 41.13322695677509, "hostname": "flow-main", "time_this_iter_s": 39.57133150100708, "custom_metrics": {"cost2_mean": -42.02047716991794, "system_level_velocity_max": 18.01004209825785, "cost2_max": -13.467886869461843, "outflow_rate_max": 1105.1105324504776, "system_level_velocity_mean": 13.765953023659183, "cost1_min": 17.622868472817718, "cost2_min": -63.20050849093643, "outflow_rate_min": 467.49150631202025, "cost1_max": 441.1385156455693, "outflow_rate_mean": 988.318822629745, "cost1_mean": 351.91963158542353, "system_level_velocity_min": 9.229923041003552}, "episodes_total": 2188, "timesteps_this_iter": 110725, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 38, "timesteps_total": 4252784, "date": "2019-04-28_11-41-46", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4252784, "num_steps_trained": 4252784, "load_time_ms": 20.73, "grad_time_ms": 24280.781, "sample_time_ms": 15404.889, "default": {"total_loss": 47.79813766479492, "cur_lr": 0.0005000000237487257, "entropy": 1.13372004032135, "vf_loss": 47.799964904785156, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6576387286186218, "kl": 0.009687993675470352, "policy_loss": -0.0020633339881896973}, "update_time_ms": 12.51}, "episode_reward_mean": 1068.0667872026415, "episodes_this_iter": 60, "time_total_s": 1533.1522462368011, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451706, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ba20>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b630>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 39, "time_since_restore": 1573.547532081604, "episode_reward_max": 1182.4143311326548, "policy_reward_mean": {}, "timesteps_since_restore": 4364010, "episode_len_mean": 684.55, "episode_reward_min": 41.13322695677509, "hostname": "flow-main", "time_this_iter_s": 40.395285844802856, "custom_metrics": {"cost2_mean": -42.403900951513315, "system_level_velocity_max": 17.63392346471617, "cost2_max": -13.467886869461843, "outflow_rate_max": 1108.150276522011, "system_level_velocity_mean": 14.08234818172803, "cost1_min": 17.622868472817718, "cost2_min": -62.18855253184721, "outflow_rate_min": 467.49150631202025, "cost1_max": 443.031222989991, "outflow_rate_mean": 995.7001435682187, "cost1_mean": 358.8568067999607, "system_level_velocity_min": 9.229923041003552}, "episodes_total": 2246, "timesteps_this_iter": 111226, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 39, "timesteps_total": 4364010, "date": "2019-04-28_11-42-26", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4364010, "num_steps_trained": 4364010, "load_time_ms": 21.567, "grad_time_ms": 24296.86, "sample_time_ms": 15450.535, "default": {"total_loss": 47.394222259521484, "cur_lr": 0.0005000000237487257, "entropy": 1.1257034540176392, "vf_loss": 47.39498519897461, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.6536590456962585, "kl": 0.011037969030439854, "policy_loss": -0.001039891387335956}, "update_time_ms": 12.258}, "episode_reward_mean": 1067.2172227771016, "episodes_this_iter": 58, "time_total_s": 1573.547532081604, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451746, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b588>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bb00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bdd8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 40, "time_since_restore": 1614.200273513794, "episode_reward_max": 1190.2287334103073, "policy_reward_mean": {}, "timesteps_since_restore": 4476969, "episode_len_mean": 684.63, "episode_reward_min": 49.797997089396425, "hostname": "flow-main", "time_this_iter_s": 40.65274143218994, "custom_metrics": {"cost2_mean": -42.97085780439931, "system_level_velocity_max": 18.25671361009762, "cost2_max": -13.713357903856037, "outflow_rate_max": 1124.61080683548, "system_level_velocity_mean": 13.98311589437, "cost1_min": 22.083054091018784, "cost2_min": -62.17627225080049, "outflow_rate_min": 470.9586080932736, "cost1_max": 445.4461056532833, "outflow_rate_mean": 995.2475207229452, "cost1_mean": 356.72858766127445, "system_level_velocity_min": 10.465103010797133}, "episodes_total": 2307, "timesteps_this_iter": 112959, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 40, "timesteps_total": 4476969, "date": "2019-04-28_11-43-07", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4476969, "num_steps_trained": 4476969, "load_time_ms": 20.676, "grad_time_ms": 24365.585, "sample_time_ms": 15436.165, "default": {"total_loss": 44.88768005371094, "cur_lr": 0.0005000000237487257, "entropy": 1.1247037649154663, "vf_loss": 44.88898468017578, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7002391815185547, "kl": 0.011029219254851341, "policy_loss": -0.001580014475621283}, "update_time_ms": 12.227}, "episode_reward_mean": 1073.4925367003466, "episodes_this_iter": 61, "time_total_s": 1614.200273513794, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451787, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b128>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b240>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 41, "time_since_restore": 1654.090346813202, "episode_reward_max": 1190.2287334103073, "policy_reward_mean": {}, "timesteps_since_restore": 4589024, "episode_len_mean": 688.07, "episode_reward_min": 49.797997089396425, "hostname": "flow-main", "time_this_iter_s": 39.89007329940796, "custom_metrics": {"cost2_mean": -44.184493997988305, "system_level_velocity_max": 18.25671361009762, "cost2_max": -13.845496666332572, "outflow_rate_max": 1122.2477115968377, "system_level_velocity_mean": 14.007377824402534, "cost1_min": 22.618045151854208, "cost2_min": -77.06230909483578, "outflow_rate_min": 502.66918130924233, "cost1_max": 445.9258728337399, "outflow_rate_mean": 1003.5496845714323, "cost1_mean": 359.64753675757095, "system_level_velocity_min": 10.204458918167122}, "episodes_total": 2364, "timesteps_this_iter": 112055, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 41, "timesteps_total": 4589024, "date": "2019-04-28_11-43-47", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4589024, "num_steps_trained": 4589024, "load_time_ms": 19.647, "grad_time_ms": 24242.562, "sample_time_ms": 15489.698, "default": {"total_loss": 47.8354606628418, "cur_lr": 0.0005000000237487257, "entropy": 1.1112158298492432, "vf_loss": 47.837005615234375, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6997371912002563, "kl": 0.011069368571043015, "policy_loss": -0.0018241029465571046}, "update_time_ms": 12.137}, "episode_reward_mean": 1084.6447216525164, "episodes_this_iter": 57, "time_total_s": 1654.090346813202, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451827, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bdd8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b2e8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 42, "time_since_restore": 1694.6806297302246, "episode_reward_max": 1223.8644385202826, "policy_reward_mean": {}, "timesteps_since_restore": 4702183, "episode_len_mean": 694.72, "episode_reward_min": 332.576440789269, "hostname": "flow-main", "time_this_iter_s": 40.590282917022705, "custom_metrics": {"cost2_mean": -45.549201097443145, "system_level_velocity_max": 17.162946280373408, "cost2_max": -17.41656694728471, "outflow_rate_max": 1133.6927803863448, "system_level_velocity_mean": 14.05663936512941, "cost1_min": 130.7895328913948, "cost2_min": -68.88565408636705, "outflow_rate_min": 786.2538703492909, "cost1_max": 445.9258728337399, "outflow_rate_mean": 1012.5049600445838, "cost1_mean": 365.1727812444786, "system_level_velocity_min": 10.204458918167122}, "episodes_total": 2423, "timesteps_this_iter": 113159, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 42, "timesteps_total": 4702183, "date": "2019-04-28_11-44-27", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4702183, "num_steps_trained": 4702183, "load_time_ms": 18.781, "grad_time_ms": 24390.559, "sample_time_ms": 15520.058, "default": {"total_loss": 48.14430236816406, "cur_lr": 0.0005000000237487257, "entropy": 1.1008827686309814, "vf_loss": 48.146026611328125, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6877020001411438, "kl": 0.01065650675445795, "policy_loss": -0.0019904503133147955}, "update_time_ms": 11.734}, "episode_reward_mean": 1102.4735883524136, "episodes_this_iter": 59, "time_total_s": 1694.6806297302246, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451867, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148cf8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148d30>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 43, "time_since_restore": 1735.8069977760315, "episode_reward_max": 1223.8644385202826, "policy_reward_mean": {}, "timesteps_since_restore": 4814053, "episode_len_mean": 686.62, "episode_reward_min": 38.809788289288406, "hostname": "flow-main", "time_this_iter_s": 41.126368045806885, "custom_metrics": {"cost2_mean": -46.636674891424924, "system_level_velocity_max": 17.979966549889934, "cost2_max": -12.91943288198203, "outflow_rate_max": 1133.6927803863448, "system_level_velocity_mean": 14.13619485419251, "cost1_min": 17.361155412756226, "cost2_min": -69.79464259168438, "outflow_rate_min": 487.8590816741719, "cost1_max": 447.0634157845441, "outflow_rate_mean": 1010.5622173525162, "cost1_mean": 361.7908809157676, "system_level_velocity_min": 10.350375623917692}, "episodes_total": 2486, "timesteps_this_iter": 111870, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 43, "timesteps_total": 4814053, "date": "2019-04-28_11-45-08", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4814053, "num_steps_trained": 4814053, "load_time_ms": 17.811, "grad_time_ms": 24513.63, "sample_time_ms": 15580.986, "default": {"total_loss": 53.7227783203125, "cur_lr": 0.0005000000237487257, "entropy": 1.0770601034164429, "vf_loss": 53.72410202026367, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.6863642930984497, "kl": 0.011150776408612728, "policy_loss": -0.0015998963499441743}, "update_time_ms": 11.363}, "episode_reward_mean": 1097.2667430585307, "episodes_this_iter": 63, "time_total_s": 1735.8069977760315, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451908, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7b8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 44, "time_since_restore": 1776.2588291168213, "episode_reward_max": 1194.6964786756992, "policy_reward_mean": {}, "timesteps_since_restore": 4926683, "episode_len_mean": 686.62, "episode_reward_min": 38.809788289288406, "hostname": "flow-main", "time_this_iter_s": 40.451831340789795, "custom_metrics": {"cost2_mean": -49.6014292139275, "system_level_velocity_max": 17.979966549889934, "cost2_max": -12.91943288198203, "outflow_rate_max": 1127.2767667974263, "system_level_velocity_mean": 14.150201667402603, "cost1_min": 17.361155412756226, "cost2_min": -77.06310819109765, "outflow_rate_min": 487.8590816741719, "cost1_max": 448.410455501299, "outflow_rate_mean": 1013.2871438114249, "cost1_mean": 361.69374920692877, "system_level_velocity_min": 10.819312187673884}, "episodes_total": 2544, "timesteps_this_iter": 112630, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 44, "timesteps_total": 4926683, "date": "2019-04-28_11-45-49", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4926683, "num_steps_trained": 4926683, "load_time_ms": 16.863, "grad_time_ms": 24503.528, "sample_time_ms": 15558.116, "default": {"total_loss": 53.19105529785156, "cur_lr": 0.0005000000237487257, "entropy": 1.074247121810913, "vf_loss": 53.19194412231445, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.6836820244789124, "kl": 0.010527932085096836, "policy_loss": -0.0011482482077553868}, "update_time_ms": 11.14}, "episode_reward_mean": 1093.548179034053, "episodes_this_iter": 58, "time_total_s": 1776.2588291168213, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451949, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bd68>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bb70>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 45, "time_since_restore": 1816.697919368744, "episode_reward_max": 1210.792457828967, "policy_reward_mean": {}, "timesteps_since_restore": 5039075, "episode_len_mean": 700.0, "episode_reward_min": 1005.5981753737323, "hostname": "flow-main", "time_this_iter_s": 40.43909025192261, "custom_metrics": {"cost2_mean": -51.82841217243751, "system_level_velocity_max": 17.566032607795936, "cost2_max": -24.213043694968185, "outflow_rate_max": 1134.126025078781, "system_level_velocity_mean": 14.057870527984694, "cost1_min": 264.96530139806174, "cost2_min": -83.15465420589842, "outflow_rate_min": 872.8878420695848, "cost1_max": 455.100350124666, "outflow_rate_mean": 1022.2545752978698, "cost1_mean": 367.5890972378266, "system_level_velocity_min": 10.087141945869181}, "episodes_total": 2603, "timesteps_this_iter": 112392, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 45, "timesteps_total": 5039075, "date": "2019-04-28_11-46-29", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5039075, "num_steps_trained": 5039075, "load_time_ms": 16.817, "grad_time_ms": 24573.67, "sample_time_ms": 15601.455, "default": {"total_loss": 54.4003791809082, "cur_lr": 0.0005000000237487257, "entropy": 1.0912293195724487, "vf_loss": 54.40170669555664, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.6870331168174744, "kl": 0.010665836744010448, "policy_loss": -0.0015982892364263535}, "update_time_ms": 11.073}, "episode_reward_mean": 1112.6874392701116, "episodes_this_iter": 59, "time_total_s": 1816.697919368744, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556451989, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b6a0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b278>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 46, "time_since_restore": 1858.8286306858063, "episode_reward_max": 1210.792457828967, "policy_reward_mean": {}, "timesteps_since_restore": 5151843, "episode_len_mean": 700.0, "episode_reward_min": 975.2146955532, "hostname": "flow-main", "time_this_iter_s": 42.13071131706238, "custom_metrics": {"cost2_mean": -50.21673302465238, "system_level_velocity_max": 17.53516467617535, "cost2_max": -21.425517848254657, "outflow_rate_max": 1125.0761232147752, "system_level_velocity_mean": 14.122800109053435, "cost1_min": 254.56008139585933, "cost2_min": -83.15465420589842, "outflow_rate_min": 845.3914263168042, "cost1_max": 452.31472161060077, "outflow_rate_mean": 1024.4506550391964, "cost1_mean": 368.9851449829117, "system_level_velocity_min": 9.907109481683719}, "episodes_total": 2660, "timesteps_this_iter": 112768, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 46, "timesteps_total": 5151843, "date": "2019-04-28_11-47-11", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5151843, "num_steps_trained": 5151843, "load_time_ms": 16.901, "grad_time_ms": 24799.551, "sample_time_ms": 15597.381, "default": {"total_loss": 52.732460021972656, "cur_lr": 0.0005000000237487257, "entropy": 1.0774388313293457, "vf_loss": 52.73410415649414, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6998531818389893, "kl": 0.0105697987601161, "policy_loss": -0.0019105290994048119}, "update_time_ms": 11.344}, "episode_reward_mean": 1111.520976579025, "episodes_this_iter": 57, "time_total_s": 1858.8286306858063, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556452031, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bd30>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b128>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 47, "time_since_restore": 1900.088122844696, "episode_reward_max": 1199.3436581546855, "policy_reward_mean": {}, "timesteps_since_restore": 5265316, "episode_len_mean": 700.0, "episode_reward_min": 975.2146955532, "hostname": "flow-main", "time_this_iter_s": 41.25949215888977, "custom_metrics": {"cost2_mean": -49.5835709134757, "system_level_velocity_max": 17.53516467617535, "cost2_max": -21.425517848254657, "outflow_rate_max": 1134.6888260748428, "system_level_velocity_mean": 14.0580125203017, "cost1_min": 254.56008139585933, "cost2_min": -81.08770362707537, "outflow_rate_min": 845.3914263168042, "cost1_max": 452.31472161060077, "outflow_rate_mean": 1021.7263666311251, "cost1_mean": 367.1906726135362, "system_level_velocity_min": 9.907109481683719}, "episodes_total": 2719, "timesteps_this_iter": 113473, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 47, "timesteps_total": 5265316, "date": "2019-04-28_11-47-53", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5265316, "num_steps_trained": 5265316, "load_time_ms": 16.906, "grad_time_ms": 24871.175, "sample_time_ms": 15512.456, "default": {"total_loss": 52.109375, "cur_lr": 0.0005000000237487257, "entropy": 1.0695405006408691, "vf_loss": 52.11078643798828, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.7070359587669373, "kl": 0.010624440386891365, "policy_loss": -0.0016773984534665942}, "update_time_ms": 11.457}, "episode_reward_mean": 1109.0832490477799, "episodes_this_iter": 59, "time_total_s": 1900.088122844696, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556452073, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b9e8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b748>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 48, "time_since_restore": 1940.3001697063446, "episode_reward_max": 1199.3436581546855, "policy_reward_mean": {}, "timesteps_since_restore": 5377729, "episode_len_mean": 700.0, "episode_reward_min": 953.2384391955031, "hostname": "flow-main", "time_this_iter_s": 40.21204686164856, "custom_metrics": {"cost2_mean": -48.67286110966571, "system_level_velocity_max": 17.313571885427653, "cost2_max": -23.50387387372789, "outflow_rate_max": 1134.6888260748428, "system_level_velocity_mean": 13.980445670549354, "cost1_min": 255.05462716413348, "cost2_min": -81.08770362707537, "outflow_rate_min": 831.3076690617179, "cost1_max": 449.84830105382485, "outflow_rate_mean": 1018.5588685944299, "cost1_mean": 365.9588486434056, "system_level_velocity_min": 9.894108488687406}, "episodes_total": 2778, "timesteps_this_iter": 112413, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 48, "timesteps_total": 5377729, "date": "2019-04-28_11-48-33", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5377729, "num_steps_trained": 5377729, "load_time_ms": 16.823, "grad_time_ms": 24896.421, "sample_time_ms": 15550.492, "default": {"total_loss": 52.93413543701172, "cur_lr": 0.0005000000237487257, "entropy": 1.0563799142837524, "vf_loss": 52.93552780151367, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.6878607869148254, "kl": 0.01151465717703104, "policy_loss": -0.001687298878096044}, "update_time_ms": 11.106}, "episode_reward_mean": 1106.254956225053, "episodes_this_iter": 59, "time_total_s": 1940.3001697063446, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556452113, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b128>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bc18>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 49, "time_since_restore": 1979.0978741645813, "episode_reward_max": 1210.0627053921482, "policy_reward_mean": {}, "timesteps_since_restore": 5488661, "episode_len_mean": 700.0, "episode_reward_min": 953.2384391955031, "hostname": "flow-main", "time_this_iter_s": 38.797704458236694, "custom_metrics": {"cost2_mean": -47.66574831679451, "system_level_velocity_max": 17.19141657906413, "cost2_max": -22.776496986396484, "outflow_rate_max": 1115.1974153577873, "system_level_velocity_mean": 13.834344722830435, "cost1_min": 255.05462716413348, "cost2_min": -74.72737304929495, "outflow_rate_min": 831.3076690617179, "cost1_max": 447.05573052291686, "outflow_rate_mean": 1004.8507090126815, "cost1_mean": 362.18256880451014, "system_level_velocity_min": 9.894108488687406}, "episodes_total": 2838, "timesteps_this_iter": 110932, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 49, "timesteps_total": 5488661, "date": "2019-04-28_11-49-12", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5488661, "num_steps_trained": 5488661, "load_time_ms": 16.785, "grad_time_ms": 24824.101, "sample_time_ms": 15463.583, "default": {"total_loss": 52.90616989135742, "cur_lr": 0.0005000000237487257, "entropy": 1.0522079467773438, "vf_loss": 52.90879440307617, "cur_kl_coeff": 0.02500000223517418, "vf_explained_var": 0.7008767127990723, "kl": 0.012158393859863281, "policy_loss": -0.0029263696633279324}, "update_time_ms": 11.31}, "episode_reward_mean": 1088.1584553731236, "episodes_this_iter": 60, "time_total_s": 1979.0978741645813, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556452152, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148a58>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914bef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b908>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 50, "time_since_restore": 2018.5562844276428, "episode_reward_max": 1210.0627053921482, "policy_reward_mean": {}, "timesteps_since_restore": 5599040, "episode_len_mean": 695.18, "episode_reward_min": 345.38459997372894, "hostname": "flow-main", "time_this_iter_s": 39.45841026306152, "custom_metrics": {"cost2_mean": -43.49306904214966, "system_level_velocity_max": 17.01855868452675, "cost2_max": -16.74903213923642, "outflow_rate_max": 1108.8194331452928, "system_level_velocity_mean": 14.150001557248874, "cost1_min": 135.48886678399828, "cost2_min": -73.9177466478358, "outflow_rate_min": 762.2481848271442, "cost1_max": 447.05573052291686, "outflow_rate_mean": 999.6495253309783, "cost1_mean": 367.46243534508403, "system_level_velocity_min": 10.337566093552002}, "episodes_total": 2896, "timesteps_this_iter": 110379, "experiment_id": "fdf610b39ea84e4faf7b5ab6f1189e71", "iterations_since_restore": 50, "timesteps_total": 5599040, "date": "2019-04-28_11-49-51", "done": true, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5599040, "num_steps_trained": 5599040, "load_time_ms": 17.474, "grad_time_ms": 24736.401, "sample_time_ms": 15432.053, "default": {"total_loss": 56.65517044067383, "cur_lr": 0.0005000000237487257, "entropy": 1.0538239479064941, "vf_loss": 56.65737533569336, "cur_kl_coeff": 0.02500000409781933, "vf_explained_var": 0.6702492833137512, "kl": 0.014083764515817165, "policy_loss": -0.0025552494917064905}, "update_time_ms": 11.353}, "episode_reward_mean": 1072.1962478582288, "episodes_this_iter": 58, "time_total_s": 2018.5562844276428, "pid": 14111, "node_ip": "10.138.0.2", "timestamp": 1556452191, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b198>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914b128>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "channel_major": false, "custom_model": null, "fcnet_hiddens": [100, 50, 25], "grayscale": false, "max_seq_len": 20, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.3]_t_min:7.0", "output": null, "vf_share_layers": false, "output_max_file_size": 67108864, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}

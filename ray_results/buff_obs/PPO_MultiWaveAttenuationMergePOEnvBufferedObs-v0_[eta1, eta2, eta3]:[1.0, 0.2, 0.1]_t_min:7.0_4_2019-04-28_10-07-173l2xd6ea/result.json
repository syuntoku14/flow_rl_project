{"training_iteration": 1, "time_since_restore": 80.79138422012329, "episode_reward_max": 454.7815040026816, "policy_reward_mean": {}, "timesteps_since_restore": 117143, "episode_len_mean": 700.0, "episode_reward_min": 209.40183610184548, "hostname": "flow-main", "time_this_iter_s": 80.79138422012329, "custom_metrics": {"cost2_mean": -38.245380238938644, "system_level_velocity_max": 9.162946597864511, "cost2_max": -23.0068505539487, "outflow_rate_max": 728.2035233133954, "system_level_velocity_mean": 7.836921366721946, "cost1_mean": 201.3966560604545, "cost2_min": -64.1347062887311, "outflow_rate_min": 562.0570529910543, "cost1_max": 235.69085406902786, "outflow_rate_mean": 606.2512787375141, "cost1_min": 154.36076637170265, "system_level_velocity_min": 6.0470846222015275}, "episodes_total": 23, "timesteps_this_iter": 117143, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 1, "timesteps_total": 117143, "date": "2019-04-28_10-08-58", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 117143, "load_time_ms": 81.482, "grad_time_ms": 28263.436, "default": {"total_loss": 1.245316982269287, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.4229183197021484, "vf_loss": 1.2453948259353638, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8814522624015808, "kl": 0.000713199086021632, "policy_loss": -0.00022038735914975405}, "num_steps_trained": 117143, "update_time_ms": 2805.066, "sample_time_ms": 49376.817}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99641d0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9144e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999ffd0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 23, "time_total_s": 80.79138422012329, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446138, "episode_reward_mean": 321.37972371741125}
{"training_iteration": 2, "time_since_restore": 120.51383376121521, "episode_reward_max": 486.2277027113916, "policy_reward_mean": {}, "timesteps_since_restore": 230690, "episode_len_mean": 700.0, "episode_reward_min": 209.40183610184548, "hostname": "flow-main", "time_this_iter_s": 39.72244954109192, "custom_metrics": {"cost2_mean": -38.68582526568729, "system_level_velocity_max": 10.320578682030302, "cost2_max": -19.059607606072092, "outflow_rate_max": 740.7467480185844, "system_level_velocity_mean": 7.9174895237600875, "cost1_mean": 203.85279542411718, "cost2_min": -67.16080248997218, "outflow_rate_min": 478.03176206211447, "cost1_max": 258.7613018580563, "outflow_rate_mean": 612.2223046446051, "cost1_min": 154.36076637170265, "system_level_velocity_min": 5.933780173210006}, "episodes_total": 89, "timesteps_this_iter": 113547, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 2, "timesteps_total": 230690, "date": "2019-04-28_10-09-38", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 230690, "load_time_ms": 47.254, "grad_time_ms": 26232.259, "default": {"total_loss": 1.3566362857818604, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.420992374420166, "vf_loss": 1.3586937189102173, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9133215546607971, "kl": 0.005963749717921019, "policy_loss": -0.0026537610683590174}, "num_steps_trained": 230690, "update_time_ms": 1408.805, "sample_time_ms": 32327.289}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c6a0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cf28>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 66, "time_total_s": 120.51383376121521, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446178, "episode_reward_mean": 328.167744091359}
{"training_iteration": 3, "time_since_restore": 159.7550024986267, "episode_reward_max": 599.3942083239656, "policy_reward_mean": {}, "timesteps_since_restore": 342301, "episode_len_mean": 700.0, "episode_reward_min": 235.89263392175562, "hostname": "flow-main", "time_this_iter_s": 39.2411687374115, "custom_metrics": {"cost2_mean": -38.908497352083835, "system_level_velocity_max": 10.985412638727054, "cost2_max": -19.059607606072092, "outflow_rate_max": 823.0398315304665, "system_level_velocity_mean": 8.483435495243032, "cost1_mean": 219.00365452411737, "cost2_min": -62.56128817386267, "outflow_rate_min": 528.7226122891605, "cost1_max": 282.45583222431355, "outflow_rate_mean": 645.5126077345147, "cost1_min": 156.47143301739396, "system_level_velocity_min": 5.891013766144437}, "episodes_total": 141, "timesteps_this_iter": 111611, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 3, "timesteps_total": 342301, "date": "2019-04-28_10-10-17", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 342301, "load_time_ms": 35.439, "grad_time_ms": 25581.996, "default": {"total_loss": 3.7173662185668945, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.4095567464828491, "vf_loss": 3.7220876216888428, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8797963261604309, "kl": 0.009802250191569328, "policy_loss": -0.00570159824565053}, "num_steps_trained": 342301, "update_time_ms": 942.51, "sample_time_ms": 26457.396}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91489e8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148940>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 52, "time_total_s": 159.7550024986267, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446217, "episode_reward_mean": 380.10751747939577}
{"training_iteration": 4, "time_since_restore": 199.36990332603455, "episode_reward_max": 732.49001553107, "policy_reward_mean": {}, "timesteps_since_restore": 456600, "episode_len_mean": 700.0, "episode_reward_min": 275.75491694844857, "hostname": "flow-main", "time_this_iter_s": 39.61490082740784, "custom_metrics": {"cost2_mean": -45.57297992969415, "system_level_velocity_max": 12.460249514587018, "cost2_max": -25.156175398631053, "outflow_rate_max": 929.7590003135191, "system_level_velocity_mean": 9.537563045620608, "cost1_mean": 248.84592780068763, "cost2_min": -68.40161778660446, "outflow_rate_min": 528.7226122891605, "cost1_max": 321.38776069201265, "outflow_rate_mean": 741.2563673085793, "cost1_min": 156.47143301739396, "system_level_velocity_min": 5.891013766144437}, "episodes_total": 201, "timesteps_this_iter": 114299, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 4, "timesteps_total": 456600, "date": "2019-04-28_10-10-57", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 456600, "load_time_ms": 29.687, "grad_time_ms": 25330.227, "default": {"total_loss": 6.7489519119262695, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.4003524780273438, "vf_loss": 6.751409530639648, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.791316032409668, "kl": 0.007319041062146425, "policy_loss": -0.00318981078453362}, "num_steps_trained": 456600, "update_time_ms": 709.619, "sample_time_ms": 23540.912}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c860>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cf28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c080>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 199.36990332603455, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446257, "episode_reward_mean": 541.7206932817219}
{"training_iteration": 5, "time_since_restore": 241.05233192443848, "episode_reward_max": 819.7696484846581, "policy_reward_mean": {}, "timesteps_since_restore": 573905, "episode_len_mean": 700.0, "episode_reward_min": 446.1769919298609, "hostname": "flow-main", "time_this_iter_s": 41.68242859840393, "custom_metrics": {"cost2_mean": -50.85503018155774, "system_level_velocity_max": 12.460249514587018, "cost2_max": -32.917032929508295, "outflow_rate_max": 957.2361437402243, "system_level_velocity_mean": 10.237242905005948, "cost1_mean": 269.677617109095, "cost2_min": -68.68913156640373, "outflow_rate_min": 648.854235502161, "cost1_max": 326.53959720773446, "outflow_rate_mean": 820.3963840510924, "cost1_min": 204.68873477231332, "system_level_velocity_min": 7.838512487364391}, "episodes_total": 254, "timesteps_this_iter": 117305, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 5, "timesteps_total": 573905, "date": "2019-04-28_10-11-39", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 573905, "load_time_ms": 26.629, "grad_time_ms": 25411.131, "default": {"total_loss": 8.792470932006836, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.392322301864624, "vf_loss": 8.79412841796875, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7902691960334778, "kl": 0.005421471782028675, "policy_loss": -0.0022004260681569576}, "num_steps_trained": 573905, "update_time_ms": 569.776, "sample_time_ms": 21973.758}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91488d0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91489e8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 53, "time_total_s": 241.05233192443848, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446299, "episode_reward_mean": 675.3372585460938}
{"training_iteration": 6, "time_since_restore": 282.2685799598694, "episode_reward_max": 878.1126707225844, "policy_reward_mean": {}, "timesteps_since_restore": 693330, "episode_len_mean": 700.0, "episode_reward_min": 601.5992028973337, "hostname": "flow-main", "time_this_iter_s": 41.21624803543091, "custom_metrics": {"cost2_mean": -52.630681985584744, "system_level_velocity_max": 12.739334596554228, "cost2_max": -39.42260978163637, "outflow_rate_max": 977.0087692746515, "system_level_velocity_mean": 10.5524437877707, "cost1_mean": 279.4232172137565, "cost2_min": -68.68913156640373, "outflow_rate_min": 730.9818803302612, "cost1_max": 334.39482204831415, "outflow_rate_mean": 856.5468788729798, "cost1_min": 214.28728182301947, "system_level_velocity_min": 8.181679617279304}, "episodes_total": 300, "timesteps_this_iter": 119425, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 6, "timesteps_total": 693330, "date": "2019-04-28_10-12-20", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 693330, "load_time_ms": 24.278, "grad_time_ms": 25525.629, "default": {"total_loss": 9.502620697021484, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.3800048828125, "vf_loss": 9.503510475158691, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8129958510398865, "kl": 0.005269921850413084, "policy_loss": -0.0014165443135425448}, "num_steps_trained": 693330, "update_time_ms": 476.349, "sample_time_ms": 20788.704}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9964898>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e278>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 46, "time_total_s": 282.2685799598694, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446340, "episode_reward_mean": 742.5510761912254}
{"training_iteration": 7, "time_since_restore": 325.4058609008789, "episode_reward_max": 892.2138810578161, "policy_reward_mean": {}, "timesteps_since_restore": 816993, "episode_len_mean": 700.0, "episode_reward_min": 623.5138868832005, "hostname": "flow-main", "time_this_iter_s": 43.13728094100952, "custom_metrics": {"cost2_mean": -55.318040040710066, "system_level_velocity_max": 12.739334596554228, "cost2_max": -43.348245690911966, "outflow_rate_max": 991.2888489002528, "system_level_velocity_mean": 10.709443217537611, "cost1_mean": 284.32693909394055, "cost2_min": -66.43100624407232, "outflow_rate_min": 753.9830430830282, "cost1_max": 335.14695244998177, "outflow_rate_mean": 884.7109963220419, "cost1_min": 225.47798781004684, "system_level_velocity_min": 8.536546983370501}, "episodes_total": 352, "timesteps_this_iter": 123663, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 7, "timesteps_total": 816993, "date": "2019-04-28_10-13-03", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 816993, "load_time_ms": 22.43, "grad_time_ms": 25744.252, "default": {"total_loss": 10.746467590332031, "cur_kl_coeff": 0.10000002384185791, "entropy": 1.370983600616455, "vf_loss": 10.746787071228027, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.800057053565979, "kl": 0.004014691337943077, "policy_loss": -0.0007223772117868066}, "num_steps_trained": 816993, "update_time_ms": 410.077, "sample_time_ms": 20078.019}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148dd8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912cc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148780>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 52, "time_total_s": 325.4058609008789, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446383, "episode_reward_mean": 774.7572591192148}
{"training_iteration": 8, "time_since_restore": 366.83345890045166, "episode_reward_max": 920.7609510341472, "policy_reward_mean": {}, "timesteps_since_restore": 938996, "episode_len_mean": 700.0, "episode_reward_min": 647.494102317421, "hostname": "flow-main", "time_this_iter_s": 41.427597999572754, "custom_metrics": {"cost2_mean": -55.29955418859071, "system_level_velocity_max": 12.656428459501466, "cost2_max": -44.58836713256978, "outflow_rate_max": 1006.9615405537273, "system_level_velocity_mean": 10.727228104057685, "cost1_mean": 285.5128751083679, "cost2_min": -66.43100624407232, "outflow_rate_min": 756.1596586469902, "cost1_max": 337.33817494024294, "outflow_rate_mean": 897.7881277930157, "cost1_min": 225.47798781004684, "system_level_velocity_min": 8.536546983370501}, "episodes_total": 391, "timesteps_this_iter": 122003, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 8, "timesteps_total": 938996, "date": "2019-04-28_10-13-44", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 938996, "load_time_ms": 21.029, "grad_time_ms": 25796.39, "default": {"total_loss": 8.006261825561523, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3708927631378174, "vf_loss": 8.007209777832031, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8329623937606812, "kl": 0.005179913714528084, "policy_loss": -0.0012061891611665487}, "num_steps_trained": 938996, "update_time_ms": 360.175, "sample_time_ms": 19444.995}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c7f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c2b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 39, "time_total_s": 366.83345890045166, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446424, "episode_reward_mean": 789.4173217401}
{"training_iteration": 9, "time_since_restore": 409.93022441864014, "episode_reward_max": 920.7609510341472, "policy_reward_mean": {}, "timesteps_since_restore": 1062938, "episode_len_mean": 700.0, "episode_reward_min": 640.484423206624, "hostname": "flow-main", "time_this_iter_s": 43.09676551818848, "custom_metrics": {"cost2_mean": -50.60201980649103, "system_level_velocity_max": 12.656428459501466, "cost2_max": -39.94017711468465, "outflow_rate_max": 1006.9615405537273, "system_level_velocity_mean": 10.370623086883956, "cost1_mean": 277.04396539132154, "cost2_min": -66.04386887967787, "outflow_rate_min": 723.3266123554582, "cost1_max": 337.33817494024294, "outflow_rate_mean": 880.3586090264804, "cost1_min": 212.030421617493, "system_level_velocity_min": 8.021184526298468}, "episodes_total": 451, "timesteps_this_iter": 123942, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 9, "timesteps_total": 1062938, "date": "2019-04-28_10-14-28", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1062938, "load_time_ms": 20.177, "grad_time_ms": 25913.85, "default": {"total_loss": 9.489147186279297, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3627375364303589, "vf_loss": 9.489738464355469, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7963683605194092, "kl": 0.005688553210347891, "policy_loss": -0.0008760204073041677}, "num_steps_trained": 1062938, "update_time_ms": 321.24, "sample_time_ms": 19059.953}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148cf8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c5c0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 409.93022441864014, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446468, "episode_reward_mean": 789.4753365541396}
{"training_iteration": 10, "time_since_restore": 451.97007870674133, "episode_reward_max": 907.1738935341685, "policy_reward_mean": {}, "timesteps_since_restore": 1185583, "episode_len_mean": 700.0, "episode_reward_min": 581.811392748803, "hostname": "flow-main", "time_this_iter_s": 42.039854288101196, "custom_metrics": {"cost2_mean": -48.29423241868686, "system_level_velocity_max": 12.160198693771337, "cost2_max": -39.94017711468465, "outflow_rate_max": 984.9737867608923, "system_level_velocity_mean": 9.952454612782088, "cost1_mean": 266.1390033322542, "cost2_min": -58.22705647543904, "outflow_rate_min": 689.5323246153941, "cost1_max": 326.637935444228, "outflow_rate_mean": 852.6136150827035, "cost1_min": 208.08497056011623, "system_level_velocity_min": 7.846727152386938}, "episodes_total": 496, "timesteps_this_iter": 122645, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 10, "timesteps_total": 1185583, "date": "2019-04-28_10-15-10", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1185583, "load_time_ms": 19.438, "grad_time_ms": 25969.452, "default": {"total_loss": 9.2328462600708, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3591463565826416, "vf_loss": 9.233875274658203, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8281395435333252, "kl": 0.006551121361553669, "policy_loss": -0.0013578577199950814}, "num_steps_trained": 1185583, "update_time_ms": 290.433, "sample_time_ms": 18685.355}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912c080>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9964048>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 45, "time_total_s": 451.97007870674133, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446510, "episode_reward_mean": 775.805525902982}
{"training_iteration": 11, "time_since_restore": 491.9426579475403, "episode_reward_max": 907.1738935341685, "policy_reward_mean": {}, "timesteps_since_restore": 1302537, "episode_len_mean": 700.0, "episode_reward_min": 532.2992562410469, "hostname": "flow-main", "time_this_iter_s": 39.97257924079895, "custom_metrics": {"cost2_mean": -47.54420777301994, "system_level_velocity_max": 12.51675348886762, "cost2_max": -30.602035805941412, "outflow_rate_max": 974.0457584709269, "system_level_velocity_mean": 10.0199997853189, "cost1_mean": 268.28111692620604, "cost2_min": -60.35798491461759, "outflow_rate_min": 588.7917098955891, "cost1_max": 336.2938216709138, "outflow_rate_mean": 859.71268336384, "cost1_min": 189.30112386045295, "system_level_velocity_min": 7.25838853717751}, "episodes_total": 546, "timesteps_this_iter": 116954, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 11, "timesteps_total": 1302537, "date": "2019-04-28_10-15-50", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1302537, "load_time_ms": 12.493, "grad_time_ms": 25654.071, "default": {"total_loss": 10.890359878540039, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.3322999477386475, "vf_loss": 10.891615867614746, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7954144477844238, "kl": 0.0071131205186247826, "policy_loss": -0.0016110865399241447}, "num_steps_trained": 1302537, "update_time_ms": 11.076, "sample_time_ms": 15209.007}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148940>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148a20>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 50, "time_total_s": 491.9426579475403, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446550, "episode_reward_mean": 789.8324839630454}
{"training_iteration": 12, "time_since_restore": 532.2137033939362, "episode_reward_max": 922.3102817454475, "policy_reward_mean": {}, "timesteps_since_restore": 1420223, "episode_len_mean": 700.0, "episode_reward_min": 532.2992562410469, "hostname": "flow-main", "time_this_iter_s": 40.271045446395874, "custom_metrics": {"cost2_mean": -41.62364741332096, "system_level_velocity_max": 12.51675348886762, "cost2_max": -29.186249472199016, "outflow_rate_max": 983.7268669922452, "system_level_velocity_mean": 10.550371515164924, "cost1_mean": 283.4351051274309, "cost2_min": -60.35798491461759, "outflow_rate_min": 588.7917098955891, "cost1_max": 336.39245202320626, "outflow_rate_mean": 890.4535305573573, "cost1_min": 189.30112386045295, "system_level_velocity_min": 7.25838853717751}, "episodes_total": 602, "timesteps_this_iter": 117686, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 12, "timesteps_total": 1420223, "date": "2019-04-28_10-16-30", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1420223, "load_time_ms": 12.461, "grad_time_ms": 25714.842, "default": {"total_loss": 12.041068077087402, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.320847749710083, "vf_loss": 12.041994094848633, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7499539256095886, "kl": 0.007870659232139587, "policy_loss": -0.001320399227552116}, "num_steps_trained": 1420223, "update_time_ms": 10.779, "sample_time_ms": 15202.35}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c4a8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c780>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 532.2137033939362, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446590, "episode_reward_mean": 829.4155727821443}
{"training_iteration": 13, "time_since_restore": 573.0879759788513, "episode_reward_max": 934.3955128307382, "policy_reward_mean": {}, "timesteps_since_restore": 1535747, "episode_len_mean": 700.0, "episode_reward_min": 759.9281818667622, "hostname": "flow-main", "time_this_iter_s": 40.87427258491516, "custom_metrics": {"cost2_mean": -34.61359843602906, "system_level_velocity_max": 13.006762390376094, "cost2_max": -25.33649624427688, "outflow_rate_max": 983.7268669922452, "system_level_velocity_mean": 11.018930339280374, "cost1_mean": 296.4424697967879, "cost2_min": -47.112608505598224, "outflow_rate_min": 778.0929641260442, "cost1_max": 351.9573942126201, "outflow_rate_mean": 900.3445131710992, "cost1_min": 227.81030736858574, "system_level_velocity_min": 8.49240892022273}, "episodes_total": 653, "timesteps_this_iter": 115524, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 13, "timesteps_total": 1535747, "date": "2019-04-28_10-17-11", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1535747, "load_time_ms": 12.475, "grad_time_ms": 25819.149, "default": {"total_loss": 12.239118576049805, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3074188232421875, "vf_loss": 12.240234375, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7463783621788025, "kl": 0.008213208988308907, "policy_loss": -0.0015262187225744128}, "num_steps_trained": 1535747, "update_time_ms": 10.951, "sample_time_ms": 15260.914}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148438>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148e48>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 51, "time_total_s": 573.0879759788513, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446631, "episode_reward_mean": 851.9499442938541}
{"training_iteration": 14, "time_since_restore": 612.5265946388245, "episode_reward_max": 934.3955128307382, "policy_reward_mean": {}, "timesteps_since_restore": 1647129, "episode_len_mean": 700.0, "episode_reward_min": 725.2124840723754, "hostname": "flow-main", "time_this_iter_s": 39.438618659973145, "custom_metrics": {"cost2_mean": -30.402280892450193, "system_level_velocity_max": 13.474833358777131, "cost2_max": -21.436757789287586, "outflow_rate_max": 973.3698254279977, "system_level_velocity_mean": 11.25469083286852, "cost1_mean": 302.3372408822258, "cost2_min": -43.64303934380391, "outflow_rate_min": 789.0256332214434, "cost1_max": 358.7808626501121, "outflow_rate_mean": 884.7527724722797, "cost1_min": 227.81030736858574, "system_level_velocity_min": 8.49240892022273}, "episodes_total": 714, "timesteps_this_iter": 111382, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 14, "timesteps_total": 1647129, "date": "2019-04-28_10-17-50", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1647129, "load_time_ms": 12.394, "grad_time_ms": 25707.511, "default": {"total_loss": 17.24558448791504, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3093876838684082, "vf_loss": 17.24616241455078, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6939688324928284, "kl": 0.0066533638164401054, "policy_loss": -0.0009097258443944156}, "num_steps_trained": 1647129, "update_time_ms": 11.061, "sample_time_ms": 15355.425}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cb38>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c9b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 61, "time_total_s": 612.5265946388245, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446670, "episode_reward_mean": 844.8806511892207}
{"training_iteration": 15, "time_since_restore": 651.7326438426971, "episode_reward_max": 945.8779723170437, "policy_reward_mean": {}, "timesteps_since_restore": 1757799, "episode_len_mean": 700.0, "episode_reward_min": 725.2124840723754, "hostname": "flow-main", "time_this_iter_s": 39.20604920387268, "custom_metrics": {"cost2_mean": -28.516270068514356, "system_level_velocity_max": 14.604481244332359, "cost2_max": -20.453655047896568, "outflow_rate_max": 995.9975097628836, "system_level_velocity_mean": 11.854249738942357, "cost1_mean": 317.7540369015352, "cost2_min": -43.64303934380391, "outflow_rate_min": 806.3942019907172, "cost1_max": 387.82020041469895, "outflow_rate_mean": 889.2480344860093, "cost1_min": 245.06308730563546, "system_level_velocity_min": 9.073142873428306}, "episodes_total": 774, "timesteps_this_iter": 110670, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 15, "timesteps_total": 1757799, "date": "2019-04-28_10-18-29", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1757799, "load_time_ms": 11.981, "grad_time_ms": 25490.851, "default": {"total_loss": 18.025606155395508, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.3035540580749512, "vf_loss": 18.025985717773438, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6943120360374451, "kl": 0.0062028151005506516, "policy_loss": -0.0006901666056364775}, "num_steps_trained": 1757799, "update_time_ms": 11.061, "sample_time_ms": 15324.243}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148c18>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148a20>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 651.7326438426971, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446709, "episode_reward_mean": 847.707560591443}
{"training_iteration": 16, "time_since_restore": 693.2887649536133, "episode_reward_max": 961.4208297871816, "policy_reward_mean": {}, "timesteps_since_restore": 1869414, "episode_len_mean": 700.0, "episode_reward_min": 775.5435765381163, "hostname": "flow-main", "time_this_iter_s": 41.55612111091614, "custom_metrics": {"cost2_mean": -26.42368751194686, "system_level_velocity_max": 14.509315193371268, "cost2_max": -20.47308356065054, "outflow_rate_max": 994.7041637280195, "system_level_velocity_mean": 12.452124322979428, "cost1_mean": 333.8409280268034, "cost2_min": -41.59702891023568, "outflow_rate_min": 806.3942019907172, "cost1_max": 387.1406202085717, "outflow_rate_mean": 916.477950784812, "cost1_min": 245.06308730563546, "system_level_velocity_min": 9.073142873428306}, "episodes_total": 834, "timesteps_this_iter": 111615, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 16, "timesteps_total": 1869414, "date": "2019-04-28_10-19-11", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1869414, "load_time_ms": 11.835, "grad_time_ms": 25455.121, "default": {"total_loss": 19.575166702270508, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.281963586807251, "vf_loss": 19.575523376464844, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6411248445510864, "kl": 0.007956703193485737, "policy_loss": -0.0007530662696808577}, "num_steps_trained": 1869414, "update_time_ms": 11.248, "sample_time_ms": 15394.86}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e278>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ceb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912c828>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 693.2887649536133, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446751, "episode_reward_mean": 874.9864964488963}
{"training_iteration": 17, "time_since_restore": 731.3871371746063, "episode_reward_max": 985.0245663848947, "policy_reward_mean": {}, "timesteps_since_restore": 1981929, "episode_len_mean": 700.0, "episode_reward_min": 777.2117343619658, "hostname": "flow-main", "time_this_iter_s": 38.09837222099304, "custom_metrics": {"cost2_mean": -26.323715650147733, "system_level_velocity_max": 14.509315193371268, "cost2_max": -19.1584026361565, "outflow_rate_max": 1011.869152634295, "system_level_velocity_mean": 12.597609796384592, "cost1_mean": 338.34695385099485, "cost2_min": -44.03379924811385, "outflow_rate_min": 776.0004800067653, "cost1_max": 388.62857849886655, "outflow_rate_mean": 932.8967452896885, "cost1_min": 218.22145616488416, "system_level_velocity_min": 8.058124520383812}, "episodes_total": 890, "timesteps_this_iter": 112515, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 17, "timesteps_total": 1981929, "date": "2019-04-28_10-19-49", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1981929, "load_time_ms": 11.891, "grad_time_ms": 25070.374, "default": {"total_loss": 17.71243667602539, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.2681517601013184, "vf_loss": 17.713499069213867, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7391403317451477, "kl": 0.007843920029699802, "policy_loss": -0.0014536511152982712}, "num_steps_trained": 1981929, "update_time_ms": 11.162, "sample_time_ms": 15279.399}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148400>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148780>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 731.3871371746063, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446789, "episode_reward_mean": 896.0360602355993}
{"training_iteration": 18, "time_since_restore": 773.2912542819977, "episode_reward_max": 986.3295083498211, "policy_reward_mean": {}, "timesteps_since_restore": 2097929, "episode_len_mean": 700.0, "episode_reward_min": 767.23685367551, "hostname": "flow-main", "time_this_iter_s": 41.90411710739136, "custom_metrics": {"cost2_mean": -27.883482575228864, "system_level_velocity_max": 14.488847072369193, "cost2_max": -19.1584026361565, "outflow_rate_max": 1015.0936859786082, "system_level_velocity_mean": 12.331642626546099, "cost1_mean": 331.8094707262844, "cost2_min": -44.03379924811385, "outflow_rate_min": 776.0004800067653, "cost1_max": 388.62857849886655, "outflow_rate_mean": 940.4106778153348, "cost1_min": 218.22145616488416, "system_level_velocity_min": 8.058124520383812}, "episodes_total": 950, "timesteps_this_iter": 116000, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 18, "timesteps_total": 2097929, "date": "2019-04-28_10-20-31", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2097929, "load_time_ms": 12.063, "grad_time_ms": 25060.59, "default": {"total_loss": 17.638809204101562, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2628005743026733, "vf_loss": 17.638885498046875, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7330004572868347, "kl": 0.006944416556507349, "policy_loss": -0.00042467861203476787}, "num_steps_trained": 2097929, "update_time_ms": 11.165, "sample_time_ms": 15335.978}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91487f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9964940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148e80>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 773.2912542819977, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446831, "episode_reward_mean": 904.2648580623724}
{"training_iteration": 19, "time_since_restore": 814.1803476810455, "episode_reward_max": 986.3295083498211, "policy_reward_mean": {}, "timesteps_since_restore": 2214036, "episode_len_mean": 700.0, "episode_reward_min": 767.23685367551, "hostname": "flow-main", "time_this_iter_s": 40.88909339904785, "custom_metrics": {"cost2_mean": -26.83714834818851, "system_level_velocity_max": 14.162052224348052, "cost2_max": -21.405571403621316, "outflow_rate_max": 1015.3791791993606, "system_level_velocity_mean": 12.300201583814358, "cost1_mean": 331.4155712018726, "cost2_min": -39.9138894304332, "outflow_rate_min": 832.0661676982085, "cost1_max": 380.0783159669056, "outflow_rate_mean": 946.0721014580299, "cost1_min": 261.1623414237265, "system_level_velocity_min": 9.761037907160096}, "episodes_total": 997, "timesteps_this_iter": 116107, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 19, "timesteps_total": 2214036, "date": "2019-04-28_10-21-12", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2214036, "load_time_ms": 11.936, "grad_time_ms": 24928.2, "default": {"total_loss": 15.63072395324707, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2595881223678589, "vf_loss": 15.631637573242188, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7658434510231018, "kl": 0.006863855291157961, "policy_loss": -0.001257199328392744}, "num_steps_trained": 2214036, "update_time_ms": 11.307, "sample_time_ms": 15249.027}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148588>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91485c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148550>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 47, "time_total_s": 814.1803476810455, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446872, "episode_reward_mean": 907.2174104698712}
{"training_iteration": 20, "time_since_restore": 854.125739812851, "episode_reward_max": 982.9269474005858, "policy_reward_mean": {}, "timesteps_since_restore": 2327631, "episode_len_mean": 700.0, "episode_reward_min": 785.9894245526472, "hostname": "flow-main", "time_this_iter_s": 39.94539213180542, "custom_metrics": {"cost2_mean": -24.64838618287702, "system_level_velocity_max": 14.630883950397843, "cost2_max": -19.62536865620318, "outflow_rate_max": 1013.0845340620709, "system_level_velocity_mean": 12.366539617878258, "cost1_mean": 333.20129472140036, "cost2_min": -34.06192556329909, "outflow_rate_min": 830.7903976706418, "cost1_max": 391.4935881671074, "outflow_rate_mean": 940.1703498074603, "cost1_min": 261.65530766469135, "system_level_velocity_min": 9.686713558909128}, "episodes_total": 1054, "timesteps_this_iter": 113595, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 20, "timesteps_total": 2327631, "date": "2019-04-28_10-21-52", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2327631, "load_time_ms": 11.945, "grad_time_ms": 24729.584, "default": {"total_loss": 20.176292419433594, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.25863516330719, "vf_loss": 20.1766357421875, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7224346995353699, "kl": 0.0059196194633841515, "policy_loss": -0.0006399788544513285}, "num_steps_trained": 2327631, "update_time_ms": 11.15, "sample_time_ms": 15240.34}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148c88>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91485f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148cc0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 57, "time_total_s": 854.125739812851, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446912, "episode_reward_mean": 898.0893726694767}
{"training_iteration": 21, "time_since_restore": 894.9061963558197, "episode_reward_max": 984.191262210087, "policy_reward_mean": {}, "timesteps_since_restore": 2441430, "episode_len_mean": 700.0, "episode_reward_min": 776.8121828419017, "hostname": "flow-main", "time_this_iter_s": 40.78045654296875, "custom_metrics": {"cost2_mean": -25.122724278974673, "system_level_velocity_max": 14.7976571500421, "cost2_max": -20.000984122398382, "outflow_rate_max": 1035.105097634669, "system_level_velocity_mean": 12.416373819964901, "cost1_mean": 333.7718893421545, "cost2_min": -34.29517546203473, "outflow_rate_min": 830.7903976706418, "cost1_max": 396.3552366710495, "outflow_rate_mean": 932.9445193086052, "cost1_min": 259.8149926353502, "system_level_velocity_min": 9.722032762965965}, "episodes_total": 1113, "timesteps_this_iter": 113799, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 21, "timesteps_total": 2441430, "date": "2019-04-28_10-22-33", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2441430, "load_time_ms": 11.954, "grad_time_ms": 24721.435, "default": {"total_loss": 21.86689567565918, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2451344728469849, "vf_loss": 21.867420196533203, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.713717520236969, "kl": 0.006818556692451239, "policy_loss": -0.0008671944960951805}, "num_steps_trained": 2441430, "update_time_ms": 11.084, "sample_time_ms": 15329.768}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148f28>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148748>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 894.9061963558197, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446953, "episode_reward_mean": 890.6938689888407}
{"training_iteration": 22, "time_since_restore": 935.1951293945312, "episode_reward_max": 984.191262210087, "policy_reward_mean": {}, "timesteps_since_restore": 2555546, "episode_len_mean": 700.0, "episode_reward_min": 779.7724072080356, "hostname": "flow-main", "time_this_iter_s": 40.28893303871155, "custom_metrics": {"cost2_mean": -25.300003391348117, "system_level_velocity_max": 14.7976571500421, "cost2_max": -19.385958191606726, "outflow_rate_max": 1035.105097634669, "system_level_velocity_mean": 12.473537532809496, "cost1_mean": 334.8571329548873, "cost2_min": -35.96513290747954, "outflow_rate_min": 832.6149314608234, "cost1_max": 396.3552366710495, "outflow_rate_mean": 940.3264557037904, "cost1_min": 247.17427217791234, "system_level_velocity_min": 9.165432321561639}, "episodes_total": 1167, "timesteps_this_iter": 114116, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 22, "timesteps_total": 2555546, "date": "2019-04-28_10-23-13", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2555546, "load_time_ms": 11.888, "grad_time_ms": 24728.806, "default": {"total_loss": 19.182416915893555, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2445067167282104, "vf_loss": 19.18370246887207, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7507292628288269, "kl": 0.0073340521194040775, "policy_loss": -0.0016540533397346735}, "num_steps_trained": 2555546, "update_time_ms": 11.24, "sample_time_ms": 15324.115}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148710>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91481d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148dd8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 54, "time_total_s": 935.1951293945312, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556446993, "episode_reward_mean": 893.4245072873136}
{"training_iteration": 23, "time_since_restore": 974.800196647644, "episode_reward_max": 968.124655811499, "policy_reward_mean": {}, "timesteps_since_restore": 2666989, "episode_len_mean": 700.0, "episode_reward_min": 785.0262836674127, "hostname": "flow-main", "time_this_iter_s": 39.60506725311279, "custom_metrics": {"cost2_mean": -23.802651913093655, "system_level_velocity_max": 15.207204270191516, "cost2_max": -18.945084582352223, "outflow_rate_max": 1022.2011939402265, "system_level_velocity_mean": 12.382375039994939, "cost1_mean": 332.35745719570133, "cost2_min": -35.96513290747954, "outflow_rate_min": 831.6410601954381, "cost1_max": 409.1587163703507, "outflow_rate_mean": 937.6714280735687, "cost1_min": 247.17427217791234, "system_level_velocity_min": 9.165432321561639}, "episodes_total": 1227, "timesteps_this_iter": 111443, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 23, "timesteps_total": 2666989, "date": "2019-04-28_10-23-53", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2666989, "load_time_ms": 11.931, "grad_time_ms": 24585.423, "default": {"total_loss": 21.836179733276367, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2476534843444824, "vf_loss": 21.837331771850586, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7145464420318604, "kl": 0.007915252819657326, "policy_loss": -0.0015476314583793283}, "num_steps_trained": 2666989, "update_time_ms": 11.379, "sample_time_ms": 15340.395}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148748>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148438>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 974.800196647644, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447033, "episode_reward_mean": 886.2572551226929}
{"training_iteration": 24, "time_since_restore": 1017.0236885547638, "episode_reward_max": 969.6728861955473, "policy_reward_mean": {}, "timesteps_since_restore": 2779354, "episode_len_mean": 700.0, "episode_reward_min": 771.0743172208327, "hostname": "flow-main", "time_this_iter_s": 42.22349190711975, "custom_metrics": {"cost2_mean": -23.091044476120764, "system_level_velocity_max": 15.207204270191516, "cost2_max": -18.39243991845937, "outflow_rate_max": 1025.8881604487144, "system_level_velocity_mean": 12.6269885351297, "cost1_mean": 338.5155710590875, "cost2_min": -28.94993542351775, "outflow_rate_min": 821.858800875658, "cost1_max": 409.1587163703507, "outflow_rate_mean": 939.9816681818565, "cost1_min": 262.2742340715582, "system_level_velocity_min": 9.84764585306105}, "episodes_total": 1284, "timesteps_this_iter": 112365, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 24, "timesteps_total": 2779354, "date": "2019-04-28_10-24-35", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2779354, "load_time_ms": 12.143, "grad_time_ms": 24871.713, "default": {"total_loss": 21.90778160095215, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2440376281738281, "vf_loss": 21.908348083496094, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7374810576438904, "kl": 0.006690080743283033, "policy_loss": -0.0009006233303807676}, "num_steps_trained": 2779354, "update_time_ms": 11.296, "sample_time_ms": 15331.399}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912c438>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ccc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912c390>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 57, "time_total_s": 1017.0236885547638, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447075, "episode_reward_mean": 885.6018975899493}
{"training_iteration": 25, "time_since_restore": 1057.4685728549957, "episode_reward_max": 975.1573946592631, "policy_reward_mean": {}, "timesteps_since_restore": 2891540, "episode_len_mean": 693.37, "episode_reward_min": 52.23364825688432, "hostname": "flow-main", "time_this_iter_s": 40.444884300231934, "custom_metrics": {"cost2_mean": -23.017932507978664, "system_level_velocity_max": 17.762444988154346, "cost2_max": -12.191148925851873, "outflow_rate_max": 1040.996304339776, "system_level_velocity_mean": 12.849161241826057, "cost1_mean": 339.44345503266436, "cost2_min": -33.50979630884328, "outflow_rate_min": 494.720681943273, "cost1_max": 406.30045050815136, "outflow_rate_mean": 940.0657242412324, "cost1_min": 23.316590678544863, "system_level_velocity_min": 9.774868498559552}, "episodes_total": 1345, "timesteps_this_iter": 112186, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 25, "timesteps_total": 2891540, "date": "2019-04-28_10-25-16", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2891540, "load_time_ms": 12.31, "grad_time_ms": 24970.781, "default": {"total_loss": 23.93027687072754, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2370506525039673, "vf_loss": 23.93062400817871, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7181804776191711, "kl": 0.006722058169543743, "policy_loss": -0.000683398568071425}, "num_steps_trained": 2891540, "update_time_ms": 11.391, "sample_time_ms": 15355.574}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91488d0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148160>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 61, "time_total_s": 1057.4685728549957, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447116, "episode_reward_mean": 878.8023784454189}
{"training_iteration": 26, "time_since_restore": 1097.3770785331726, "episode_reward_max": 975.1573946592631, "policy_reward_mean": {}, "timesteps_since_restore": 3003045, "episode_len_mean": 700.0, "episode_reward_min": 765.0358957776284, "hostname": "flow-main", "time_this_iter_s": 39.90850567817688, "custom_metrics": {"cost2_mean": -22.127983458829245, "system_level_velocity_max": 15.913509294458825, "cost2_max": -17.193126163272773, "outflow_rate_max": 1046.4399717861693, "system_level_velocity_mean": 12.779671745543565, "cost1_mean": 341.42123705120287, "cost2_min": -28.286085594873683, "outflow_rate_min": 822.8544215551399, "cost1_max": 421.7372548573448, "outflow_rate_mean": 938.3137187739047, "cost1_min": 262.43658084091606, "system_level_velocity_min": 9.90635355797122}, "episodes_total": 1405, "timesteps_this_iter": 111505, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 26, "timesteps_total": 3003045, "date": "2019-04-28_10-25-55", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3003045, "load_time_ms": 12.395, "grad_time_ms": 24825.162, "default": {"total_loss": 23.655061721801758, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2271698713302612, "vf_loss": 23.655517578125, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7353540062904358, "kl": 0.007322683464735746, "policy_loss": -0.0008191941888071597}, "num_steps_trained": 3003045, "update_time_ms": 11.362, "sample_time_ms": 15335.761}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c400>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cf60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cac8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 1097.3770785331726, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447155, "episode_reward_mean": 876.9125918313053}
{"training_iteration": 27, "time_since_restore": 1136.5326538085938, "episode_reward_max": 971.2119489476679, "policy_reward_mean": {}, "timesteps_since_restore": 3113493, "episode_len_mean": 699.57, "episode_reward_min": 765.0358957776284, "hostname": "flow-main", "time_this_iter_s": 39.15557527542114, "custom_metrics": {"cost2_mean": -21.84459502752934, "system_level_velocity_max": 16.16673228122116, "cost2_max": -18.47658278471267, "outflow_rate_max": 1046.4399717861693, "system_level_velocity_mean": 13.125690946724237, "cost1_mean": 349.24889595842325, "cost2_min": -29.692212814560687, "outflow_rate_min": 822.8544215551399, "cost1_max": 426.08149132134247, "outflow_rate_mean": 938.4645384937306, "cost1_min": 267.4931340304126, "system_level_velocity_min": 10.09710088839265}, "episodes_total": 1465, "timesteps_this_iter": 110448, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 27, "timesteps_total": 3113493, "date": "2019-04-28_10-26-35", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3113493, "load_time_ms": 12.486, "grad_time_ms": 24862.479, "default": {"total_loss": 28.645431518554688, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.22298002243042, "vf_loss": 28.646352767944336, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6735419034957886, "kl": 0.008325859904289246, "policy_loss": -0.0013409822713583708}, "num_steps_trained": 3113493, "update_time_ms": 11.41, "sample_time_ms": 15402.098}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148710>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148b70>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 1136.5326538085938, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447195, "episode_reward_mean": 877.6754241738918}
{"training_iteration": 28, "time_since_restore": 1176.067551612854, "episode_reward_max": 971.2119489476679, "policy_reward_mean": {}, "timesteps_since_restore": 3223990, "episode_len_mean": 699.57, "episode_reward_min": 777.841191710849, "hostname": "flow-main", "time_this_iter_s": 39.534897804260254, "custom_metrics": {"cost2_mean": -21.73267163925917, "system_level_velocity_max": 16.16673228122116, "cost2_max": -18.36460736483267, "outflow_rate_max": 1039.6254880820204, "system_level_velocity_mean": 13.014025967483406, "cost1_mean": 345.7708618617705, "cost2_min": -29.692212814560687, "outflow_rate_min": 826.4559816484589, "cost1_max": 426.08149132134247, "outflow_rate_mean": 928.656855273458, "cost1_min": 268.02232606138875, "system_level_velocity_min": 10.09710088839265}, "episodes_total": 1524, "timesteps_this_iter": 110497, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 28, "timesteps_total": 3223990, "date": "2019-04-28_10-27-14", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3223990, "load_time_ms": 12.451, "grad_time_ms": 24660.983, "default": {"total_loss": 26.039167404174805, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2239840030670166, "vf_loss": 26.039398193359375, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7000142335891724, "kl": 0.006479964591562748, "policy_loss": -0.0005539282574318349}, "num_steps_trained": 3223990, "update_time_ms": 11.457, "sample_time_ms": 15367.862}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ca90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912c0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912c080>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 1176.067551612854, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447234, "episode_reward_mean": 867.2532548542441}
{"training_iteration": 29, "time_since_restore": 1214.9320588111877, "episode_reward_max": 948.9189046922831, "policy_reward_mean": {}, "timesteps_since_restore": 3335034, "episode_len_mean": 700.0, "episode_reward_min": 774.1754020018461, "hostname": "flow-main", "time_this_iter_s": 38.86450719833374, "custom_metrics": {"cost2_mean": -21.57206832544494, "system_level_velocity_max": 15.8540258926743, "cost2_max": -18.280184884527728, "outflow_rate_max": 1019.410761978449, "system_level_velocity_mean": 13.121751108054928, "cost1_mean": 349.3330782944073, "cost2_min": -26.27954985499713, "outflow_rate_min": 827.617445442252, "cost1_max": 418.0140616881197, "outflow_rate_mean": 930.9702625691697, "cost1_min": 269.64981563537685, "system_level_velocity_min": 10.127038393810814}, "episodes_total": 1585, "timesteps_this_iter": 111044, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 29, "timesteps_total": 3335034, "date": "2019-04-28_10-27-53", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3335034, "load_time_ms": 12.682, "grad_time_ms": 24449.34, "default": {"total_loss": 27.739315032958984, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2262893915176392, "vf_loss": 27.740236282348633, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7011480927467346, "kl": 0.00771669577807188, "policy_loss": -0.0013090017018839717}, "num_steps_trained": 3335034, "update_time_ms": 11.467, "sample_time_ms": 15377.342}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148358>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91484e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148978>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 61, "time_total_s": 1214.9320588111877, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447273, "episode_reward_mean": 869.2525540258972}
{"training_iteration": 30, "time_since_restore": 1254.8247919082642, "episode_reward_max": 978.6449067041747, "policy_reward_mean": {}, "timesteps_since_restore": 3447980, "episode_len_mean": 700.0, "episode_reward_min": 774.1754020018461, "hostname": "flow-main", "time_this_iter_s": 39.892733097076416, "custom_metrics": {"cost2_mean": -21.807656470301872, "system_level_velocity_max": 15.936289103396176, "cost2_max": -18.280184884527728, "outflow_rate_max": 1037.5216633524017, "system_level_velocity_mean": 13.203856797627235, "cost1_mean": 351.7328787119396, "cost2_min": -29.385200140015456, "outflow_rate_min": 834.4212370818265, "cost1_max": 423.42665302701784, "outflow_rate_mean": 940.9198228673195, "cost1_min": 262.75339929541747, "system_level_velocity_min": 9.890680436209152}, "episodes_total": 1642, "timesteps_this_iter": 112946, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 30, "timesteps_total": 3447980, "date": "2019-04-28_10-28-33", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3447980, "load_time_ms": 12.724, "grad_time_ms": 24439.043, "default": {"total_loss": 24.937664031982422, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2127737998962402, "vf_loss": 24.938589096069336, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7351346015930176, "kl": 0.007677176967263222, "policy_loss": -0.0013089707354083657}, "num_steps_trained": 3447980, "update_time_ms": 11.272, "sample_time_ms": 15380.664}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91486a0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c208>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 57, "time_total_s": 1254.8247919082642, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447313, "episode_reward_mean": 880.8654028920251}
{"training_iteration": 31, "time_since_restore": 1294.3983747959137, "episode_reward_max": 978.6449067041747, "policy_reward_mean": {}, "timesteps_since_restore": 3560298, "episode_len_mean": 700.0, "episode_reward_min": 790.2822876679901, "hostname": "flow-main", "time_this_iter_s": 39.573582887649536, "custom_metrics": {"cost2_mean": -22.318411967930643, "system_level_velocity_max": 15.936289103396176, "cost2_max": -18.9346970068618, "outflow_rate_max": 1037.5216633524017, "system_level_velocity_mean": 13.04022603763737, "cost1_mean": 347.3754373654987, "cost2_min": -31.445463225833706, "outflow_rate_min": 823.1264345567463, "cost1_max": 424.2914081631495, "outflow_rate_mean": 940.7049937695026, "cost1_min": 266.2068876233233, "system_level_velocity_min": 9.930104079889313}, "episodes_total": 1702, "timesteps_this_iter": 112318, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 31, "timesteps_total": 3560298, "date": "2019-04-28_10-29-13", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3560298, "load_time_ms": 12.632, "grad_time_ms": 24358.144, "default": {"total_loss": 26.72011375427246, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.2066736221313477, "vf_loss": 26.721031188964844, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7294434905052185, "kl": 0.006973540410399437, "policy_loss": -0.0012674193130806088}, "num_steps_trained": 3560298, "update_time_ms": 11.366, "sample_time_ms": 15340.62}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148470>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91481d0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 1294.3983747959137, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447353, "episode_reward_mean": 884.9560508802329}
{"training_iteration": 32, "time_since_restore": 1335.6755249500275, "episode_reward_max": 1007.4935430461877, "policy_reward_mean": {}, "timesteps_since_restore": 3674047, "episode_len_mean": 700.0, "episode_reward_min": 792.4298642861296, "hostname": "flow-main", "time_this_iter_s": 41.27715015411377, "custom_metrics": {"cost2_mean": -22.58363951182095, "system_level_velocity_max": 16.133805722307528, "cost2_max": -18.25259763001434, "outflow_rate_max": 1064.6982102907846, "system_level_velocity_mean": 13.115452914721226, "cost1_mean": 349.33160829017373, "cost2_min": -31.445463225833706, "outflow_rate_min": 828.5667736116352, "cost1_max": 426.8063978309292, "outflow_rate_mean": 946.8679402247303, "cost1_min": 264.1289214571922, "system_level_velocity_min": 9.953247564739433}, "episodes_total": 1759, "timesteps_this_iter": 113749, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 32, "timesteps_total": 3674047, "date": "2019-04-28_10-29-54", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3674047, "load_time_ms": 13.02, "grad_time_ms": 24361.237, "default": {"total_loss": 27.12188148498535, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.2071707248687744, "vf_loss": 27.123126983642578, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7524355053901672, "kl": 0.007347183767706156, "policy_loss": -0.001612725667655468}, "num_steps_trained": 3674047, "update_time_ms": 11.512, "sample_time_ms": 15437.1}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148390>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91482b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148208>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 57, "time_total_s": 1335.6755249500275, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447394, "episode_reward_mean": 892.5048491465029}
{"training_iteration": 33, "time_since_restore": 1374.955090045929, "episode_reward_max": 1007.4935430461877, "policy_reward_mean": {}, "timesteps_since_restore": 3783835, "episode_len_mean": 700.0, "episode_reward_min": 779.7275108617469, "hostname": "flow-main", "time_this_iter_s": 39.27956509590149, "custom_metrics": {"cost2_mean": -23.54091773683305, "system_level_velocity_max": 16.4011928317619, "cost2_max": -20.045493416650057, "outflow_rate_max": 1064.6982102907846, "system_level_velocity_mean": 13.359013551969058, "cost1_mean": 354.878565447591, "cost2_min": -32.63329292202341, "outflow_rate_min": 819.0228685596004, "cost1_max": 432.05346527148345, "outflow_rate_mean": 948.4824327440115, "cost1_min": 243.54373122599648, "system_level_velocity_min": 9.065790140383209}, "episodes_total": 1819, "timesteps_this_iter": 109788, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 33, "timesteps_total": 3783835, "date": "2019-04-28_10-30-33", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3783835, "load_time_ms": 13.339, "grad_time_ms": 24365.014, "default": {"total_loss": 31.794614791870117, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.186676263809204, "vf_loss": 31.795818328857422, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6879200339317322, "kl": 0.008198820054531097, "policy_loss": -0.0016141951782628894}, "num_steps_trained": 3783835, "update_time_ms": 11.204, "sample_time_ms": 15401.263}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c898>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148ef0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 1374.955090045929, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447433, "episode_reward_mean": 883.4204998986148}
{"training_iteration": 34, "time_since_restore": 1414.1362762451172, "episode_reward_max": 956.6875700921505, "policy_reward_mean": {}, "timesteps_since_restore": 3893263, "episode_len_mean": 700.0, "episode_reward_min": 778.6622409577868, "hostname": "flow-main", "time_this_iter_s": 39.18118619918823, "custom_metrics": {"cost2_mean": -24.420639602845373, "system_level_velocity_max": 16.4011928317619, "cost2_max": -18.90074352510046, "outflow_rate_max": 1038.6536977553558, "system_level_velocity_mean": 13.607686249613328, "cost1_mean": 360.2148314736867, "cost2_min": -32.63329292202341, "outflow_rate_min": 819.0228685596004, "cost1_max": 432.05346527148345, "outflow_rate_mean": 947.0637686631925, "cost1_min": 243.54373122599648, "system_level_velocity_min": 9.065790140383209}, "episodes_total": 1878, "timesteps_this_iter": 109428, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 34, "timesteps_total": 3893263, "date": "2019-04-28_10-31-12", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3893263, "load_time_ms": 13.36, "grad_time_ms": 24091.024, "default": {"total_loss": 32.63906478881836, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.1791350841522217, "vf_loss": 32.64012145996094, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6914214491844177, "kl": 0.0076238312758505344, "policy_loss": -0.0014361971989274025}, "num_steps_trained": 3893263, "update_time_ms": 11.173, "sample_time_ms": 15371.851}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912c128>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912c828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912c5f8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 1414.1362762451172, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447472, "episode_reward_mean": 873.6897209930726}
{"training_iteration": 35, "time_since_restore": 1453.9687502384186, "episode_reward_max": 984.26096743565, "policy_reward_mean": {}, "timesteps_since_restore": 4004964, "episode_len_mean": 693.4, "episode_reward_min": 54.35684572395219, "hostname": "flow-main", "time_this_iter_s": 39.83247399330139, "custom_metrics": {"cost2_mean": -23.02250440656915, "system_level_velocity_max": 17.498889366367848, "cost2_max": -11.712083858723535, "outflow_rate_max": 1054.4659809478353, "system_level_velocity_mean": 13.463543779432142, "cost1_mean": 351.6699878808199, "cost2_min": -31.152699054241168, "outflow_rate_min": 504.25024581518545, "cost1_max": 427.43126122282206, "outflow_rate_mean": 935.4900517297709, "cost1_min": 24.829320666056056, "system_level_velocity_min": 9.821331136985302}, "episodes_total": 1941, "timesteps_this_iter": 111701, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 35, "timesteps_total": 4004964, "date": "2019-04-28_10-31-52", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4004964, "load_time_ms": 13.36, "grad_time_ms": 24013.309, "default": {"total_loss": 32.02973556518555, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1864650249481201, "vf_loss": 32.03046417236328, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.716899037361145, "kl": 0.0070077721029520035, "policy_loss": -0.001082635368220508}, "num_steps_trained": 4004964, "update_time_ms": 11.197, "sample_time_ms": 15390.402}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c3c8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99640f0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 63, "time_total_s": 1453.9687502384186, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447512, "episode_reward_mean": 862.4675751404942}
{"training_iteration": 36, "time_since_restore": 1493.5879366397858, "episode_reward_max": 984.1907980388925, "policy_reward_mean": {}, "timesteps_since_restore": 4117846, "episode_len_mean": 700.0, "episode_reward_min": 781.0282759683085, "hostname": "flow-main", "time_this_iter_s": 39.61918640136719, "custom_metrics": {"cost2_mean": -21.648390591332813, "system_level_velocity_max": 16.237589260185512, "cost2_max": -18.305810455091887, "outflow_rate_max": 1053.4478925350056, "system_level_velocity_mean": 12.938375369111048, "cost1_mean": 343.77192433857863, "cost2_min": -30.073333360045137, "outflow_rate_min": 828.0737098038835, "cost1_max": 427.4759568783022, "outflow_rate_mean": 934.7075704957947, "cost1_min": 263.8417049295582, "system_level_velocity_min": 9.821331136985302}, "episodes_total": 1999, "timesteps_this_iter": 112882, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 36, "timesteps_total": 4117846, "date": "2019-04-28_10-32-32", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4117846, "load_time_ms": 13.4, "grad_time_ms": 23980.306, "default": {"total_loss": 26.691720962524414, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1702349185943604, "vf_loss": 26.69273567199707, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7608707547187805, "kl": 0.008652414195239544, "policy_loss": -0.001449936768040061}, "num_steps_trained": 4117846, "update_time_ms": 11.296, "sample_time_ms": 15395.214}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ce48>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148470>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 58, "time_total_s": 1493.5879366397858, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447552, "episode_reward_mean": 880.2569709401118}
{"training_iteration": 37, "time_since_restore": 1533.9792268276215, "episode_reward_max": 984.1907980388925, "policy_reward_mean": {}, "timesteps_since_restore": 4232212, "episode_len_mean": 700.0, "episode_reward_min": 778.7784982697193, "hostname": "flow-main", "time_this_iter_s": 40.39129018783569, "custom_metrics": {"cost2_mean": -21.11269393720844, "system_level_velocity_max": 16.237589260185512, "cost2_max": -18.305810455091887, "outflow_rate_max": 1053.4478925350056, "system_level_velocity_mean": 12.501960660826505, "cost1_mean": 333.9331006580112, "cost2_min": -25.989707492903918, "outflow_rate_min": 831.8743767948284, "cost1_max": 427.4759568783022, "outflow_rate_mean": 928.9010048246563, "cost1_min": 254.90459832993872, "system_level_velocity_min": 9.544809753130798}, "episodes_total": 2053, "timesteps_this_iter": 114366, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 37, "timesteps_total": 4232212, "date": "2019-04-28_10-33-12", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4232212, "load_time_ms": 13.283, "grad_time_ms": 24111.011, "default": {"total_loss": 23.49335479736328, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.159657597541809, "vf_loss": 23.494213104248047, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7815365195274353, "kl": 0.00800697784870863, "policy_loss": -0.001259089563973248}, "num_steps_trained": 4232212, "update_time_ms": 11.463, "sample_time_ms": 15387.264}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91487f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91482e8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 54, "time_total_s": 1533.9792268276215, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447592, "episode_reward_mean": 881.4868370632457}
{"training_iteration": 38, "time_since_restore": 1574.1357488632202, "episode_reward_max": 970.5671844036287, "policy_reward_mean": {}, "timesteps_since_restore": 4346741, "episode_len_mean": 700.0, "episode_reward_min": 778.7784982697193, "hostname": "flow-main", "time_this_iter_s": 40.156522035598755, "custom_metrics": {"cost2_mean": -20.91879945520307, "system_level_velocity_max": 15.317088055812913, "cost2_max": -17.549499659067813, "outflow_rate_max": 1027.8726044598357, "system_level_velocity_mean": 12.103932019376252, "cost1_mean": 323.51655786154583, "cost2_min": -25.3110802549158, "outflow_rate_min": 831.8957448494042, "cost1_max": 407.75742409469024, "outflow_rate_mean": 917.204269135978, "cost1_min": 254.90459832993872, "system_level_velocity_min": 9.544809753130798}, "episodes_total": 2109, "timesteps_this_iter": 114529, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 38, "timesteps_total": 4346741, "date": "2019-04-28_10-33-53", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4346741, "load_time_ms": 13.49, "grad_time_ms": 24168.549, "default": {"total_loss": 25.19955825805664, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.154317855834961, "vf_loss": 25.200305938720703, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7624754905700684, "kl": 0.008191385306417942, "policy_loss": -0.0011612287489697337}, "num_steps_trained": 4346741, "update_time_ms": 11.608, "sample_time_ms": 15391.068}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99640f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912e278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9964da0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 1574.1357488632202, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447633, "episode_reward_mean": 872.9742909468765}
{"training_iteration": 39, "time_since_restore": 1615.167448759079, "episode_reward_max": 964.7386957560559, "policy_reward_mean": {}, "timesteps_since_restore": 4459032, "episode_len_mean": 700.0, "episode_reward_min": 787.1586332434529, "hostname": "flow-main", "time_this_iter_s": 41.031699895858765, "custom_metrics": {"cost2_mean": -20.131036322353435, "system_level_velocity_max": 15.826571124320612, "cost2_max": -15.632636483565495, "outflow_rate_max": 1032.0856200027047, "system_level_velocity_mean": 12.24569895137234, "cost1_mean": 326.89317927273424, "cost2_min": -25.3110802549158, "outflow_rate_min": 825.4969030149712, "cost1_max": 422.0618848814466, "outflow_rate_mean": 915.4458583078915, "cost1_min": 259.67895648825254, "system_level_velocity_min": 9.754137497990374}, "episodes_total": 2167, "timesteps_this_iter": 112291, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 39, "timesteps_total": 4459032, "date": "2019-04-28_10-34-34", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4459032, "load_time_ms": 13.509, "grad_time_ms": 24356.983, "default": {"total_loss": 28.57304573059082, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1379613876342773, "vf_loss": 28.573833465576172, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7345549464225769, "kl": 0.008398391306400299, "policy_loss": -0.0012096132850274444}, "num_steps_trained": 4459032, "update_time_ms": 11.496, "sample_time_ms": 15416.342}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c400>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c0f0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 58, "time_total_s": 1615.167448759079, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447674, "episode_reward_mean": 868.2021476394273}
{"training_iteration": 40, "time_since_restore": 1655.619312286377, "episode_reward_max": 964.7386957560559, "policy_reward_mean": {}, "timesteps_since_restore": 4570613, "episode_len_mean": 693.38, "episode_reward_min": 52.60084091017348, "hostname": "flow-main", "time_this_iter_s": 40.451863527297974, "custom_metrics": {"cost2_mean": -19.507937112684587, "system_level_velocity_max": 17.152842373134195, "cost2_max": -9.966083489651385, "outflow_rate_max": 1026.5245888606084, "system_level_velocity_mean": 12.52766730600016, "cost1_mean": 329.8977144505418, "cost2_min": -24.370730151207294, "outflow_rate_min": 496.3206105869156, "cost1_max": 423.15897617081083, "outflow_rate_mean": 912.7930321480563, "cost1_min": 23.068318836453788, "system_level_velocity_min": 9.546825970542166}, "episodes_total": 2224, "timesteps_this_iter": 111581, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 40, "timesteps_total": 4570613, "date": "2019-04-28_10-35-14", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4570613, "load_time_ms": 13.514, "grad_time_ms": 24359.345, "default": {"total_loss": 28.993783950805664, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1389583349227905, "vf_loss": 28.9956111907959, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7332535982131958, "kl": 0.00861431285738945, "policy_loss": -0.0022576949559152126}, "num_steps_trained": 4570613, "update_time_ms": 11.976, "sample_time_ms": 15470.245}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cc88>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148f98>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 57, "time_total_s": 1655.619312286377, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447714, "episode_reward_mean": 860.2744141774413}
{"training_iteration": 41, "time_since_restore": 1694.9015069007874, "episode_reward_max": 960.5137591976468, "policy_reward_mean": {}, "timesteps_since_restore": 4679851, "episode_len_mean": 700.0, "episode_reward_min": 780.2416258599776, "hostname": "flow-main", "time_this_iter_s": 39.2821946144104, "custom_metrics": {"cost2_mean": -20.21127157467455, "system_level_velocity_max": 16.228565977198706, "cost2_max": -15.784399558390096, "outflow_rate_max": 1026.5245888606084, "system_level_velocity_mean": 12.947566842213503, "cost1_mean": 344.80737441610705, "cost2_min": -24.370730151207294, "outflow_rate_min": 828.4254188327591, "cost1_max": 427.27349021061247, "outflow_rate_mean": 927.6457398365839, "cost1_min": 253.93526048429047, "system_level_velocity_min": 9.546825970542166}, "episodes_total": 2287, "timesteps_this_iter": 109238, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 41, "timesteps_total": 4679851, "date": "2019-04-28_10-35-53", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4679851, "load_time_ms": 13.598, "grad_time_ms": 24294.473, "default": {"total_loss": 35.893516540527344, "cur_kl_coeff": 0.050000011920928955, "entropy": 1.1281028985977173, "vf_loss": 35.894718170166016, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6704730987548828, "kl": 0.008598284795880318, "policy_loss": -0.0016333761159330606}, "num_steps_trained": 4679851, "update_time_ms": 11.914, "sample_time_ms": 15506.718}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148a58>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148860>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 63, "time_total_s": 1694.9015069007874, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447753, "episode_reward_mean": 875.3040549679913}
{"training_iteration": 42, "time_since_restore": 1734.4305505752563, "episode_reward_max": 952.3899743327717, "policy_reward_mean": {}, "timesteps_since_restore": 4789827, "episode_len_mean": 700.0, "episode_reward_min": 780.2416258599776, "hostname": "flow-main", "time_this_iter_s": 39.529043674468994, "custom_metrics": {"cost2_mean": -20.480145653867275, "system_level_velocity_max": 16.228565977198706, "cost2_max": -15.01931095813654, "outflow_rate_max": 1022.7542366537209, "system_level_velocity_mean": 13.02008631490787, "cost1_mean": 346.81740254266055, "cost2_min": -25.81781611099533, "outflow_rate_min": 832.5712314315076, "cost1_max": 427.27349021061247, "outflow_rate_mean": 930.0792012205113, "cost1_min": 271.8862006489103, "system_level_velocity_min": 10.164098996622315}, "episodes_total": 2348, "timesteps_this_iter": 109976, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 42, "timesteps_total": 4789827, "date": "2019-04-28_10-36-33", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4789827, "load_time_ms": 13.412, "grad_time_ms": 24211.493, "default": {"total_loss": 32.079952239990234, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.131831407546997, "vf_loss": 32.08055877685547, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7171415090560913, "kl": 0.007917341776192188, "policy_loss": -0.0010036176536232233}, "num_steps_trained": 4789827, "update_time_ms": 11.776, "sample_time_ms": 15413.622}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c128>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cfd0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 61, "time_total_s": 1734.4305505752563, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447793, "episode_reward_mean": 875.2569757097518}
{"training_iteration": 43, "time_since_restore": 1773.6779012680054, "episode_reward_max": 964.4793025140583, "policy_reward_mean": {}, "timesteps_since_restore": 4900261, "episode_len_mean": 700.0, "episode_reward_min": 773.6281007892588, "hostname": "flow-main", "time_this_iter_s": 39.24735069274902, "custom_metrics": {"cost2_mean": -20.540892586751394, "system_level_velocity_max": 15.94529102806903, "cost2_max": -17.34910363216163, "outflow_rate_max": 1024.415471735446, "system_level_velocity_mean": 13.08757867596375, "cost1_mean": 348.758481729343, "cost2_min": -24.721781921884563, "outflow_rate_min": 823.7114669481145, "cost1_max": 421.1148372292248, "outflow_rate_mean": 934.3407704279482, "cost1_min": 271.3631098024324, "system_level_velocity_min": 10.164098996622315}, "episodes_total": 2408, "timesteps_this_iter": 110434, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 43, "timesteps_total": 4900261, "date": "2019-04-28_10-37-12", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4900261, "load_time_ms": 13.228, "grad_time_ms": 24211.142, "default": {"total_loss": 30.64054298400879, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1251729726791382, "vf_loss": 30.642074584960938, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7417044639587402, "kl": 0.009548386558890343, "policy_loss": -0.002009105170145631}, "num_steps_trained": 4900261, "update_time_ms": 11.896, "sample_time_ms": 15409.807}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148c88>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148be0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 1773.6779012680054, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447832, "episode_reward_mean": 875.372071639172}
{"training_iteration": 44, "time_since_restore": 1812.3546669483185, "episode_reward_max": 964.4793025140583, "policy_reward_mean": {}, "timesteps_since_restore": 5011821, "episode_len_mean": 700.0, "episode_reward_min": 769.8162298635176, "hostname": "flow-main", "time_this_iter_s": 38.67676568031311, "custom_metrics": {"cost2_mean": -20.85830686714457, "system_level_velocity_max": 15.94529102806903, "cost2_max": -17.94454311132728, "outflow_rate_max": 1027.9530523858937, "system_level_velocity_mean": 13.093296822512555, "cost1_mean": 349.0171008191856, "cost2_min": -25.17189653416937, "outflow_rate_min": 813.5522966169169, "cost1_max": 421.1148372292248, "outflow_rate_mean": 936.2228029864647, "cost1_min": 264.577715143035, "system_level_velocity_min": 9.861047907471656}, "episodes_total": 2466, "timesteps_this_iter": 111560, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 44, "timesteps_total": 5011821, "date": "2019-04-28_10-37-51", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5011821, "load_time_ms": 13.372, "grad_time_ms": 24175.057, "default": {"total_loss": 28.445449829101562, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.1123980283737183, "vf_loss": 28.446510314941406, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.766542375087738, "kl": 0.009313171729445457, "policy_loss": -0.0015265439869835973}, "num_steps_trained": 5011821, "update_time_ms": 11.946, "sample_time_ms": 15395.161}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cd30>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cba8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 58, "time_total_s": 1812.3546669483185, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447871, "episode_reward_mean": 874.5749006130366}
{"training_iteration": 45, "time_since_restore": 1852.9213757514954, "episode_reward_max": 964.2519328477657, "policy_reward_mean": {}, "timesteps_since_restore": 5124496, "episode_len_mean": 700.0, "episode_reward_min": 769.8162298635176, "hostname": "flow-main", "time_this_iter_s": 40.56670880317688, "custom_metrics": {"cost2_mean": -21.465833673188108, "system_level_velocity_max": 15.846362052313058, "cost2_max": -17.712769552212837, "outflow_rate_max": 1027.9530523858937, "system_level_velocity_mean": 12.90285647767326, "cost1_mean": 344.01809640101266, "cost2_min": -26.248557337106767, "outflow_rate_min": 813.5522966169169, "cost1_max": 420.8814112111345, "outflow_rate_mean": 933.3519026067469, "cost1_min": 249.6885450821601, "system_level_velocity_min": 9.429750175495382}, "episodes_total": 2525, "timesteps_this_iter": 112675, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 45, "timesteps_total": 5124496, "date": "2019-04-28_10-38-32", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5124496, "load_time_ms": 13.63, "grad_time_ms": 24270.643, "default": {"total_loss": 30.124948501586914, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.0972707271575928, "vf_loss": 30.126073837280273, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7719582915306091, "kl": 0.008615043945610523, "policy_loss": -0.0015548932133242488}, "num_steps_trained": 5124496, "update_time_ms": 11.873, "sample_time_ms": 15370.037}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c860>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e912ca90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9123e10>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 1852.9213757514954, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447912, "episode_reward_mean": 873.4377312941427}
{"training_iteration": 46, "time_since_restore": 1893.287959575653, "episode_reward_max": 964.2519328477657, "policy_reward_mean": {}, "timesteps_since_restore": 5236679, "episode_len_mean": 700.0, "episode_reward_min": 778.1766245333217, "hostname": "flow-main", "time_this_iter_s": 40.366583824157715, "custom_metrics": {"cost2_mean": -21.93004055741013, "system_level_velocity_max": 15.926589770143188, "cost2_max": -17.712769552212837, "outflow_rate_max": 1021.3003572793818, "system_level_velocity_mean": 12.879563261588325, "cost1_mean": 343.24634510635866, "cost2_min": -29.26362549876042, "outflow_rate_min": 815.0603976786344, "cost1_max": 423.7590322576719, "outflow_rate_mean": 932.9297330812899, "cost1_min": 249.6885450821601, "system_level_velocity_min": 9.429750175495382}, "episodes_total": 2583, "timesteps_this_iter": 112183, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 46, "timesteps_total": 5236679, "date": "2019-04-28_10-39-12", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5236679, "load_time_ms": 13.67, "grad_time_ms": 24327.467, "default": {"total_loss": 30.35303497314453, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.0980172157287598, "vf_loss": 30.35451889038086, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7738966345787048, "kl": 0.009434488601982594, "policy_loss": -0.0019583709072321653}, "num_steps_trained": 5236679, "update_time_ms": 12.148, "sample_time_ms": 15386.811}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cc18>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cfd0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 58, "time_total_s": 1893.287959575653, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447952, "episode_reward_mean": 873.1776095324224}
{"training_iteration": 47, "time_since_restore": 1934.342452764511, "episode_reward_max": 963.6058418697246, "policy_reward_mean": {}, "timesteps_since_restore": 5347924, "episode_len_mean": 700.0, "episode_reward_min": 774.0509315344768, "hostname": "flow-main", "time_this_iter_s": 41.05449318885803, "custom_metrics": {"cost2_mean": -22.799122017216565, "system_level_velocity_max": 16.075764212129503, "cost2_max": -19.07686812376728, "outflow_rate_max": 1044.737105863964, "system_level_velocity_mean": 12.926130419411365, "cost1_mean": 343.32295381453486, "cost2_min": -29.26362549876042, "outflow_rate_min": 834.244191054004, "cost1_max": 425.79066424403214, "outflow_rate_mean": 930.758116244227, "cost1_min": 259.97331119005673, "system_level_velocity_min": 9.834577400957182}, "episodes_total": 2644, "timesteps_this_iter": 111245, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 47, "timesteps_total": 5347924, "date": "2019-04-28_10-39-53", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5347924, "load_time_ms": 13.88, "grad_time_ms": 24385.545, "default": {"total_loss": 34.13686752319336, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.0972154140472412, "vf_loss": 34.13846206665039, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7518772482872009, "kl": 0.009744323790073395, "policy_loss": -0.002083376282826066}, "num_steps_trained": 5347924, "update_time_ms": 11.936, "sample_time_ms": 15394.475}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cc50>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c438>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 61, "time_total_s": 1934.342452764511, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556447993, "episode_reward_mean": 866.9617598680895}
{"training_iteration": 48, "time_since_restore": 1975.0575289726257, "episode_reward_max": 941.4271695431632, "policy_reward_mean": {}, "timesteps_since_restore": 5459420, "episode_len_mean": 700.0, "episode_reward_min": 764.9260044700385, "hostname": "flow-main", "time_this_iter_s": 40.715076208114624, "custom_metrics": {"cost2_mean": -23.74339483664477, "system_level_velocity_max": 15.966231651760413, "cost2_max": -19.07686812376728, "outflow_rate_max": 1034.526920027412, "system_level_velocity_mean": 13.13485451324964, "cost1_mean": 347.81106940910473, "cost2_min": -35.62736542783072, "outflow_rate_min": 824.592587743293, "cost1_max": 420.5081412672678, "outflow_rate_mean": 933.4991924258107, "cost1_min": 266.39765815875535, "system_level_velocity_min": 9.9883674409654}, "episodes_total": 2703, "timesteps_this_iter": 111496, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 48, "timesteps_total": 5459420, "date": "2019-04-28_10-40-34", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5459420, "load_time_ms": 13.775, "grad_time_ms": 24398.38, "default": {"total_loss": 35.2062873840332, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.0937011241912842, "vf_loss": 35.20770263671875, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7487845420837402, "kl": 0.00872297864407301, "policy_loss": -0.0018532754620537162}, "num_steps_trained": 5459420, "update_time_ms": 11.936, "sample_time_ms": 15437.167}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cf98>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ce48>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 1975.0575289726257, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556448034, "episode_reward_mean": 864.0282210946561}
{"training_iteration": 49, "time_since_restore": 2014.8166975975037, "episode_reward_max": 965.6617182681982, "policy_reward_mean": {}, "timesteps_since_restore": 5572044, "episode_len_mean": 700.0, "episode_reward_min": 741.1030399632333, "hostname": "flow-main", "time_this_iter_s": 39.75916862487793, "custom_metrics": {"cost2_mean": -26.230788998956303, "system_level_velocity_max": 16.111437413813483, "cost2_max": -20.155786901275242, "outflow_rate_max": 1038.7806619458063, "system_level_velocity_mean": 13.23325905999701, "cost1_mean": 350.02365426169933, "cost2_min": -39.20848750077118, "outflow_rate_min": 824.592587743293, "cost1_max": 422.8291250239842, "outflow_rate_mean": 939.6788728104482, "cost1_min": 263.4361164971218, "system_level_velocity_min": 9.810197539581003}, "episodes_total": 2759, "timesteps_this_iter": 112624, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 49, "timesteps_total": 5572044, "date": "2019-04-28_10-41-14", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5572044, "load_time_ms": 13.819, "grad_time_ms": 24309.528, "default": {"total_loss": 34.5056266784668, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.0897964239120483, "vf_loss": 34.5070915222168, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7723042964935303, "kl": 0.010021400637924671, "policy_loss": -0.00196563801728189}, "num_steps_trained": 5572044, "update_time_ms": 12.048, "sample_time_ms": 15399.312}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c240>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c940>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 2014.8166975975037, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556448074, "episode_reward_mean": 859.7139755572757}
{"training_iteration": 50, "time_since_restore": 2054.17094540596, "episode_reward_max": 946.0484894487281, "policy_reward_mean": {}, "timesteps_since_restore": 5684020, "episode_len_mean": 700.0, "episode_reward_min": 741.1030399632333, "hostname": "flow-main", "time_this_iter_s": 39.35424780845642, "custom_metrics": {"cost2_mean": -27.823603963310152, "system_level_velocity_max": 16.380284569013448, "cost2_max": -19.693185666558563, "outflow_rate_max": 1060.917600445504, "system_level_velocity_mean": 12.894408121170839, "cost1_mean": 340.80476852533116, "cost2_min": -39.20848750077118, "outflow_rate_min": 829.2184091043061, "cost1_max": 426.8096672375854, "outflow_rate_mean": 931.9239619992208, "cost1_min": 260.7196882087844, "system_level_velocity_min": 9.810197539581003}, "episodes_total": 2816, "timesteps_this_iter": 111976, "experiment_id": "d065b473cb8f41e9a502f24005e9dcf5", "iterations_since_restore": 50, "timesteps_total": 5684020, "date": "2019-04-28_10-41-53", "num_metric_batches_dropped": 0, "done": true, "info": {"num_steps_sampled": 5684020, "load_time_ms": 13.89, "grad_time_ms": 24248.817, "default": {"total_loss": 33.96672058105469, "cur_kl_coeff": 0.05000000447034836, "entropy": 1.0849119424819946, "vf_loss": 33.96816635131836, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7882063984870911, "kl": 0.008546197786927223, "policy_loss": -0.0018744848202914}, "num_steps_trained": 5684020, "update_time_ms": 11.746, "sample_time_ms": 15350.219}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cda0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914c908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914cef0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "use_gae": true, "collect_metrics_timeout": 180, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "use_lstm": false, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.2, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "lr_schedule": null, "monitor": false, "custom_resources_per_worker": {}, "optimizer": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 57, "time_total_s": 2054.17094540596, "pid": 32321, "node_ip": "10.138.0.2", "timestamp": 1556448113, "episode_reward_mean": 851.3253243296073}

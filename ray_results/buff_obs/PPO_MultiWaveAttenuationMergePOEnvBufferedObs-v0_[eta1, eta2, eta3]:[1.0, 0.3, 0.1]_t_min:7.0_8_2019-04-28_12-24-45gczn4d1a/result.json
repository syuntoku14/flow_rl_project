{"training_iteration": 1, "time_since_restore": 71.29200220108032, "episode_reward_max": 420.73384043112503, "policy_reward_mean": {}, "timesteps_since_restore": 115763, "episode_len_mean": 700.0, "episode_reward_min": 207.014447605457, "hostname": "flow-main", "time_this_iter_s": 71.29200220108032, "custom_metrics": {"cost2_mean": -38.44889875181475, "system_level_velocity_max": 9.596135531618382, "cost2_max": -25.33405161056644, "outflow_rate_max": 718.1947023886028, "cost2_min": -53.91259421807241, "cost1_mean": 198.10850344381194, "system_level_velocity_mean": 7.659331395351269, "outflow_rate_min": 545.6770728655079, "cost1_max": 248.611542003873, "outflow_rate_mean": 609.2960839483164, "cost1_min": 138.84118771074037, "system_level_velocity_min": 5.147502143106484}, "episodes_total": 39, "timesteps_this_iter": 115763, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 1, "timesteps_total": 115763, "date": "2019-04-28_12-26-15", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 115763, "load_time_ms": 85.995, "grad_time_ms": 26529.145, "update_time_ms": 2394.102, "num_steps_trained": 115763, "default": {"total_loss": 1.3684937953948975, "cur_kl_coeff": 0.20000001788139343, "entropy": 1.4148613214492798, "vf_loss": 1.368939995765686, "kl": 0.0019152411259710789, "vf_explained_var": 0.8829100728034973, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008290742407552898}, "sample_time_ms": 42019.264}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148e48>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9148a58>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 39, "time_total_s": 71.29200220108032, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454375, "episode_reward_mean": 305.25316745231476}
{"training_iteration": 2, "time_since_restore": 113.12613415718079, "episode_reward_max": 540.809764861231, "policy_reward_mean": {}, "timesteps_since_restore": 233451, "episode_len_mean": 700.0, "episode_reward_min": 200.99666221897627, "hostname": "flow-main", "time_this_iter_s": 41.834131956100464, "custom_metrics": {"cost2_mean": -39.007303497654256, "system_level_velocity_max": 10.444265003251498, "cost2_max": -23.06873934336986, "outflow_rate_max": 827.0908879631844, "cost2_min": -63.37265867505378, "cost1_mean": 202.16339681628222, "system_level_velocity_mean": 7.806167763973712, "outflow_rate_min": 402.6076960710563, "cost1_max": 274.6777761218173, "outflow_rate_mean": 613.7702345863385, "cost1_min": 138.84118771074037, "system_level_velocity_min": 5.147502143106484}, "episodes_total": 99, "timesteps_this_iter": 117688, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 2, "timesteps_total": 233451, "date": "2019-04-28_12-26-57", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 233451, "load_time_ms": 54.617, "grad_time_ms": 26297.164, "update_time_ms": 1202.907, "num_steps_trained": 233451, "default": {"total_loss": 1.2158896923065186, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.4082390069961548, "vf_loss": 1.218993902206421, "kl": 0.00890031922608614, "vf_explained_var": 0.8782773017883301, "cur_lr": 0.0005000000237487257, "policy_loss": -0.003994205500930548}, "sample_time_ms": 28761.937}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ebe0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e748>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 113.12613415718079, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454417, "episode_reward_mean": 329.20599961204636}
{"training_iteration": 3, "time_since_restore": 149.71974992752075, "episode_reward_max": 609.5303128196517, "policy_reward_mean": {}, "timesteps_since_restore": 342801, "episode_len_mean": 700.0, "episode_reward_min": 200.99666221897627, "hostname": "flow-main", "time_this_iter_s": 36.593615770339966, "custom_metrics": {"cost2_mean": -35.88772630518365, "system_level_velocity_max": 10.804310449670231, "cost2_max": -23.06873934336986, "outflow_rate_max": 832.8918915322253, "cost2_min": -63.37265867505378, "cost1_mean": 224.09054535615266, "system_level_velocity_mean": 8.634693719202625, "outflow_rate_min": 402.6076960710563, "cost1_max": 283.469649155855, "outflow_rate_mean": 668.4173307103893, "cost1_min": 153.41609394280644, "system_level_velocity_min": 5.9839625030411305}, "episodes_total": 153, "timesteps_this_iter": 109350, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 3, "timesteps_total": 342801, "date": "2019-04-28_12-27-34", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 342801, "load_time_ms": 43.859, "grad_time_ms": 24979.964, "update_time_ms": 805.692, "num_steps_trained": 342801, "default": {"total_loss": 3.7336199283599854, "cur_kl_coeff": 0.10000000894069672, "entropy": 1.3884698152542114, "vf_loss": 3.7383055686950684, "kl": 0.010850859805941582, "vf_explained_var": 0.8639504313468933, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005770576186478138}, "sample_time_ms": 23846.769}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6550>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 54, "time_total_s": 149.71974992752075, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454454, "episode_reward_mean": 408.3299191184587}
{"training_iteration": 4, "time_since_restore": 189.18284797668457, "episode_reward_max": 839.5052670503691, "policy_reward_mean": {}, "timesteps_since_restore": 458117, "episode_len_mean": 700.0, "episode_reward_min": 303.12395532351707, "hostname": "flow-main", "time_this_iter_s": 39.46309804916382, "custom_metrics": {"cost2_mean": -37.4604543025486, "system_level_velocity_max": 12.760636732172124, "cost2_max": -25.50131127447616, "outflow_rate_max": 970.9164747063403, "cost2_min": -52.97252142002361, "cost1_mean": 263.1050029205486, "system_level_velocity_mean": 10.038000235650811, "outflow_rate_min": 568.3327744587774, "cost1_max": 337.99754065253717, "outflow_rate_mean": 775.1930987898784, "cost1_min": 187.65712398880308, "system_level_velocity_min": 7.226386111725467}, "episodes_total": 210, "timesteps_this_iter": 115316, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 4, "timesteps_total": 458117, "date": "2019-04-28_12-28-13", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 458117, "load_time_ms": 36.517, "grad_time_ms": 24654.51, "update_time_ms": 606.593, "num_steps_trained": 458117, "default": {"total_loss": 7.670046329498291, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.3823201656341553, "vf_loss": 7.672415733337402, "kl": 0.00715795299038291, "vf_explained_var": 0.7575172185897827, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0030856942757964134}, "sample_time_ms": 21773.322}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e5f8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915eeb8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 57, "time_total_s": 189.18284797668457, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454493, "episode_reward_mean": 589.5071916098254}
{"training_iteration": 5, "time_since_restore": 232.17346334457397, "episode_reward_max": 839.5052670503691, "policy_reward_mean": {}, "timesteps_since_restore": 576606, "episode_len_mean": 693.35, "episode_reward_min": 41.90240259302989, "hostname": "flow-main", "time_this_iter_s": 42.990615367889404, "custom_metrics": {"cost2_mean": -39.692106187827434, "system_level_velocity_max": 17.63419175582717, "cost2_max": -14.994660111272891, "outflow_rate_max": 970.9164747063403, "cost2_min": -52.97252142002361, "cost1_mean": 280.77447526077145, "system_level_velocity_mean": 10.8046930830844, "outflow_rate_min": 486.0278995954896, "cost1_max": 343.80992171927636, "outflow_rate_mean": 833.8080437890934, "cost1_min": 21.875158259345298, "system_level_velocity_min": 8.291613343320796}, "episodes_total": 253, "timesteps_this_iter": 118489, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 5, "timesteps_total": 576606, "date": "2019-04-28_12-28-56", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 576606, "load_time_ms": 34.351, "grad_time_ms": 25209.932, "update_time_ms": 487.394, "num_steps_trained": 576606, "default": {"total_loss": 7.3713483810424805, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.3713948726654053, "vf_loss": 7.372463226318359, "kl": 0.0062850904650986195, "vf_explained_var": 0.7955902814865112, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0017434757901355624}, "sample_time_ms": 20476.553}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6fd0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6470>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 43, "time_total_s": 232.17346334457397, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454536, "episode_reward_mean": 702.5725075638486}
{"training_iteration": 6, "time_since_restore": 272.9724359512329, "episode_reward_max": 828.5536011291138, "policy_reward_mean": {}, "timesteps_since_restore": 696386, "episode_len_mean": 693.35, "episode_reward_min": 41.90240259302989, "hostname": "flow-main", "time_this_iter_s": 40.798972606658936, "custom_metrics": {"cost2_mean": -39.04208675251765, "system_level_velocity_max": 17.63419175582717, "cost2_max": -14.994660111272891, "outflow_rate_max": 954.1316184172923, "cost2_min": -49.52596462887513, "cost1_mean": 275.37674323217436, "system_level_velocity_mean": 10.565600466884746, "outflow_rate_min": 486.0278995954896, "cost1_max": 343.80992171927636, "outflow_rate_mean": 836.7175986750434, "cost1_min": 21.875158259345298, "system_level_velocity_min": 7.615145360344912}, "episodes_total": 307, "timesteps_this_iter": 119780, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 6, "timesteps_total": 696386, "date": "2019-04-28_12-29-37", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 696386, "load_time_ms": 32.421, "grad_time_ms": 25252.43, "update_time_ms": 408.078, "num_steps_trained": 696386, "default": {"total_loss": 8.663496971130371, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.3606106042861938, "vf_loss": 8.663898468017578, "kl": 0.004180135205388069, "vf_explained_var": 0.8089914321899414, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008197721908800304}, "sample_time_ms": 19576.357}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e518>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e65f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6e10>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 54, "time_total_s": 272.9724359512329, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454577, "episode_reward_mean": 728.0148077741605}
{"training_iteration": 7, "time_since_restore": 315.11287212371826, "episode_reward_max": 847.0391524843182, "policy_reward_mean": {}, "timesteps_since_restore": 817259, "episode_len_mean": 700.0, "episode_reward_min": 427.8962806555618, "hostname": "flow-main", "time_this_iter_s": 42.14043617248535, "custom_metrics": {"cost2_mean": -38.79778173316714, "system_level_velocity_max": 12.911815117446908, "cost2_max": -33.532534904885594, "outflow_rate_max": 972.2459968061033, "cost2_min": -49.52596462887513, "cost1_mean": 272.2482920806461, "system_level_velocity_mean": 10.265246517385144, "outflow_rate_min": 334.80215500031204, "cost1_max": 338.80937814733477, "outflow_rate_mean": 831.8124290700547, "cost1_min": 95.10749774596874, "system_level_velocity_min": 3.6413158324909487}, "episodes_total": 356, "timesteps_this_iter": 120873, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 7, "timesteps_total": 817259, "date": "2019-04-28_12-30-19", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 817259, "load_time_ms": 31.298, "grad_time_ms": 25473.93, "update_time_ms": 351.123, "num_steps_trained": 817259, "default": {"total_loss": 9.036079406738281, "cur_kl_coeff": 0.05000000819563866, "entropy": 1.3476779460906982, "vf_loss": 9.0365629196167, "kl": 0.004869111347943544, "vf_explained_var": 0.8435613512992859, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0007277132826857269}, "sample_time_ms": 18932.276}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914ae10>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e914a2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6ac8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 49, "time_total_s": 315.11287212371826, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454619, "episode_reward_mean": 737.8154018692259}
{"training_iteration": 8, "time_since_restore": 355.9270615577698, "episode_reward_max": 870.6148564858591, "policy_reward_mean": {}, "timesteps_since_restore": 933781, "episode_len_mean": 700.0, "episode_reward_min": 427.8962806555618, "hostname": "flow-main", "time_this_iter_s": 40.814189434051514, "custom_metrics": {"cost2_mean": -37.8731100997477, "system_level_velocity_max": 13.673741500404342, "cost2_max": -31.823581606607473, "outflow_rate_max": 1002.7185698654663, "cost2_min": -46.23787532490681, "cost1_mean": 277.78182009334586, "system_level_velocity_mean": 10.45718346981836, "outflow_rate_min": 334.80215500031204, "cost1_max": 357.4818087931103, "outflow_rate_mean": 852.9022922892691, "cost1_min": 95.10749774596874, "system_level_velocity_min": 3.6413158324909487}, "episodes_total": 407, "timesteps_this_iter": 116522, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 8, "timesteps_total": 933781, "date": "2019-04-28_12-31-00", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 933781, "load_time_ms": 30.558, "grad_time_ms": 25456.873, "update_time_ms": 308.527, "num_steps_trained": 933781, "default": {"total_loss": 9.875649452209473, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.3382476568222046, "vf_loss": 9.876460075378418, "kl": 0.0064685894176363945, "vf_explained_var": 0.8538768291473389, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0009727643919177353}, "sample_time_ms": 18469.286}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6c88>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6978>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 51, "time_total_s": 355.9270615577698, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454660, "episode_reward_mean": 760.8483019103094}
{"training_iteration": 9, "time_since_restore": 397.26237511634827, "episode_reward_max": 891.9774255810293, "policy_reward_mean": {}, "timesteps_since_restore": 1050606, "episode_len_mean": 700.0, "episode_reward_min": 565.6013962141268, "hostname": "flow-main", "time_this_iter_s": 41.33531355857849, "custom_metrics": {"cost2_mean": -35.93836937623148, "system_level_velocity_max": 14.117928213797127, "cost2_max": -30.663406344376924, "outflow_rate_max": 1024.583019260878, "cost2_min": -43.9181293747123, "cost1_mean": 294.9774491034209, "system_level_velocity_mean": 11.10862366517833, "outflow_rate_min": 481.8115099500663, "cost1_max": 370.43315354463266, "outflow_rate_mean": 898.1822948314021, "cost1_min": 126.90404307407826, "system_level_velocity_min": 4.761936946234134}, "episodes_total": 463, "timesteps_this_iter": 116825, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 9, "timesteps_total": 1050606, "date": "2019-04-28_12-31-41", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1050606, "load_time_ms": 29.835, "grad_time_ms": 25452.219, "update_time_ms": 275.638, "num_steps_trained": 1050606, "default": {"total_loss": 11.255701065063477, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.32656729221344, "vf_loss": 11.256133079528809, "kl": 0.006013376638293266, "vf_explained_var": 0.80389004945755, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0005822962266393006}, "sample_time_ms": 18156.397}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e62b0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6748>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 397.26237511634827, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454701, "episode_reward_mean": 800.4434876461985}
{"training_iteration": 10, "time_since_restore": 437.65447783470154, "episode_reward_max": 919.0279473032871, "policy_reward_mean": {}, "timesteps_since_restore": 1166122, "episode_len_mean": 700.0, "episode_reward_min": 680.3668544657045, "hostname": "flow-main", "time_this_iter_s": 40.39210271835327, "custom_metrics": {"cost2_mean": -33.70063433222312, "system_level_velocity_max": 14.612974532004214, "cost2_max": -28.26503585226814, "outflow_rate_max": 1051.4954144420542, "cost2_min": -39.7951229290415, "cost1_mean": 298.88077329446395, "system_level_velocity_mean": 11.228207131090993, "outflow_rate_min": 770.0172826883306, "cost1_max": 383.00790850262376, "outflow_rate_mean": 914.0059985382618, "cost1_min": 230.57101796571874, "system_level_velocity_min": 8.562599182937827}, "episodes_total": 516, "timesteps_this_iter": 115516, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 10, "timesteps_total": 1166122, "date": "2019-04-28_12-32-22", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1166122, "load_time_ms": 28.419, "grad_time_ms": 25419.506, "update_time_ms": 249.189, "num_steps_trained": 1166122, "default": {"total_loss": 11.304654121398926, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.3130624294281006, "vf_loss": 11.3048095703125, "kl": 0.006459285970777273, "vf_explained_var": 0.7969580292701721, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0003172526485286653}, "sample_time_ms": 17842.314}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6cc0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6be0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 53, "time_total_s": 437.65447783470154, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454742, "episode_reward_mean": 822.1953041492973}
{"training_iteration": 11, "time_since_restore": 477.5929160118103, "episode_reward_max": 937.9902304125209, "policy_reward_mean": {}, "timesteps_since_restore": 1282012, "episode_len_mean": 700.0, "episode_reward_min": 757.3119110055866, "hostname": "flow-main", "time_this_iter_s": 39.938438177108765, "custom_metrics": {"cost2_mean": -31.427484140569035, "system_level_velocity_max": 14.612974532004214, "cost2_max": -26.12888721431134, "outflow_rate_max": 1055.014411812156, "cost2_min": -37.29897977882748, "cost1_mean": 303.0144917911884, "system_level_velocity_mean": 11.35225426132328, "outflow_rate_min": 803.9821998659479, "cost1_max": 383.00790850262376, "outflow_rate_mean": 927.3690993333694, "cost1_min": 230.9480414125475, "system_level_velocity_min": 8.562599182937827}, "episodes_total": 575, "timesteps_this_iter": 115890, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 11, "timesteps_total": 1282012, "date": "2019-04-28_12-33-02", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1282012, "load_time_ms": 21.926, "grad_time_ms": 25138.641, "update_time_ms": 10.896, "num_steps_trained": 1282012, "default": {"total_loss": 12.31513786315918, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.3018088340759277, "vf_loss": 12.315068244934082, "kl": 0.006304359063506126, "vf_explained_var": 0.7878968119621277, "cur_lr": 0.0005000000237487257, "policy_loss": -8.781108044786379e-05}, "sample_time_ms": 15237.442}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6550>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6908>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 477.5929160118103, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454782, "episode_reward_mean": 842.0246362712219}
{"training_iteration": 12, "time_since_restore": 518.7869250774384, "episode_reward_max": 961.4873378598606, "policy_reward_mean": {}, "timesteps_since_restore": 1397234, "episode_len_mean": 700.0, "episode_reward_min": 762.3745919399903, "hostname": "flow-main", "time_this_iter_s": 41.19400906562805, "custom_metrics": {"cost2_mean": -30.526238226839734, "system_level_velocity_max": 14.922642818546768, "cost2_max": -26.12888721431134, "outflow_rate_max": 1068.993664405657, "cost2_min": -33.926001186568556, "cost1_mean": 309.9973569319272, "system_level_velocity_mean": 11.615126692230923, "outflow_rate_min": 810.5703575008082, "cost1_max": 392.81748349564873, "outflow_rate_mean": 942.3893704934903, "cost1_min": 237.04273046517486, "system_level_velocity_min": 8.773777419042233}, "episodes_total": 625, "timesteps_this_iter": 115222, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 12, "timesteps_total": 1397234, "date": "2019-04-28_12-33-43", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1397234, "load_time_ms": 22.165, "grad_time_ms": 25106.585, "update_time_ms": 10.893, "num_steps_trained": 1397234, "default": {"total_loss": 12.190245628356934, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.3060181140899658, "vf_loss": 12.190162658691406, "kl": 0.006895238067954779, "vf_explained_var": 0.8075820803642273, "cur_lr": 0.0005000000237487257, "policy_loss": -8.933305798564106e-05}, "sample_time_ms": 15205.716}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6a20>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e60b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6c88>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 50, "time_total_s": 518.7869250774384, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454823, "episode_reward_mean": 857.7475125622321}
{"training_iteration": 13, "time_since_restore": 561.0179936885834, "episode_reward_max": 961.4873378598606, "policy_reward_mean": {}, "timesteps_since_restore": 1513513, "episode_len_mean": 700.0, "episode_reward_min": 764.6898369067111, "hostname": "flow-main", "time_this_iter_s": 42.23106861114502, "custom_metrics": {"cost2_mean": -29.502151965023575, "system_level_velocity_max": 14.922642818546768, "cost2_max": -24.894064609753734, "outflow_rate_max": 1068.993664405657, "cost2_min": -32.96465715973753, "cost1_mean": 314.81465352378905, "system_level_velocity_mean": 11.801631181475308, "outflow_rate_min": 825.6819084382546, "cost1_max": 392.81748349564873, "outflow_rate_mean": 950.3027378650174, "cost1_min": 237.04273046517486, "system_level_velocity_min": 8.777726108499111}, "episodes_total": 684, "timesteps_this_iter": 116279, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 13, "timesteps_total": 1513513, "date": "2019-04-28_12-34-25", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1513513, "load_time_ms": 22.475, "grad_time_ms": 25462.047, "update_time_ms": 10.897, "num_steps_trained": 1513513, "default": {"total_loss": 14.016012191772461, "cur_kl_coeff": 0.025000005960464478, "entropy": 1.2908223867416382, "vf_loss": 14.016070365905762, "kl": 0.0061127073131501675, "vf_explained_var": 0.7758368253707886, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00021055340766906738}, "sample_time_ms": 15410.85}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6198>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e67b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e62b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 561.0179936885834, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454865, "episode_reward_mean": 861.7051635005034}
{"training_iteration": 14, "time_since_restore": 601.6597027778625, "episode_reward_max": 941.6740227726573, "policy_reward_mean": {}, "timesteps_since_restore": 1630879, "episode_len_mean": 700.0, "episode_reward_min": 757.1684343263504, "hostname": "flow-main", "time_this_iter_s": 40.641709089279175, "custom_metrics": {"cost2_mean": -28.72417844520982, "system_level_velocity_max": 14.445892930116612, "cost2_max": -23.97834729551527, "outflow_rate_max": 1045.7158194238687, "cost2_min": -31.173019840859258, "cost1_mean": 317.1382834829839, "system_level_velocity_mean": 11.888037618614696, "outflow_rate_min": 825.6819084382546, "cost1_max": 380.6395377510934, "outflow_rate_mean": 953.0734059558022, "cost1_min": 246.38290507897915, "system_level_velocity_min": 9.115103872381484}, "episodes_total": 731, "timesteps_this_iter": 117366, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 14, "timesteps_total": 1630879, "date": "2019-04-28_12-35-06", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1630879, "load_time_ms": 23.417, "grad_time_ms": 25591.199, "update_time_ms": 11.062, "num_steps_trained": 1630879, "default": {"total_loss": 11.891254425048828, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.2766300439834595, "vf_loss": 11.892264366149902, "kl": 0.008041730150580406, "vf_explained_var": 0.7968485951423645, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001211123657412827}, "sample_time_ms": 15396.291}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6f60>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6978>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 47, "time_total_s": 601.6597027778625, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454906, "episode_reward_mean": 863.1622507889685}
{"training_iteration": 15, "time_since_restore": 641.353718996048, "episode_reward_max": 941.6928941169391, "policy_reward_mean": {}, "timesteps_since_restore": 1748104, "episode_len_mean": 700.0, "episode_reward_min": 752.5027720566062, "hostname": "flow-main", "time_this_iter_s": 39.694016218185425, "custom_metrics": {"cost2_mean": -28.243279372281282, "system_level_velocity_max": 14.445892930116612, "cost2_max": -23.789212369192192, "outflow_rate_max": 1045.7158194238687, "cost2_min": -31.77193634015369, "cost1_mean": 306.65398458824376, "system_level_velocity_mean": 11.468179456684092, "outflow_rate_min": 813.6482045204705, "cost1_max": 380.6395377510934, "outflow_rate_mean": 935.2679167937125, "cost1_min": 242.72997795895603, "system_level_velocity_min": 8.968375598553601}, "episodes_total": 781, "timesteps_this_iter": 117225, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 15, "timesteps_total": 1748104, "date": "2019-04-28_12-35-46", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1748104, "load_time_ms": 22.995, "grad_time_ms": 25273.389, "update_time_ms": 11.138, "num_steps_trained": 1748104, "default": {"total_loss": 12.479941368103027, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.274261713027954, "vf_loss": 12.480778694152832, "kl": 0.007479793857783079, "vf_explained_var": 0.7891684770584106, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0010229131439700723}, "sample_time_ms": 15387.466}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6b70>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6748>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 50, "time_total_s": 641.353718996048, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454946, "episode_reward_mean": 854.8554905527765}
{"training_iteration": 16, "time_since_restore": 682.9979786872864, "episode_reward_max": 941.6928941169391, "policy_reward_mean": {}, "timesteps_since_restore": 1862539, "episode_len_mean": 700.0, "episode_reward_min": 752.5027720566062, "hostname": "flow-main", "time_this_iter_s": 41.6442596912384, "custom_metrics": {"cost2_mean": -27.15144804966384, "system_level_velocity_max": 13.828523316360847, "cost2_max": -23.554764720034036, "outflow_rate_max": 1035.639044301708, "cost2_min": -31.77193634015369, "cost1_mean": 298.93377345891554, "system_level_velocity_mean": 11.150772359546774, "outflow_rate_min": 813.6482045204705, "cost1_max": 369.1765470545772, "outflow_rate_mean": 920.4415138571075, "cost1_min": 240.56956019162445, "system_level_velocity_min": 8.86107816987664}, "episodes_total": 837, "timesteps_this_iter": 114435, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 16, "timesteps_total": 1862539, "date": "2019-04-28_12-36-27", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1862539, "load_time_ms": 23.126, "grad_time_ms": 25250.956, "update_time_ms": 10.961, "num_steps_trained": 1862539, "default": {"total_loss": 14.89964485168457, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.2573662996292114, "vf_loss": 14.899816513061523, "kl": 0.007012083660811186, "vf_explained_var": 0.7461323738098145, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00034670828608796}, "sample_time_ms": 15492.712}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6518>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6278>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 682.9979786872864, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556454987, "episode_reward_mean": 846.7868828907577}
{"training_iteration": 17, "time_since_restore": 724.1800186634064, "episode_reward_max": 947.8603644372222, "policy_reward_mean": {}, "timesteps_since_restore": 1977038, "episode_len_mean": 700.0, "episode_reward_min": 757.140697679727, "hostname": "flow-main", "time_this_iter_s": 41.182039976119995, "custom_metrics": {"cost2_mean": -25.473698214841928, "system_level_velocity_max": 14.197851889766563, "cost2_max": -21.64764887732956, "outflow_rate_max": 1040.9978330981423, "cost2_min": -29.53577405996092, "cost1_mean": 303.42733549367546, "system_level_velocity_mean": 11.327208681959748, "outflow_rate_min": 818.8319531825031, "cost1_max": 378.68872853204186, "outflow_rate_mean": 918.6920123594517, "cost1_min": 240.56956019162445, "system_level_velocity_min": 8.86107816987664}, "episodes_total": 893, "timesteps_this_iter": 114499, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 17, "timesteps_total": 1977038, "date": "2019-04-28_12-37-09", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 1977038, "load_time_ms": 22.261, "grad_time_ms": 25092.817, "update_time_ms": 11.58, "num_steps_trained": 1977038, "default": {"total_loss": 15.518579483032227, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.2532198429107666, "vf_loss": 15.518929481506348, "kl": 0.007727351039648056, "vf_explained_var": 0.6903560757637024, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0005421158275566995}, "sample_time_ms": 15555.285}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6470>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6828>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 724.1800186634064, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455029, "episode_reward_mean": 846.9219037537966}
{"training_iteration": 18, "time_since_restore": 765.26580119133, "episode_reward_max": 929.884799028983, "policy_reward_mean": {}, "timesteps_since_restore": 2090944, "episode_len_mean": 700.0, "episode_reward_min": 755.3712729967906, "hostname": "flow-main", "time_this_iter_s": 41.085782527923584, "custom_metrics": {"cost2_mean": -23.67136515425532, "system_level_velocity_max": 13.969019361081406, "cost2_max": -19.51254095629946, "outflow_rate_max": 1035.8007527257757, "cost2_min": -27.067127409191084, "cost1_mean": 299.2764012860277, "system_level_velocity_mean": 11.164925331785762, "outflow_rate_min": 818.8319531825031, "cost1_max": 371.9969764633302, "outflow_rate_mean": 903.2475447602496, "cost1_min": 252.70240425044804, "system_level_velocity_min": 9.428338612676901}, "episodes_total": 953, "timesteps_this_iter": 113906, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 18, "timesteps_total": 2090944, "date": "2019-04-28_12-37-50", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2090944, "load_time_ms": 22.043, "grad_time_ms": 25067.833, "update_time_ms": 11.955, "num_steps_trained": 2090944, "default": {"total_loss": 17.095727920532227, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.2401130199432373, "vf_loss": 17.09693717956543, "kl": 0.00798114389181137, "vf_explained_var": 0.6603984832763672, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0014102309942245483}, "sample_time_ms": 15606.259}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6be0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e67f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6cc0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 765.26580119133, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455070, "episode_reward_mean": 837.4378224444395}
{"training_iteration": 19, "time_since_restore": 805.6490342617035, "episode_reward_max": 956.3125235110417, "policy_reward_mean": {}, "timesteps_since_restore": 2203846, "episode_len_mean": 700.0, "episode_reward_min": 755.3712729967906, "hostname": "flow-main", "time_this_iter_s": 40.383233070373535, "custom_metrics": {"cost2_mean": -22.485343001591026, "system_level_velocity_max": 14.53074066976462, "cost2_max": -17.00040820883448, "outflow_rate_max": 1036.9670488141307, "cost2_min": -26.08173679628547, "cost1_mean": 299.53438302825015, "system_level_velocity_mean": 11.15978571907114, "outflow_rate_min": 819.0075928663729, "cost1_max": 387.77007531766003, "outflow_rate_mean": 900.7208373213292, "cost1_min": 248.84300789326352, "system_level_velocity_min": 9.18608776580069}, "episodes_total": 1005, "timesteps_this_iter": 112902, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 19, "timesteps_total": 2203846, "date": "2019-04-28_12-38-30", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2203846, "load_time_ms": 21.837, "grad_time_ms": 25024.989, "update_time_ms": 11.659, "num_steps_trained": 2203846, "default": {"total_loss": 16.545154571533203, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.2328832149505615, "vf_loss": 16.545429229736328, "kl": 0.007439622189849615, "vf_explained_var": 0.6794735789299011, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00046043048496358097}, "sample_time_ms": 15555.277}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6320>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e61d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e68d0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 52, "time_total_s": 805.6490342617035, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455110, "episode_reward_mean": 840.3079619501401}
{"training_iteration": 20, "time_since_restore": 849.0477316379547, "episode_reward_max": 956.3125235110417, "policy_reward_mean": {}, "timesteps_since_restore": 2317704, "episode_len_mean": 700.0, "episode_reward_min": 760.3890667663434, "hostname": "flow-main", "time_this_iter_s": 43.39869737625122, "custom_metrics": {"cost2_mean": -21.65803938551248, "system_level_velocity_max": 14.53074066976462, "cost2_max": -17.00040820883448, "outflow_rate_max": 1036.9670488141307, "cost2_min": -26.08173679628547, "cost1_mean": 310.9726167711899, "system_level_velocity_mean": 11.599150257356525, "outflow_rate_min": 819.0075928663729, "cost1_max": 387.77007531766003, "outflow_rate_mean": 916.7217132982194, "cost1_min": 248.84300789326352, "system_level_velocity_min": 9.18608776580069}, "episodes_total": 1066, "timesteps_this_iter": 113858, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 20, "timesteps_total": 2317704, "date": "2019-04-28_12-39-14", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2317704, "load_time_ms": 22.68, "grad_time_ms": 25232.124, "update_time_ms": 11.727, "num_steps_trained": 2317704, "default": {"total_loss": 18.62018394470215, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.2325646877288818, "vf_loss": 18.620988845825195, "kl": 0.008602016605436802, "vf_explained_var": 0.6626189351081848, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0010215655202046037}, "sample_time_ms": 15647.233}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6080>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6d68>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 61, "time_total_s": 849.0477316379547, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455154, "episode_reward_mean": 852.2937977641545}
{"training_iteration": 21, "time_since_restore": 887.216694355011, "episode_reward_max": 953.9817280040477, "policy_reward_mean": {}, "timesteps_since_restore": 2431677, "episode_len_mean": 700.0, "episode_reward_min": 761.0419627699322, "hostname": "flow-main", "time_this_iter_s": 38.168962717056274, "custom_metrics": {"cost2_mean": -20.76698934489567, "system_level_velocity_max": 14.74257503795528, "cost2_max": -17.740347359355574, "outflow_rate_max": 1035.2972002851234, "cost2_min": -24.74728874840105, "cost1_mean": 316.65914397450723, "system_level_velocity_mean": 11.818826791315601, "outflow_rate_min": 817.8648355566714, "cost1_max": 392.5428777906528, "outflow_rate_mean": 922.3222648851668, "cost1_min": 247.4820966806323, "system_level_velocity_min": 9.198699968857865}, "episodes_total": 1119, "timesteps_this_iter": 113973, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 21, "timesteps_total": 2431677, "date": "2019-04-28_12-39-52", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2431677, "load_time_ms": 21.937, "grad_time_ms": 25144.018, "update_time_ms": 11.686, "num_steps_trained": 2431677, "default": {"total_loss": 16.829694747924805, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.2148544788360596, "vf_loss": 16.830419540405273, "kl": 0.009350459091365337, "vf_explained_var": 0.7114865183830261, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0009598404285497963}, "sample_time_ms": 15559.9}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6b00>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e68d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6ef0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 53, "time_total_s": 887.216694355011, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455192, "episode_reward_mean": 856.6727066964319}
{"training_iteration": 22, "time_since_restore": 927.2723598480225, "episode_reward_max": 953.9817280040477, "policy_reward_mean": {}, "timesteps_since_restore": 2545441, "episode_len_mean": 700.0, "episode_reward_min": 757.268616271745, "hostname": "flow-main", "time_this_iter_s": 40.055665493011475, "custom_metrics": {"cost2_mean": -19.92975174564392, "system_level_velocity_max": 14.74257503795528, "cost2_max": -17.31017280768795, "outflow_rate_max": 1035.2972002851234, "cost2_min": -22.465433505252154, "cost1_mean": 312.4070813274917, "system_level_velocity_mean": 11.649505095840533, "outflow_rate_min": 818.1550893706118, "cost1_max": 392.5428777906528, "outflow_rate_mean": 912.4220671374791, "cost1_min": 246.25595689324206, "system_level_velocity_min": 9.138804325304664}, "episodes_total": 1176, "timesteps_this_iter": 113764, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 22, "timesteps_total": 2545441, "date": "2019-04-28_12-40-32", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2545441, "load_time_ms": 20.77, "grad_time_ms": 25035.053, "update_time_ms": 11.502, "num_steps_trained": 2545441, "default": {"total_loss": 18.13535499572754, "cur_kl_coeff": 0.025000005960464478, "entropy": 1.2198057174682617, "vf_loss": 18.135570526123047, "kl": 0.00799067597836256, "vf_explained_var": 0.6955753564834595, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0004150244640186429}, "sample_time_ms": 15557.293}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9144a90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9144080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915e550>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 57, "time_total_s": 927.2723598480225, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455232, "episode_reward_mean": 852.4122461861231}
{"training_iteration": 23, "time_since_restore": 967.1849443912506, "episode_reward_max": 952.6799887490539, "policy_reward_mean": {}, "timesteps_since_restore": 2658027, "episode_len_mean": 700.0, "episode_reward_min": 757.268616271745, "hostname": "flow-main", "time_this_iter_s": 39.91258454322815, "custom_metrics": {"cost2_mean": -19.674016795372356, "system_level_velocity_max": 15.203288814839434, "cost2_max": -16.80782519116353, "outflow_rate_max": 1048.5705698006843, "cost2_min": -23.19809050329625, "cost1_mean": 313.7226209166047, "system_level_velocity_mean": 11.711555738180017, "outflow_rate_min": 818.1550893706118, "cost1_max": 401.80263257824845, "outflow_rate_mean": 915.2431371199924, "cost1_min": 246.25595689324206, "system_level_velocity_min": 9.138804325304664}, "episodes_total": 1228, "timesteps_this_iter": 112586, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 23, "timesteps_total": 2658027, "date": "2019-04-28_12-41-12", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2658027, "load_time_ms": 20.668, "grad_time_ms": 24919.954, "update_time_ms": 11.693, "num_steps_trained": 2658027, "default": {"total_loss": 18.524860382080078, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.2075320482254028, "vf_loss": 18.525522232055664, "kl": 0.007941081188619137, "vf_explained_var": 0.688042163848877, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008610952063463628}, "sample_time_ms": 15439.623}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6320>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6a90>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 52, "time_total_s": 967.1849443912506, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455272, "episode_reward_mean": 854.5295386296617}
{"training_iteration": 24, "time_since_restore": 1007.2778322696686, "episode_reward_max": 952.6799887490539, "policy_reward_mean": {}, "timesteps_since_restore": 2770205, "episode_len_mean": 700.0, "episode_reward_min": 767.5605012444373, "hostname": "flow-main", "time_this_iter_s": 40.09288787841797, "custom_metrics": {"cost2_mean": -19.301342295184963, "system_level_velocity_max": 15.203288814839434, "cost2_max": -16.405102180265153, "outflow_rate_max": 1048.5705698006843, "cost2_min": -23.19809050329625, "cost1_mean": 313.8732237997838, "system_level_velocity_mean": 11.74045229974941, "outflow_rate_min": 816.945105595971, "cost1_max": 401.80263257824845, "outflow_rate_mean": 912.6062153479867, "cost1_min": 252.75239593745914, "system_level_velocity_min": 9.368558887689023}, "episodes_total": 1286, "timesteps_this_iter": 112178, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 24, "timesteps_total": 2770205, "date": "2019-04-28_12-41-52", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2770205, "load_time_ms": 20.565, "grad_time_ms": 24904.423, "update_time_ms": 11.914, "num_steps_trained": 2770205, "default": {"total_loss": 21.491987228393555, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.212003469467163, "vf_loss": 21.492080688476562, "kl": 0.00818977877497673, "vf_explained_var": 0.6548035740852356, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00029620909481309354}, "sample_time_ms": 15401.322}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9144a90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9144710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91446a0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 58, "time_total_s": 1007.2778322696686, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455312, "episode_reward_mean": 852.0182710987237}
{"training_iteration": 25, "time_since_restore": 1046.6855976581573, "episode_reward_max": 971.3952550962449, "policy_reward_mean": {}, "timesteps_since_restore": 2882135, "episode_len_mean": 700.0, "episode_reward_min": 765.6210094238759, "hostname": "flow-main", "time_this_iter_s": 39.40776538848877, "custom_metrics": {"cost2_mean": -19.198348589421304, "system_level_velocity_max": 15.777873185350987, "cost2_max": -16.405102180265153, "outflow_rate_max": 1062.860246745612, "cost2_min": -22.61625874449163, "cost1_mean": 324.3758776464454, "system_level_velocity_mean": 12.168014306357945, "outflow_rate_min": 816.945105595971, "cost1_max": 415.34491590184393, "outflow_rate_mean": 926.3213819532275, "cost1_min": 254.1477144212935, "system_level_velocity_min": 9.382937655297178}, "episodes_total": 1347, "timesteps_this_iter": 111930, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 25, "timesteps_total": 2882135, "date": "2019-04-28_12-42-31", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2882135, "load_time_ms": 20.791, "grad_time_ms": 24885.014, "update_time_ms": 11.797, "num_steps_trained": 2882135, "default": {"total_loss": 23.100950241088867, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.1965115070343018, "vf_loss": 23.101449966430664, "kl": 0.007387273479253054, "vf_explained_var": 0.6759232878684998, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006862026057206094}, "sample_time_ms": 15391.482}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6b70>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6898>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 61, "time_total_s": 1046.6855976581573, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455351, "episode_reward_mean": 858.298548421932}
{"training_iteration": 26, "time_since_restore": 1085.047481060028, "episode_reward_max": 971.3952550962449, "policy_reward_mean": {}, "timesteps_since_restore": 2993160, "episode_len_mean": 700.0, "episode_reward_min": 752.4725276023868, "hostname": "flow-main", "time_this_iter_s": 38.36188340187073, "custom_metrics": {"cost2_mean": -18.991583919708923, "system_level_velocity_max": 15.777873185350987, "cost2_max": -15.880821191029625, "outflow_rate_max": 1062.860246745612, "cost2_min": -22.346029715414474, "cost1_mean": 327.3697275872496, "system_level_velocity_mean": 12.304273132702415, "outflow_rate_min": 812.8290808517174, "cost1_max": 415.34491590184393, "outflow_rate_mean": 926.2604376366451, "cost1_min": 257.24221739591394, "system_level_velocity_min": 9.530725171944214}, "episodes_total": 1405, "timesteps_this_iter": 111025, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 26, "timesteps_total": 2993160, "date": "2019-04-28_12-43-10", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 2993160, "load_time_ms": 20.691, "grad_time_ms": 24701.091, "update_time_ms": 11.964, "num_steps_trained": 2993160, "default": {"total_loss": 23.107458114624023, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.174189805984497, "vf_loss": 23.107942581176758, "kl": 0.00804811716079712, "vf_explained_var": 0.6472362279891968, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006857940461486578}, "sample_time_ms": 15249.847}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6860>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e60b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6e10>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 58, "time_total_s": 1085.047481060028, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455390, "episode_reward_mean": 849.951167191965}
{"training_iteration": 27, "time_since_restore": 1123.890209197998, "episode_reward_max": 982.1040520033407, "policy_reward_mean": {}, "timesteps_since_restore": 3104100, "episode_len_mean": 700.0, "episode_reward_min": 750.7814502996266, "hostname": "flow-main", "time_this_iter_s": 38.84272813796997, "custom_metrics": {"cost2_mean": -18.79061506907705, "system_level_velocity_max": 16.031047083324403, "cost2_max": -15.880821191029625, "outflow_rate_max": 1062.0215117596495, "cost2_min": -21.06306456125216, "cost1_mean": 331.48431968620525, "system_level_velocity_mean": 12.461954644998512, "outflow_rate_min": 820.8624727844541, "cost1_max": 420.38532863847996, "outflow_rate_mean": 929.4903730870453, "cost1_min": 255.31121398782267, "system_level_velocity_min": 9.487662981286636}, "episodes_total": 1466, "timesteps_this_iter": 110940, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 27, "timesteps_total": 3104100, "date": "2019-04-28_12-43-49", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3104100, "load_time_ms": 20.532, "grad_time_ms": 24493.366, "update_time_ms": 11.653, "num_steps_trained": 3104100, "default": {"total_loss": 25.642810821533203, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.1478912830352783, "vf_loss": 25.643779754638672, "kl": 0.011290319263935089, "vf_explained_var": 0.6587532758712769, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001251774956472218}, "sample_time_ms": 15226.256}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e93c8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9438>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 61, "time_total_s": 1123.890209197998, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455429, "episode_reward_mean": 856.380051556163}
{"training_iteration": 28, "time_since_restore": 1163.3585510253906, "episode_reward_max": 998.2384383858376, "policy_reward_mean": {}, "timesteps_since_restore": 3214239, "episode_len_mean": 700.0, "episode_reward_min": 754.1202172157708, "hostname": "flow-main", "time_this_iter_s": 39.46834182739258, "custom_metrics": {"cost2_mean": -18.798641612937722, "system_level_velocity_max": 16.342279963656114, "cost2_max": -15.737473475430464, "outflow_rate_max": 1080.9713968217577, "cost2_min": -21.50459944430336, "cost1_mean": 341.84870236629837, "system_level_velocity_mean": 12.878242017716397, "outflow_rate_min": 801.9321357174144, "cost1_max": 425.4472785614586, "outflow_rate_mean": 948.9607328872175, "cost1_min": 255.31121398782267, "system_level_velocity_min": 9.487662981286636}, "episodes_total": 1526, "timesteps_this_iter": 110139, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 28, "timesteps_total": 3214239, "date": "2019-04-28_12-44-28", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3214239, "load_time_ms": 20.57, "grad_time_ms": 24408.066, "update_time_ms": 11.236, "num_steps_trained": 3214239, "default": {"total_loss": 25.920244216918945, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.136380672454834, "vf_loss": 25.920276641845703, "kl": 0.008763929829001427, "vf_explained_var": 0.6644389033317566, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0002508914622012526}, "sample_time_ms": 15148.944}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6eb8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6320>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 1163.3585510253906, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455468, "episode_reward_mean": 875.2583229444084}
{"training_iteration": 29, "time_since_restore": 1202.11310172081, "episode_reward_max": 998.2384383858376, "policy_reward_mean": {}, "timesteps_since_restore": 3324667, "episode_len_mean": 700.0, "episode_reward_min": 749.5552788294369, "hostname": "flow-main", "time_this_iter_s": 38.75455069541931, "custom_metrics": {"cost2_mean": -18.625013240246105, "system_level_velocity_max": 16.342279963656114, "cost2_max": -15.292776995542349, "outflow_rate_max": 1080.9713968217577, "cost2_min": -21.162079935768386, "cost1_mean": 345.57650793931384, "system_level_velocity_mean": 13.025599330279476, "outflow_rate_min": 813.2398689994698, "cost1_max": 425.4472785614586, "outflow_rate_mean": 955.776125895587, "cost1_min": 257.31513291210723, "system_level_velocity_min": 9.591257548236555}, "episodes_total": 1586, "timesteps_this_iter": 110428, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 29, "timesteps_total": 3324667, "date": "2019-04-28_12-45-07", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3324667, "load_time_ms": 20.627, "grad_time_ms": 24266.077, "update_time_ms": 11.486, "num_steps_trained": 3324667, "default": {"total_loss": 27.17481803894043, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.14248788356781, "vf_loss": 27.17511749267578, "kl": 0.008283444680273533, "vf_explained_var": 0.64300936460495, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0005046130390837789}, "sample_time_ms": 15128.669}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e90b8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9438>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 1202.11310172081, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455507, "episode_reward_mean": 880.6085532808767}
{"training_iteration": 30, "time_since_restore": 1240.5413427352905, "episode_reward_max": 994.0429792695319, "policy_reward_mean": {}, "timesteps_since_restore": 3434882, "episode_len_mean": 700.0, "episode_reward_min": 749.5552788294369, "hostname": "flow-main", "time_this_iter_s": 38.42824101448059, "custom_metrics": {"cost2_mean": -18.345193953915, "system_level_velocity_max": 16.151612408335065, "cost2_max": -15.292776995542349, "outflow_rate_max": 1071.3075408445006, "cost2_min": -20.744223226316038, "cost1_mean": 339.1854920678928, "system_level_velocity_mean": 12.782745131071069, "outflow_rate_min": 813.2398689994698, "cost1_max": 421.88931744285446, "outflow_rate_mean": 943.1614841643313, "cost1_min": 257.31513291210723, "system_level_velocity_min": 9.591257548236555}, "episodes_total": 1642, "timesteps_this_iter": 110215, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 30, "timesteps_total": 3434882, "date": "2019-04-28_12-45-45", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3434882, "load_time_ms": 20.385, "grad_time_ms": 23896.857, "update_time_ms": 11.347, "num_steps_trained": 3434882, "default": {"total_loss": 25.138748168945312, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.134128451347351, "vf_loss": 25.138839721679688, "kl": 0.007928503677248955, "vf_explained_var": 0.6530715227127075, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000290230440441519}, "sample_time_ms": 15002.869}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6e48>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9964f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e69e8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 1240.5413427352905, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455545, "episode_reward_mean": 870.4384755552106}
{"training_iteration": 31, "time_since_restore": 1280.0501272678375, "episode_reward_max": 987.1821640084346, "policy_reward_mean": {}, "timesteps_since_restore": 3545236, "episode_len_mean": 693.37, "episode_reward_min": 48.529681318096806, "hostname": "flow-main", "time_this_iter_s": 39.508784532547, "custom_metrics": {"cost2_mean": -18.041607379136458, "system_level_velocity_max": 17.31474754440527, "cost2_max": -9.170781937157429, "outflow_rate_max": 1071.3075408445006, "cost2_min": -21.616675239205335, "cost1_mean": 331.76150462949795, "system_level_velocity_mean": 12.655569281453696, "outflow_rate_min": 499.122409994049, "cost1_max": 419.9787451159964, "outflow_rate_mean": 930.5445959823526, "cost1_min": 22.472719137729005, "system_level_velocity_min": 9.72735859160298}, "episodes_total": 1703, "timesteps_this_iter": 110354, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 31, "timesteps_total": 3545236, "date": "2019-04-28_12-46-25", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3545236, "load_time_ms": 21.226, "grad_time_ms": 23990.718, "update_time_ms": 11.36, "num_steps_trained": 3545236, "default": {"total_loss": 28.830535888671875, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.1352665424346924, "vf_loss": 28.830738067626953, "kl": 0.008849297650158405, "vf_explained_var": 0.5793646574020386, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00042306201066821814}, "sample_time_ms": 15041.417}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e94e0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9780>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 61, "time_total_s": 1280.0501272678375, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455585, "episode_reward_mean": 853.6291980693657}
{"training_iteration": 32, "time_since_restore": 1319.6870634555817, "episode_reward_max": 994.4476591906555, "policy_reward_mean": {}, "timesteps_since_restore": 3655029, "episode_len_mean": 687.62, "episode_reward_min": 48.529681318096806, "hostname": "flow-main", "time_this_iter_s": 39.63693618774414, "custom_metrics": {"cost2_mean": -17.92330934228715, "system_level_velocity_max": 17.31474754440527, "cost2_max": -9.170781937157429, "outflow_rate_max": 1069.5110032028333, "cost2_min": -21.616675239205335, "cost1_mean": 328.6512859988878, "system_level_velocity_mean": 12.67709357160398, "outflow_rate_min": 499.122409994049, "cost1_max": 419.47564649368974, "outflow_rate_mean": 927.2839791019455, "cost1_min": 22.472719137729005, "system_level_velocity_min": 9.505826529960219}, "episodes_total": 1763, "timesteps_this_iter": 109793, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 32, "timesteps_total": 3655029, "date": "2019-04-28_12-47-05", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3655029, "load_time_ms": 22.06, "grad_time_ms": 23990.774, "update_time_ms": 11.567, "num_steps_trained": 3655029, "default": {"total_loss": 28.266740798950195, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.136620283126831, "vf_loss": 28.267658233642578, "kl": 0.009256239049136639, "vf_explained_var": 0.6316194534301758, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0011468634475022554}, "sample_time_ms": 14998.377}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6f98>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9144f28>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 1319.6870634555817, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455625, "episode_reward_mean": 845.3022021482036}
{"training_iteration": 33, "time_since_restore": 1358.3586711883545, "episode_reward_max": 994.4476591906555, "policy_reward_mean": {}, "timesteps_since_restore": 3765421, "episode_len_mean": 694.25, "episode_reward_min": 165.79096757666198, "hostname": "flow-main", "time_this_iter_s": 38.67160773277283, "custom_metrics": {"cost2_mean": -18.066136104098003, "system_level_velocity_max": 16.47606806292533, "cost2_max": -10.306403205958581, "outflow_rate_max": 1085.1162715974474, "cost2_min": -20.35796026885088, "cost1_mean": 338.5360084481365, "system_level_velocity_mean": 12.885613306578874, "outflow_rate_min": 676.1696716050594, "cost1_max": 427.8414368645816, "outflow_rate_mean": 944.5384213195159, "cost1_min": 73.76635935708428, "system_level_velocity_min": 9.780595842139991}, "episodes_total": 1823, "timesteps_this_iter": 110392, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 33, "timesteps_total": 3765421, "date": "2019-04-28_12-47-43", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3765421, "load_time_ms": 22.057, "grad_time_ms": 23853.323, "update_time_ms": 11.379, "num_steps_trained": 3765421, "default": {"total_loss": 31.112180709838867, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.120801329612732, "vf_loss": 31.11224365234375, "kl": 0.008379865437746048, "vf_explained_var": 0.5805671811103821, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00027716325712390244}, "sample_time_ms": 15012.87}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e96d8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9438>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 1358.3586711883545, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455663, "episode_reward_mean": 873.6116213282909}
{"training_iteration": 34, "time_since_restore": 1397.6643755435944, "episode_reward_max": 1010.1712899503325, "policy_reward_mean": {}, "timesteps_since_restore": 3876711, "episode_len_mean": 700.0, "episode_reward_min": 760.8206597590987, "hostname": "flow-main", "time_this_iter_s": 39.30570435523987, "custom_metrics": {"cost2_mean": -18.16632015579099, "system_level_velocity_max": 16.47606806292533, "cost2_max": -14.804734910793977, "outflow_rate_max": 1085.1162715974474, "cost2_min": -20.413689380523106, "cost1_mean": 340.13327671572637, "system_level_velocity_mean": 12.79693482720234, "outflow_rate_min": 818.7632459608011, "cost1_max": 427.8414368645816, "outflow_rate_mean": 949.7129000463087, "cost1_min": 258.5887112797973, "system_level_velocity_min": 9.652297753939168}, "episodes_total": 1876, "timesteps_this_iter": 111290, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 34, "timesteps_total": 3876711, "date": "2019-04-28_12-48-23", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3876711, "load_time_ms": 22.143, "grad_time_ms": 23788.499, "update_time_ms": 11.147, "num_steps_trained": 3876711, "default": {"total_loss": 27.054462432861328, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.1366723775863647, "vf_loss": 27.054662704467773, "kl": 0.00844952929764986, "vf_explained_var": 0.6111553907394409, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00041006869287230074}, "sample_time_ms": 14997.184}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6a20>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6cf8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 53, "time_total_s": 1397.6643755435944, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455703, "episode_reward_mean": 888.8468485230821}
{"training_iteration": 35, "time_since_restore": 1437.4290227890015, "episode_reward_max": 1010.1712899503325, "policy_reward_mean": {}, "timesteps_since_restore": 3986724, "episode_len_mean": 700.0, "episode_reward_min": 754.9245277248801, "hostname": "flow-main", "time_this_iter_s": 39.764647245407104, "custom_metrics": {"cost2_mean": -17.853410193749102, "system_level_velocity_max": 16.344817043391767, "cost2_max": -14.804734910793977, "outflow_rate_max": 1084.668536180951, "cost2_min": -20.413689380523106, "cost1_mean": 329.44606811664374, "system_level_velocity_mean": 12.390773012197908, "outflow_rate_min": 818.7632459608011, "cost1_max": 425.95309310061833, "outflow_rate_mean": 932.6688514130659, "cost1_min": 254.4356093325083, "system_level_velocity_min": 9.388417401298177}, "episodes_total": 1936, "timesteps_this_iter": 110013, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 35, "timesteps_total": 3986724, "date": "2019-04-28_12-49-02", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 3986724, "load_time_ms": 21.095, "grad_time_ms": 23839.493, "update_time_ms": 11.192, "num_steps_trained": 3986724, "default": {"total_loss": 30.514123916625977, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.1233259439468384, "vf_loss": 30.514938354492188, "kl": 0.009433374740183353, "vf_explained_var": 0.6054349541664124, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0010509360581636429}, "sample_time_ms": 14980.776}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e91d0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9c88>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 1437.4290227890015, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455742, "episode_reward_mean": 875.4221380283167}
{"training_iteration": 36, "time_since_restore": 1478.1222295761108, "episode_reward_max": 1002.8142579339597, "policy_reward_mean": {}, "timesteps_since_restore": 4098330, "episode_len_mean": 694.25, "episode_reward_min": 170.49659818343218, "hostname": "flow-main", "time_this_iter_s": 40.693206787109375, "custom_metrics": {"cost2_mean": -17.658391589010172, "system_level_velocity_max": 16.6143739135607, "cost2_max": -11.265569153251688, "outflow_rate_max": 1084.5856062580751, "cost2_min": -20.393906316912343, "cost1_mean": 334.9193667143632, "system_level_velocity_mean": 12.749006519680211, "outflow_rate_min": 684.0171419214909, "cost1_max": 425.95309310061833, "outflow_rate_mean": 943.1010033266289, "cost1_min": 76.3795151820226, "system_level_velocity_min": 9.388417401298177}, "episodes_total": 1992, "timesteps_this_iter": 111606, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 36, "timesteps_total": 4098330, "date": "2019-04-28_12-49-43", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4098330, "load_time_ms": 21.186, "grad_time_ms": 24023.14, "update_time_ms": 11.446, "num_steps_trained": 4098330, "default": {"total_loss": 28.8482666015625, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.1213587522506714, "vf_loss": 28.849023818969727, "kl": 0.009914531372487545, "vf_explained_var": 0.6369394063949585, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0010055131278932095}, "sample_time_ms": 15029.349}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e60b8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91440b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9144a90>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 1478.1222295761108, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455783, "episode_reward_mean": 881.4918424180815}
{"training_iteration": 37, "time_since_restore": 1519.4584364891052, "episode_reward_max": 1002.3207245262472, "policy_reward_mean": {}, "timesteps_since_restore": 4210493, "episode_len_mean": 684.66, "episode_reward_min": 170.49659818343218, "hostname": "flow-main", "time_this_iter_s": 41.336206912994385, "custom_metrics": {"cost2_mean": -17.98975750305359, "system_level_velocity_max": 16.624040130774574, "cost2_max": -11.265569153251688, "outflow_rate_max": 1096.2745469924416, "cost2_min": -20.20539109491156, "cost1_mean": 337.1172922384214, "system_level_velocity_mean": 13.056657637860672, "outflow_rate_min": 684.0171419214909, "cost1_max": 428.70399147889725, "outflow_rate_mean": 952.8704773090768, "cost1_min": 76.3795151820226, "system_level_velocity_min": 9.807957454287441}, "episodes_total": 2046, "timesteps_this_iter": 112163, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 37, "timesteps_total": 4210493, "date": "2019-04-28_12-50-24", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4210493, "load_time_ms": 22.081, "grad_time_ms": 24197.788, "update_time_ms": 11.158, "num_steps_trained": 4210493, "default": {"total_loss": 29.22547149658203, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.1088011264801025, "vf_loss": 29.22568130493164, "kl": 0.009994062595069408, "vf_explained_var": 0.6410395503044128, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0004599484382197261}, "sample_time_ms": 15101.348}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9048>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e95c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9a58>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 54, "time_total_s": 1519.4584364891052, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455824, "episode_reward_mean": 885.6894692678893}
{"training_iteration": 38, "time_since_restore": 1558.309950351715, "episode_reward_max": 1009.9634549382325, "policy_reward_mean": {}, "timesteps_since_restore": 4321706, "episode_len_mean": 690.09, "episode_reward_min": 303.93841110755193, "hostname": "flow-main", "time_this_iter_s": 38.85151386260986, "custom_metrics": {"cost2_mean": -18.117183718545324, "system_level_velocity_max": 16.925214429557084, "cost2_max": -13.325997851478126, "outflow_rate_max": 1105.5670315153575, "cost2_min": -21.322172646470932, "cost1_mean": 339.8356413787676, "system_level_velocity_mean": 13.047986276660577, "outflow_rate_min": 789.6746424025263, "cost1_max": 436.6272132986779, "outflow_rate_mean": 958.8137864313061, "cost1_min": 133.10160220121406, "system_level_velocity_min": 9.807957454287441}, "episodes_total": 2102, "timesteps_this_iter": 111213, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 38, "timesteps_total": 4321706, "date": "2019-04-28_12-51-03", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4321706, "load_time_ms": 20.942, "grad_time_ms": 24143.271, "update_time_ms": 11.544, "num_steps_trained": 4321706, "default": {"total_loss": 30.814287185668945, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.1076594591140747, "vf_loss": 30.81488609313965, "kl": 0.010143446736037731, "vf_explained_var": 0.6761892437934875, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008505687001161277}, "sample_time_ms": 15096.304}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ecf8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9964f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91481d0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 1558.309950351715, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455863, "episode_reward_mean": 899.2066916017598}
{"training_iteration": 39, "time_since_restore": 1598.831711769104, "episode_reward_max": 1009.9634549382325, "policy_reward_mean": {}, "timesteps_since_restore": 4434573, "episode_len_mean": 700.0, "episode_reward_min": 805.0047956458839, "hostname": "flow-main", "time_this_iter_s": 40.521761417388916, "custom_metrics": {"cost2_mean": -18.269150401749986, "system_level_velocity_max": 16.925214429557084, "cost2_max": -16.28282956214475, "outflow_rate_max": 1105.5670315153575, "cost2_min": -21.322172646470932, "cost1_mean": 340.8335109062527, "system_level_velocity_mean": 12.846567155565511, "outflow_rate_min": 834.6510442246984, "cost1_max": 436.6272132986779, "outflow_rate_mean": 960.6392090552125, "cost1_min": 261.0626624692884, "system_level_velocity_min": 9.773381143929697}, "episodes_total": 2161, "timesteps_this_iter": 112867, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 39, "timesteps_total": 4434573, "date": "2019-04-28_12-51-44", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4434573, "load_time_ms": 20.697, "grad_time_ms": 24285.155, "update_time_ms": 11.498, "num_steps_trained": 4434573, "default": {"total_loss": 31.00348472595215, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.1016744375228882, "vf_loss": 31.003890991210938, "kl": 0.010547417216002941, "vf_explained_var": 0.6756224632263184, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006699498626403511}, "sample_time_ms": 15130.302}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9710>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e94a8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 1598.831711769104, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455904, "episode_reward_mean": 910.2727198618843}
{"training_iteration": 40, "time_since_restore": 1638.8245232105255, "episode_reward_max": 1027.4672229301252, "policy_reward_mean": {}, "timesteps_since_restore": 4547627, "episode_len_mean": 696.08, "episode_reward_min": 437.8242885718054, "hostname": "flow-main", "time_this_iter_s": 39.99281144142151, "custom_metrics": {"cost2_mean": -18.02683067557326, "system_level_velocity_max": 16.808270200523786, "cost2_max": -14.577225427307743, "outflow_rate_max": 1099.9035176873033, "cost2_min": -20.720805248338795, "cost1_mean": 337.1921239600742, "system_level_velocity_mean": 12.789459486752792, "outflow_rate_min": 821.4721054597276, "cost1_max": 436.8597802495539, "outflow_rate_mean": 954.1030043530959, "cost1_min": 191.1095766120069, "system_level_velocity_min": 9.773381143929697}, "episodes_total": 2217, "timesteps_this_iter": 113054, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 40, "timesteps_total": 4547627, "date": "2019-04-28_12-52-24", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4547627, "load_time_ms": 20.65, "grad_time_ms": 24359.164, "update_time_ms": 11.576, "num_steps_trained": 4547627, "default": {"total_loss": 30.345670700073242, "cur_kl_coeff": 0.025000005960464478, "entropy": 1.1048420667648315, "vf_loss": 30.345983505249023, "kl": 0.010240985080599785, "vf_explained_var": 0.7180241942405701, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0005705573130398989}, "sample_time_ms": 15210.611}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e915ee48>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9d68>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 56, "time_total_s": 1638.8245232105255, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455944, "episode_reward_mean": 902.3679593655728}
{"training_iteration": 41, "time_since_restore": 1678.622428894043, "episode_reward_max": 1027.4672229301252, "policy_reward_mean": {}, "timesteps_since_restore": 4658925, "episode_len_mean": 696.08, "episode_reward_min": 437.8242885718054, "hostname": "flow-main", "time_this_iter_s": 39.797905683517456, "custom_metrics": {"cost2_mean": -18.068288475059003, "system_level_velocity_max": 16.946620762256615, "cost2_max": -14.577225427307743, "outflow_rate_max": 1099.9035176873033, "cost2_min": -22.39652001922348, "cost1_mean": 339.37865634468704, "system_level_velocity_mean": 12.878180853061012, "outflow_rate_min": 833.3545404948733, "cost1_max": 436.8597802495539, "outflow_rate_mean": 955.6716540925091, "cost1_min": 191.1095766120069, "system_level_velocity_min": 9.984170345796707}, "episodes_total": 2276, "timesteps_this_iter": 111298, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 41, "timesteps_total": 4658925, "date": "2019-04-28_12-53-04", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4658925, "load_time_ms": 20.551, "grad_time_ms": 24416.149, "update_time_ms": 11.634, "num_steps_trained": 4658925, "default": {"total_loss": 32.399696350097656, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.092033863067627, "vf_loss": 32.39980697631836, "kl": 0.010743202641606331, "vf_explained_var": 0.7068904042243958, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0003777109959628433}, "sample_time_ms": 15182.444}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9048>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e92b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9668>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 1678.622428894043, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556455984, "episode_reward_mean": 909.7992073551064}
{"training_iteration": 42, "time_since_restore": 1718.8704676628113, "episode_reward_max": 1018.4024259849601, "policy_reward_mean": {}, "timesteps_since_restore": 4771441, "episode_len_mean": 700.0, "episode_reward_min": 824.4090328035195, "hostname": "flow-main", "time_this_iter_s": 40.24803876876831, "custom_metrics": {"cost2_mean": -18.074714657248013, "system_level_velocity_max": 16.946620762256615, "cost2_max": -14.998938421326962, "outflow_rate_max": 1095.177212736051, "cost2_min": -22.39652001922348, "cost1_mean": 348.1993714527062, "system_level_velocity_mean": 13.118969133821638, "outflow_rate_min": 845.6135255806985, "cost1_max": 435.94732000457316, "outflow_rate_mean": 968.4928108427558, "cost1_min": 269.9770726503722, "system_level_velocity_min": 10.039029114902634}, "episodes_total": 2333, "timesteps_this_iter": 112516, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 42, "timesteps_total": 4771441, "date": "2019-04-28_12-53-44", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4771441, "load_time_ms": 19.553, "grad_time_ms": 24435.481, "update_time_ms": 11.554, "num_steps_trained": 4771441, "default": {"total_loss": 31.193126678466797, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.078902244567871, "vf_loss": 31.192794799804688, "kl": 0.009495983831584454, "vf_explained_var": 0.7286255955696106, "cur_lr": 0.0005000000237487257, "policy_loss": 9.502201282884926e-05}, "sample_time_ms": 15223.64}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9940>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9f98>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 57, "time_total_s": 1718.8704676628113, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556456024, "episode_reward_mean": 921.5078937433776}
{"training_iteration": 43, "time_since_restore": 1758.2803268432617, "episode_reward_max": 1011.0336393767956, "policy_reward_mean": {}, "timesteps_since_restore": 4883790, "episode_len_mean": 700.0, "episode_reward_min": 800.8885370933568, "hostname": "flow-main", "time_this_iter_s": 39.40985918045044, "custom_metrics": {"cost2_mean": -17.953821848495558, "system_level_velocity_max": 17.18509624927656, "cost2_max": -14.998938421326962, "outflow_rate_max": 1106.1956347400385, "cost2_min": -20.393371637990125, "cost1_mean": 346.4852649440977, "system_level_velocity_mean": 13.069335777581712, "outflow_rate_min": 842.4283109907071, "cost1_max": 443.02712221207815, "outflow_rate_mean": 966.8484670632195, "cost1_min": 265.2863291940397, "system_level_velocity_min": 9.88810530983627}, "episodes_total": 2392, "timesteps_this_iter": 112349, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 43, "timesteps_total": 4883790, "date": "2019-04-28_12-54-23", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4883790, "load_time_ms": 18.312, "grad_time_ms": 24505.893, "update_time_ms": 11.419, "num_steps_trained": 4883790, "default": {"total_loss": 31.962236404418945, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.0785319805145264, "vf_loss": 31.96295928955078, "kl": 0.0103903254494071, "vf_explained_var": 0.7491908073425293, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0009849650086835027}, "sample_time_ms": 15229.055}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e96d8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e99e8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 1758.2803268432617, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556456063, "episode_reward_mean": 915.6754346193442}
{"training_iteration": 44, "time_since_restore": 1799.1401517391205, "episode_reward_max": 1007.694157154135, "policy_reward_mean": {}, "timesteps_since_restore": 4996121, "episode_len_mean": 693.35, "episode_reward_min": 47.70433012542057, "hostname": "flow-main", "time_this_iter_s": 40.859824895858765, "custom_metrics": {"cost2_mean": -18.007308100014395, "system_level_velocity_max": 17.224130490312866, "cost2_max": -8.064979692803869, "outflow_rate_max": 1106.1956347400385, "cost2_min": -20.38736230381061, "cost1_mean": 337.3216680706975, "system_level_velocity_mean": 12.895799296464666, "outflow_rate_min": 491.0818408308928, "cost1_max": 443.02712221207815, "outflow_rate_mean": 953.4307096918579, "cost1_min": 21.21380731365821, "system_level_velocity_min": 9.822042999132186}, "episodes_total": 2446, "timesteps_this_iter": 112331, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 44, "timesteps_total": 4996121, "date": "2019-04-28_12-55-04", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 4996121, "load_time_ms": 17.309, "grad_time_ms": 24549.031, "update_time_ms": 11.419, "num_steps_trained": 4996121, "default": {"total_loss": 29.896196365356445, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.0533674955368042, "vf_loss": 29.89697265625, "kl": 0.011646311730146408, "vf_explained_var": 0.7581444978713989, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001068475074134767}, "sample_time_ms": 15342.548}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9400>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e97f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9f28>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 54, "time_total_s": 1799.1401517391205, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556456104, "episode_reward_mean": 900.8586867743666}
{"training_iteration": 45, "time_since_restore": 1839.0920715332031, "episode_reward_max": 1024.2475495157892, "policy_reward_mean": {}, "timesteps_since_restore": 5108214, "episode_len_mean": 681.8, "episode_reward_min": 47.70433012542057, "hostname": "flow-main", "time_this_iter_s": 39.95191979408264, "custom_metrics": {"cost2_mean": -18.318825068596563, "system_level_velocity_max": 17.289702380199284, "cost2_max": -8.064979692803869, "outflow_rate_max": 1099.4803920141494, "cost2_min": -24.816607259608467, "cost1_mean": 338.00010591713703, "system_level_velocity_mean": 13.210682008430542, "outflow_rate_min": 491.0818408308928, "cost1_max": 444.1864607339002, "outflow_rate_mean": 956.1077231493224, "cost1_min": 21.21380731365821, "system_level_velocity_min": 9.822042999132186}, "episodes_total": 2504, "timesteps_this_iter": 112093, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 45, "timesteps_total": 5108214, "date": "2019-04-28_12-55-44", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5108214, "load_time_ms": 17.279, "grad_time_ms": 24548.588, "update_time_ms": 11.688, "num_steps_trained": 5108214, "default": {"total_loss": 32.07184600830078, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.0281245708465576, "vf_loss": 32.071956634521484, "kl": 0.01303227711468935, "vf_explained_var": 0.7551494240760803, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0004345814813859761}, "sample_time_ms": 15362.555}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e96d8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9470>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 58, "time_total_s": 1839.0920715332031, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556456144, "episode_reward_mean": 896.852782469813}
{"training_iteration": 46, "time_since_restore": 1878.2891249656677, "episode_reward_max": 1024.2475495157892, "policy_reward_mean": {}, "timesteps_since_restore": 5219473, "episode_len_mean": 688.45, "episode_reward_min": 50.101257408844404, "hostname": "flow-main", "time_this_iter_s": 39.1970534324646, "custom_metrics": {"cost2_mean": -18.724072970016312, "system_level_velocity_max": 17.289702380199284, "cost2_max": -9.741938654675394, "outflow_rate_max": 1099.4803920141494, "cost2_min": -24.816607259608467, "cost1_mean": 345.02972641528936, "system_level_velocity_mean": 13.304759769726358, "outflow_rate_min": 494.87161175541405, "cost1_max": 444.1864607339002, "outflow_rate_mean": 967.503971693367, "cost1_min": 23.14816851369023, "system_level_velocity_min": 9.871028090305138}, "episodes_total": 2563, "timesteps_this_iter": 111259, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 46, "timesteps_total": 5219473, "date": "2019-04-28_12-56-24", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5219473, "load_time_ms": 16.924, "grad_time_ms": 24405.094, "update_time_ms": 11.442, "num_steps_trained": 5219473, "default": {"total_loss": 35.19855499267578, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.0222914218902588, "vf_loss": 35.198490142822266, "kl": 0.011799050495028496, "vf_explained_var": 0.7232446670532227, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00023173846420831978}, "sample_time_ms": 15355.874}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9a90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9be0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 59, "time_total_s": 1878.2891249656677, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556456184, "episode_reward_mean": 911.8803695102365}
{"training_iteration": 47, "time_since_restore": 1918.9952249526978, "episode_reward_max": 1013.7189142354406, "policy_reward_mean": {}, "timesteps_since_restore": 5331961, "episode_len_mean": 700.0, "episode_reward_min": 796.1484423336407, "hostname": "flow-main", "time_this_iter_s": 40.70609998703003, "custom_metrics": {"cost2_mean": -18.9681407283573, "system_level_velocity_max": 16.75449401813146, "cost2_max": -17.202983346459874, "outflow_rate_max": 1096.625341197077, "cost2_min": -21.576228358197866, "cost1_mean": 344.64980403485606, "system_level_velocity_mean": 13.003382455461457, "outflow_rate_min": 838.0802661355135, "cost1_max": 433.931347615278, "outflow_rate_mean": 964.502448381022, "cost1_min": 258.18245364138045, "system_level_velocity_min": 9.529537089710931}, "episodes_total": 2621, "timesteps_this_iter": 112488, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 47, "timesteps_total": 5331961, "date": "2019-04-28_12-57-04", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5331961, "load_time_ms": 16.88, "grad_time_ms": 24445.23, "update_time_ms": 11.577, "num_steps_trained": 5331961, "default": {"total_loss": 33.09858322143555, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.0390626192092896, "vf_loss": 33.099422454833984, "kl": 0.011789917945861816, "vf_explained_var": 0.7491552233695984, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0011356254108250141}, "sample_time_ms": 15252.412}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9fd0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9c88>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 58, "time_total_s": 1918.9952249526978, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556456224, "episode_reward_mean": 918.3636244613876}
{"training_iteration": 48, "time_since_restore": 1956.9349262714386, "episode_reward_max": 1018.1621774658737, "policy_reward_mean": {}, "timesteps_since_restore": 5444367, "episode_len_mean": 700.0, "episode_reward_min": 806.8906949197153, "hostname": "flow-main", "time_this_iter_s": 37.939701318740845, "custom_metrics": {"cost2_mean": -19.114772108480196, "system_level_velocity_max": 17.476204359589772, "cost2_max": -17.309281801811363, "outflow_rate_max": 1103.9492586018866, "cost2_min": -22.561713062396233, "cost1_mean": 345.0770365243584, "system_level_velocity_mean": 13.013471569065391, "outflow_rate_min": 846.1707738243118, "cost1_max": 446.1383688179096, "outflow_rate_mean": 963.735752600946, "cost1_min": 258.18245364138045, "system_level_velocity_min": 9.529537089710931}, "episodes_total": 2676, "timesteps_this_iter": 112406, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 48, "timesteps_total": 5444367, "date": "2019-04-28_12-57-42", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5444367, "load_time_ms": 17.117, "grad_time_ms": 24324.552, "update_time_ms": 11.392, "num_steps_trained": 5444367, "default": {"total_loss": 32.628231048583984, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.031886339187622, "vf_loss": 32.62823486328125, "kl": 0.010351422242820263, "vf_explained_var": 0.7435494661331177, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0002606527996249497}, "sample_time_ms": 15281.663}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e60f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6c88>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 55, "time_total_s": 1956.9349262714386, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556456262, "episode_reward_mean": 921.0174372083898}
{"training_iteration": 49, "time_since_restore": 1995.4197437763214, "episode_reward_max": 1018.1621774658737, "policy_reward_mean": {}, "timesteps_since_restore": 5556204, "episode_len_mean": 700.0, "episode_reward_min": 806.8906949197153, "hostname": "flow-main", "time_this_iter_s": 38.48481750488281, "custom_metrics": {"cost2_mean": -19.479985398928644, "system_level_velocity_max": 17.476204359589772, "cost2_max": -17.309281801811363, "outflow_rate_max": 1109.0504556776177, "cost2_min": -21.62128150024429, "cost1_mean": 346.8544076480376, "system_level_velocity_mean": 13.052888750730038, "outflow_rate_min": 835.8661804898169, "cost1_max": 446.4450517678223, "outflow_rate_mean": 966.7337095660481, "cost1_min": 256.07857827663923, "system_level_velocity_min": 9.612437768809075}, "episodes_total": 2733, "timesteps_this_iter": 111837, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 49, "timesteps_total": 5556204, "date": "2019-04-28_12-58-21", "done": false, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5556204, "load_time_ms": 16.354, "grad_time_ms": 24155.111, "update_time_ms": 11.405, "num_steps_trained": 5556204, "default": {"total_loss": 35.41218948364258, "cur_kl_coeff": 0.02500000223517418, "entropy": 1.009997010231018, "vf_loss": 35.41239929199219, "kl": 0.011016522534191608, "vf_explained_var": 0.7285910844802856, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0004860417975578457}, "sample_time_ms": 15246.58}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9128>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e9710>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 57, "time_total_s": 1995.4197437763214, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556456301, "episode_reward_mean": 928.0331963328779}
{"training_iteration": 50, "time_since_restore": 2034.8534569740295, "episode_reward_max": 1012.2728751589874, "policy_reward_mean": {}, "timesteps_since_restore": 5667660, "episode_len_mean": 693.37, "episode_reward_min": 49.0105369275032, "hostname": "flow-main", "time_this_iter_s": 39.43371319770813, "custom_metrics": {"cost2_mean": -19.671680365541548, "system_level_velocity_max": 17.403350913333, "cost2_max": -10.07278368019476, "outflow_rate_max": 1109.0504556776177, "cost2_min": -22.37986508922557, "cost1_mean": 348.74808707543184, "system_level_velocity_mean": 13.290928237869489, "outflow_rate_min": 497.50637466738357, "cost1_max": 446.4450517678223, "outflow_rate_mean": 971.4845083021377, "cost1_min": 22.73772429976941, "system_level_velocity_min": 10.156042486360436}, "episodes_total": 2793, "timesteps_this_iter": 111456, "experiment_id": "1ee181a780d34fd48b33d7961c28ac6e", "iterations_since_restore": 50, "timesteps_total": 5667660, "date": "2019-04-28_12-59-00", "done": true, "num_metric_batches_dropped": 0, "info": {"num_steps_sampled": 5667660, "load_time_ms": 16.262, "grad_time_ms": 24133.516, "update_time_ms": 11.366, "num_steps_trained": 5667660, "default": {"total_loss": 35.8961067199707, "cur_kl_coeff": 0.02500000409781933, "entropy": 1.0167526006698608, "vf_loss": 35.89659118652344, "kl": 0.012270975857973099, "vf_explained_var": 0.7118735313415527, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0007907890249043703}, "sample_time_ms": 15215.037}, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e65f8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e90e6ac8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "optimizer": {}, "tf_session_args": {"gpu_options": {"allow_growth": true}, "log_device_placement": false, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true}, "use_gae": true, "lr_schedule": null, "simple_optimizer": false, "sgd_minibatch_size": 128, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "custom_options": {}, "custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "custom_model": null, "dim": 84, "fcnet_hiddens": [100, 50, 25], "zero_mean": true, "framestack": true, "channel_major": false, "lstm_cell_size": 256, "use_lstm": false, "conv_filters": null, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "max_seq_len": 20, "free_log_std": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "output_max_file_size": 67108864, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.3, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "entropy_coeff": 0.0, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "sample_batch_size": 200, "collect_metrics_timeout": 180, "monitor": false, "custom_resources_per_worker": {}, "sample_async": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "synchronize_filters": true}, "episodes_this_iter": 60, "time_total_s": 2034.8534569740295, "pid": 40231, "node_ip": "10.138.0.2", "timestamp": 1556456340, "episode_reward_mean": 924.995296849757}

{"training_iteration": 1, "time_since_restore": 57.28941202163696, "episode_reward_max": 481.73645300256845, "policy_reward_mean": {}, "timesteps_since_restore": 119646, "episode_len_mean": 660.8823529411765, "episode_reward_min": 47.99372792539195, "hostname": "flow-main", "time_this_iter_s": 57.28941202163696, "custom_metrics": {"cost2_mean": -39.40982115575535, "system_level_velocity_max": 17.694957306292668, "cost2_max": -18.1556015006593, "outflow_rate_max": 712.2977443997476, "cost2_min": -54.177004119915175, "cost1_mean": 194.4306181718598, "system_level_velocity_mean": 8.519846077963454, "outflow_rate_min": 488.70614849509667, "cost1_max": 243.65603632972415, "outflow_rate_mean": 623.8911490613013, "cost1_min": 22.642391295888732, "system_level_velocity_min": 6.674598819781389}, "episodes_total": 17, "timesteps_this_iter": 119646, "episodes_this_iter": 17, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 1, "timesteps_total": 119646, "date": "2019-04-28_07-51-57", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 119646, "load_time_ms": 64.01, "grad_time_ms": 23698.693, "update_time_ms": 1226.077, "num_steps_trained": 119646, "default": {"total_loss": 1.3167954683303833, "kl": 0.0025101664941757917, "entropy": 1.4160261154174805, "vf_loss": 1.317386269569397, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8834825754165649, "cur_kl_coeff": 0.20000004768371582, "policy_loss": -0.001092683058232069}, "sample_time_ms": 32059.351}, "episode_reward_mean": 323.14620849005587, "pid": 551, "time_total_s": 57.28941202163696, "node_ip": "10.138.0.2", "timestamp": 1556437917, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984518>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99844a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99844e0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 2, "time_since_restore": 96.00658941268921, "episode_reward_max": 506.02332116803717, "policy_reward_mean": {}, "timesteps_since_restore": 239508, "episode_len_mean": 691.474358974359, "episode_reward_min": 47.99372792539195, "hostname": "flow-main", "time_this_iter_s": 38.717177391052246, "custom_metrics": {"cost2_mean": -41.47184796412668, "system_level_velocity_max": 17.694957306292668, "cost2_max": -18.1556015006593, "outflow_rate_max": 841.473264787585, "cost2_min": -58.358393073212355, "cost1_mean": 204.06715909199414, "system_level_velocity_mean": 8.094731538247876, "outflow_rate_min": 376.348827774786, "cost1_max": 259.6022089643757, "outflow_rate_mean": 635.194280842745, "cost1_min": 22.642391295888732, "system_level_velocity_min": 5.938562876980679}, "episodes_total": 78, "timesteps_this_iter": 119862, "episodes_this_iter": 61, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 2, "timesteps_total": 239508, "date": "2019-04-28_07-52-36", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 239508, "load_time_ms": 38.363, "grad_time_ms": 23763.108, "update_time_ms": 618.613, "num_steps_trained": 239508, "default": {"total_loss": 2.117701530456543, "kl": 0.007512183394283056, "entropy": 1.4106765985488892, "vf_loss": 2.120004653930664, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9087904691696167, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0030544628389179707}, "sample_time_ms": 23349.775}, "episode_reward_mean": 365.9241964970207, "pid": 551, "time_total_s": 96.00658941268921, "node_ip": "10.138.0.2", "timestamp": 1556437956, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984e10>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984dd8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 3, "time_since_restore": 133.61258554458618, "episode_reward_max": 740.0330710782698, "policy_reward_mean": {}, "timesteps_since_restore": 352873, "episode_len_mean": 693.35, "episode_reward_min": 49.89696488398875, "hostname": "flow-main", "time_this_iter_s": 37.60599613189697, "custom_metrics": {"cost2_mean": -46.19183767070372, "system_level_velocity_max": 18.046966171594065, "cost2_max": -17.32720342581402, "outflow_rate_max": 980.4021503356913, "cost2_min": -79.84140681621587, "cost1_mean": 225.14206638592847, "system_level_velocity_mean": 8.818109195764057, "outflow_rate_min": 377.47775992344754, "cost1_max": 315.28950795371156, "outflow_rate_mean": 695.1718561381708, "cost1_min": 22.51388065373635, "system_level_velocity_min": 6.133988333530289}, "episodes_total": 137, "timesteps_this_iter": 113365, "episodes_this_iter": 59, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 3, "timesteps_total": 352873, "date": "2019-04-28_07-53-14", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 352873, "load_time_ms": 29.928, "grad_time_ms": 23114.96, "update_time_ms": 416.651, "num_steps_trained": 352873, "default": {"total_loss": 5.158880710601807, "kl": 0.00797189399600029, "entropy": 1.3982911109924316, "vf_loss": 5.1622209548950195, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8748116493225098, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.004137572832405567}, "sample_time_ms": 20756.942}, "episode_reward_mean": 449.5831124470449, "pid": 551, "time_total_s": 133.61258554458618, "node_ip": "10.138.0.2", "timestamp": 1556437994, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c7b8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c780>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 4, "time_since_restore": 170.90171337127686, "episode_reward_max": 839.0431345550559, "policy_reward_mean": {}, "timesteps_since_restore": 469872, "episode_len_mean": 693.35, "episode_reward_min": 49.89696488398875, "hostname": "flow-main", "time_this_iter_s": 37.289127826690674, "custom_metrics": {"cost2_mean": -53.5868549959928, "system_level_velocity_max": 18.046966171594065, "cost2_max": -17.32720342581402, "outflow_rate_max": 982.0086866622178, "cost2_min": -79.84140681621587, "cost1_mean": 260.58582497232726, "system_level_velocity_mean": 10.059640929401368, "outflow_rate_min": 481.57111688240434, "cost1_max": 319.5557723867669, "outflow_rate_mean": 798.490816534941, "cost1_min": 22.51388065373635, "system_level_velocity_min": 7.2097386830457015}, "episodes_total": 197, "timesteps_this_iter": 116999, "episodes_this_iter": 60, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 4, "timesteps_total": 469872, "date": "2019-04-28_07-53-51", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 469872, "load_time_ms": 25.523, "grad_time_ms": 22944.381, "update_time_ms": 314.955, "num_steps_trained": 469872, "default": {"total_loss": 8.648579597473145, "kl": 0.0059023709036409855, "entropy": 1.3871272802352905, "vf_loss": 8.650259017944336, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7677614092826843, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0022691579069942236}, "sample_time_ms": 19226.746}, "episode_reward_mean": 629.2794173305724, "pid": 551, "time_total_s": 170.90171337127686, "node_ip": "10.138.0.2", "timestamp": 1556438031, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984668>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984828>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 5, "time_since_restore": 209.73732733726501, "episode_reward_max": 921.7382980184607, "policy_reward_mean": {}, "timesteps_since_restore": 590634, "episode_len_mean": 700.0, "episode_reward_min": 569.8689051629184, "hostname": "flow-main", "time_this_iter_s": 38.83561396598816, "custom_metrics": {"cost2_mean": -59.794947748881576, "system_level_velocity_max": 12.174170054621092, "cost2_max": -39.12654105788144, "outflow_rate_max": 982.0086866622178, "cost2_min": -85.64481727830494, "cost1_mean": 280.5403812314526, "system_level_velocity_mean": 10.564664209112589, "outflow_rate_min": 695.1167107448999, "cost1_max": 325.5259273110281, "outflow_rate_mean": 864.7441457750309, "cost1_min": 217.8229262917558, "system_level_velocity_min": 8.217053266332483}, "episodes_total": 245, "timesteps_this_iter": 120762, "episodes_this_iter": 48, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 5, "timesteps_total": 590634, "date": "2019-04-28_07-54-30", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 590634, "load_time_ms": 25.151, "grad_time_ms": 22927.373, "update_time_ms": 253.903, "num_steps_trained": 590634, "default": {"total_loss": 8.520532608032227, "kl": 0.004993530921638012, "entropy": 1.3806194067001343, "vf_loss": 8.52143383026123, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7946495413780212, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.001400231965817511}, "sample_time_ms": 18528.515}, "episode_reward_mean": 763.2682590820051, "pid": 551, "time_total_s": 209.73732733726501, "node_ip": "10.138.0.2", "timestamp": 1556438070, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c1d0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c3c8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 6, "time_since_restore": 248.95951771736145, "episode_reward_max": 931.9621839262766, "policy_reward_mean": {}, "timesteps_since_restore": 710831, "episode_len_mean": 700.0, "episode_reward_min": 629.7488265885984, "hostname": "flow-main", "time_this_iter_s": 39.222190380096436, "custom_metrics": {"cost2_mean": -66.90609566457084, "system_level_velocity_max": 12.174170054621092, "cost2_max": -41.82080313905486, "outflow_rate_max": 987.5462341965839, "cost2_min": -96.1316499491343, "cost1_mean": 280.56576921872374, "system_level_velocity_mean": 10.515450297534917, "outflow_rate_min": 753.3365984699204, "cost1_max": 325.5259273110281, "outflow_rate_mean": 889.8771622264561, "cost1_min": 217.8229262917558, "system_level_velocity_min": 8.217053266332483}, "episodes_total": 293, "timesteps_this_iter": 120197, "episodes_this_iter": 48, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 6, "timesteps_total": 710831, "date": "2019-04-28_07-55-09", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 710831, "load_time_ms": 23.15, "grad_time_ms": 23178.118, "update_time_ms": 214.058, "num_steps_trained": 710831, "default": {"total_loss": 10.078461647033691, "kl": 0.004478230141103268, "entropy": 1.3694019317626953, "vf_loss": 10.079312324523926, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8007680177688599, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0010746670886874199}, "sample_time_ms": 17863.267}, "episode_reward_mean": 822.9972731414362, "pid": 551, "time_total_s": 248.95951771736145, "node_ip": "10.138.0.2", "timestamp": 1556438109, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984be0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984b38>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 7, "time_since_restore": 289.1921260356903, "episode_reward_max": 974.054510229587, "policy_reward_mean": {}, "timesteps_since_restore": 833760, "episode_len_mean": 700.0, "episode_reward_min": 695.962666049825, "hostname": "flow-main", "time_this_iter_s": 40.23260831832886, "custom_metrics": {"cost2_mean": -71.89335695462547, "system_level_velocity_max": 12.950231861530208, "cost2_max": -54.68980073002518, "outflow_rate_max": 1046.231224697101, "cost2_min": -96.1316499491343, "cost1_mean": 294.43781455663304, "system_level_velocity_mean": 11.020620650858213, "outflow_rate_min": 784.1853027261219, "cost1_max": 343.3071999785372, "outflow_rate_mean": 938.3974388487794, "cost1_min": 231.15230022828615, "system_level_velocity_min": 8.786397484708571}, "episodes_total": 348, "timesteps_this_iter": 122929, "episodes_this_iter": 55, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 7, "timesteps_total": 833760, "date": "2019-04-28_07-55-49", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 833760, "load_time_ms": 22.841, "grad_time_ms": 23449.898, "update_time_ms": 185.09, "num_steps_trained": 833760, "default": {"total_loss": 11.202925682067871, "kl": 0.0039560627192258835, "entropy": 1.3605659008026123, "vf_loss": 11.202900886535645, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7829307317733765, "cur_kl_coeff": 0.02500000409781933, "policy_loss": -7.481600187020376e-05}, "sample_time_ms": 17438.931}, "episode_reward_mean": 866.9817579875323, "pid": 551, "time_total_s": 289.1921260356903, "node_ip": "10.138.0.2", "timestamp": 1556438149, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c320>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c4e0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 8, "time_since_restore": 329.333247423172, "episode_reward_max": 978.3186948398609, "policy_reward_mean": {}, "timesteps_since_restore": 957002, "episode_len_mean": 700.0, "episode_reward_min": 695.962666049825, "hostname": "flow-main", "time_this_iter_s": 40.14112138748169, "custom_metrics": {"cost2_mean": -72.52359888082718, "system_level_velocity_max": 12.950231861530208, "cost2_max": -54.68980073002518, "outflow_rate_max": 1046.231224697101, "cost2_min": -93.32984016558407, "cost1_mean": 304.47798012301075, "system_level_velocity_mean": 11.382003584357367, "outflow_rate_min": 788.3640302121981, "cost1_max": 343.3071999785372, "outflow_rate_mean": 963.53426586365, "cost1_min": 232.6099303112881, "system_level_velocity_min": 8.786397484708571}, "episodes_total": 379, "timesteps_this_iter": 123242, "episodes_this_iter": 31, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 8, "timesteps_total": 957002, "date": "2019-04-28_07-56-30", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 957002, "load_time_ms": 21.633, "grad_time_ms": 23743.296, "update_time_ms": 163.388, "num_steps_trained": 957002, "default": {"total_loss": 8.514946937561035, "kl": 0.005256913136690855, "entropy": 1.3595619201660156, "vf_loss": 8.51572036743164, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8270148038864136, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.000839098880533129}, "sample_time_ms": 17017.823}, "episode_reward_mean": 886.4065488710266, "pid": 551, "time_total_s": 329.333247423172, "node_ip": "10.138.0.2", "timestamp": 1556438190, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984710>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99849e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984fd0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 9, "time_since_restore": 370.46861505508423, "episode_reward_max": 978.3186948398609, "policy_reward_mean": {}, "timesteps_since_restore": 1079304, "episode_len_mean": 700.0, "episode_reward_min": 695.962666049825, "hostname": "flow-main", "time_this_iter_s": 41.13536763191223, "custom_metrics": {"cost2_mean": -79.08904368171692, "system_level_velocity_max": 12.741185327374966, "cost2_max": -55.94111799047474, "outflow_rate_max": 1036.5085962918636, "cost2_min": -112.05710753206299, "cost1_mean": 294.45605944823336, "system_level_velocity_mean": 10.995699530680927, "outflow_rate_min": 792.8125088964034, "cost1_max": 339.95777463693025, "outflow_rate_mean": 947.2212072869562, "cost1_min": 234.08540686750186, "system_level_velocity_min": 8.857795728813466}, "episodes_total": 439, "timesteps_this_iter": 122302, "episodes_this_iter": 60, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 9, "timesteps_total": 1079304, "date": "2019-04-28_07-57-11", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1079304, "load_time_ms": 20.812, "grad_time_ms": 23997.839, "update_time_ms": 146.783, "num_steps_trained": 1079304, "default": {"total_loss": 12.849554061889648, "kl": 0.005660814233124256, "entropy": 1.3525679111480713, "vf_loss": 12.849997520446777, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7546696662902832, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0005142763839103281}, "sample_time_ms": 16773.636}, "episode_reward_mean": 873.0905655226716, "pid": 551, "time_total_s": 370.46861505508423, "node_ip": "10.138.0.2", "timestamp": 1556438231, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c5f8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c748>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 10, "time_since_restore": 410.4730772972107, "episode_reward_max": 955.9881295972799, "policy_reward_mean": {}, "timesteps_since_restore": 1201589, "episode_len_mean": 700.0, "episode_reward_min": 774.8171346841877, "hostname": "flow-main", "time_this_iter_s": 40.004462242126465, "custom_metrics": {"cost2_mean": -83.8788855507074, "system_level_velocity_max": 12.312478702241101, "cost2_max": -61.56374906075483, "outflow_rate_max": 1027.362522770574, "cost2_min": -112.52815027733824, "cost1_mean": 286.0165404356645, "system_level_velocity_mean": 10.67378732234944, "outflow_rate_min": 834.0056603993029, "cost1_max": 332.75012502635906, "outflow_rate_mean": 933.5498027845233, "cost1_min": 244.4550890266276, "system_level_velocity_min": 9.175999190968946}, "episodes_total": 489, "timesteps_this_iter": 122285, "episodes_this_iter": 50, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 10, "timesteps_total": 1201589, "date": "2019-04-28_07-57-51", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1201589, "load_time_ms": 19.36, "grad_time_ms": 24102.292, "update_time_ms": 133.199, "num_steps_trained": 1201589, "default": {"total_loss": 12.195443153381348, "kl": 0.007285614497959614, "entropy": 1.3519006967544556, "vf_loss": 12.19648265838623, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7638034820556641, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.001129942829720676}, "sample_time_ms": 16568.776}, "episode_reward_mean": 864.3691371742157, "pid": 551, "time_total_s": 410.4730772972107, "node_ip": "10.138.0.2", "timestamp": 1556438271, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984ac8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984898>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 11, "time_since_restore": 448.9037787914276, "episode_reward_max": 972.3272673482551, "policy_reward_mean": {}, "timesteps_since_restore": 1319281, "episode_len_mean": 700.0, "episode_reward_min": 753.2950023699091, "hostname": "flow-main", "time_this_iter_s": 38.43070149421692, "custom_metrics": {"cost2_mean": -83.48497302317918, "system_level_velocity_max": 12.114649166332185, "cost2_max": -61.43704607080661, "outflow_rate_max": 1014.8145067714493, "cost2_min": -112.52815027733824, "cost1_mean": 286.7887908775566, "system_level_velocity_mean": 10.695326769517608, "outflow_rate_min": 822.1660763258856, "cost1_max": 324.92485843430654, "outflow_rate_mean": 939.084502368676, "cost1_min": 245.05226023924837, "system_level_velocity_min": 9.24655212402135}, "episodes_total": 539, "timesteps_this_iter": 117692, "episodes_this_iter": 50, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 11, "timesteps_total": 1319281, "date": "2019-04-28_07-58-29", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1319281, "load_time_ms": 15.018, "grad_time_ms": 24147.143, "update_time_ms": 11.77, "num_steps_trained": 1319281, "default": {"total_loss": 12.890826225280762, "kl": 0.007101066410541534, "entropy": 1.3492852449417114, "vf_loss": 12.891851425170898, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7646535634994507, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0011132489889860153}, "sample_time_ms": 14766.404}, "episode_reward_mean": 869.9664672452415, "pid": 551, "time_total_s": 448.9037787914276, "node_ip": "10.138.0.2", "timestamp": 1556438309, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c550>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999ccc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c9b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 12, "time_since_restore": 488.33652114868164, "episode_reward_max": 990.8649430510249, "policy_reward_mean": {}, "timesteps_since_restore": 1436635, "episode_len_mean": 700.0, "episode_reward_min": 753.2950023699091, "hostname": "flow-main", "time_this_iter_s": 39.43274235725403, "custom_metrics": {"cost2_mean": -74.72511733470387, "system_level_velocity_max": 12.507238794373906, "cost2_max": -50.849071716955834, "outflow_rate_max": 1030.669610713824, "cost2_min": -100.67610585879606, "cost1_mean": 297.8720582184376, "system_level_velocity_mean": 11.097747333574999, "outflow_rate_min": 822.1660763258856, "cost1_max": 336.9799636647842, "outflow_rate_mean": 957.4380329161773, "cost1_min": 225.12481838450302, "system_level_velocity_min": 8.390548395982014}, "episodes_total": 594, "timesteps_this_iter": 117354, "episodes_this_iter": 55, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 12, "timesteps_total": 1436635, "date": "2019-04-28_07-59-09", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1436635, "load_time_ms": 16.147, "grad_time_ms": 24182.569, "update_time_ms": 11.749, "num_steps_trained": 1436635, "default": {"total_loss": 14.705376625061035, "kl": 0.007977154105901718, "entropy": 1.3378304243087769, "vf_loss": 14.706414222717285, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7245775461196899, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.001136156963184476}, "sample_time_ms": 14800.388}, "episode_reward_mean": 890.217667414286, "pid": 551, "time_total_s": 488.33652114868164, "node_ip": "10.138.0.2", "timestamp": 1556438349, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cb38>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cd68>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 13, "time_since_restore": 525.8822634220123, "episode_reward_max": 990.8649430510249, "policy_reward_mean": {}, "timesteps_since_restore": 1554878, "episode_len_mean": 693.37, "episode_reward_min": 53.703791824757594, "hostname": "flow-main", "time_this_iter_s": 37.54574227333069, "custom_metrics": {"cost2_mean": -70.14684935195656, "system_level_velocity_max": 17.738355166097907, "cost2_max": -14.970082321175699, "outflow_rate_max": 1041.2701984905445, "cost2_min": -97.74696222247056, "cost1_mean": 303.2664914331742, "system_level_velocity_mean": 11.460662631030143, "outflow_rate_min": 496.2871102902245, "cost1_max": 341.84316266673886, "outflow_rate_mean": 967.82467543083, "cost1_min": 23.320066933602572, "system_level_velocity_min": 8.390548395982014}, "episodes_total": 641, "timesteps_this_iter": 118243, "episodes_this_iter": 47, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 13, "timesteps_total": 1554878, "date": "2019-04-28_07-59-46", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1554878, "load_time_ms": 17.043, "grad_time_ms": 24293.096, "update_time_ms": 11.573, "num_steps_trained": 1554878, "default": {"total_loss": 13.914819717407227, "kl": 0.008789537474513054, "entropy": 1.3230067491531372, "vf_loss": 13.916584968566895, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7615567445755005, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0018752283649519086}, "sample_time_ms": 14679.819}, "episode_reward_mean": 895.2662522852224, "pid": 551, "time_total_s": 525.8822634220123, "node_ip": "10.138.0.2", "timestamp": 1556438386, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c0f0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c3c8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 14, "time_since_restore": 564.3458623886108, "episode_reward_max": 1000.680847528838, "policy_reward_mean": {}, "timesteps_since_restore": 1675311, "episode_len_mean": 693.37, "episode_reward_min": 53.703791824757594, "hostname": "flow-main", "time_this_iter_s": 38.46359896659851, "custom_metrics": {"cost2_mean": -71.0736740296181, "system_level_velocity_max": 17.738355166097907, "cost2_max": -14.970082321175699, "outflow_rate_max": 1059.9273113822846, "cost2_min": -97.74696222247056, "cost1_mean": 307.61858371451115, "system_level_velocity_mean": 11.613188880296816, "outflow_rate_min": 496.2871102902245, "cost1_max": 349.33975579527925, "outflow_rate_mean": 982.0138520449921, "cost1_min": 23.320066933602572, "system_level_velocity_min": 9.471918912188084}, "episodes_total": 697, "timesteps_this_iter": 120433, "episodes_this_iter": 56, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 14, "timesteps_total": 1675311, "date": "2019-04-28_08-00-25", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1675311, "load_time_ms": 17.085, "grad_time_ms": 24422.756, "update_time_ms": 11.521, "num_steps_trained": 1675311, "default": {"total_loss": 14.84306812286377, "kl": 0.006179089192301035, "entropy": 1.3135435581207275, "vf_loss": 14.843756675720215, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7344263792037964, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0007662198622711003}, "sample_time_ms": 14664.108}, "episode_reward_mean": 904.705827664371, "pid": 551, "time_total_s": 564.3458623886108, "node_ip": "10.138.0.2", "timestamp": 1556438425, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984940>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984dd8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 15, "time_since_restore": 604.0639417171478, "episode_reward_max": 1007.3585397938283, "policy_reward_mean": {}, "timesteps_since_restore": 1794765, "episode_len_mean": 700.0, "episode_reward_min": 808.4333805965323, "hostname": "flow-main", "time_this_iter_s": 39.71807932853699, "custom_metrics": {"cost2_mean": -73.42905674806137, "system_level_velocity_max": 12.933367670368627, "cost2_max": -54.380689956684336, "outflow_rate_max": 1059.9273113822846, "cost2_min": -98.24170254565774, "cost1_mean": 308.82264466469195, "system_level_velocity_mean": 11.480568184132984, "outflow_rate_min": 839.3142702440606, "cost1_max": 349.33975579527925, "outflow_rate_mean": 988.1575601026827, "cost1_min": 225.84747054217866, "system_level_velocity_min": 8.465553496487633}, "episodes_total": 738, "timesteps_this_iter": 119454, "episodes_this_iter": 41, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 15, "timesteps_total": 1794765, "date": "2019-04-28_08-01-04", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1794765, "load_time_ms": 16.339, "grad_time_ms": 24544.879, "update_time_ms": 11.723, "num_steps_trained": 1794765, "default": {"total_loss": 12.855917930603027, "kl": 0.009164812043309212, "entropy": 1.2990113496780396, "vf_loss": 12.856651306152344, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7844415307044983, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0008485985454171896}, "sample_time_ms": 14630.356}, "episode_reward_mean": 915.3751802535241, "pid": 551, "time_total_s": 604.0639417171478, "node_ip": "10.138.0.2", "timestamp": 1556438464, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c748>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cbe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c5c0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 16, "time_since_restore": 643.3673641681671, "episode_reward_max": 1007.3585397938283, "policy_reward_mean": {}, "timesteps_since_restore": 1913960, "episode_len_mean": 700.0, "episode_reward_min": 808.4333805965323, "hostname": "flow-main", "time_this_iter_s": 39.30342245101929, "custom_metrics": {"cost2_mean": -71.23523099774218, "system_level_velocity_max": 12.776359559532773, "cost2_max": -52.848942703901145, "outflow_rate_max": 1056.6640913162028, "cost2_min": -98.24170254565774, "cost1_mean": 308.09920805978805, "system_level_velocity_mean": 11.450619455097476, "outflow_rate_min": 839.3142702440606, "cost1_max": 346.248684218712, "outflow_rate_mean": 985.2412171036985, "cost1_min": 225.84747054217866, "system_level_velocity_min": 8.465553496487633}, "episodes_total": 794, "timesteps_this_iter": 119195, "episodes_this_iter": 56, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 16, "timesteps_total": 1913960, "date": "2019-04-28_08-01-44", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 1913960, "load_time_ms": 16.666, "grad_time_ms": 24534.28, "update_time_ms": 11.262, "num_steps_trained": 1913960, "default": {"total_loss": 17.591392517089844, "kl": 0.006829445715993643, "entropy": 1.2887396812438965, "vf_loss": 17.591943740844727, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7423824071884155, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.000636051467154175}, "sample_time_ms": 14648.392}, "episode_reward_mean": 914.9816273077679, "pid": 551, "time_total_s": 643.3673641681671, "node_ip": "10.138.0.2", "timestamp": 1556438504, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984cf8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984dd8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 17, "time_since_restore": 681.3362336158752, "episode_reward_max": 1004.9958262189851, "policy_reward_mean": {}, "timesteps_since_restore": 2030873, "episode_len_mean": 700.0, "episode_reward_min": 789.6991626962525, "hostname": "flow-main", "time_this_iter_s": 37.96886944770813, "custom_metrics": {"cost2_mean": -66.32354848582077, "system_level_velocity_max": 12.797727495333275, "cost2_max": -50.349088524520695, "outflow_rate_max": 1045.0956126565013, "cost2_min": -86.82986061011711, "cost1_mean": 308.64892957108407, "system_level_velocity_mean": 11.479709093458487, "outflow_rate_min": 857.8233843428862, "cost1_max": 344.70426135680543, "outflow_rate_mean": 982.6141796664108, "cost1_min": 234.72270742990503, "system_level_velocity_min": 8.781531595920507}, "episodes_total": 844, "timesteps_this_iter": 116913, "episodes_this_iter": 50, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 17, "timesteps_total": 2030873, "date": "2019-04-28_08-02-22", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2030873, "load_time_ms": 16.05, "grad_time_ms": 24363.195, "update_time_ms": 11.164, "num_steps_trained": 2030873, "default": {"total_loss": 16.652666091918945, "kl": 0.007534271106123924, "entropy": 1.2765775918960571, "vf_loss": 16.653324127197266, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7595825791358948, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0007518528727814555}, "sample_time_ms": 14594.006}, "episode_reward_mean": 915.520549274279, "pid": 551, "time_total_s": 681.3362336158752, "node_ip": "10.138.0.2", "timestamp": 1556438542, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cac8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c198>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 18, "time_since_restore": 719.2889294624329, "episode_reward_max": 1005.8831557637403, "policy_reward_mean": {}, "timesteps_since_restore": 2147921, "episode_len_mean": 700.0, "episode_reward_min": 789.6991626962525, "hostname": "flow-main", "time_this_iter_s": 37.95269584655762, "custom_metrics": {"cost2_mean": -61.05861264116804, "system_level_velocity_max": 12.97574882884895, "cost2_max": -47.74502313528619, "outflow_rate_max": 1045.0956126565013, "cost2_min": -83.080074264552, "cost1_mean": 314.7200310404072, "system_level_velocity_mean": 11.694827155765537, "outflow_rate_min": 857.8233843428862, "cost1_max": 350.14322922462475, "outflow_rate_mean": 992.3260956997167, "cost1_min": 234.72270742990503, "system_level_velocity_min": 8.781531595920507}, "episodes_total": 895, "timesteps_this_iter": 117048, "episodes_this_iter": 51, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 18, "timesteps_total": 2147921, "date": "2019-04-28_08-03-00", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2147921, "load_time_ms": 15.899, "grad_time_ms": 24190.071, "update_time_ms": 11.223, "num_steps_trained": 2147921, "default": {"total_loss": 15.650712966918945, "kl": 0.008914121426641941, "entropy": 1.265249490737915, "vf_loss": 15.651497840881348, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7723733186721802, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0008949809125624597}, "sample_time_ms": 14550.6}, "episode_reward_mean": 925.353982889183, "pid": 551, "time_total_s": 719.2889294624329, "node_ip": "10.138.0.2", "timestamp": 1556438580, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984a90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984dd8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 19, "time_since_restore": 756.853789806366, "episode_reward_max": 1005.8831557637403, "policy_reward_mean": {}, "timesteps_since_restore": 2264743, "episode_len_mean": 700.0, "episode_reward_min": 797.9724164155298, "hostname": "flow-main", "time_this_iter_s": 37.564860343933105, "custom_metrics": {"cost2_mean": -56.74497783139406, "system_level_velocity_max": 12.97574882884895, "cost2_max": -44.97053984214819, "outflow_rate_max": 1043.838275437118, "cost2_min": -72.9056580504857, "cost1_mean": 316.8504968713537, "system_level_velocity_mean": 11.764811142783872, "outflow_rate_min": 866.8536590970367, "cost1_max": 350.14322922462475, "outflow_rate_mean": 993.4296462516285, "cost1_min": 255.70422417829914, "system_level_velocity_min": 9.66326428924916}, "episodes_total": 950, "timesteps_this_iter": 116822, "episodes_this_iter": 55, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 19, "timesteps_total": 2264743, "date": "2019-04-28_08-03-37", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2264743, "load_time_ms": 15.991, "grad_time_ms": 23935.674, "update_time_ms": 11.022, "num_steps_trained": 2264743, "default": {"total_loss": 16.542394638061523, "kl": 0.00826007779687643, "entropy": 1.2529363632202148, "vf_loss": 16.543521881103516, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7526344656944275, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0012292638421058655}, "sample_time_ms": 14451.372}, "episode_reward_mean": 927.6901333403893, "pid": 551, "time_total_s": 756.853789806366, "node_ip": "10.138.0.2", "timestamp": 1556438617, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984668>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999ce48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999ca90>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 20, "time_since_restore": 795.7860941886902, "episode_reward_max": 1004.6168028298158, "policy_reward_mean": {}, "timesteps_since_restore": 2380212, "episode_len_mean": 700.0, "episode_reward_min": 797.9724164155298, "hostname": "flow-main", "time_this_iter_s": 38.93230438232422, "custom_metrics": {"cost2_mean": -53.811039483859375, "system_level_velocity_max": 13.026453957146044, "cost2_max": -34.26665653431411, "outflow_rate_max": 1031.2939550081214, "cost2_min": -76.77503810596949, "cost1_mean": 314.4204319474712, "system_level_velocity_mean": 11.67689776480447, "outflow_rate_min": 865.4110521179766, "cost1_max": 349.76631985792756, "outflow_rate_mean": 980.5504100809517, "cost1_min": 255.70422417829914, "system_level_velocity_min": 9.663120530923871}, "episodes_total": 1000, "timesteps_this_iter": 115469, "episodes_this_iter": 50, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 20, "timesteps_total": 2380212, "date": "2019-04-28_08-04-16", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2380212, "load_time_ms": 17.053, "grad_time_ms": 23842.676, "update_time_ms": 10.867, "num_steps_trained": 2380212, "default": {"total_loss": 18.123666763305664, "kl": 0.008441371843218803, "entropy": 1.2219607830047607, "vf_loss": 18.123897552490234, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7331891655921936, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.00033704721136018634}, "sample_time_ms": 14435.945}, "episode_reward_mean": 923.9696393583731, "pid": 551, "time_total_s": 795.7860941886902, "node_ip": "10.138.0.2", "timestamp": 1556438656, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984908>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984978>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 21, "time_since_restore": 837.4319927692413, "episode_reward_max": 982.5397793388269, "policy_reward_mean": {}, "timesteps_since_restore": 2495641, "episode_len_mean": 700.0, "episode_reward_min": 779.7299561808197, "hostname": "flow-main", "time_this_iter_s": 41.64589858055115, "custom_metrics": {"cost2_mean": -46.665806016782156, "system_level_velocity_max": 12.866828558620162, "cost2_max": -30.893529992229436, "outflow_rate_max": 1018.4379582171935, "cost2_min": -71.00031828493691, "cost1_mean": 312.8562172133104, "system_level_velocity_mean": 11.608167565094941, "outflow_rate_min": 818.5691507808128, "cost1_max": 346.6061324002133, "outflow_rate_mean": 965.8650668784913, "cost1_min": 229.18115306947493, "system_level_velocity_min": 8.500446336762131}, "episodes_total": 1060, "timesteps_this_iter": 115429, "episodes_this_iter": 60, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 21, "timesteps_total": 2495641, "date": "2019-04-28_08-04-58", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2495641, "load_time_ms": 16.531, "grad_time_ms": 23922.215, "update_time_ms": 11.079, "num_steps_trained": 2495641, "default": {"total_loss": 20.370759963989258, "kl": 0.008442379534244537, "entropy": 1.2124695777893066, "vf_loss": 20.371566772460938, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.685393750667572, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.0009142368216998875}, "sample_time_ms": 14678.317}, "episode_reward_mean": 919.3569605520732, "pid": 551, "time_total_s": 837.4319927692413, "node_ip": "10.138.0.2", "timestamp": 1556438698, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cb38>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c1d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c898>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 22, "time_since_restore": 875.9069173336029, "episode_reward_max": 979.4369019113421, "policy_reward_mean": {}, "timesteps_since_restore": 2609123, "episode_len_mean": 700.0, "episode_reward_min": 779.7299561808197, "hostname": "flow-main", "time_this_iter_s": 38.47492456436157, "custom_metrics": {"cost2_mean": -39.6582435882587, "system_level_velocity_max": 12.866828558620162, "cost2_max": -28.7308687550925, "outflow_rate_max": 1006.21222355772, "cost2_min": -68.43286120885226, "cost1_mean": 313.09328344340037, "system_level_velocity_mean": 11.619171878594791, "outflow_rate_min": 818.5691507808128, "cost1_max": 346.6061324002133, "outflow_rate_mean": 955.0949940843118, "cost1_min": 229.18115306947493, "system_level_velocity_min": 8.500446336762131}, "episodes_total": 1110, "timesteps_this_iter": 113482, "episodes_this_iter": 50, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 22, "timesteps_total": 2609123, "date": "2019-04-28_08-05-36", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2609123, "load_time_ms": 15.804, "grad_time_ms": 23846.005, "update_time_ms": 11.06, "num_steps_trained": 2609123, "default": {"total_loss": 18.987266540527344, "kl": 0.010149111971259117, "entropy": 1.1805343627929688, "vf_loss": 18.98834228515625, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6588443517684937, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0011995019158348441}, "sample_time_ms": 14663.274}, "episode_reward_mean": 911.9053850313096, "pid": 551, "time_total_s": 875.9069173336029, "node_ip": "10.138.0.2", "timestamp": 1556438736, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984eb8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984cc0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 23, "time_since_restore": 916.8885922431946, "episode_reward_max": 953.2958753120972, "policy_reward_mean": {}, "timesteps_since_restore": 2722365, "episode_len_mean": 700.0, "episode_reward_min": 809.3981433594336, "hostname": "flow-main", "time_this_iter_s": 40.981674909591675, "custom_metrics": {"cost2_mean": -33.02829161413524, "system_level_velocity_max": 12.950199729744382, "cost2_max": -24.39578819685216, "outflow_rate_max": 999.2283664403092, "cost2_min": -50.22775372822386, "cost1_mean": 316.21289812921725, "system_level_velocity_mean": 11.743842128574995, "outflow_rate_min": 855.5966109678172, "cost1_max": 347.92087464254655, "outflow_rate_mean": 948.5772706817198, "cost1_min": 258.694833687969, "system_level_velocity_min": 9.746756498217861}, "episodes_total": 1172, "timesteps_this_iter": 113242, "episodes_this_iter": 62, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 23, "timesteps_total": 2722365, "date": "2019-04-28_08-06-18", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2722365, "load_time_ms": 15.085, "grad_time_ms": 24055.135, "update_time_ms": 11.221, "num_steps_trained": 2722365, "default": {"total_loss": 21.848464965820312, "kl": 0.010410824790596962, "entropy": 1.1929337978363037, "vf_loss": 21.84965705871582, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5716671347618103, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.001320068258792162}, "sample_time_ms": 14797.579}, "episode_reward_mean": 906.1621876739945, "pid": 551, "time_total_s": 916.8885922431946, "node_ip": "10.138.0.2", "timestamp": 1556438778, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9127550>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e91274e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9127518>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 24, "time_since_restore": 956.2824332714081, "episode_reward_max": 953.2958753120972, "policy_reward_mean": {}, "timesteps_since_restore": 2834512, "episode_len_mean": 700.0, "episode_reward_min": 808.5299754075257, "hostname": "flow-main", "time_this_iter_s": 39.3938410282135, "custom_metrics": {"cost2_mean": -29.763484679745037, "system_level_velocity_max": 13.241972127217279, "cost2_max": -22.49262375175649, "outflow_rate_max": 997.9567177350169, "cost2_min": -46.68437682931199, "cost1_mean": 317.7616420353019, "system_level_velocity_mean": 11.805582269676279, "outflow_rate_min": 848.9834808571544, "cost1_max": 355.29247958327926, "outflow_rate_mean": 943.5025094260106, "cost1_min": 265.32474710725273, "system_level_velocity_min": 9.901231504113603}, "episodes_total": 1226, "timesteps_this_iter": 112147, "episodes_this_iter": 54, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 24, "timesteps_total": 2834512, "date": "2019-04-28_08-06-57", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2834512, "load_time_ms": 15.358, "grad_time_ms": 24137.596, "update_time_ms": 11.432, "num_steps_trained": 2834512, "default": {"total_loss": 20.722352981567383, "kl": 0.009364944882690907, "entropy": 1.17258620262146, "vf_loss": 20.722457885742188, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6104981303215027, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0002222414914285764}, "sample_time_ms": 14811.025}, "episode_reward_mean": 899.2510537883456, "pid": 551, "time_total_s": 956.2824332714081, "node_ip": "10.138.0.2", "timestamp": 1556438817, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c6d8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c748>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 25, "time_since_restore": 995.1707327365875, "episode_reward_max": 966.5411988396087, "policy_reward_mean": {}, "timesteps_since_restore": 2947684, "episode_len_mean": 700.0, "episode_reward_min": 807.9239815258316, "hostname": "flow-main", "time_this_iter_s": 38.88829946517944, "custom_metrics": {"cost2_mean": -27.25198650113129, "system_level_velocity_max": 13.457055774733409, "cost2_max": -22.49262375175649, "outflow_rate_max": 1003.7925935418028, "cost2_min": -37.15295308246451, "cost1_mean": 325.6950674673069, "system_level_velocity_mean": 12.114927142285037, "outflow_rate_min": 830.0346259403501, "cost1_max": 359.76032477019555, "outflow_rate_mean": 952.3887642168709, "cost1_min": 258.2371987351721, "system_level_velocity_min": 9.619130314380548}, "episodes_total": 1285, "timesteps_this_iter": 113172, "episodes_this_iter": 59, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 25, "timesteps_total": 2947684, "date": "2019-04-28_08-07-36", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 2947684, "load_time_ms": 15.174, "grad_time_ms": 24116.593, "update_time_ms": 11.309, "num_steps_trained": 2947684, "default": {"total_loss": 23.35237693786621, "kl": 0.011014421470463276, "entropy": 1.1629890203475952, "vf_loss": 23.35334587097168, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6099873781204224, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0011067010927945375}, "sample_time_ms": 14747.554}, "episode_reward_mean": 909.7696049854369, "pid": 551, "time_total_s": 995.1707327365875, "node_ip": "10.138.0.2", "timestamp": 1556438856, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c940>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c588>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 26, "time_since_restore": 1033.6151645183563, "episode_reward_max": 962.2344165951263, "policy_reward_mean": {}, "timesteps_since_restore": 3060772, "episode_len_mean": 700.0, "episode_reward_min": 784.2077889465415, "hostname": "flow-main", "time_this_iter_s": 38.4444317817688, "custom_metrics": {"cost2_mean": -26.39824329205814, "system_level_velocity_max": 13.457055774733409, "cost2_max": -22.07022737519893, "outflow_rate_max": 1009.4209269773994, "cost2_min": -37.15295308246451, "cost1_mean": 330.14958422971836, "system_level_velocity_mean": 12.296020910260989, "outflow_rate_min": 841.2295864068016, "cost1_max": 359.76032477019555, "outflow_rate_mean": 958.3269619981995, "cost1_min": 263.0360764752696, "system_level_velocity_min": 9.75793529669046}, "episodes_total": 1339, "timesteps_this_iter": 113088, "episodes_this_iter": 54, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 26, "timesteps_total": 3060772, "date": "2019-04-28_08-08-14", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3060772, "load_time_ms": 14.729, "grad_time_ms": 24026.833, "update_time_ms": 11.387, "num_steps_trained": 3060772, "default": {"total_loss": 20.18203353881836, "kl": 0.008948990143835545, "entropy": 1.1740169525146484, "vf_loss": 20.183208465576172, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6624618172645569, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.0012882412411272526}, "sample_time_ms": 14755.453}, "episode_reward_mean": 912.0462472488409, "pid": 551, "time_total_s": 1033.6151645183563, "node_ip": "10.138.0.2", "timestamp": 1556438894, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c3c8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c748>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 27, "time_since_restore": 1070.827918291092, "episode_reward_max": 964.4578742258981, "policy_reward_mean": {}, "timesteps_since_restore": 3175011, "episode_len_mean": 700.0, "episode_reward_min": 784.2077889465415, "hostname": "flow-main", "time_this_iter_s": 37.212753772735596, "custom_metrics": {"cost2_mean": -25.94676481531079, "system_level_velocity_max": 13.498814301984769, "cost2_max": -22.48053484171508, "outflow_rate_max": 1010.0711678386933, "cost2_min": -32.292194834068376, "cost1_mean": 327.74449367617694, "system_level_velocity_mean": 12.209408556780705, "outflow_rate_min": 845.1296291588197, "cost1_max": 360.6383235964491, "outflow_rate_mean": 954.5821365622083, "cost1_min": 259.35653584216413, "system_level_velocity_min": 9.58926335911129}, "episodes_total": 1390, "timesteps_this_iter": 114239, "episodes_this_iter": 51, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 27, "timesteps_total": 3175011, "date": "2019-04-28_08-08-52", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3175011, "load_time_ms": 14.556, "grad_time_ms": 23891.596, "update_time_ms": 11.632, "num_steps_trained": 3175011, "default": {"total_loss": 20.1852970123291, "kl": 0.008192299865186214, "entropy": 1.1513477563858032, "vf_loss": 20.185684204101562, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.700989842414856, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.00048655353020876646}, "sample_time_ms": 14814.512}, "episode_reward_mean": 907.9740095556746, "pid": 551, "time_total_s": 1070.827918291092, "node_ip": "10.138.0.2", "timestamp": 1556438932, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f748>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f710>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 28, "time_since_restore": 1109.1990585327148, "episode_reward_max": 976.9195826648819, "policy_reward_mean": {}, "timesteps_since_restore": 3290435, "episode_len_mean": 700.0, "episode_reward_min": 789.987950540136, "hostname": "flow-main", "time_this_iter_s": 38.371140241622925, "custom_metrics": {"cost2_mean": -27.128698156093584, "system_level_velocity_max": 13.795944958757936, "cost2_max": -22.676563391035998, "outflow_rate_max": 1030.2134647323912, "cost2_min": -33.987645148734885, "cost1_mean": 322.14176548627506, "system_level_velocity_mean": 11.985716226702516, "outflow_rate_min": 826.1298882557452, "cost1_max": 368.26316720983266, "outflow_rate_mean": 949.5141670297355, "cost1_min": 245.18374655557741, "system_level_velocity_min": 9.195021667306698}, "episodes_total": 1446, "timesteps_this_iter": 115424, "episodes_this_iter": 56, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 28, "timesteps_total": 3290435, "date": "2019-04-28_08-09-30", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3290435, "load_time_ms": 14.791, "grad_time_ms": 23773.092, "update_time_ms": 11.671, "num_steps_trained": 3290435, "default": {"total_loss": 21.968605041503906, "kl": 0.008892129175364971, "entropy": 1.1415027379989624, "vf_loss": 21.969200134277344, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6948608160018921, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.0007079437491483986}, "sample_time_ms": 14976.67}, "episode_reward_mean": 910.2345959875552, "pid": 551, "time_total_s": 1109.1990585327148, "node_ip": "10.138.0.2", "timestamp": 1556438970, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c470>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c518>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 29, "time_since_restore": 1147.7959101200104, "episode_reward_max": 977.1052287000889, "policy_reward_mean": {}, "timesteps_since_restore": 3404497, "episode_len_mean": 693.4, "episode_reward_min": 56.90825207669658, "hostname": "flow-main", "time_this_iter_s": 38.59685158729553, "custom_metrics": {"cost2_mean": -27.301450036909912, "system_level_velocity_max": 17.82998603637831, "cost2_max": -12.797745582731213, "outflow_rate_max": 1033.8552730186793, "cost2_min": -35.08683598414795, "cost1_mean": 319.1912251625692, "system_level_velocity_mean": 12.052361753572265, "outflow_rate_min": 507.01602474218834, "cost1_max": 368.26316720983266, "outflow_rate_mean": 946.5226104457979, "cost1_min": 25.44864247922496, "system_level_velocity_min": 9.195021667306698}, "episodes_total": 1498, "timesteps_this_iter": 114062, "episodes_this_iter": 52, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 29, "timesteps_total": 3404497, "date": "2019-04-28_08-10-09", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3404497, "load_time_ms": 14.672, "grad_time_ms": 23727.075, "update_time_ms": 11.817, "num_steps_trained": 3404497, "default": {"total_loss": 20.037904739379883, "kl": 0.010409949347376823, "entropy": 1.1121538877487183, "vf_loss": 20.038347244262695, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7377605438232422, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.00057342549553141}, "sample_time_ms": 15127.444}, "episode_reward_mean": 901.3915690312447, "pid": 551, "time_total_s": 1147.7959101200104, "node_ip": "10.138.0.2", "timestamp": 1556439009, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fa20>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fcf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fc18>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 30, "time_since_restore": 1187.6244761943817, "episode_reward_max": 982.0027294575088, "policy_reward_mean": {}, "timesteps_since_restore": 3519314, "episode_len_mean": 693.4, "episode_reward_min": 56.90825207669658, "hostname": "flow-main", "time_this_iter_s": 39.82856607437134, "custom_metrics": {"cost2_mean": -26.42098134951483, "system_level_velocity_max": 17.82998603637831, "cost2_max": -12.797745582731213, "outflow_rate_max": 1033.8552730186793, "cost2_min": -38.63018212377321, "cost1_mean": 320.9446802624869, "system_level_velocity_mean": 12.115490248214329, "outflow_rate_min": 507.01602474218834, "cost1_max": 367.7162551655898, "outflow_rate_mean": 947.4234425326388, "cost1_min": 25.44864247922496, "system_level_velocity_min": 9.45347619075288}, "episodes_total": 1558, "timesteps_this_iter": 114817, "episodes_this_iter": 60, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 30, "timesteps_total": 3519314, "date": "2019-04-28_08-10-48", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3519314, "load_time_ms": 14.374, "grad_time_ms": 23719.829, "update_time_ms": 11.938, "num_steps_trained": 3519314, "default": {"total_loss": 22.01658058166504, "kl": 0.008613241836428642, "entropy": 1.1171208620071411, "vf_loss": 22.017620086669922, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7434354424476624, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0011452368926256895}, "sample_time_ms": 15226.567}, "episode_reward_mean": 901.864543545684, "pid": 551, "time_total_s": 1187.6244761943817, "node_ip": "10.138.0.2", "timestamp": 1556439048, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f0b8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984710>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 31, "time_since_restore": 1226.5770175457, "episode_reward_max": 989.19928310546, "policy_reward_mean": {}, "timesteps_since_restore": 3633093, "episode_len_mean": 700.0, "episode_reward_min": 797.6182636190521, "hostname": "flow-main", "time_this_iter_s": 38.95254135131836, "custom_metrics": {"cost2_mean": -27.1128723633866, "system_level_velocity_max": 13.98776472394366, "cost2_max": -22.833800650717798, "outflow_rate_max": 1031.8979053822322, "cost2_min": -38.63018212377321, "cost1_mean": 330.89723864989327, "system_level_velocity_mean": 12.312897108579087, "outflow_rate_min": 831.7823504833726, "cost1_max": 375.0657394745954, "outflow_rate_mean": 961.046379276491, "cost1_min": 258.9016494367223, "system_level_velocity_min": 9.686743230943922}, "episodes_total": 1609, "timesteps_this_iter": 113779, "episodes_this_iter": 51, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 31, "timesteps_total": 3633093, "date": "2019-04-28_08-11-27", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3633093, "load_time_ms": 14.103, "grad_time_ms": 23613.806, "update_time_ms": 11.872, "num_steps_trained": 3633093, "default": {"total_loss": 21.15741539001465, "kl": 0.009100922383368015, "entropy": 1.1030445098876953, "vf_loss": 21.15814208984375, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7571237087249756, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.0008402677485719323}, "sample_time_ms": 15064.85}, "episode_reward_mean": 921.4906531946093, "pid": 551, "time_total_s": 1226.5770175457, "node_ip": "10.138.0.2", "timestamp": 1556439087, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f400>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f5f8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 32, "time_since_restore": 1267.1798493862152, "episode_reward_max": 1004.5809595672865, "policy_reward_mean": {}, "timesteps_since_restore": 3745805, "episode_len_mean": 700.0, "episode_reward_min": 796.60894692935, "hostname": "flow-main", "time_this_iter_s": 40.60283184051514, "custom_metrics": {"cost2_mean": -28.420865845174184, "system_level_velocity_max": 14.572231236642724, "cost2_max": -22.43852106328853, "outflow_rate_max": 1048.49053619812, "cost2_min": -41.05898939561447, "cost1_mean": 337.9728547713192, "system_level_velocity_mean": 12.575899160693847, "outflow_rate_min": 845.0052138965665, "cost1_max": 390.5904310417616, "outflow_rate_mean": 970.5095639129089, "cost1_min": 262.79795639759516, "system_level_velocity_min": 9.816021987264692}, "episodes_total": 1672, "timesteps_this_iter": 112712, "episodes_this_iter": 63, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 32, "timesteps_total": 3745805, "date": "2019-04-28_08-12-08", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3745805, "load_time_ms": 14.0, "grad_time_ms": 23738.086, "update_time_ms": 11.896, "num_steps_trained": 3745805, "default": {"total_loss": 26.029396057128906, "kl": 0.009726409800350666, "entropy": 1.0858300924301147, "vf_loss": 26.030370712280273, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7093175649642944, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0010976794874295592}, "sample_time_ms": 15150.018}, "episode_reward_mean": 931.1510361014708, "pid": 551, "time_total_s": 1267.1798493862152, "node_ip": "10.138.0.2", "timestamp": 1556439128, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fac8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f9b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 33, "time_since_restore": 1306.5675556659698, "episode_reward_max": 1012.3441321757555, "policy_reward_mean": {}, "timesteps_since_restore": 3857845, "episode_len_mean": 693.35, "episode_reward_min": 49.564128828798765, "hostname": "flow-main", "time_this_iter_s": 39.38770627975464, "custom_metrics": {"cost2_mean": -28.428299289971566, "system_level_velocity_max": 17.809999106370217, "cost2_max": -13.131989307962062, "outflow_rate_max": 1048.49053619812, "cost2_min": -41.05898939561447, "cost1_mean": 342.2183793296078, "system_level_velocity_mean": 12.911267744263212, "outflow_rate_min": 500.3160898688181, "cost1_max": 394.16247380760814, "outflow_rate_mean": 974.2382897334604, "cost1_min": 22.184271709520676, "system_level_velocity_min": 9.816021987264692}, "episodes_total": 1729, "timesteps_this_iter": 112040, "episodes_this_iter": 57, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 33, "timesteps_total": 3857845, "date": "2019-04-28_08-12-47", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3857845, "load_time_ms": 13.951, "grad_time_ms": 23651.455, "update_time_ms": 11.788, "num_steps_trained": 3857845, "default": {"total_loss": 25.588045120239258, "kl": 0.010069066658616066, "entropy": 1.077280044555664, "vf_loss": 25.5889949798584, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7075257301330566, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0010770835215225816}, "sample_time_ms": 15077.63}, "episode_reward_mean": 926.8293464512035, "pid": 551, "time_total_s": 1306.5675556659698, "node_ip": "10.138.0.2", "timestamp": 1556439167, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f908>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f7b8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 34, "time_since_restore": 1344.2572157382965, "episode_reward_max": 1012.3441321757555, "policy_reward_mean": {}, "timesteps_since_restore": 3970098, "episode_len_mean": 686.73, "episode_reward_min": 49.564128828798765, "hostname": "flow-main", "time_this_iter_s": 37.68966007232666, "custom_metrics": {"cost2_mean": -28.472265547873416, "system_level_velocity_max": 17.809999106370217, "cost2_max": -12.414070992484145, "outflow_rate_max": 1043.1606594281732, "cost2_min": -46.66258494217507, "cost1_mean": 340.6978427979006, "system_level_velocity_mean": 13.006540673574646, "outflow_rate_min": 485.2782780211436, "cost1_max": 395.49825400786756, "outflow_rate_mean": 967.956514897028, "cost1_min": 22.184271709520676, "system_level_velocity_min": 9.79186286169852}, "episodes_total": 1791, "timesteps_this_iter": 112253, "episodes_this_iter": 62, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 34, "timesteps_total": 3970098, "date": "2019-04-28_08-13-25", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 3970098, "load_time_ms": 13.624, "grad_time_ms": 23453.864, "update_time_ms": 11.844, "num_steps_trained": 3970098, "default": {"total_loss": 26.051286697387695, "kl": 0.010298280045390129, "entropy": 1.0495009422302246, "vf_loss": 26.0521183013916, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6922140121459961, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0009592431597411633}, "sample_time_ms": 15101.892}, "episode_reward_mean": 920.4898095521723, "pid": 551, "time_total_s": 1344.2572157382965, "node_ip": "10.138.0.2", "timestamp": 1556439205, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999ff98>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f0b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f9b0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 35, "time_since_restore": 1381.901995897293, "episode_reward_max": 1007.8750097744912, "policy_reward_mean": {}, "timesteps_since_restore": 4081327, "episode_len_mean": 693.38, "episode_reward_min": 56.37291882737505, "hostname": "flow-main", "time_this_iter_s": 37.64478015899658, "custom_metrics": {"cost2_mean": -27.005877662989743, "system_level_velocity_max": 17.83108644018094, "cost2_max": -13.875212554006398, "outflow_rate_max": 1037.2993662847023, "cost2_min": -44.67808897914554, "cost1_mean": 344.98044898252317, "system_level_velocity_mean": 13.011432164449468, "outflow_rate_min": 483.8459559548968, "cost1_max": 395.5972031062197, "outflow_rate_mean": 969.3623742821379, "cost1_min": 24.140643360053907, "system_level_velocity_min": 10.446489250956594}, "episodes_total": 1852, "timesteps_this_iter": 111229, "episodes_this_iter": 61, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 35, "timesteps_total": 4081327, "date": "2019-04-28_08-14-03", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4081327, "load_time_ms": 13.453, "grad_time_ms": 23339.168, "update_time_ms": 11.958, "num_steps_trained": 4081327, "default": {"total_loss": 26.062942504882812, "kl": 0.010059253312647343, "entropy": 1.0353803634643555, "vf_loss": 26.063461303710938, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6655609607696533, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0006442013545893133}, "sample_time_ms": 15092.574}, "episode_reward_mean": 926.7061010026081, "pid": 551, "time_total_s": 1381.901995897293, "node_ip": "10.138.0.2", "timestamp": 1556439243, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f470>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f438>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 36, "time_since_restore": 1419.4205536842346, "episode_reward_max": 1007.8750097744912, "policy_reward_mean": {}, "timesteps_since_restore": 4191756, "episode_len_mean": 693.38, "episode_reward_min": 56.37291882737505, "hostname": "flow-main", "time_this_iter_s": 37.51855778694153, "custom_metrics": {"cost2_mean": -24.5741798071023, "system_level_velocity_max": 17.83108644018094, "cost2_max": -13.875212554006398, "outflow_rate_max": 1048.0804196955655, "cost2_min": -33.32026910436855, "cost1_mean": 353.12698628787774, "system_level_velocity_mean": 13.35541199796712, "outflow_rate_min": 483.8459559548968, "cost1_max": 400.8438431426054, "outflow_rate_mean": 975.2897300638073, "cost1_min": 24.140643360053907, "system_level_velocity_min": 10.680519752108436}, "episodes_total": 1912, "timesteps_this_iter": 110429, "episodes_this_iter": 60, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 36, "timesteps_total": 4191756, "date": "2019-04-28_08-14-40", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4191756, "load_time_ms": 13.573, "grad_time_ms": 23274.366, "update_time_ms": 11.996, "num_steps_trained": 4191756, "default": {"total_loss": 27.925819396972656, "kl": 0.009279219433665276, "entropy": 1.0160647630691528, "vf_loss": 27.926692962646484, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6638014912605286, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0009887628257274628}, "sample_time_ms": 15062.185}, "episode_reward_mean": 925.9375131550071, "pid": 551, "time_total_s": 1419.4205536842346, "node_ip": "10.138.0.2", "timestamp": 1556439280, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fb38>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fda0>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 37, "time_since_restore": 1459.0702335834503, "episode_reward_max": 1008.5896777208009, "policy_reward_mean": {}, "timesteps_since_restore": 4302863, "episode_len_mean": 700.0, "episode_reward_min": 866.1819562316402, "hostname": "flow-main", "time_this_iter_s": 39.6496798992157, "custom_metrics": {"cost2_mean": -24.78539349254414, "system_level_velocity_max": 15.76543329659272, "cost2_max": -19.464828901447177, "outflow_rate_max": 1058.3933584224962, "cost2_min": -37.56729886570974, "cost1_mean": 361.7654507739489, "system_level_velocity_mean": 13.510572241496163, "outflow_rate_min": 898.6729470340999, "cost1_max": 418.39635315405224, "outflow_rate_mean": 985.1495793020662, "cost1_min": 299.9150674576558, "system_level_velocity_min": 11.2295652847601}, "episodes_total": 1972, "timesteps_this_iter": 111107, "episodes_this_iter": 60, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 37, "timesteps_total": 4302863, "date": "2019-04-28_08-15-20", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4302863, "load_time_ms": 13.354, "grad_time_ms": 23499.824, "update_time_ms": 11.836, "num_steps_trained": 4302863, "default": {"total_loss": 29.535930633544922, "kl": 0.01086485106498003, "entropy": 1.0254194736480713, "vf_loss": 29.537147521972656, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6487945914268494, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0013545315014198422}, "sample_time_ms": 15081.379}, "episode_reward_mean": 941.0250302404513, "pid": 551, "time_total_s": 1459.0702335834503, "node_ip": "10.138.0.2", "timestamp": 1556439320, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f470>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999ff60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f278>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 38, "time_since_restore": 1497.948462486267, "episode_reward_max": 1008.5896777208009, "policy_reward_mean": {}, "timesteps_since_restore": 4414593, "episode_len_mean": 693.27, "episode_reward_min": 41.34964261665614, "hostname": "flow-main", "time_this_iter_s": 38.87822890281677, "custom_metrics": {"cost2_mean": -25.423604413863504, "system_level_velocity_max": 17.263010796460343, "cost2_max": -13.03175393496544, "outflow_rate_max": 1058.3933584224962, "cost2_min": -37.56729886570974, "cost1_mean": 356.60968277388963, "system_level_velocity_mean": 13.484428001647569, "outflow_rate_min": 476.16837092108835, "cost1_max": 418.39635315405224, "outflow_rate_mean": 980.3781652188951, "cost1_min": 17.615183369695327, "system_level_velocity_min": 10.557836664626027}, "episodes_total": 2028, "timesteps_this_iter": 111730, "episodes_this_iter": 56, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 38, "timesteps_total": 4414593, "date": "2019-04-28_08-15-59", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4414593, "load_time_ms": 13.166, "grad_time_ms": 23616.628, "update_time_ms": 11.849, "num_steps_trained": 4414593, "default": {"total_loss": 27.53252601623535, "kl": 0.009598112665116787, "entropy": 1.0173702239990234, "vf_loss": 27.533096313476562, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.6926126480102539, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0006900900043547153}, "sample_time_ms": 15013.634}, "episode_reward_mean": 932.8092190110859, "pid": 551, "time_total_s": 1497.948462486267, "node_ip": "10.138.0.2", "timestamp": 1556439359, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984ac8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984f28>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 39, "time_since_restore": 1537.0885117053986, "episode_reward_max": 1040.574747284708, "policy_reward_mean": {}, "timesteps_since_restore": 4526717, "episode_len_mean": 693.27, "episode_reward_min": 41.34964261665614, "hostname": "flow-main", "time_this_iter_s": 39.14004921913147, "custom_metrics": {"cost2_mean": -25.895860921814673, "system_level_velocity_max": 17.263010796460343, "cost2_max": -13.03175393496544, "outflow_rate_max": 1076.4607585536403, "cost2_min": -36.14364905629808, "cost1_mean": 352.68507696401196, "system_level_velocity_mean": 13.321579789045625, "outflow_rate_min": 476.16837092108835, "cost1_max": 423.9236937682566, "outflow_rate_mean": 981.9018830770808, "cost1_min": 17.615183369695327, "system_level_velocity_min": 10.557836664626027}, "episodes_total": 2085, "timesteps_this_iter": 112124, "episodes_this_iter": 57, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 39, "timesteps_total": 4526717, "date": "2019-04-28_08-16-38", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4526717, "load_time_ms": 13.205, "grad_time_ms": 23721.037, "update_time_ms": 11.631, "num_steps_trained": 4526717, "default": {"total_loss": 27.286375045776367, "kl": 0.01151272188872099, "entropy": 1.023293375968933, "vf_loss": 27.286640167236328, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7230570316314697, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0004063784726895392}, "sample_time_ms": 14961.123}, "episode_reward_mean": 936.7227453945925, "pid": 551, "time_total_s": 1537.0885117053986, "node_ip": "10.138.0.2", "timestamp": 1556439398, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999ff60>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fc50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f860>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 40, "time_since_restore": 1575.9887578487396, "episode_reward_max": 1040.574747284708, "policy_reward_mean": {}, "timesteps_since_restore": 4638800, "episode_len_mean": 700.0, "episode_reward_min": 876.7760894596038, "hostname": "flow-main", "time_this_iter_s": 38.900246143341064, "custom_metrics": {"cost2_mean": -25.87272217348792, "system_level_velocity_max": 15.985080138618809, "cost2_max": -20.17054243296269, "outflow_rate_max": 1076.4607585536403, "cost2_min": -39.22275505241883, "cost1_mean": 358.30695725942894, "system_level_velocity_mean": 13.366693112266738, "outflow_rate_min": 903.7389107364862, "cost1_max": 423.9236937682566, "outflow_rate_mean": 994.244657793123, "cost1_min": 284.1395297515262, "system_level_velocity_min": 10.419578231079894}, "episodes_total": 2141, "timesteps_this_iter": 112083, "episodes_this_iter": 56, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 40, "timesteps_total": 4638800, "date": "2019-04-28_08-17-17", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4638800, "load_time_ms": 12.385, "grad_time_ms": 23680.556, "update_time_ms": 11.703, "num_steps_trained": 4638800, "default": {"total_loss": 26.895191192626953, "kl": 0.009857621975243092, "entropy": 1.016168475151062, "vf_loss": 26.89575958251953, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7449173927307129, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0006918807048350573}, "sample_time_ms": 14908.666}, "episode_reward_mean": 952.1770078645974, "pid": 551, "time_total_s": 1575.9887578487396, "node_ip": "10.138.0.2", "timestamp": 1556439437, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c3c8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999cfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c160>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 41, "time_since_restore": 1613.2944893836975, "episode_reward_max": 1035.1451326702554, "policy_reward_mean": {}, "timesteps_since_restore": 4751225, "episode_len_mean": 693.37, "episode_reward_min": 55.354276588413825, "hostname": "flow-main", "time_this_iter_s": 37.305731534957886, "custom_metrics": {"cost2_mean": -25.58854372597755, "system_level_velocity_max": 18.117736658920645, "cost2_max": -11.984850155663285, "outflow_rate_max": 1074.7959390263584, "cost2_min": -39.34811103570118, "cost1_mean": 353.09130135181044, "system_level_velocity_mean": 13.348472885168901, "outflow_rate_min": 491.97888356820476, "cost1_max": 414.65465843844424, "outflow_rate_mean": 985.0614046255135, "cost1_min": 23.690783249121168, "system_level_velocity_min": 10.124624697913324}, "episodes_total": 2201, "timesteps_this_iter": 112425, "episodes_this_iter": 60, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 41, "timesteps_total": 4751225, "date": "2019-04-28_08-17-54", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4751225, "load_time_ms": 12.379, "grad_time_ms": 23511.837, "update_time_ms": 11.528, "num_steps_trained": 4751225, "default": {"total_loss": 29.90653419494629, "kl": 0.010827303864061832, "entropy": 1.0115379095077515, "vf_loss": 29.907167434692383, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7165926098823547, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0007649172912351787}, "sample_time_ms": 14909.089}, "episode_reward_mean": 940.6261479539243, "pid": 551, "time_total_s": 1613.2944893836975, "node_ip": "10.138.0.2", "timestamp": 1556439474, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fef0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f550>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 42, "time_since_restore": 1650.2342536449432, "episode_reward_max": 1033.26678435196, "policy_reward_mean": {}, "timesteps_since_restore": 4862578, "episode_len_mean": 693.37, "episode_reward_min": 55.354276588413825, "hostname": "flow-main", "time_this_iter_s": 36.93976426124573, "custom_metrics": {"cost2_mean": -26.592072527379642, "system_level_velocity_max": 18.117736658920645, "cost2_max": -11.984850155663285, "outflow_rate_max": 1071.000386546791, "cost2_min": -39.96128423484295, "cost1_mean": 353.5039969853531, "system_level_velocity_mean": 13.358579577756885, "outflow_rate_min": 491.97888356820476, "cost1_max": 415.8783413288462, "outflow_rate_mean": 983.3642811910012, "cost1_min": 23.690783249121168, "system_level_velocity_min": 10.124624697913324}, "episodes_total": 2261, "timesteps_this_iter": 111353, "episodes_this_iter": 60, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 42, "timesteps_total": 4862578, "date": "2019-04-28_08-18-31", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4862578, "load_time_ms": 12.293, "grad_time_ms": 23257.524, "update_time_ms": 11.628, "num_steps_trained": 4862578, "default": {"total_loss": 28.608858108520508, "kl": 0.010310579091310501, "entropy": 0.9966604113578796, "vf_loss": 28.609577178955078, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.7191757559776306, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0008496766095049679}, "sample_time_ms": 14796.957}, "episode_reward_mean": 934.8137030768298, "pid": 551, "time_total_s": 1650.2342536449432, "node_ip": "10.138.0.2", "timestamp": 1556439511, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c518>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c6d8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 43, "time_since_restore": 1688.065195798874, "episode_reward_max": 1004.541000146769, "policy_reward_mean": {}, "timesteps_since_restore": 4971336, "episode_len_mean": 693.35, "episode_reward_min": 51.49006723222557, "hostname": "flow-main", "time_this_iter_s": 37.830942153930664, "custom_metrics": {"cost2_mean": -26.908687553621125, "system_level_velocity_max": 17.927588548948787, "cost2_max": -13.762137380723138, "outflow_rate_max": 1057.9768639685828, "cost2_min": -39.96128423484295, "cost1_mean": 367.0180409267174, "system_level_velocity_mean": 13.893577913454767, "outflow_rate_min": 485.23085063479124, "cost1_max": 416.9152510951481, "outflow_rate_mean": 992.9501837019873, "cost1_min": 22.33651845409213, "system_level_velocity_min": 10.219299225379332}, "episodes_total": 2324, "timesteps_this_iter": 108758, "episodes_this_iter": 63, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 43, "timesteps_total": 4971336, "date": "2019-04-28_08-19-09", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 4971336, "load_time_ms": 12.042, "grad_time_ms": 23112.7, "update_time_ms": 11.744, "num_steps_trained": 4971336, "default": {"total_loss": 37.732906341552734, "kl": 0.01178418193012476, "entropy": 0.9655001759529114, "vf_loss": 37.73398971557617, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.48027291893959045, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0012301295064389706}, "sample_time_ms": 14787.651}, "episode_reward_mean": 940.0094985635124, "pid": 551, "time_total_s": 1688.065195798874, "node_ip": "10.138.0.2", "timestamp": 1556439549, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984630>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984eb8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 44, "time_since_restore": 1725.4934830665588, "episode_reward_max": 1004.541000146769, "policy_reward_mean": {}, "timesteps_since_restore": 5079926, "episode_len_mean": 700.0, "episode_reward_min": 881.8088905050907, "hostname": "flow-main", "time_this_iter_s": 37.42828726768494, "custom_metrics": {"cost2_mean": -28.443920526665387, "system_level_velocity_max": 15.760816968774517, "cost2_max": -20.820492155165972, "outflow_rate_max": 1055.5317732203603, "cost2_min": -48.520423957031355, "cost1_mean": 375.60927356792155, "system_level_velocity_mean": 14.07387641903867, "outflow_rate_min": 908.7952429489635, "cost1_max": 416.9152510951481, "outflow_rate_mean": 997.0718147296491, "cost1_min": 289.9038022529255, "system_level_velocity_min": 10.655024761135483}, "episodes_total": 2384, "timesteps_this_iter": 108590, "episodes_this_iter": 60, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 44, "timesteps_total": 5079926, "date": "2019-04-28_08-19-47", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5079926, "load_time_ms": 12.173, "grad_time_ms": 23141.707, "update_time_ms": 11.605, "num_steps_trained": 5079926, "default": {"total_loss": 34.03937530517578, "kl": 0.013812500052154064, "entropy": 0.9495208859443665, "vf_loss": 34.040733337402344, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.49678805470466614, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0015316939679905772}, "sample_time_ms": 14733.369}, "episode_reward_mean": 948.2197423672376, "pid": 551, "time_total_s": 1725.4934830665588, "node_ip": "10.138.0.2", "timestamp": 1556439587, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fbe0>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fa58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f4a8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 45, "time_since_restore": 1764.3894340991974, "episode_reward_max": 974.7259976460953, "policy_reward_mean": {}, "timesteps_since_restore": 5187792, "episode_len_mean": 689.34, "episode_reward_min": 52.34573455077314, "hostname": "flow-main", "time_this_iter_s": 38.89595103263855, "custom_metrics": {"cost2_mean": -28.425794461794077, "system_level_velocity_max": 18.25494248260562, "cost2_max": -13.286064371455149, "outflow_rate_max": 1054.7504818108885, "cost2_min": -55.434537676329526, "cost1_mean": 374.339933366817, "system_level_velocity_mean": 14.345574305419643, "outflow_rate_min": 509.17963376796814, "cost1_max": 418.616821240759, "outflow_rate_mean": 988.6968330511176, "cost1_min": 23.812109523257824, "system_level_velocity_min": 11.963290658517726}, "episodes_total": 2446, "timesteps_this_iter": 107866, "episodes_this_iter": 62, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 45, "timesteps_total": 5187792, "date": "2019-04-28_08-20-26", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5187792, "load_time_ms": 12.159, "grad_time_ms": 23216.37, "update_time_ms": 11.511, "num_steps_trained": 5187792, "default": {"total_loss": 35.42039489746094, "kl": 0.013500283472239971, "entropy": 0.91595458984375, "vf_loss": 35.421260833740234, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4905931055545807, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0010363336186856031}, "sample_time_ms": 14784.173}, "episode_reward_mean": 924.5680014788937, "pid": 551, "time_total_s": 1764.3894340991974, "node_ip": "10.138.0.2", "timestamp": 1556439626, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fdd8>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999fb00>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 46, "time_since_restore": 1802.317630290985, "episode_reward_max": 963.7270211442476, "policy_reward_mean": {}, "timesteps_since_restore": 5295816, "episode_len_mean": 691.94, "episode_reward_min": 405.8731166086899, "hostname": "flow-main", "time_this_iter_s": 37.92819619178772, "custom_metrics": {"cost2_mean": -27.669041706483558, "system_level_velocity_max": 16.26570955631206, "cost2_max": -18.603516413647323, "outflow_rate_max": 1039.2315631814897, "cost2_min": -55.434537676329526, "cost1_mean": 373.2675195803793, "system_level_velocity_mean": 14.242850231886802, "outflow_rate_min": 815.4133133243174, "cost1_max": 411.3130320775822, "outflow_rate_mean": 982.5867573350521, "cost1_min": 173.952901609378, "system_level_velocity_min": 11.329170145083902}, "episodes_total": 2506, "timesteps_this_iter": 108024, "episodes_this_iter": 60, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 46, "timesteps_total": 5295816, "date": "2019-04-28_08-21-04", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5295816, "load_time_ms": 12.216, "grad_time_ms": 23229.277, "update_time_ms": 11.409, "num_steps_trained": 5295816, "default": {"total_loss": 35.94611740112305, "kl": 0.0139236468821764, "entropy": 0.9102206230163574, "vf_loss": 35.947120666503906, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.46506544947624207, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.0011779253836721182}, "sample_time_ms": 14811.658}, "episode_reward_mean": 914.984593967466, "pid": 551, "time_total_s": 1802.317630290985, "node_ip": "10.138.0.2", "timestamp": 1556439664, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f780>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f278>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 47, "time_since_restore": 1839.886305809021, "episode_reward_max": 966.8274717039246, "policy_reward_mean": {}, "timesteps_since_restore": 5403120, "episode_len_mean": 695.97, "episode_reward_min": 406.27315506857974, "hostname": "flow-main", "time_this_iter_s": 37.56867551803589, "custom_metrics": {"cost2_mean": -28.421378495920177, "system_level_velocity_max": 15.668751109741676, "cost2_max": -18.655633209800193, "outflow_rate_max": 1033.925957881517, "cost2_min": -46.19530402875478, "cost1_mean": 371.68867762609966, "system_level_velocity_mean": 14.096917427603818, "outflow_rate_min": 815.4133133243174, "cost1_max": 411.3130320775822, "outflow_rate_mean": 976.3494484969741, "cost1_min": 173.952901609378, "system_level_velocity_min": 11.329170145083902}, "episodes_total": 2568, "timesteps_this_iter": 107304, "episodes_this_iter": 62, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 47, "timesteps_total": 5403120, "date": "2019-04-28_08-21-41", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5403120, "load_time_ms": 12.632, "grad_time_ms": 23047.903, "update_time_ms": 11.385, "num_steps_trained": 5403120, "default": {"total_loss": 37.902320861816406, "kl": 0.012263800017535686, "entropy": 0.8996542692184448, "vf_loss": 37.90291976928711, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4553838074207306, "cur_kl_coeff": 0.012500002980232239, "policy_loss": -0.0007469813572242856}, "sample_time_ms": 14787.861}, "episode_reward_mean": 912.7982918171706, "pid": 551, "time_total_s": 1839.886305809021, "node_ip": "10.138.0.2", "timestamp": 1556439701, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984a90>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e99845f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984cf8>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 48, "time_since_restore": 1877.361085653305, "episode_reward_max": 964.5701540444708, "policy_reward_mean": {}, "timesteps_since_restore": 5509968, "episode_len_mean": 700.0, "episode_reward_min": 836.8964465545938, "hostname": "flow-main", "time_this_iter_s": 37.47477984428406, "custom_metrics": {"cost2_mean": -29.66456239475435, "system_level_velocity_max": 15.772037322178637, "cost2_max": -20.695299962277502, "outflow_rate_max": 1033.925957881517, "cost2_min": -65.18391688810887, "cost1_mean": 377.06672667836335, "system_level_velocity_mean": 14.239294829728262, "outflow_rate_min": 855.9032587950322, "cost1_max": 414.02870239377296, "outflow_rate_mean": 979.8787524259055, "cost1_min": 273.81777910071685, "system_level_velocity_min": 10.201022560297972}, "episodes_total": 2629, "timesteps_this_iter": 106848, "episodes_this_iter": 61, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 48, "timesteps_total": 5509968, "date": "2019-04-28_08-22-19", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5509968, "load_time_ms": 12.74, "grad_time_ms": 22877.702, "update_time_ms": 11.305, "num_steps_trained": 5509968, "default": {"total_loss": 36.49497985839844, "kl": 0.014639568515121937, "entropy": 0.8909747004508972, "vf_loss": 36.495079040527344, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.5408194661140442, "cur_kl_coeff": 0.01250000111758709, "policy_loss": -0.0002824845723807812}, "sample_time_ms": 14817.228}, "episode_reward_mean": 913.2416617608376, "pid": 551, "time_total_s": 1877.361085653305, "node_ip": "10.138.0.2", "timestamp": 1556439739, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f710>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f908>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 49, "time_since_restore": 1913.1219065189362, "episode_reward_max": 977.4444676961743, "policy_reward_mean": {}, "timesteps_since_restore": 5616471, "episode_len_mean": 696.87, "episode_reward_min": 498.0124405054572, "hostname": "flow-main", "time_this_iter_s": 35.7608208656311, "custom_metrics": {"cost2_mean": -30.235960694380694, "system_level_velocity_max": 16.04808329652738, "cost2_max": -21.043094176882036, "outflow_rate_max": 1060.4980635437964, "cost2_min": -65.18391688810887, "cost1_mean": 378.45838371637643, "system_level_velocity_mean": 14.386670361990143, "outflow_rate_min": 800.627608462098, "cost1_max": 417.7759015457967, "outflow_rate_mean": 982.5434995101612, "cost1_min": 210.09857993052836, "system_level_velocity_min": 10.6153953572286}, "episodes_total": 2692, "timesteps_this_iter": 106503, "episodes_this_iter": 63, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 49, "timesteps_total": 5616471, "date": "2019-04-28_08-22-55", "num_metric_batches_dropped": 0, "done": false, "info": {"num_steps_sampled": 5616471, "load_time_ms": 12.709, "grad_time_ms": 22547.671, "update_time_ms": 11.248, "num_steps_trained": 5616471, "default": {"total_loss": 39.789390563964844, "kl": 0.014282643795013428, "entropy": 0.8757884502410889, "vf_loss": 39.790138244628906, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.45679107308387756, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0009241637890227139}, "sample_time_ms": 14812.163}, "episode_reward_mean": 906.6041399845132, "pid": 551, "time_total_s": 1913.1219065189362, "node_ip": "10.138.0.2", "timestamp": 1556439775, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c828>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e9984908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999c550>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}
{"training_iteration": 50, "time_since_restore": 1949.6877341270447, "episode_reward_max": 977.4444676961743, "policy_reward_mean": {}, "timesteps_since_restore": 5723895, "episode_len_mean": 687.11, "episode_reward_min": 55.36011156186441, "hostname": "flow-main", "time_this_iter_s": 36.56582760810852, "custom_metrics": {"cost2_mean": -29.315295304446114, "system_level_velocity_max": 18.107700680342376, "cost2_max": -11.915023208546591, "outflow_rate_max": 1072.198108270273, "cost2_min": -64.39867447465969, "cost1_mean": 378.7525453450084, "system_level_velocity_mean": 14.664612568193766, "outflow_rate_min": 496.2871102902245, "cost1_max": 422.7383788916693, "outflow_rate_mean": 983.2230557074593, "cost1_min": 23.670221712224645, "system_level_velocity_min": 11.060409830796846}, "episodes_total": 2756, "timesteps_this_iter": 107424, "episodes_this_iter": 64, "experiment_id": "34ad0827bf5d4d809ba9e2e0f5e42413", "iterations_since_restore": 50, "timesteps_total": 5723895, "date": "2019-04-28_08-23-31", "num_metric_batches_dropped": 0, "done": true, "info": {"num_steps_sampled": 5723895, "load_time_ms": 13.274, "grad_time_ms": 22319.968, "update_time_ms": 11.159, "num_steps_trained": 5723895, "default": {"total_loss": 39.2911376953125, "kl": 0.014995912089943886, "entropy": 0.8639876246452332, "vf_loss": 39.29203414916992, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.4905512034893036, "cur_kl_coeff": 0.012500002048909664, "policy_loss": -0.0010803136974573135}, "sample_time_ms": 14805.452}, "episode_reward_mean": 901.5022163118159, "pid": 551, "time_total_s": 1949.6877341270447, "node_ip": "10.138.0.2", "timestamp": 1556439811, "config": {"callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f358>", "on_sample_end": null, "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fa2e999f438>"}, "num_gpus": 0, "batch_mode": "truncate_episodes", "vf_clip_param": 1000000.0, "output_max_file_size": 67108864, "tf_session_args": {"gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "allow_soft_placement": true, "intra_op_parallelism_threads": 2}, "use_gae": true, "collect_metrics_timeout": 180, "sgd_minibatch_size": 128, "multiagent": {"policy_mapping_fn": null, "policies_to_train": null, "policy_graphs": {}}, "num_gpus_per_worker": 0, "num_sgd_iter": 10, "vf_loss_coeff": 1.0, "model": {"conv_activation": "relu", "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "lstm_cell_size": 256, "dim": 84, "custom_options": {}, "zero_mean": true, "framestack": true, "fcnet_hiddens": [100, 50, 25], "channel_major": false, "custom_model": null, "grayscale": false, "free_log_std": false, "fcnet_activation": "tanh", "conv_filters": null, "max_seq_len": 20, "lstm_use_prev_action_reward": false}, "kl_target": 0.01, "gamma": 0.99, "log_level": "INFO", "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "sample_batch_size": 200, "output_compress_columns": ["obs", "new_obs"], "horizon": 1500, "entropy_coeff": 0.0, "num_cpus_for_driver": 1, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:7.0", "output": null, "vf_share_layers": false, "clip_rewards": null, "num_envs_per_worker": 1, "lambda": 0.97, "observation_filter": "NoFilter", "preprocessor_pref": "deepmind", "input_evaluation": null, "clip_param": 0.3, "lr": 0.0005, "num_workers": 60, "input": "sampler", "train_batch_size": 90000, "straggler_mitigation": false, "num_cpus_per_worker": 1, "kl_coeff": 0.2, "clip_actions": false, "compress_observations": false, "optimizer": {}, "lr_schedule": null, "monitor": false, "simple_optimizer": false, "custom_resources_per_worker": {}, "synchronize_filters": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sample_async": false}}

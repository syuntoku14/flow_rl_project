{"time_this_iter_s": 29.249330282211304, "time_since_restore": 29.249330282211304, "timestamp": 1557102021, "episode_reward_mean": 252.8212326639636, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 40256, "timesteps_total": 40256, "done": false, "hostname": "flow-main", "timesteps_since_restore": 40256, "info": {"default": {"entropy": 1.4178155660629272, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8939747214317322, "policy_loss": -0.0034989577252417803, "cur_kl_coeff": 0.20000003278255463, "total_loss": 1.1174923181533813, "kl": 0.004331147763878107, "vf_loss": 1.1201249361038208}, "update_time_ms": 1620.804, "sample_time_ms": 17641.621, "num_steps_trained": 40256, "grad_time_ms": 9787.632, "load_time_ms": 73.321, "num_steps_sampled": 40256}, "training_iteration": 1, "date": "2019-05-06_00-20-21", "episode_reward_min": 230.21857766028648, "episode_len_mean": 700.0, "episode_reward_max": 286.39042870989454, "time_total_s": 29.249330282211304, "custom_metrics": {"cost2_min": 0.0, "system_level_velocity_min": 6.224300031425009, "cost1_mean": 204.6359641659097, "system_level_velocity_max": 8.624583623190288, "cost2_mean": 0.0, "cost2_max": 0.0, "outflow_rate_mean": 597.4073879245977, "system_level_velocity_mean": 7.924174802356926, "cost1_max": 225.27013946834805, "outflow_rate_min": 534.6009185147362, "outflow_rate_max": 690.115607072405, "cost1_min": 162.49364176184847}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 5, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 5, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefd4ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefd4c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefd4be0>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 1}
{"time_this_iter_s": 25.98259210586548, "time_since_restore": 55.23192238807678, "timestamp": 1557102047, "episode_reward_mean": 278.300243417014, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 40621, "timesteps_total": 80877, "done": false, "hostname": "flow-main", "timesteps_since_restore": 80877, "info": {"default": {"entropy": 1.4093737602233887, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9607807993888855, "policy_loss": -0.008127358742058277, "cur_kl_coeff": 0.10000001639127731, "total_loss": 0.8632216453552246, "kl": 0.01354239508509636, "vf_loss": 0.8699949383735657}, "update_time_ms": 813.938, "sample_time_ms": 16459.743, "num_steps_trained": 80877, "grad_time_ms": 10185.492, "load_time_ms": 42.158, "num_steps_sampled": 80877}, "training_iteration": 2, "date": "2019-05-06_00-20-47", "episode_reward_min": 31.287089488498466, "episode_len_mean": 673.8846153846154, "episode_reward_max": 394.72627452213504, "time_total_s": 55.23192238807678, "custom_metrics": {"cost2_min": -0.39305557029438987, "system_level_velocity_min": 6.224300031425009, "cost1_mean": 192.83920024061823, "system_level_velocity_max": 16.660321208283538, "cost2_mean": -0.01511752193439961, "cost2_max": 0.0, "outflow_rate_mean": 596.7771596064839, "system_level_velocity_mean": 8.071167654404706, "cost1_max": 225.27013946834805, "outflow_rate_min": 439.4535797252743, "outflow_rate_max": 690.115607072405, "cost1_min": 13.615658785369597}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 26, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 21, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add740b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74080>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 2}
{"time_this_iter_s": 22.62825298309326, "time_since_restore": 77.86017537117004, "timestamp": 1557102069, "episode_reward_mean": 317.13797388339304, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 37332, "timesteps_total": 118209, "done": false, "hostname": "flow-main", "timesteps_since_restore": 118209, "info": {"default": {"entropy": 1.3869441747665405, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9679123163223267, "policy_loss": -0.012866365723311901, "cur_kl_coeff": 0.10000000894069672, "total_loss": 1.0657954216003418, "kl": 0.020751815289258957, "vf_loss": 1.0765864849090576}, "update_time_ms": 546.04, "sample_time_ms": 15516.598, "num_steps_trained": 118209, "grad_time_ms": 9752.449, "load_time_ms": 32.728, "num_steps_sampled": 118209}, "training_iteration": 3, "date": "2019-05-06_00-21-09", "episode_reward_min": 31.287089488498466, "episode_len_mean": 684.9111111111112, "episode_reward_max": 547.5870737776473, "time_total_s": 77.86017537117004, "custom_metrics": {"cost2_min": -0.5, "system_level_velocity_min": 2.7032146280422955, "cost1_mean": 200.16624237605174, "system_level_velocity_max": 16.660321208283538, "cost2_mean": -0.023894655450538326, "cost2_max": 0.0, "outflow_rate_mean": 616.8519921766148, "system_level_velocity_mean": 8.08057561502142, "cost1_max": 266.29014089649763, "outflow_rate_min": 201.58084133423648, "outflow_rate_max": 809.5446341263236, "cost1_min": 13.615658785369597}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 45, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 19, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed438>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 3}
{"time_this_iter_s": 22.215859174728394, "time_since_restore": 100.07603454589844, "timestamp": 1557102092, "episode_reward_mean": 368.24617362836904, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 37467, "timesteps_total": 155676, "done": false, "hostname": "flow-main", "timesteps_since_restore": 155676, "info": {"default": {"entropy": 1.3789235353469849, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9296097159385681, "policy_loss": -0.011593353003263474, "cur_kl_coeff": 0.14999999105930328, "total_loss": 2.2293591499328613, "kl": 0.016046514734625816, "vf_loss": 2.2385454177856445}, "update_time_ms": 411.852, "sample_time_ms": 15234.221, "num_steps_trained": 155676, "grad_time_ms": 9249.831, "load_time_ms": 26.406, "num_steps_sampled": 155676}, "training_iteration": 4, "date": "2019-05-06_00-21-32", "episode_reward_min": 31.287089488498466, "episode_len_mean": 689.7121212121212, "episode_reward_max": 635.4219394044985, "time_total_s": 100.07603454589844, "custom_metrics": {"cost2_min": -0.5, "system_level_velocity_min": 2.7032146280422955, "cost1_mean": 213.1877619015393, "system_level_velocity_max": 16.660321208283538, "cost2_mean": -0.017558421863837586, "cost2_max": 0.0, "outflow_rate_mean": 648.8165645026958, "system_level_velocity_mean": 8.466473683809202, "cost1_max": 296.71462858810526, "outflow_rate_min": 201.58084133423648, "outflow_rate_max": 925.7086207749354, "cost1_min": 13.615658785369597}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 66, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 21, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add746d8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 4}
{"time_this_iter_s": 22.955563068389893, "time_since_restore": 123.03159761428833, "timestamp": 1557102115, "episode_reward_mean": 421.0455397908593, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 36588, "timesteps_total": 192264, "done": false, "hostname": "flow-main", "timesteps_since_restore": 192264, "info": {"default": {"entropy": 1.3778843879699707, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9329012632369995, "policy_loss": -0.012517089024186134, "cur_kl_coeff": 0.1499999761581421, "total_loss": 2.769948959350586, "kl": 0.016548849642276764, "vf_loss": 2.7799839973449707}, "update_time_ms": 331.528, "sample_time_ms": 15096.164, "num_steps_trained": 192264, "grad_time_ms": 9065.02, "load_time_ms": 22.825, "num_steps_sampled": 192264}, "training_iteration": 5, "date": "2019-05-06_00-21-55", "episode_reward_min": 31.287089488498466, "episode_len_mean": 692.0117647058823, "episode_reward_max": 719.1737937219003, "time_total_s": 123.03159761428833, "custom_metrics": {"cost2_min": -0.6399688304252974, "system_level_velocity_min": 2.7032146280422955, "cost1_mean": 224.81948198585087, "system_level_velocity_max": 16.660321208283538, "cost2_mean": -0.028824233325949418, "cost2_max": 0.0, "outflow_rate_mean": 683.8746294076213, "system_level_velocity_mean": 8.84277126374523, "cost1_max": 308.7835136812044, "outflow_rate_min": 201.58084133423648, "outflow_rate_max": 971.9806259976205, "cost1_min": 13.615658785369597}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 85, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 19, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed7b8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 5}
{"time_this_iter_s": 21.87733817100525, "time_since_restore": 144.90893578529358, "timestamp": 1557102137, "episode_reward_mean": 472.9375537474198, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 39403, "timesteps_total": 231667, "done": false, "hostname": "flow-main", "timesteps_since_restore": 231667, "info": {"default": {"entropy": 1.423080563545227, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9531238079071045, "policy_loss": -0.012861927039921284, "cur_kl_coeff": 0.14999999105930328, "total_loss": 2.6287710666656494, "kl": 0.01670190319418907, "vf_loss": 2.639127492904663}, "update_time_ms": 277.655, "sample_time_ms": 14674.023, "num_steps_trained": 231667, "grad_time_ms": 9091.078, "load_time_ms": 21.035, "num_steps_sampled": 231667}, "training_iteration": 6, "date": "2019-05-06_00-22-17", "episode_reward_min": 31.287089488498466, "episode_len_mean": 693.21, "episode_reward_max": 821.2257677930618, "time_total_s": 144.90893578529358, "custom_metrics": {"cost2_min": -0.6399688304252974, "system_level_velocity_min": 2.7032146280422955, "cost1_mean": 234.53911250940615, "system_level_velocity_max": 16.660321208283538, "cost2_mean": -0.03029080982971384, "cost2_max": 0.0, "outflow_rate_mean": 718.3552324216746, "system_level_velocity_mean": 9.172476984858912, "cost1_max": 330.8545794356377, "outflow_rate_min": 201.58084133423648, "outflow_rate_max": 971.9806259976205, "cost1_min": 13.615658785369597}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 103, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 18, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74048>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 6}
{"time_this_iter_s": 23.897833108901978, "time_since_restore": 168.80676889419556, "timestamp": 1557102160, "episode_reward_mean": 532.6534799226679, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 42405, "timesteps_total": 274072, "done": false, "hostname": "flow-main", "timesteps_since_restore": 274072, "info": {"default": {"entropy": 1.4527361392974854, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9606768488883972, "policy_loss": -0.012154803611338139, "cur_kl_coeff": 0.1499999761581421, "total_loss": 2.5474090576171875, "kl": 0.01577151194214821, "vf_loss": 2.5571980476379395}, "update_time_ms": 238.997, "sample_time_ms": 14636.693, "num_steps_trained": 274072, "grad_time_ms": 9132.354, "load_time_ms": 19.512, "num_steps_sampled": 274072}, "training_iteration": 7, "date": "2019-05-06_00-22-40", "episode_reward_min": 244.28574030770602, "episode_len_mean": 700.0, "episode_reward_max": 870.2101059798906, "time_total_s": 168.80676889419556, "custom_metrics": {"cost2_min": -0.6399688304252974, "system_level_velocity_min": 2.7032146280422955, "cost1_mean": 247.9478478294368, "system_level_velocity_max": 12.850984212899618, "cost2_mean": -0.0357262753230245, "cost2_max": 0.0, "outflow_rate_mean": 759.1368576343572, "system_level_velocity_mean": 9.497931213110165, "cost1_max": 330.8545794356377, "outflow_rate_min": 201.58084133423648, "outflow_rate_max": 1000.6106826142724, "cost1_min": 69.51636380873933}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 119, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 16, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74908>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 7}
{"time_this_iter_s": 23.567391872406006, "time_since_restore": 192.37416076660156, "timestamp": 1557102184, "episode_reward_mean": 552.7535694249239, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 43270, "timesteps_total": 317342, "done": false, "hostname": "flow-main", "timesteps_since_restore": 317342, "info": {"default": {"entropy": 1.4677276611328125, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9845461249351501, "policy_loss": -0.01171530969440937, "cur_kl_coeff": 0.1499999761581421, "total_loss": 1.3887670040130615, "kl": 0.015267692506313324, "vf_loss": 1.398192048072815}, "update_time_ms": 210.176, "sample_time_ms": 14499.263, "num_steps_trained": 317342, "grad_time_ms": 9232.306, "load_time_ms": 18.64, "num_steps_sampled": 317342}, "training_iteration": 8, "date": "2019-05-06_00-23-04", "episode_reward_min": 53.992487045710654, "episode_len_mean": 693.42, "episode_reward_max": 870.2101059798906, "time_total_s": 192.37416076660156, "custom_metrics": {"cost2_min": -0.6399688304252974, "system_level_velocity_min": 2.7032146280422955, "cost1_mean": 251.5238557267745, "system_level_velocity_max": 18.149549548780566, "cost2_mean": -0.035820720578330356, "cost2_max": 0.0, "outflow_rate_mean": 775.8247771711468, "system_level_velocity_mean": 9.79148301877207, "cost1_max": 353.19849537563107, "outflow_rate_min": 201.58084133423648, "outflow_rate_max": 1065.3861667076967, "cost1_min": 27.61353282135811}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 128, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 9, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed320>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 8}
{"time_this_iter_s": 24.58671545982361, "time_since_restore": 216.96087622642517, "timestamp": 1557102209, "episode_reward_mean": 601.6958353101877, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 40941, "timesteps_total": 358283, "done": false, "hostname": "flow-main", "timesteps_since_restore": 358283, "info": {"default": {"entropy": 1.4250781536102295, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9823078513145447, "policy_loss": -0.014100381173193455, "cur_kl_coeff": 0.1499999761581421, "total_loss": 1.8958641290664673, "kl": 0.01924939639866352, "vf_loss": 1.9070769548416138}, "update_time_ms": 187.522, "sample_time_ms": 14465.023, "num_steps_trained": 358283, "grad_time_ms": 9349.133, "load_time_ms": 17.821, "num_steps_sampled": 358283}, "training_iteration": 9, "date": "2019-05-06_00-23-29", "episode_reward_min": 53.992487045710654, "episode_len_mean": 693.42, "episode_reward_max": 936.6946039231852, "time_total_s": 216.96087622642517, "custom_metrics": {"cost2_min": -1.1524514702243345, "system_level_velocity_min": 5.210091674057951, "cost1_mean": 261.6089621309517, "system_level_velocity_max": 18.149549548780566, "cost2_mean": -0.050536664036822464, "cost2_max": 0.0, "outflow_rate_mean": 817.152639280247, "system_level_velocity_mean": 10.147321779504416, "cost1_max": 353.19849537563107, "outflow_rate_min": 480.8596322104372, "outflow_rate_max": 1065.3861667076967, "cost1_min": 27.61353282135811}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 147, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 19, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add740b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74358>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 9}
{"time_this_iter_s": 23.71798586845398, "time_since_restore": 240.67886209487915, "timestamp": 1557102232, "episode_reward_mean": 654.5415644847225, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 39724, "timesteps_total": 398007, "done": false, "hostname": "flow-main", "timesteps_since_restore": 398007, "info": {"default": {"entropy": 1.417304277420044, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9792807102203369, "policy_loss": -0.013930943794548512, "cur_kl_coeff": 0.14999999105930328, "total_loss": 2.4126265048980713, "kl": 0.018134310841560364, "vf_loss": 2.423837423324585}, "update_time_ms": 169.474, "sample_time_ms": 14415.434, "num_steps_trained": 398007, "grad_time_ms": 9378.393, "load_time_ms": 18.052, "num_steps_sampled": 398007}, "training_iteration": 10, "date": "2019-05-06_00-23-52", "episode_reward_min": 53.992487045710654, "episode_len_mean": 693.42, "episode_reward_max": 989.6924129361425, "time_total_s": 240.67886209487915, "custom_metrics": {"cost2_min": -1.1524514702243345, "system_level_velocity_min": 5.210091674057951, "cost1_mean": 271.38522184536396, "system_level_velocity_max": 18.149549548780566, "cost2_mean": -0.05678500356642163, "cost2_max": 0.0, "outflow_rate_mean": 859.6144951561614, "system_level_velocity_mean": 10.476916854411424, "cost1_max": 353.19849537563107, "outflow_rate_min": 480.8596322104372, "outflow_rate_max": 1083.1810332076082, "cost1_min": 27.61353282135811}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 165, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 18, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74a90>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 10}
{"time_this_iter_s": 23.67306113243103, "time_since_restore": 264.3519232273102, "timestamp": 1557102256, "episode_reward_mean": 686.5348742117634, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 40756, "timesteps_total": 438763, "done": false, "hostname": "flow-main", "timesteps_since_restore": 438763, "info": {"default": {"entropy": 1.3979417085647583, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.974061906337738, "policy_loss": -0.017213191837072372, "cur_kl_coeff": 0.14999999105930328, "total_loss": 2.562433958053589, "kl": 0.022387895733118057, "vf_loss": 2.576288938522339}, "update_time_ms": 8.237, "sample_time_ms": 14139.212, "num_steps_trained": 438763, "grad_time_ms": 9269.553, "load_time_ms": 12.051, "num_steps_sampled": 438763}, "training_iteration": 11, "date": "2019-05-06_00-24-16", "episode_reward_min": 50.21242921497887, "episode_len_mean": 686.71, "episode_reward_max": 989.6924129361425, "time_total_s": 264.3519232273102, "custom_metrics": {"cost2_min": -1.1524514702243345, "system_level_velocity_min": 5.210091674057951, "cost1_mean": 276.87807087363393, "system_level_velocity_max": 18.149549548780566, "cost2_mean": -0.04575330554983932, "cost2_max": 0.0, "outflow_rate_mean": 889.0126341355854, "system_level_velocity_mean": 10.8384190147517, "cost1_max": 359.2816461161531, "outflow_rate_min": 480.8596322104372, "outflow_rate_max": 1084.3324220189181, "cost1_min": 19.20267168201625}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 184, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 19, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed898>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed470>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 11}
{"time_this_iter_s": 24.06445813179016, "time_since_restore": 288.41638135910034, "timestamp": 1557102280, "episode_reward_mean": 696.4497234027875, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 40665, "timesteps_total": 479428, "done": false, "hostname": "flow-main", "timesteps_since_restore": 479428, "info": {"default": {"entropy": 1.3944956064224243, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9709208607673645, "policy_loss": -0.016590474173426628, "cur_kl_coeff": 0.22499999403953552, "total_loss": 2.7231621742248535, "kl": 0.019109323620796204, "vf_loss": 2.735452890396118}, "update_time_ms": 8.18, "sample_time_ms": 14037.744, "num_steps_trained": 479428, "grad_time_ms": 9181.791, "load_time_ms": 12.944, "num_steps_sampled": 479428}, "training_iteration": 12, "date": "2019-05-06_00-24-40", "episode_reward_min": 50.21242921497887, "episode_len_mean": 686.71, "episode_reward_max": 989.6924129361425, "time_total_s": 288.41638135910034, "custom_metrics": {"cost2_min": -1.1524514702243345, "system_level_velocity_min": 5.210091674057951, "cost1_mean": 279.25711529425536, "system_level_velocity_max": 18.149549548780566, "cost2_mean": -0.05031368828591016, "cost2_max": 0.0, "outflow_rate_mean": 897.3859362123268, "system_level_velocity_mean": 10.92343748882963, "cost1_max": 407.43646465563734, "outflow_rate_min": 480.8596322104372, "outflow_rate_max": 1235.087422775121, "cost1_min": 19.20267168201625}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 201, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 17, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add743c8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 12}
{"time_this_iter_s": 22.83043670654297, "time_since_restore": 311.2468180656433, "timestamp": 1557102303, "episode_reward_mean": 713.9895415621453, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 42264, "timesteps_total": 521692, "done": false, "hostname": "flow-main", "timesteps_since_restore": 521692, "info": {"default": {"entropy": 1.4202061891555786, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.966859757900238, "policy_loss": -0.016328806057572365, "cur_kl_coeff": 0.22499999403953552, "total_loss": 2.647991895675659, "kl": 0.018119459971785545, "vf_loss": 2.6602439880371094}, "update_time_ms": 7.89, "sample_time_ms": 13965.119, "num_steps_trained": 521692, "grad_time_ms": 9273.611, "load_time_ms": 13.591, "num_steps_sampled": 521692}, "training_iteration": 13, "date": "2019-05-06_00-25-03", "episode_reward_min": 50.21242921497887, "episode_len_mean": 686.71, "episode_reward_max": 989.6924129361425, "time_total_s": 311.2468180656433, "custom_metrics": {"cost2_min": -1.1524514702243345, "system_level_velocity_min": 5.210091674057951, "cost1_mean": 285.3650534856803, "system_level_velocity_max": 18.149549548780566, "cost2_mean": -0.05265730041237919, "cost2_max": 0.0, "outflow_rate_mean": 918.433518172258, "system_level_velocity_mean": 11.162377393472157, "cost1_max": 430.7407637797885, "outflow_rate_min": 493.4100718231657, "outflow_rate_max": 1235.087422775121, "cost1_min": 19.20267168201625}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 214, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 13, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74b00>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 13}
{"time_this_iter_s": 23.178566932678223, "time_since_restore": 334.42538499832153, "timestamp": 1557102326, "episode_reward_mean": 741.3921767085078, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 40843, "timesteps_total": 562535, "done": false, "hostname": "flow-main", "timesteps_since_restore": 562535, "info": {"default": {"entropy": 1.3769227266311646, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9677011370658875, "policy_loss": -0.019169101491570473, "cur_kl_coeff": 0.2250000238418579, "total_loss": 2.9146175384521484, "kl": 0.020152295008301735, "vf_loss": 2.9292523860931396}, "update_time_ms": 7.895, "sample_time_ms": 13892.933, "num_steps_trained": 562535, "grad_time_ms": 9440.697, "load_time_ms": 14.875, "num_steps_sampled": 562535}, "training_iteration": 14, "date": "2019-05-06_00-25-26", "episode_reward_min": 50.21242921497887, "episode_len_mean": 686.66, "episode_reward_max": 989.6924129361425, "time_total_s": 334.42538499832153, "custom_metrics": {"cost2_min": -1.1524514702243345, "system_level_velocity_min": 5.210091674057951, "cost1_mean": 287.1144708795024, "system_level_velocity_max": 18.046290888495534, "cost2_mean": -0.06719837214969798, "cost2_max": 0.0, "outflow_rate_mean": 927.3066344561905, "system_level_velocity_mean": 11.246909904516208, "cost1_max": 430.7407637797885, "outflow_rate_min": 493.4100718231657, "outflow_rate_max": 1235.087422775121, "cost1_min": 19.20267168201625}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 232, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 18, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefedc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefd4710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add740b8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 14}
{"time_this_iter_s": 24.079894542694092, "time_since_restore": 358.5052795410156, "timestamp": 1557102350, "episode_reward_mean": 759.2883578562958, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 39482, "timesteps_total": 602017, "done": false, "hostname": "flow-main", "timesteps_since_restore": 602017, "info": {"default": {"entropy": 1.3564133644104004, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9596623182296753, "policy_loss": -0.01723499968647957, "cur_kl_coeff": 0.33750003576278687, "total_loss": 3.287200450897217, "kl": 0.015794528648257256, "vf_loss": 3.299104690551758}, "update_time_ms": 7.729, "sample_time_ms": 13914.59, "num_steps_trained": 602017, "grad_time_ms": 9530.658, "load_time_ms": 15.136, "num_steps_sampled": 602017}, "training_iteration": 15, "date": "2019-05-06_00-25-50", "episode_reward_min": 50.21242921497887, "episode_len_mean": 686.66, "episode_reward_max": 989.6924129361425, "time_total_s": 358.5052795410156, "custom_metrics": {"cost2_min": -0.9314079611275452, "system_level_velocity_min": 6.646739055185639, "cost1_mean": 292.3613170772898, "system_level_velocity_max": 18.046290888495534, "cost2_mean": -0.06341860110585275, "cost2_max": 0.0, "outflow_rate_mean": 939.0870990568721, "system_level_velocity_mean": 11.469343874079502, "cost1_max": 430.7407637797885, "outflow_rate_min": 493.4100718231657, "outflow_rate_max": 1235.087422775121, "cost1_min": 19.20267168201625}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 249, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 17, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74358>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 15}
{"time_this_iter_s": 23.078009128570557, "time_since_restore": 381.5832886695862, "timestamp": 1557102374, "episode_reward_mean": 757.348233707453, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 38357, "timesteps_total": 640374, "done": false, "hostname": "flow-main", "timesteps_since_restore": 640374, "info": {"default": {"entropy": 1.3428555727005005, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9630826115608215, "policy_loss": -0.017734240740537643, "cur_kl_coeff": 0.33750003576278687, "total_loss": 3.4977357387542725, "kl": 0.01556993555277586, "vf_loss": 3.5102155208587646}, "update_time_ms": 7.604, "sample_time_ms": 14045.915, "num_steps_trained": 640374, "grad_time_ms": 9519.3, "load_time_ms": 15.092, "num_steps_sampled": 640374}, "training_iteration": 16, "date": "2019-05-06_00-26-14", "episode_reward_min": 50.21242921497887, "episode_len_mean": 686.66, "episode_reward_max": 981.419770369481, "time_total_s": 381.5832886695862, "custom_metrics": {"cost2_min": -0.9314079611275452, "system_level_velocity_min": 6.646739055185639, "cost1_mean": 295.78720918028233, "system_level_velocity_max": 18.046290888495534, "cost2_mean": -0.07754269245019797, "cost2_max": 0.0, "outflow_rate_mean": 937.384674308973, "system_level_velocity_mean": 11.639742660718673, "cost1_max": 430.7407637797885, "outflow_rate_min": 493.4100718231657, "outflow_rate_max": 1235.087422775121, "cost1_min": 19.20267168201625}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 268, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 19, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add747b8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 16}
{"time_this_iter_s": 21.758118629455566, "time_since_restore": 403.34140729904175, "timestamp": 1557102395, "episode_reward_mean": 765.1672226928189, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 38076, "timesteps_total": 678450, "done": false, "hostname": "flow-main", "timesteps_since_restore": 678450, "info": {"default": {"entropy": 1.3825050592422485, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9664654731750488, "policy_loss": -0.01700284145772457, "cur_kl_coeff": 0.33750003576278687, "total_loss": 3.6215007305145264, "kl": 0.014920992776751518, "vf_loss": 3.633467674255371}, "update_time_ms": 7.702, "sample_time_ms": 13846.455, "num_steps_trained": 678450, "grad_time_ms": 9506.212, "load_time_ms": 15.569, "num_steps_sampled": 678450}, "training_iteration": 17, "date": "2019-05-06_00-26-35", "episode_reward_min": 59.68316515625818, "episode_len_mean": 693.37, "episode_reward_max": 981.419770369481, "time_total_s": 403.34140729904175, "custom_metrics": {"cost2_min": -0.9314079611275452, "system_level_velocity_min": 6.646739055185639, "cost1_mean": 300.1901646404172, "system_level_velocity_max": 17.693087983589102, "cost2_mean": -0.0933276274354833, "cost2_max": 0.0, "outflow_rate_mean": 946.1474814001414, "system_level_velocity_mean": 11.640849684659274, "cost1_max": 430.7407637797885, "outflow_rate_min": 518.3986908822038, "outflow_rate_max": 1269.803512267635, "cost1_min": 24.109584137294064}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 287, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 19, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ac88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ac18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ab70>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 17}
{"time_this_iter_s": 22.570880651474, "time_since_restore": 425.91228795051575, "timestamp": 1557102418, "episode_reward_mean": 777.3254077050411, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 39722, "timesteps_total": 718172, "done": false, "hostname": "flow-main", "timesteps_since_restore": 718172, "info": {"default": {"entropy": 1.3668384552001953, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9719793796539307, "policy_loss": -0.0175601989030838, "cur_kl_coeff": 0.33750003576278687, "total_loss": 3.250866651535034, "kl": 0.015075416304171085, "vf_loss": 3.263338804244995}, "update_time_ms": 7.633, "sample_time_ms": 13907.539, "num_steps_trained": 718172, "grad_time_ms": 9347.21, "load_time_ms": 15.325, "num_steps_sampled": 718172}, "training_iteration": 18, "date": "2019-05-06_00-26-58", "episode_reward_min": 59.68316515625818, "episode_len_mean": 693.37, "episode_reward_max": 1175.9607260824844, "time_total_s": 425.91228795051575, "custom_metrics": {"cost2_min": -0.9314079611275452, "system_level_velocity_min": 6.646739055185639, "cost1_mean": 307.373539865566, "system_level_velocity_max": 17.693087983589102, "cost2_mean": -0.08531637955647092, "cost2_max": 0.0, "outflow_rate_mean": 955.5406804765835, "system_level_velocity_mean": 11.932205682041472, "cost1_max": 436.4397381413892, "outflow_rate_min": 518.3986908822038, "outflow_rate_max": 1271.5570513452155, "cost1_min": 24.109584137294064}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 304, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 17, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefedc18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefede80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed390>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 18}
{"time_this_iter_s": 24.59642457962036, "time_since_restore": 450.5087125301361, "timestamp": 1557102443, "episode_reward_mean": 770.9560440239724, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 39761, "timesteps_total": 757933, "done": false, "hostname": "flow-main", "timesteps_since_restore": 757933, "info": {"default": {"entropy": 1.4041399955749512, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.962526261806488, "policy_loss": -0.021049262955784798, "cur_kl_coeff": 0.33750003576278687, "total_loss": 3.484808921813965, "kl": 0.01699628308415413, "vf_loss": 3.500121593475342}, "update_time_ms": 7.588, "sample_time_ms": 13998.07, "num_steps_trained": 757933, "grad_time_ms": 9260.901, "load_time_ms": 14.868, "num_steps_sampled": 757933}, "training_iteration": 19, "date": "2019-05-06_00-27-23", "episode_reward_min": 48.992685012066126, "episode_len_mean": 693.29, "episode_reward_max": 1175.9607260824844, "time_total_s": 450.5087125301361, "custom_metrics": {"cost2_min": -1.011111111111111, "system_level_velocity_min": 6.646739055185639, "cost1_mean": 306.57162881215174, "system_level_velocity_max": 17.961666453977273, "cost2_mean": -0.09392382560588217, "cost2_max": 0.0, "outflow_rate_mean": 951.7724218015313, "system_level_velocity_mean": 11.913526166382137, "cost1_max": 436.4397381413892, "outflow_rate_min": 487.90790141812573, "outflow_rate_max": 1271.5570513452155, "cost1_min": 19.26009548422241}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 323, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 19, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add745c0>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 19}
{"time_this_iter_s": 22.804946660995483, "time_since_restore": 473.3136591911316, "timestamp": 1557102465, "episode_reward_mean": 769.7021934482048, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 39579, "timesteps_total": 797512, "done": false, "hostname": "flow-main", "timesteps_since_restore": 797512, "info": {"default": {"entropy": 1.4107959270477295, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.957665205001831, "policy_loss": -0.02101748436689377, "cur_kl_coeff": 0.3375000059604645, "total_loss": 3.5797390937805176, "kl": 0.01783064566552639, "vf_loss": 3.594738483428955}, "update_time_ms": 7.49, "sample_time_ms": 13931.464, "num_steps_trained": 797512, "grad_time_ms": 9237.172, "load_time_ms": 13.845, "num_steps_sampled": 797512}, "training_iteration": 20, "date": "2019-05-06_00-27-45", "episode_reward_min": 48.992685012066126, "episode_len_mean": 693.29, "episode_reward_max": 1175.9607260824844, "time_total_s": 473.3136591911316, "custom_metrics": {"cost2_min": -1.011111111111111, "system_level_velocity_min": 6.928819275473085, "cost1_mean": 310.00930010366346, "system_level_velocity_max": 17.961666453977273, "cost2_mean": -0.09033305970165323, "cost2_max": 0.0, "outflow_rate_mean": 956.3334164950921, "system_level_velocity_mean": 12.041639875318522, "cost1_max": 436.4397381413892, "outflow_rate_min": 487.90790141812573, "outflow_rate_max": 1271.5570513452155, "cost1_min": 19.26009548422241}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 338, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 15, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0af02ba58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefedc88>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 20}
{"time_this_iter_s": 22.128266096115112, "time_since_restore": 495.4419252872467, "timestamp": 1557102488, "episode_reward_mean": 751.477972710524, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 38913, "timesteps_total": 836425, "done": false, "hostname": "flow-main", "timesteps_since_restore": 836425, "info": {"default": {"entropy": 1.3555643558502197, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9576040506362915, "policy_loss": -0.018347563222050667, "cur_kl_coeff": 0.33750003576278687, "total_loss": 3.953903913497925, "kl": 0.01653730496764183, "vf_loss": 3.966670036315918}, "update_time_ms": 7.466, "sample_time_ms": 13793.267, "num_steps_trained": 836425, "grad_time_ms": 9221.599, "load_time_ms": 13.51, "num_steps_sampled": 836425}, "training_iteration": 21, "date": "2019-05-06_00-28-08", "episode_reward_min": 48.992685012066126, "episode_len_mean": 686.68, "episode_reward_max": 1175.9607260824844, "time_total_s": 495.4419252872467, "custom_metrics": {"cost2_min": -1.011111111111111, "system_level_velocity_min": 6.928819275473085, "cost1_mean": 307.9136048194824, "system_level_velocity_max": 18.027274672061377, "cost2_mean": -0.06812261425838326, "cost2_max": 0.0, "outflow_rate_mean": 935.0556382972319, "system_level_velocity_mean": 12.13662708438775, "cost1_max": 436.4397381413892, "outflow_rate_min": 487.90790141812573, "outflow_rate_max": 1271.5570513452155, "cost1_min": 19.26009548422241}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 357, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 19, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7aba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a978>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 21}
{"time_this_iter_s": 23.59012794494629, "time_since_restore": 519.032053232193, "timestamp": 1557102511, "episode_reward_mean": 757.1445034406704, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 40532, "timesteps_total": 876957, "done": false, "hostname": "flow-main", "timesteps_since_restore": 876957, "info": {"default": {"entropy": 1.4521085023880005, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9738176465034485, "policy_loss": -0.020878640934824944, "cur_kl_coeff": 0.33750003576278687, "total_loss": 3.7104387283325195, "kl": 0.017749929800629616, "vf_loss": 3.7253267765045166}, "update_time_ms": 7.508, "sample_time_ms": 13833.699, "num_steps_trained": 876957, "grad_time_ms": 9133.857, "load_time_ms": 12.595, "num_steps_sampled": 876957}, "training_iteration": 22, "date": "2019-05-06_00-28-31", "episode_reward_min": 48.992685012066126, "episode_len_mean": 686.68, "episode_reward_max": 1175.9607260824844, "time_total_s": 519.032053232193, "custom_metrics": {"cost2_min": -1.011111111111111, "system_level_velocity_min": 6.928819275473085, "cost1_mean": 308.75690276773753, "system_level_velocity_max": 18.027274672061377, "cost2_mean": -0.06747904317732166, "cost2_max": 0.0, "outflow_rate_mean": 941.310974492243, "system_level_velocity_mean": 12.152027631216162, "cost1_max": 436.4397381413892, "outflow_rate_min": 487.90790141812573, "outflow_rate_max": 1271.5570513452155, "cost1_min": 19.26009548422241}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 374, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 17, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7abe0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a0b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a518>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 22}
{"time_this_iter_s": 24.03868842124939, "time_since_restore": 543.0707416534424, "timestamp": 1557102535, "episode_reward_mean": 747.6586409520531, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 40619, "timesteps_total": 917576, "done": false, "hostname": "flow-main", "timesteps_since_restore": 917576, "info": {"default": {"entropy": 1.4280872344970703, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9712960720062256, "policy_loss": -0.021330948919057846, "cur_kl_coeff": 0.33750006556510925, "total_loss": 3.18993878364563, "kl": 0.017210427671670914, "vf_loss": 3.205461025238037}, "update_time_ms": 7.465, "sample_time_ms": 14007.665, "num_steps_trained": 917576, "grad_time_ms": 9083.392, "load_time_ms": 11.725, "num_steps_sampled": 917576}, "training_iteration": 23, "date": "2019-05-06_00-28-55", "episode_reward_min": 48.992685012066126, "episode_len_mean": 686.68, "episode_reward_max": 977.0326996038323, "time_total_s": 543.0707416534424, "custom_metrics": {"cost2_min": -1.011111111111111, "system_level_velocity_min": 8.535812834888914, "cost1_mean": 305.6542729125001, "system_level_velocity_max": 18.027274672061377, "cost2_mean": -0.05751715517240696, "cost2_max": 0.0, "outflow_rate_mean": 930.2811066463236, "system_level_velocity_mean": 12.031716228786454, "cost1_max": 396.86120290045784, "outflow_rate_min": 487.90790141812573, "outflow_rate_max": 1179.4724031781784, "cost1_min": 19.26009548422241}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 392, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 18, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefedef0>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 23}
{"time_this_iter_s": 22.26027250289917, "time_since_restore": 565.3310141563416, "timestamp": 1557102558, "episode_reward_mean": 734.5241951729106, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 37101, "timesteps_total": 954677, "done": false, "hostname": "flow-main", "timesteps_since_restore": 954677, "info": {"default": {"entropy": 1.3749475479125977, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9527352452278137, "policy_loss": -0.02057926543056965, "cur_kl_coeff": 0.33750003576278687, "total_loss": 5.888001441955566, "kl": 0.01662406139075756, "vf_loss": 5.902970790863037}, "update_time_ms": 7.399, "sample_time_ms": 14016.301, "num_steps_trained": 954677, "grad_time_ms": 8984.362, "load_time_ms": 10.541, "num_steps_sampled": 954677}, "training_iteration": 24, "date": "2019-05-06_00-29-18", "episode_reward_min": 25.300433379576035, "episode_len_mean": 675.38, "episode_reward_max": 957.0235942062194, "time_total_s": 565.3310141563416, "custom_metrics": {"cost2_min": -0.6666666666666666, "system_level_velocity_min": 9.247425329155146, "cost1_mean": 302.8458985896402, "system_level_velocity_max": 18.430154700328337, "cost2_mean": -0.03729835755073674, "cost2_max": 0.0, "outflow_rate_mean": 924.0200931051289, "system_level_velocity_mean": 12.195023382549756, "cost1_max": 421.11761070566297, "outflow_rate_min": 464.2002765876701, "outflow_rate_max": 1164.8023744734726, "cost1_min": 11.620348006181935}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 413, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 21, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ab38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a5f8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 24}
{"time_this_iter_s": 22.134464025497437, "time_since_restore": 587.465478181839, "timestamp": 1557102580, "episode_reward_mean": 739.4205582247301, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 38433, "timesteps_total": 993110, "done": false, "hostname": "flow-main", "timesteps_since_restore": 993110, "info": {"default": {"entropy": 1.3670964241027832, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9537011981010437, "policy_loss": -0.021207548677921295, "cur_kl_coeff": 0.33750006556510925, "total_loss": 5.408547401428223, "kl": 0.019128315150737762, "vf_loss": 5.423299312591553}, "update_time_ms": 7.28, "sample_time_ms": 14000.275, "num_steps_trained": 993110, "grad_time_ms": 8805.245, "load_time_ms": 10.885, "num_steps_sampled": 993110}, "training_iteration": 25, "date": "2019-05-06_00-29-40", "episode_reward_min": 23.44145849277291, "episode_len_mean": 675.27, "episode_reward_max": 1040.504007318512, "time_total_s": 587.465478181839, "custom_metrics": {"cost2_min": -0.6666666666666666, "system_level_velocity_min": 9.130487722119454, "cost1_mean": 308.0556926024634, "system_level_velocity_max": 18.430154700328337, "cost2_mean": -0.030919794369799317, "cost2_max": 0.0, "outflow_rate_mean": 923.4305373689718, "system_level_velocity_mean": 12.388486802605856, "cost1_max": 421.11761070566297, "outflow_rate_min": 464.2002765876701, "outflow_rate_max": 1164.8023744734726, "cost1_min": 11.620348006181935}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 433, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 20, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add744e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add745c0>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 25}
{"time_this_iter_s": 23.529619932174683, "time_since_restore": 610.9950981140137, "timestamp": 1557102603, "episode_reward_mean": 745.4729651745777, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 37895, "timesteps_total": 1031005, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1031005, "info": {"default": {"entropy": 1.4247890710830688, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9627450704574585, "policy_loss": -0.021605219691991806, "cur_kl_coeff": 0.33750003576278687, "total_loss": 4.603652477264404, "kl": 0.018160205334424973, "vf_loss": 4.619129180908203}, "update_time_ms": 7.571, "sample_time_ms": 14100.881, "num_steps_trained": 1031005, "grad_time_ms": 8748.165, "load_time_ms": 10.653, "num_steps_sampled": 1031005}, "training_iteration": 26, "date": "2019-05-06_00-30-03", "episode_reward_min": 23.44145849277291, "episode_len_mean": 675.19, "episode_reward_max": 1040.504007318512, "time_total_s": 610.9950981140137, "custom_metrics": {"cost2_min": -0.728469629384239, "system_level_velocity_min": 9.130487722119454, "cost1_mean": 309.51030410264184, "system_level_velocity_max": 18.79401827129012, "cost2_mean": -0.02733468995668001, "cost2_max": 0.0, "outflow_rate_mean": 931.7326895477213, "system_level_velocity_mean": 12.454192285882446, "cost1_max": 421.11761070566297, "outflow_rate_min": 464.2002765876701, "outflow_rate_max": 1164.8023744734726, "cost1_min": 11.620348006181935}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 454, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 21, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ac88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a7b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a550>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 26}
{"time_this_iter_s": 23.054685354232788, "time_since_restore": 634.0497834682465, "timestamp": 1557102626, "episode_reward_mean": 725.9609359529791, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 39504, "timesteps_total": 1070509, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1070509, "info": {"default": {"entropy": 1.3881309032440186, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9498447775840759, "policy_loss": -0.022523848339915276, "cur_kl_coeff": 0.33750003576278687, "total_loss": 5.594601154327393, "kl": 0.020882096141576767, "vf_loss": 5.610077857971191}, "update_time_ms": 7.696, "sample_time_ms": 14216.62, "num_steps_trained": 1070509, "grad_time_ms": 8758.86, "load_time_ms": 10.339, "num_steps_sampled": 1070509}, "training_iteration": 27, "date": "2019-05-06_00-30-26", "episode_reward_min": 23.44145849277291, "episode_len_mean": 668.62, "episode_reward_max": 1040.504007318512, "time_total_s": 634.0497834682465, "custom_metrics": {"cost2_min": -0.728469629384239, "system_level_velocity_min": 9.130487722119454, "cost1_mean": 310.0492715689495, "system_level_velocity_max": 18.79401827129012, "cost2_mean": -0.023170954270392764, "cost2_max": 0.0, "outflow_rate_mean": 911.9023890758127, "system_level_velocity_mean": 12.68121226788549, "cost1_max": 421.11761070566297, "outflow_rate_min": 464.2002765876701, "outflow_rate_max": 1164.8023744734726, "cost1_min": 11.620348006181935}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 472, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 18, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add74710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add748d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add747b8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 27}
{"time_this_iter_s": 22.660905599594116, "time_since_restore": 656.7106890678406, "timestamp": 1557102649, "episode_reward_mean": 726.3834894231367, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35868, "timesteps_total": 1106377, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1106377, "info": {"default": {"entropy": 1.3611892461776733, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9382400512695312, "policy_loss": -0.019435454159975052, "cur_kl_coeff": 0.5062499642372131, "total_loss": 7.8555707931518555, "kl": 0.014779501594603062, "vf_loss": 7.867523193359375}, "update_time_ms": 7.989, "sample_time_ms": 14205.826, "num_steps_trained": 1106377, "grad_time_ms": 8777.454, "load_time_ms": 10.032, "num_steps_sampled": 1106377}, "training_iteration": 28, "date": "2019-05-06_00-30-49", "episode_reward_min": 23.44145849277291, "episode_len_mean": 666.59, "episode_reward_max": 1040.504007318512, "time_total_s": 656.7106890678406, "custom_metrics": {"cost2_min": -0.728469629384239, "system_level_velocity_min": 9.130487722119454, "cost1_mean": 318.33880720901175, "system_level_velocity_max": 18.79401827129012, "cost2_mean": -0.029186884269671098, "cost2_max": 0.0, "outflow_rate_mean": 909.9468070878739, "system_level_velocity_mean": 13.067431098216517, "cost1_max": 421.11761070566297, "outflow_rate_min": 464.2002765876701, "outflow_rate_max": 1164.8023744734726, "cost1_min": 11.620348006181935}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 494, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 22, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7cb38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7cc18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefd4630>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 28}
{"time_this_iter_s": 21.841577291488647, "time_since_restore": 678.5522663593292, "timestamp": 1557102671, "episode_reward_mean": 722.9733872452182, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35920, "timesteps_total": 1142297, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1142297, "info": {"default": {"entropy": 1.316291093826294, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8603488206863403, "policy_loss": -0.021449625492095947, "cur_kl_coeff": 0.5062499642372131, "total_loss": 11.244148254394531, "kl": 0.016667606309056282, "vf_loss": 11.257160186767578}, "update_time_ms": 8.397, "sample_time_ms": 14122.204, "num_steps_trained": 1142297, "grad_time_ms": 8584.172, "load_time_ms": 10.063, "num_steps_sampled": 1142297}, "training_iteration": 29, "date": "2019-05-06_00-31-11", "episode_reward_min": 23.44145849277291, "episode_len_mean": 673.41, "episode_reward_max": 1040.504007318512, "time_total_s": 678.5522663593292, "custom_metrics": {"cost2_min": -0.7751257810242766, "system_level_velocity_min": 9.130487722119454, "cost1_mean": 329.9763499391314, "system_level_velocity_max": 18.79401827129012, "cost2_mean": -0.04090895956616156, "cost2_max": 0.0, "outflow_rate_mean": 907.2731889432476, "system_level_velocity_mean": 13.377233069860399, "cost1_max": 412.3308436609885, "outflow_rate_min": 464.32649368107076, "outflow_rate_max": 1145.0617968997, "cost1_min": 11.72072924638646}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 515, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 21, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a9e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7aac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a7b8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 29}
{"time_this_iter_s": 21.71777319908142, "time_since_restore": 700.2700395584106, "timestamp": 1557102693, "episode_reward_mean": 721.1646649628495, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 34897, "timesteps_total": 1177194, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1177194, "info": {"default": {"entropy": 1.32123601436615, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8010737299919128, "policy_loss": -0.022680941969156265, "cur_kl_coeff": 0.5062499046325684, "total_loss": 11.716629028320312, "kl": 0.015892451629042625, "vf_loss": 11.731264114379883}, "update_time_ms": 8.738, "sample_time_ms": 14125.797, "num_steps_trained": 1177194, "grad_time_ms": 8470.636, "load_time_ms": 9.914, "num_steps_sampled": 1177194}, "training_iteration": 30, "date": "2019-05-06_00-31-33", "episode_reward_min": 43.32756799776145, "episode_len_mean": 673.53, "episode_reward_max": 1042.6549485307096, "time_total_s": 700.2700395584106, "custom_metrics": {"cost2_min": -0.7751257810242766, "system_level_velocity_min": 9.672308557732824, "cost1_mean": 336.78128581071155, "system_level_velocity_max": 18.79401827129012, "cost2_mean": -0.043056802419243534, "cost2_max": 0.0, "outflow_rate_mean": 914.0688714449611, "system_level_velocity_mean": 13.641587276156331, "cost1_max": 432.64054048530676, "outflow_rate_min": 480.8901999107064, "outflow_rate_max": 1145.0617968997, "cost1_min": 19.857648282634987}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 537, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 22, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefede80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed5c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed3c8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 30}
{"time_this_iter_s": 21.572365283966064, "time_since_restore": 721.8424048423767, "timestamp": 1557102714, "episode_reward_mean": 720.2281714398752, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 34055, "timesteps_total": 1211249, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1211249, "info": {"default": {"entropy": 1.3494960069656372, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8756032586097717, "policy_loss": -0.020953889936208725, "cur_kl_coeff": 0.5062499046325684, "total_loss": 12.212424278259277, "kl": 0.015982378274202347, "vf_loss": 12.225288391113281}, "update_time_ms": 9.159, "sample_time_ms": 14155.149, "num_steps_trained": 1211249, "grad_time_ms": 8384.127, "load_time_ms": 9.551, "num_steps_sampled": 1211249}, "training_iteration": 31, "date": "2019-05-06_00-31-54", "episode_reward_min": 43.32756799776145, "episode_len_mean": 686.79, "episode_reward_max": 1042.6549485307096, "time_total_s": 721.8424048423767, "custom_metrics": {"cost2_min": -0.7751257810242766, "system_level_velocity_min": 9.839507319356674, "cost1_mean": 357.12392809295, "system_level_velocity_max": 17.829590049464176, "cost2_mean": -0.033672864487655725, "cost2_max": 0.0, "outflow_rate_mean": 907.0792863989241, "system_level_velocity_mean": 14.123567908459727, "cost1_max": 440.8842422568927, "outflow_rate_min": 480.8901999107064, "outflow_rate_max": 1145.0617968997, "cost1_min": 19.857648282634987}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 562, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 25, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7cf28>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 31}
{"time_this_iter_s": 21.857900857925415, "time_since_restore": 743.7003057003021, "timestamp": 1557102736, "episode_reward_mean": 703.1418427594633, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 34877, "timesteps_total": 1246126, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1246126, "info": {"default": {"entropy": 1.3620386123657227, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8566204905509949, "policy_loss": -0.02078171633183956, "cur_kl_coeff": 0.5062499046325684, "total_loss": 13.263094902038574, "kl": 0.015289075672626495, "vf_loss": 13.276135444641113}, "update_time_ms": 9.502, "sample_time_ms": 14135.019, "num_steps_trained": 1246126, "grad_time_ms": 8229.043, "load_time_ms": 9.471, "num_steps_sampled": 1246126}, "training_iteration": 32, "date": "2019-05-06_00-32-16", "episode_reward_min": 43.32756799776145, "episode_len_mean": 691.17, "episode_reward_max": 1042.6549485307096, "time_total_s": 743.7003057003021, "custom_metrics": {"cost2_min": -0.7751257810242766, "system_level_velocity_min": 9.839507319356674, "cost1_mean": 370.7410933940337, "system_level_velocity_max": 17.829590049464176, "cost2_mean": -0.02247588107499304, "cost2_max": 0.0, "outflow_rate_mean": 892.6053737836039, "system_level_velocity_mean": 14.577557995459198, "cost1_max": 440.8842422568927, "outflow_rate_min": 480.8901999107064, "outflow_rate_max": 1145.0617968997, "cost1_min": 19.857648282634987}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 589, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 27, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a550>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 32}
{"time_this_iter_s": 21.143177270889282, "time_since_restore": 764.8434829711914, "timestamp": 1557102758, "episode_reward_mean": 679.6075450190236, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 33844, "timesteps_total": 1279970, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1279970, "info": {"default": {"entropy": 1.3817875385284424, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9069967269897461, "policy_loss": -0.020691240206360817, "cur_kl_coeff": 0.5062499642372131, "total_loss": 11.123523712158203, "kl": 0.01571788638830185, "vf_loss": 11.136258125305176}, "update_time_ms": 9.759, "sample_time_ms": 13983.905, "num_steps_trained": 1279970, "grad_time_ms": 8089.687, "load_time_ms": 9.015, "num_steps_sampled": 1279970}, "training_iteration": 33, "date": "2019-05-06_00-32-38", "episode_reward_min": 43.32756799776145, "episode_len_mean": 691.17, "episode_reward_max": 1042.6549485307096, "time_total_s": 764.8434829711914, "custom_metrics": {"cost2_min": -0.4444444444444444, "system_level_velocity_min": 11.053844450367452, "cost1_mean": 370.16588900534856, "system_level_velocity_max": 17.829590049464176, "cost2_mean": -0.01418709728046157, "cost2_max": 0.0, "outflow_rate_mean": 865.5966092043362, "system_level_velocity_mean": 14.594040638298912, "cost1_max": 440.8842422568927, "outflow_rate_min": 480.8901999107064, "outflow_rate_max": 1127.5172276254305, "cost1_min": 19.857648282634987}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 613, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 24, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7cc50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7cef0>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 33}
{"time_this_iter_s": 21.65920925140381, "time_since_restore": 786.5026922225952, "timestamp": 1557102779, "episode_reward_mean": 660.4519510238874, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 36014, "timesteps_total": 1315984, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1315984, "info": {"default": {"entropy": 1.4095771312713623, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9190705418586731, "policy_loss": -0.02125820890069008, "cur_kl_coeff": 0.5062499046325684, "total_loss": 11.889131546020508, "kl": 0.01560200285166502, "vf_loss": 11.902491569519043}, "update_time_ms": 9.928, "sample_time_ms": 13960.077, "num_steps_trained": 1315984, "grad_time_ms": 8051.251, "load_time_ms": 8.882, "num_steps_sampled": 1315984}, "training_iteration": 34, "date": "2019-05-06_00-32-59", "episode_reward_min": 361.0061914409195, "episode_len_mean": 697.87, "episode_reward_max": 937.1514599416777, "time_total_s": 786.5026922225952, "custom_metrics": {"cost2_min": -0.4444444444444444, "system_level_velocity_min": 11.053844450367452, "cost1_mean": 376.7649058568331, "system_level_velocity_max": 17.59056771080298, "cost2_mean": -0.009027255611818615, "cost2_max": 0.0, "outflow_rate_mean": 838.5259201517572, "system_level_velocity_mean": 14.731491207095727, "cost1_max": 440.8842422568927, "outflow_rate_min": 618.6958166729627, "outflow_rate_max": 1108.9415312718982, "cost1_min": 283.4215698886143}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 636, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 23, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7cac8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 34}
{"time_this_iter_s": 23.09992551803589, "time_since_restore": 809.6026177406311, "timestamp": 1557102802, "episode_reward_mean": 654.2529942593496, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35968, "timesteps_total": 1351952, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1351952, "info": {"default": {"entropy": 1.4075438976287842, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9574270248413086, "policy_loss": -0.022653132677078247, "cur_kl_coeff": 0.5062499046325684, "total_loss": 8.8077974319458, "kl": 0.015486907213926315, "vf_loss": 8.822610855102539}, "update_time_ms": 10.055, "sample_time_ms": 14084.358, "num_steps_trained": 1351952, "grad_time_ms": 8025.347, "load_time_ms": 7.982, "num_steps_sampled": 1351952}, "training_iteration": 35, "date": "2019-05-06_00-33-22", "episode_reward_min": 341.4147845490741, "episode_len_mean": 697.87, "episode_reward_max": 937.1514599416777, "time_total_s": 809.6026177406311, "custom_metrics": {"cost2_min": -1.522247473620709, "system_level_velocity_min": 5.3378668023877465, "cost1_mean": 370.60645188313634, "system_level_velocity_max": 17.536143199004844, "cost2_mean": -0.023692216646760494, "cost2_max": 0.0, "outflow_rate_mean": 833.1900390842187, "system_level_velocity_mean": 14.499704418210543, "cost1_max": 438.7984610398135, "outflow_rate_min": 587.0774853704417, "outflow_rate_max": 1139.7802091555945, "cost1_min": 135.2004845409056}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 662, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 26, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7aeb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a320>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 35}
{"time_this_iter_s": 22.70955729484558, "time_since_restore": 832.3121750354767, "timestamp": 1557102825, "episode_reward_mean": 657.1946853635767, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35776, "timesteps_total": 1387728, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1387728, "info": {"default": {"entropy": 1.41488516330719, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9289405345916748, "policy_loss": -0.02345249429345131, "cur_kl_coeff": 0.5062499046325684, "total_loss": 11.468647003173828, "kl": 0.017243480309844017, "vf_loss": 11.483370780944824}, "update_time_ms": 9.841, "sample_time_ms": 14004.898, "num_steps_trained": 1387728, "grad_time_ms": 8024.172, "load_time_ms": 8.081, "num_steps_sampled": 1387728}, "training_iteration": 36, "date": "2019-05-06_00-33-45", "episode_reward_min": 341.4147845490741, "episode_len_mean": 700.0, "episode_reward_max": 930.3775124646774, "time_total_s": 832.3121750354767, "custom_metrics": {"cost2_min": -1.522247473620709, "system_level_velocity_min": 5.3378668023877465, "cost1_mean": 367.86801269488717, "system_level_velocity_max": 17.536143199004844, "cost2_mean": -0.03373946739259845, "cost2_max": 0.0, "outflow_rate_mean": 831.4982396283402, "system_level_velocity_mean": 14.334931463186805, "cost1_max": 438.7984610398135, "outflow_rate_min": 587.0774853704417, "outflow_rate_max": 1139.7802091555945, "cost1_min": 135.2004845409056}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 683, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 21, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ceb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ce10>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 36}
{"time_this_iter_s": 21.71304750442505, "time_since_restore": 854.0252225399017, "timestamp": 1557102847, "episode_reward_mean": 661.7504363085536, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35135, "timesteps_total": 1422863, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1422863, "info": {"default": {"entropy": 1.4213720560073853, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9378044009208679, "policy_loss": -0.02413221076130867, "cur_kl_coeff": 0.5062499046325684, "total_loss": 8.83133316040039, "kl": 0.015646837651729584, "vf_loss": 8.84754467010498}, "update_time_ms": 9.893, "sample_time_ms": 13969.055, "num_steps_trained": 1422863, "grad_time_ms": 7928.387, "load_time_ms": 7.744, "num_steps_sampled": 1422863}, "training_iteration": 37, "date": "2019-05-06_00-34-07", "episode_reward_min": 23.421216116810548, "episode_len_mean": 693.18, "episode_reward_max": 933.8088943719117, "time_total_s": 854.0252225399017, "custom_metrics": {"cost2_min": -1.522247473620709, "system_level_velocity_min": 5.3378668023877465, "cost1_mean": 358.38589868665093, "system_level_velocity_max": 17.536143199004844, "cost2_mean": -0.04587875846160769, "cost2_max": 0.0, "outflow_rate_mean": 832.8667512895399, "system_level_velocity_mean": 14.11251748648922, "cost1_max": 438.7984610398135, "outflow_rate_min": 464.32649368107076, "outflow_rate_max": 1139.7802091555945, "cost1_min": 11.710608058405274}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 706, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 23, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c0f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c940>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 37}
{"time_this_iter_s": 21.927911043167114, "time_since_restore": 875.9531335830688, "timestamp": 1557102869, "episode_reward_mean": 678.499917721081, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35405, "timesteps_total": 1458268, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1458268, "info": {"default": {"entropy": 1.4237686395645142, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9234234094619751, "policy_loss": -0.022059833630919456, "cur_kl_coeff": 0.5062499046325684, "total_loss": 11.08707332611084, "kl": 0.015460309572517872, "vf_loss": 11.101306915283203}, "update_time_ms": 9.715, "sample_time_ms": 13971.939, "num_steps_trained": 1458268, "grad_time_ms": 7852.85, "load_time_ms": 7.896, "num_steps_sampled": 1458268}, "training_iteration": 38, "date": "2019-05-06_00-34-29", "episode_reward_min": 23.421216116810548, "episode_len_mean": 693.18, "episode_reward_max": 952.918524775969, "time_total_s": 875.9531335830688, "custom_metrics": {"cost2_min": -1.522247473620709, "system_level_velocity_min": 5.3378668023877465, "cost1_mean": 354.37864515283405, "system_level_velocity_max": 17.41404388794081, "cost2_mean": -0.05014402884603121, "cost2_max": 0.0, "outflow_rate_mean": 843.8262978039804, "system_level_velocity_mean": 13.944698059106793, "cost1_max": 438.7984610398135, "outflow_rate_min": 464.32649368107076, "outflow_rate_max": 1139.7802091555945, "cost1_min": 11.710608058405274}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 730, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 24, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ac88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefed780>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 38}
{"time_this_iter_s": 23.035388708114624, "time_since_restore": 898.9885222911835, "timestamp": 1557102892, "episode_reward_mean": 682.3764092949762, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35098, "timesteps_total": 1493366, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1493366, "info": {"default": {"entropy": 1.3912161588668823, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8970729112625122, "policy_loss": -0.023706864565610886, "cur_kl_coeff": 0.5062499046325684, "total_loss": 11.352676391601562, "kl": 0.016560381278395653, "vf_loss": 11.368000030517578}, "update_time_ms": 9.666, "sample_time_ms": 13962.575, "num_steps_trained": 1493366, "grad_time_ms": 7980.251, "load_time_ms": 8.133, "num_steps_sampled": 1493366}, "training_iteration": 39, "date": "2019-05-06_00-34-52", "episode_reward_min": 23.421216116810548, "episode_len_mean": 693.18, "episode_reward_max": 952.918524775969, "time_total_s": 898.9885222911835, "custom_metrics": {"cost2_min": -0.625, "system_level_velocity_min": 6.154394844164802, "cost1_mean": 358.3117843433793, "system_level_velocity_max": 18.074054852310816, "cost2_mean": -0.04013101163322634, "cost2_max": 0.0, "outflow_rate_mean": 841.495161156763, "system_level_velocity_mean": 14.101857256108394, "cost1_max": 448.89806490513007, "outflow_rate_min": 464.32649368107076, "outflow_rate_max": 1102.0857950965944, "cost1_min": 11.710608058405274}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 752, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 22, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c080>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 39}
{"time_this_iter_s": 21.259191036224365, "time_since_restore": 920.2477133274078, "timestamp": 1557102913, "episode_reward_mean": 689.4429247350055, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 36150, "timesteps_total": 1529516, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1529516, "info": {"default": {"entropy": 1.4166040420532227, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9127145409584045, "policy_loss": -0.024720769375562668, "cur_kl_coeff": 0.5062499642372131, "total_loss": 11.164519309997559, "kl": 0.016511501744389534, "vf_loss": 11.18088150024414}, "update_time_ms": 9.465, "sample_time_ms": 13844.829, "num_steps_trained": 1529516, "grad_time_ms": 8053.957, "load_time_ms": 8.33, "num_steps_sampled": 1529516}, "training_iteration": 40, "date": "2019-05-06_00-35-13", "episode_reward_min": 23.421216116810548, "episode_len_mean": 693.18, "episode_reward_max": 952.918524775969, "time_total_s": 920.2477133274078, "custom_metrics": {"cost2_min": -0.6359338467398026, "system_level_velocity_min": 6.154394844164802, "cost1_mean": 362.4739240018341, "system_level_velocity_max": 18.074054852310816, "cost2_mean": -0.0498851896498854, "cost2_max": 0.0, "outflow_rate_mean": 852.4135342523396, "system_level_velocity_mean": 14.253893653689984, "cost1_max": 448.89806490513007, "outflow_rate_min": 464.32649368107076, "outflow_rate_max": 1102.1787658646615, "cost1_min": 11.710608058405274}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 773, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 21, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ca20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c860>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 40}
{"time_this_iter_s": 22.138275384902954, "time_since_restore": 942.3859887123108, "timestamp": 1557102935, "episode_reward_mean": 695.3984768422479, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35422, "timesteps_total": 1564938, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1564938, "info": {"default": {"entropy": 1.4396718740463257, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9148387312889099, "policy_loss": -0.0223254207521677, "cur_kl_coeff": 0.5062499046325684, "total_loss": 11.944625854492188, "kl": 0.01634085364639759, "vf_loss": 11.958680152893066}, "update_time_ms": 9.01, "sample_time_ms": 13856.199, "num_steps_trained": 1564938, "grad_time_ms": 8100.929, "load_time_ms": 8.442, "num_steps_sampled": 1564938}, "training_iteration": 41, "date": "2019-05-06_00-35-35", "episode_reward_min": 35.568105369003405, "episode_len_mean": 693.28, "episode_reward_max": 952.918524775969, "time_total_s": 942.3859887123108, "custom_metrics": {"cost2_min": -0.6359338467398026, "system_level_velocity_min": 7.022592473066138, "cost1_mean": 365.42513638697056, "system_level_velocity_max": 18.28364665857464, "cost2_mean": -0.04047574168375927, "cost2_max": 0.0, "outflow_rate_mean": 859.4288095082652, "system_level_velocity_mean": 14.370152104420013, "cost1_max": 448.89806490513007, "outflow_rate_min": 494.9553377667385, "outflow_rate_max": 1102.1787658646615, "cost1_min": 18.71350495138999}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 797, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 24, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7aa90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a3c8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 41}
{"time_this_iter_s": 21.493480682373047, "time_since_restore": 963.8794693946838, "timestamp": 1557102957, "episode_reward_mean": 700.6356986893127, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 34121, "timesteps_total": 1599059, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1599059, "info": {"default": {"entropy": 1.4370359182357788, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9157959818840027, "policy_loss": -0.022296130657196045, "cur_kl_coeff": 0.5062499046325684, "total_loss": 11.79473876953125, "kl": 0.014846629463136196, "vf_loss": 11.809518814086914}, "update_time_ms": 9.009, "sample_time_ms": 13727.927, "num_steps_trained": 1599059, "grad_time_ms": 8195.655, "load_time_ms": 8.338, "num_steps_sampled": 1599059}, "training_iteration": 42, "date": "2019-05-06_00-35-57", "episode_reward_min": 35.568105369003405, "episode_len_mean": 693.28, "episode_reward_max": 930.9039912936915, "time_total_s": 963.8794693946838, "custom_metrics": {"cost2_min": -0.6359338467398026, "system_level_velocity_min": 7.022592473066138, "cost1_mean": 365.3945220450951, "system_level_velocity_max": 18.28364665857464, "cost2_mean": -0.03873105554873721, "cost2_max": 0.0, "outflow_rate_mean": 863.9342256314021, "system_level_velocity_mean": 14.381647962374805, "cost1_max": 448.89806490513007, "outflow_rate_min": 494.9553377667385, "outflow_rate_max": 1102.1787658646615, "cost1_min": 18.71350495138999}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 821, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 24, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0af0315c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c080>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 42}
{"time_this_iter_s": 22.74222731590271, "time_since_restore": 986.6216967105865, "timestamp": 1557102980, "episode_reward_mean": 706.6841118270142, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35357, "timesteps_total": 1634416, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1634416, "info": {"default": {"entropy": 1.43094003200531, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8555645942687988, "policy_loss": -0.02407476305961609, "cur_kl_coeff": 0.5062499046325684, "total_loss": 12.80484676361084, "kl": 0.017541183158755302, "vf_loss": 12.82004165649414}, "update_time_ms": 9.018, "sample_time_ms": 13770.346, "num_steps_trained": 1634416, "grad_time_ms": 8313.504, "load_time_ms": 8.67, "num_steps_sampled": 1634416}, "training_iteration": 43, "date": "2019-05-06_00-36-20", "episode_reward_min": 35.568105369003405, "episode_len_mean": 689.61, "episode_reward_max": 930.9039912936915, "time_total_s": 986.6216967105865, "custom_metrics": {"cost2_min": -0.6359338467398026, "system_level_velocity_min": 9.575546549818956, "cost1_mean": 370.1575351399378, "system_level_velocity_max": 18.28364665857464, "cost2_mean": -0.034219724808505776, "cost2_max": 0.0, "outflow_rate_mean": 872.0213623822139, "system_level_velocity_mean": 14.6496595812454, "cost1_max": 443.5989310597365, "outflow_rate_min": 494.9553377667385, "outflow_rate_max": 1102.1787658646615, "cost1_min": 18.71350495138999}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 844, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 23, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c5f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c2e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c208>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 43}
{"time_this_iter_s": 22.173888206481934, "time_since_restore": 1008.7955849170685, "timestamp": 1557103002, "episode_reward_mean": 706.5257733602907, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35458, "timesteps_total": 1669874, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1669874, "info": {"default": {"entropy": 1.444032073020935, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9053588509559631, "policy_loss": -0.02504528872668743, "cur_kl_coeff": 0.5062499046325684, "total_loss": 10.582704544067383, "kl": 0.016608158126473427, "vf_loss": 10.599342346191406}, "update_time_ms": 8.911, "sample_time_ms": 13792.476, "num_steps_trained": 1669874, "grad_time_ms": 8342.779, "load_time_ms": 8.998, "num_steps_sampled": 1669874}, "training_iteration": 44, "date": "2019-05-06_00-36-42", "episode_reward_min": 35.568105369003405, "episode_len_mean": 685.22, "episode_reward_max": 921.7830170876264, "time_total_s": 1008.7955849170685, "custom_metrics": {"cost2_min": -0.4, "system_level_velocity_min": 9.575546549818956, "cost1_mean": 367.43855860443057, "system_level_velocity_max": 18.28364665857464, "cost2_mean": -0.02002040774661874, "cost2_max": 0.0, "outflow_rate_mean": 875.1942451988958, "system_level_velocity_mean": 14.627669012518265, "cost1_max": 443.5989310597365, "outflow_rate_min": 494.9553377667385, "outflow_rate_max": 1102.3904160557065, "cost1_min": 18.71350495138999}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 869, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 25, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add8b748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add8b4e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add8b898>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 44}
{"time_this_iter_s": 22.491228818893433, "time_since_restore": 1031.286813735962, "timestamp": 1557103025, "episode_reward_mean": 729.2339194956012, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 36432, "timesteps_total": 1706306, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1706306, "info": {"default": {"entropy": 1.4744477272033691, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9503064155578613, "policy_loss": -0.022835154086351395, "cur_kl_coeff": 0.5062499046325684, "total_loss": 7.949273586273193, "kl": 0.01677718572318554, "vf_loss": 7.963614463806152}, "update_time_ms": 8.93, "sample_time_ms": 13575.661, "num_steps_trained": 1706306, "grad_time_ms": 8498.397, "load_time_ms": 9.406, "num_steps_sampled": 1706306}, "training_iteration": 45, "date": "2019-05-06_00-37-05", "episode_reward_min": 308.57728619835194, "episode_len_mean": 691.94, "episode_reward_max": 921.7830170876264, "time_total_s": 1031.286813735962, "custom_metrics": {"cost2_min": -0.5897144059872977, "system_level_velocity_min": 11.028258312094207, "cost1_mean": 372.77793292032845, "system_level_velocity_max": 17.712157605340867, "cost2_mean": -0.022024562719403167, "cost2_max": 0.0, "outflow_rate_mean": 900.4390769682058, "system_level_velocity_mean": 14.639927839064795, "cost1_max": 443.5989310597365, "outflow_rate_min": 670.7029583295407, "outflow_rate_max": 1104.157799873236, "cost1_min": 134.6882590281117}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 889, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 20, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ab38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ab00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a860>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 45}
{"time_this_iter_s": 21.926913261413574, "time_since_restore": 1053.2137269973755, "timestamp": 1557103047, "episode_reward_mean": 728.283507703029, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35902, "timesteps_total": 1742208, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1742208, "info": {"default": {"entropy": 1.473740816116333, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9581708908081055, "policy_loss": -0.023680908605456352, "cur_kl_coeff": 0.5062499642372131, "total_loss": 9.237789154052734, "kl": 0.01590343378484249, "vf_loss": 9.253419876098633}, "update_time_ms": 8.831, "sample_time_ms": 13434.507, "num_steps_trained": 1742208, "grad_time_ms": 8560.21, "load_time_ms": 9.399, "num_steps_sampled": 1742208}, "training_iteration": 46, "date": "2019-05-06_00-37-27", "episode_reward_min": 308.57728619835194, "episode_len_mean": 691.94, "episode_reward_max": 892.4683323168989, "time_total_s": 1053.2137269973755, "custom_metrics": {"cost2_min": -0.5897144059872977, "system_level_velocity_min": 9.633153439686964, "cost1_mean": 368.34475643348327, "system_level_velocity_max": 17.62728240187435, "cost2_mean": -0.03319863265386472, "cost2_max": 0.0, "outflow_rate_mean": 900.7406655607685, "system_level_velocity_mean": 14.463514208462705, "cost1_max": 439.67985680166424, "outflow_rate_min": 670.7029583295407, "outflow_rate_max": 1125.4827980696643, "cost1_min": 134.6882590281117}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 911, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 22, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add8b320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7c4e0>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 46}
{"time_this_iter_s": 21.479285955429077, "time_since_restore": 1074.6930129528046, "timestamp": 1557103068, "episode_reward_mean": 738.3669596082317, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 36115, "timesteps_total": 1778323, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1778323, "info": {"default": {"entropy": 1.449167013168335, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9366081953048706, "policy_loss": -0.020612087100744247, "cur_kl_coeff": 0.5062499642372131, "total_loss": 11.162192344665527, "kl": 0.015290496870875359, "vf_loss": 11.175064086914062}, "update_time_ms": 8.871, "sample_time_ms": 13361.076, "num_steps_trained": 1778323, "grad_time_ms": 8610.777, "load_time_ms": 9.433, "num_steps_sampled": 1778323}, "training_iteration": 47, "date": "2019-05-06_00-37-48", "episode_reward_min": 308.57728619835194, "episode_len_mean": 691.94, "episode_reward_max": 886.2057897174543, "time_total_s": 1074.6930129528046, "custom_metrics": {"cost2_min": -0.5897144059872977, "system_level_velocity_min": 9.633153439686964, "cost1_mean": 367.29110736991913, "system_level_velocity_max": 17.62728240187435, "cost2_mean": -0.03419126579458251, "cost2_max": 0.0, "outflow_rate_mean": 913.7369859210678, "system_level_velocity_mean": 14.404384051158617, "cost1_max": 439.67985680166424, "outflow_rate_min": 670.7029583295407, "outflow_rate_max": 1125.4827980696643, "cost1_min": 134.6882590281117}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 931, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 20, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add8bef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add8bc18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add8bac8>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 47}
{"time_this_iter_s": 21.56645154953003, "time_since_restore": 1096.2594645023346, "timestamp": 1557103090, "episode_reward_mean": 745.2784843968146, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 34581, "timesteps_total": 1812904, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1812904, "info": {"default": {"entropy": 1.4813532829284668, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8863887786865234, "policy_loss": -0.024029135704040527, "cur_kl_coeff": 0.5062499046325684, "total_loss": 13.810399055480957, "kl": 0.017046764492988586, "vf_loss": 13.825798988342285}, "update_time_ms": 9.044, "sample_time_ms": 13297.107, "num_steps_trained": 1812904, "grad_time_ms": 8636.553, "load_time_ms": 9.463, "num_steps_sampled": 1812904}, "training_iteration": 48, "date": "2019-05-06_00-38-10", "episode_reward_min": 308.57728619835194, "episode_len_mean": 695.61, "episode_reward_max": 909.9383272183551, "time_total_s": 1096.2594645023346, "custom_metrics": {"cost2_min": -0.5897144059872977, "system_level_velocity_min": 9.633153439686964, "cost1_mean": 367.60299256248487, "system_level_velocity_max": 17.62728240187435, "cost2_mean": -0.03961600584620508, "cost2_max": 0.0, "outflow_rate_mean": 916.8954793229002, "system_level_velocity_mean": 14.317290173822657, "cost1_max": 441.024537098611, "outflow_rate_min": 686.9975035778568, "outflow_rate_max": 1131.7721495697228, "cost1_min": 134.6882590281117}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 956, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 25, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ab00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7a978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add7ab38>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 48}
{"time_this_iter_s": 22.721412181854248, "time_since_restore": 1118.9808766841888, "timestamp": 1557103112, "episode_reward_mean": 744.9388454149544, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 35282, "timesteps_total": 1848186, "done": false, "hostname": "flow-main", "timesteps_since_restore": 1848186, "info": {"default": {"entropy": 1.470380425453186, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.9073812961578369, "policy_loss": -0.02204357646405697, "cur_kl_coeff": 0.5062499642372131, "total_loss": 12.979473114013672, "kl": 0.01652800478041172, "vf_loss": 12.993147850036621}, "update_time_ms": 9.051, "sample_time_ms": 13172.975, "num_steps_trained": 1848186, "grad_time_ms": 8730.342, "load_time_ms": 9.565, "num_steps_sampled": 1848186}, "training_iteration": 49, "date": "2019-05-06_00-38-32", "episode_reward_min": 604.5282872063221, "episode_len_mean": 700.0, "episode_reward_max": 909.9383272183551, "time_total_s": 1118.9808766841888, "custom_metrics": {"cost2_min": -0.5897144059872977, "system_level_velocity_min": 9.633153439686964, "cost1_mean": 370.96792766109843, "system_level_velocity_max": 17.62728240187435, "cost2_mean": -0.036221268836591, "cost2_max": 0.0, "outflow_rate_mean": 914.3092871524353, "system_level_velocity_mean": 14.383393812245318, "cost1_max": 441.024537098611, "outflow_rate_min": 686.9975035778568, "outflow_rate_max": 1131.7721495697228, "cost1_min": 244.74864224036835}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 977, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 21, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add8b630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add8b080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0add8b828>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 49}
{"time_this_iter_s": 20.55056357383728, "time_since_restore": 1139.5314402580261, "timestamp": 1557103133, "episode_reward_mean": 738.3037922274042, "pid": 12624, "node_ip": "10.138.0.2", "timesteps_this_iter": 34837, "timesteps_total": 1883023, "done": true, "hostname": "flow-main", "timesteps_since_restore": 1883023, "info": {"default": {"entropy": 1.4741848707199097, "cur_lr": 0.0005000000237487257, "vf_explained_var": 0.8593739867210388, "policy_loss": -0.024437880143523216, "cur_kl_coeff": 0.5062499046325684, "total_loss": 15.518080711364746, "kl": 0.017827948555350304, "vf_loss": 15.533492088317871}, "update_time_ms": 9.174, "sample_time_ms": 13219.719, "num_steps_trained": 1883023, "grad_time_ms": 8614.04, "load_time_ms": 9.294, "num_steps_sampled": 1883023}, "training_iteration": 50, "date": "2019-05-06_00-38-53", "episode_reward_min": 547.6670236108158, "episode_len_mean": 699.46, "episode_reward_max": 909.9383272183551, "time_total_s": 1139.5314402580261, "custom_metrics": {"cost2_min": -0.5723844794662778, "system_level_velocity_min": 10.125249824820507, "cost1_mean": 372.6996987610835, "system_level_velocity_max": 17.840267899350813, "cost2_mean": -0.03399641391834247, "cost2_max": 0.0, "outflow_rate_mean": 910.5714777677472, "system_level_velocity_mean": 14.483131168435406, "cost1_max": 441.024537098611, "outflow_rate_min": 699.8430596659558, "outflow_rate_max": 1131.7721495697228, "cost1_min": 264.6921126880163}, "experiment_id": "c7372579a66242259bb6e8c927fa1249", "episodes_total": 1004, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "episodes_this_iter": 27, "config": {"synchronize_filters": true, "input_evaluation": null, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fb0aefd4320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fb0af031c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fb0af031400>", "on_sample_end": null, "on_train_result": null}, "kl_target": 0.01, "gamma": 0.99, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output": null, "sample_batch_size": 200, "num_gpus": 0, "sgd_minibatch_size": 128, "collect_metrics_timeout": 180, "use_gae": true, "num_envs_per_worker": 1, "input": "sampler", "lr_schedule": null, "straggler_mitigation": false, "optimizer": {}, "log_level": "INFO", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "multiagent": {"policies_to_train": null, "policy_mapping_fn": null, "policy_graphs": {}}, "horizon": 1500, "sample_async": false, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "vf_share_layers": false, "custom_resources_per_worker": {}, "vf_clip_param": 1000000.0, "compress_observations": false, "preprocessor_pref": "deepmind", "observation_filter": "MeanStdFilter", "output_max_file_size": 67108864, "kl_coeff": 0.2, "model": {"framestack": true, "use_lstm": false, "custom_preprocessor": null, "squash_to_range": false, "custom_model": null, "custom_options": {}, "max_seq_len": 20, "free_log_std": false, "grayscale": false, "conv_activation": "relu", "channel_major": false, "lstm_use_prev_action_reward": false, "lstm_cell_size": 256, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "fcnet_activation": "tanh", "conv_filters": null}, "num_sgd_iter": 10, "simple_optimizer": false, "entropy_coeff": 0.0, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:1.0", "num_cpus_per_worker": 1, "clip_rewards": null, "tf_session_args": {"device_count": {"CPU": 1}, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "log_device_placement": false, "inter_op_parallelism_threads": 2}, "monitor": false, "clip_param": 0.3, "train_batch_size": 30000, "clip_actions": false, "num_workers": 20, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "lambda": 0.97, "num_cpus_for_driver": 1, "lr": 0.0005}, "iterations_since_restore": 50}

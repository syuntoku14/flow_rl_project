{"info": {"num_steps_trained": 40059, "load_time_ms": 91.226, "update_time_ms": 825.933, "grad_time_ms": 8363.358, "default": {"kl": 0.0020521075930446386, "cur_lr": 0.0005000000237487257, "total_loss": 1.5597810745239258, "entropy": 1.4189220666885376, "cur_kl_coeff": 0.20000003278255463, "vf_loss": 1.5606616735458374, "policy_loss": -0.0012911030789837241, "vf_explained_var": 0.8773412704467773}, "sample_time_ms": 29792.853, "num_steps_sampled": 40059}, "custom_metrics": {"cost1_min": 193.16978828588256, "system_level_velocity_min": 7.385222505146013, "outflow_rate_min": 570.1481596858716, "cost1_mean": 205.2148706976318, "cost2_max": 0.0, "cost2_mean": -0.018891613394749946, "cost2_min": -0.1322412937632496, "system_level_velocity_mean": 7.974486898680299, "outflow_rate_max": 741.4601278443942, "cost1_max": 231.95338935642536, "outflow_rate_mean": 627.8088997844027, "system_level_velocity_max": 8.861881666775062}, "episodes_total": 7, "episode_reward_max": 415.1853202636431, "timestamp": 1557110854, "episode_reward_mean": 338.81072863636916, "episodes_this_iter": 7, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 40059, "episode_reward_min": 243.7900855964638, "node_ip": "10.138.0.2", "time_total_s": 39.201385259628296, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-47-34", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4519fd0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4519f98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4519b70>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40059, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 39.201385259628296, "timesteps_total": 40059, "iterations_since_restore": 1, "training_iteration": 1, "policy_reward_mean": {}, "time_since_restore": 39.201385259628296}
{"info": {"num_steps_trained": 80259, "load_time_ms": 54.386, "update_time_ms": 417.106, "grad_time_ms": 7707.554, "default": {"kl": 0.009052721783518791, "cur_lr": 0.0005000000237487257, "total_loss": 1.8151309490203857, "entropy": 1.4153388738632202, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 1.8171170949935913, "policy_loss": -0.0028916620649397373, "vf_explained_var": 0.9227911829948425}, "sample_time_ms": 21414.882, "num_steps_sampled": 80259}, "custom_metrics": {"cost1_min": 79.37943405139909, "system_level_velocity_min": 3.0712922560225806, "outflow_rate_min": 371.15079921829744, "cost1_mean": 194.33848474320274, "cost2_max": 0.0, "cost2_mean": -0.027120047917157393, "cost2_min": -0.6000000000000001, "system_level_velocity_mean": 7.521159109986932, "outflow_rate_max": 741.4601278443942, "cost1_max": 232.6410607054095, "outflow_rate_mean": 605.1987473144058, "system_level_velocity_max": 8.987029163600925}, "episodes_total": 27, "episode_reward_max": 507.9624715239634, "timestamp": 1557110874, "episode_reward_mean": 382.1006382081127, "episodes_this_iter": 20, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 80259, "episode_reward_min": 243.7900855964638, "node_ip": "10.138.0.2", "time_total_s": 59.389461278915405, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-47-54", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531828>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531898>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40200, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.18807601928711, "timesteps_total": 80259, "iterations_since_restore": 2, "training_iteration": 2, "policy_reward_mean": {}, "time_since_restore": 59.389461278915405}
{"info": {"num_steps_trained": 123448, "load_time_ms": 42.136, "update_time_ms": 280.247, "grad_time_ms": 7888.534, "default": {"kl": 0.011430909857153893, "cur_lr": 0.0005000000237487257, "total_loss": 4.319597244262695, "entropy": 1.404477834701538, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 4.321885585784912, "policy_loss": -0.00343142868950963, "vf_explained_var": 0.9376941323280334}, "sample_time_ms": 18608.64, "num_steps_sampled": 123448}, "custom_metrics": {"cost1_min": 26.864713318526327, "system_level_velocity_min": 3.0712922560225806, "outflow_rate_min": 371.15079921829744, "cost1_mean": 207.75724414545178, "cost2_max": 0.0, "cost2_mean": -0.03642646579403902, "cost2_min": -0.6865591584752782, "system_level_velocity_mean": 8.399451720049196, "outflow_rate_max": 1060.23167111476, "cost1_max": 359.74252144984666, "outflow_rate_mean": 656.1265018499212, "system_level_velocity_max": 18.027021849869215}, "episodes_total": 42, "episode_reward_max": 1114.7654148772654, "timestamp": 1557110896, "episode_reward_mean": 458.13346751795206, "episodes_this_iter": 15, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 123448, "episode_reward_min": 63.73561692155121, "node_ip": "10.138.0.2", "time_total_s": 80.74401307106018, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-48-16", "episode_len_mean": 684.2857142857143, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531e48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531ef0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 43189, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.354551792144775, "timesteps_total": 123448, "iterations_since_restore": 3, "training_iteration": 3, "policy_reward_mean": {}, "time_since_restore": 80.74401307106018}
{"info": {"num_steps_trained": 166782, "load_time_ms": 35.91, "update_time_ms": 212.574, "grad_time_ms": 8034.809, "default": {"kl": 0.0031123703811317682, "cur_lr": 0.0005000000237487257, "total_loss": 3.4424808025360107, "entropy": 1.4078810214996338, "cur_kl_coeff": 0.10000002384185791, "vf_loss": 3.4437479972839355, "policy_loss": -0.0015786903677508235, "vf_explained_var": 0.9604986310005188}, "sample_time_ms": 17332.546, "num_steps_sampled": 166782}, "custom_metrics": {"cost1_min": 16.91359549120609, "system_level_velocity_min": 3.0712922560225806, "outflow_rate_min": 371.15079921829744, "cost1_mean": 221.26006481154266, "cost2_max": 0.0, "cost2_mean": -0.03329968348006063, "cost2_min": -0.6865591584752782, "system_level_velocity_mean": 9.094570391133852, "outflow_rate_max": 1122.3890609663626, "cost1_max": 359.74252144984666, "outflow_rate_mean": 716.6959957296777, "system_level_velocity_max": 19.18804975881141}, "episodes_total": 58, "episode_reward_max": 1114.7654148772654, "timestamp": 1557110918, "episode_reward_mean": 536.7059664433707, "episodes_this_iter": 16, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 166782, "episode_reward_min": 43.55414176925114, "node_ip": "10.138.0.2", "time_total_s": 102.83291554450989, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-48-38", "episode_len_mean": 677.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abac88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba978>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba9b0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 43334, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 22.088902473449707, "timesteps_total": 166782, "iterations_since_restore": 4, "training_iteration": 4, "policy_reward_mean": {}, "time_since_restore": 102.83291554450989}
{"info": {"num_steps_trained": 209080, "load_time_ms": 31.792, "update_time_ms": 171.59, "grad_time_ms": 8103.505, "default": {"kl": 0.006841049995273352, "cur_lr": 0.0005000000237487257, "total_loss": 5.097096920013428, "entropy": 1.3802825212478638, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 5.098467826843262, "policy_loss": -0.001712633646093309, "vf_explained_var": 0.9386566281318665}, "sample_time_ms": 16393.05, "num_steps_sampled": 209080}, "custom_metrics": {"cost1_min": 16.91359549120609, "system_level_velocity_min": 3.0712922560225806, "outflow_rate_min": 371.15079921829744, "cost1_mean": 237.21894854149326, "cost2_max": 0.0, "cost2_mean": -0.03885038846832193, "cost2_min": -0.6865591584752782, "system_level_velocity_mean": 9.543857154617672, "outflow_rate_max": 1122.3890609663626, "cost1_max": 359.74252144984666, "outflow_rate_mean": 776.8063140220198, "system_level_velocity_max": 19.18804975881141}, "episodes_total": 75, "episode_reward_max": 1114.7654148772654, "timestamp": 1557110939, "episode_reward_mean": 608.2062540253874, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 209080, "episode_reward_min": 43.55414176925114, "node_ip": "10.138.0.2", "time_total_s": 123.94793248176575, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-48-59", "episode_len_mean": 682.2133333333334, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531780>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45315c0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 42298, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.11501693725586, "timesteps_total": 209080, "iterations_since_restore": 5, "training_iteration": 5, "policy_reward_mean": {}, "time_since_restore": 123.94793248176575}
{"info": {"num_steps_trained": 251542, "load_time_ms": 28.795, "update_time_ms": 144.353, "grad_time_ms": 8136.045, "default": {"kl": 0.0056719426065683365, "cur_lr": 0.0005000000237487257, "total_loss": 4.266452789306641, "entropy": 1.3903888463974, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 4.267894268035889, "policy_loss": -0.0017250002129003406, "vf_explained_var": 0.9613153338432312}, "sample_time_ms": 15745.207, "num_steps_sampled": 251542}, "custom_metrics": {"cost1_min": 16.91359549120609, "system_level_velocity_min": 3.0712922560225806, "outflow_rate_min": 371.15079921829744, "cost1_mean": 244.9641232576154, "cost2_max": 0.0, "cost2_mean": -0.04089692767125921, "cost2_min": -0.6865591584752782, "system_level_velocity_mean": 9.749468503790863, "outflow_rate_max": 1122.3890609663626, "cost1_max": 359.74252144984666, "outflow_rate_mean": 805.5386516942792, "system_level_velocity_max": 19.18804975881141}, "episodes_total": 88, "episode_reward_max": 1114.7654148772654, "timestamp": 1557110960, "episode_reward_mean": 642.8886090287208, "episodes_this_iter": 13, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 251542, "episode_reward_min": 43.55414176925114, "node_ip": "10.138.0.2", "time_total_s": 144.85307359695435, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-49-20", "episode_len_mean": 684.8409090909091, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba2e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba9b0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 42462, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.9051411151886, "timesteps_total": 251542, "iterations_since_restore": 6, "training_iteration": 6, "policy_reward_mean": {}, "time_since_restore": 144.85307359695435}
{"info": {"num_steps_trained": 293051, "load_time_ms": 25.823, "update_time_ms": 124.66, "grad_time_ms": 8144.02, "default": {"kl": 0.007649352308362722, "cur_lr": 0.0005000000237487257, "total_loss": 5.867491722106934, "entropy": 1.372666358947754, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 5.869758605957031, "policy_loss": -0.0026495791971683502, "vf_explained_var": 0.9423526525497437}, "sample_time_ms": 15306.608, "num_steps_sampled": 293051}, "custom_metrics": {"cost1_min": 16.91359549120609, "system_level_velocity_min": 3.0712922560225806, "outflow_rate_min": 371.15079921829744, "cost1_mean": 257.19512204744075, "cost2_max": 0.0, "cost2_mean": -0.04952598443805263, "cost2_min": -0.6865591584752782, "system_level_velocity_mean": 10.147330222700486, "outflow_rate_max": 1182.4423356459256, "cost1_max": 371.898195932525, "outflow_rate_mean": 850.1977275995337, "system_level_velocity_max": 19.18804975881141}, "episodes_total": 106, "episode_reward_max": 1114.7654148772654, "timestamp": 1557110981, "episode_reward_mean": 709.0528145398317, "episodes_this_iter": 18, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 293051, "episode_reward_min": 43.55414176925114, "node_ip": "10.138.0.2", "time_total_s": 165.80965065956116, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-49-41", "episode_len_mean": 686.66, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abafd0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1c88>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41509, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.95657706260681, "timesteps_total": 293051, "iterations_since_restore": 7, "training_iteration": 7, "policy_reward_mean": {}, "time_since_restore": 165.80965065956116}
{"info": {"num_steps_trained": 336509, "load_time_ms": 24.462, "update_time_ms": 110.306, "grad_time_ms": 8204.168, "default": {"kl": 0.0078881299123168, "cur_lr": 0.0005000000237487257, "total_loss": 6.291520595550537, "entropy": 1.363571286201477, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 6.292735576629639, "policy_loss": -0.0016097394982352853, "vf_explained_var": 0.9285922646522522}, "sample_time_ms": 14903.062, "num_steps_sampled": 336509}, "custom_metrics": {"cost1_min": 16.91359549120609, "system_level_velocity_min": 6.31369517533954, "outflow_rate_min": 487.611115026176, "cost1_mean": 275.8510327145376, "cost2_max": 0.0, "cost2_mean": -0.04965178389982544, "cost2_min": -0.6865591584752782, "system_level_velocity_mean": 10.848867569029549, "outflow_rate_max": 1182.4423356459256, "cost1_max": 371.898195932525, "outflow_rate_mean": 913.8820834045925, "system_level_velocity_max": 19.18804975881141}, "episodes_total": 121, "episode_reward_max": 1114.7654148772654, "timestamp": 1557111002, "episode_reward_mean": 789.3029537501806, "episodes_this_iter": 15, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 336509, "episode_reward_min": 43.55414176925114, "node_ip": "10.138.0.2", "time_total_s": 186.62121057510376, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-50-02", "episode_len_mean": 686.66, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45317b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f44fbba8>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 43458, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.811559915542603, "timesteps_total": 336509, "iterations_since_restore": 8, "training_iteration": 8, "policy_reward_mean": {}, "time_since_restore": 186.62121057510376}
{"info": {"num_steps_trained": 379533, "load_time_ms": 23.254, "update_time_ms": 98.877, "grad_time_ms": 8129.277, "default": {"kl": 0.005787150468677282, "cur_lr": 0.0005000000237487257, "total_loss": 4.513393402099609, "entropy": 1.3639079332351685, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 4.514349937438965, "policy_loss": -0.0012461749138310552, "vf_explained_var": 0.9545669555664062}, "sample_time_ms": 14586.01, "num_steps_sampled": 379533}, "custom_metrics": {"cost1_min": 16.91359549120609, "system_level_velocity_min": 6.31369517533954, "outflow_rate_min": 487.611115026176, "cost1_mean": 284.3896842367125, "cost2_max": 0.0, "cost2_mean": -0.044748487107038805, "cost2_min": -0.6365567037714382, "system_level_velocity_mean": 11.006585403482715, "outflow_rate_max": 1182.4423356459256, "cost1_max": 371.898195932525, "outflow_rate_mean": 944.5527651293883, "system_level_velocity_max": 19.18804975881141}, "episodes_total": 131, "episode_reward_max": 1114.7654148772654, "timestamp": 1557111022, "episode_reward_mean": 832.3912078699184, "episodes_this_iter": 10, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 379533, "episode_reward_min": 43.55414176925114, "node_ip": "10.138.0.2", "time_total_s": 206.2978274822235, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-50-22", "episode_len_mean": 693.26, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531e48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531d68>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 43024, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 19.67661690711975, "timesteps_total": 379533, "iterations_since_restore": 9, "training_iteration": 9, "policy_reward_mean": {}, "time_since_restore": 206.2978274822235}
{"info": {"num_steps_trained": 424327, "load_time_ms": 22.063, "update_time_ms": 89.71, "grad_time_ms": 8232.143, "default": {"kl": 0.007992294616997242, "cur_lr": 0.0005000000237487257, "total_loss": 5.528259754180908, "entropy": 1.3611054420471191, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 5.529617786407471, "policy_loss": -0.0017575954552739859, "vf_explained_var": 0.9534600973129272}, "sample_time_ms": 14400.807, "num_steps_sampled": 424327}, "custom_metrics": {"cost1_min": 163.09586372356858, "system_level_velocity_min": 6.31369517533954, "outflow_rate_min": 569.8983546201038, "cost1_mean": 290.2272281776707, "cost2_max": 0.0, "cost2_mean": -0.053191899464987674, "cost2_min": -0.6365567037714382, "system_level_velocity_mean": 11.049001671074382, "outflow_rate_max": 1182.4423356459256, "cost1_max": 371.898195932525, "outflow_rate_mean": 970.0120437182211, "system_level_velocity_max": 14.09544199190612}, "episodes_total": 149, "episode_reward_max": 1071.751727070089, "timestamp": 1557111044, "episode_reward_mean": 878.2015483867217, "episodes_this_iter": 18, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 424327, "episode_reward_min": 524.1015712454512, "node_ip": "10.138.0.2", "time_total_s": 228.29022884368896, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-50-44", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45314e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531fd0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45315f8>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 44794, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.992401361465454, "timesteps_total": 424327, "iterations_since_restore": 10, "training_iteration": 10, "policy_reward_mean": {}, "time_since_restore": 228.29022884368896}
{"info": {"num_steps_trained": 466893, "load_time_ms": 14.118, "update_time_ms": 7.881, "grad_time_ms": 8083.955, "default": {"kl": 0.007314053829759359, "cur_lr": 0.0005000000237487257, "total_loss": 4.58807897567749, "entropy": 1.3808865547180176, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 4.5894598960876465, "policy_loss": -0.0017464769771322608, "vf_explained_var": 0.965611457824707}, "sample_time_ms": 12788.839, "num_steps_sampled": 466893}, "custom_metrics": {"cost1_min": 184.95307974555396, "system_level_velocity_min": 7.124251964179513, "outflow_rate_min": 622.8277739837854, "cost1_mean": 293.2935787476084, "cost2_max": 0.0, "cost2_mean": -0.05374999076038891, "cost2_min": -0.6365567037714382, "system_level_velocity_mean": 11.165287077369358, "outflow_rate_max": 1191.080850633834, "cost1_max": 380.01998984266726, "outflow_rate_mean": 981.130931017265, "system_level_velocity_max": 14.178774597413394}, "episodes_total": 163, "episode_reward_max": 1164.1388378326135, "timestamp": 1557111064, "episode_reward_mean": 885.5881732833639, "episodes_this_iter": 14, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 466893, "episode_reward_min": 526.0666714785186, "node_ip": "10.138.0.2", "time_total_s": 248.9454402923584, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-51-04", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac14a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1940>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac19b0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 42566, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.655211448669434, "timesteps_total": 466893, "iterations_since_restore": 11, "training_iteration": 11, "policy_reward_mean": {}, "time_since_restore": 248.9454402923584}
{"info": {"num_steps_trained": 509427, "load_time_ms": 13.101, "update_time_ms": 7.68, "grad_time_ms": 8113.192, "default": {"kl": 0.006953851785510778, "cur_lr": 0.0005000000237487257, "total_loss": 6.534966468811035, "entropy": 1.3358683586120605, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 6.536582946777344, "policy_loss": -0.00196452927775681, "vf_explained_var": 0.9420825839042664}, "sample_time_ms": 12782.531, "num_steps_sampled": 509427}, "custom_metrics": {"cost1_min": 74.11871913362532, "system_level_velocity_min": 3.010835334737269, "outflow_rate_min": 286.63260457756974, "cost1_mean": 288.31704367863733, "cost2_max": 0.0, "cost2_mean": -0.054093441861929575, "cost2_min": -0.6666666666666666, "system_level_velocity_mean": 10.984257892394583, "outflow_rate_max": 1191.92760534843, "cost1_max": 380.01998984266726, "outflow_rate_mean": 967.4862305016894, "system_level_velocity_max": 14.178774597413394}, "episodes_total": 180, "episode_reward_max": 1164.1388378326135, "timestamp": 1557111085, "episode_reward_mean": 887.4958173832174, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 509427, "episode_reward_min": 417.0552967048314, "node_ip": "10.138.0.2", "time_total_s": 269.3555734157562, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-51-25", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531f98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba2b0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 42534, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.410133123397827, "timesteps_total": 509427, "iterations_since_restore": 12, "training_iteration": 12, "policy_reward_mean": {}, "time_since_restore": 269.3555734157562}
{"info": {"num_steps_trained": 551994, "load_time_ms": 12.137, "update_time_ms": 7.767, "grad_time_ms": 8075.323, "default": {"kl": 0.006726095452904701, "cur_lr": 0.0005000000237487257, "total_loss": 8.511993408203125, "entropy": 1.3159546852111816, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 8.512324333190918, "policy_loss": -0.0006663815584033728, "vf_explained_var": 0.9039608240127563}, "sample_time_ms": 12828.633, "num_steps_sampled": 551994}, "custom_metrics": {"cost1_min": 74.11871913362532, "system_level_velocity_min": 3.010835334737269, "outflow_rate_min": 286.63260457756974, "cost1_mean": 286.9150108259794, "cost2_max": 0.0, "cost2_mean": -0.05609433240298503, "cost2_min": -0.6666666666666666, "system_level_velocity_mean": 10.934583434691387, "outflow_rate_max": 1191.92760534843, "cost1_max": 380.01998984266726, "outflow_rate_mean": 964.9739091224618, "system_level_velocity_max": 14.178774597413394}, "episodes_total": 197, "episode_reward_max": 1259.901684542849, "timestamp": 1557111106, "episode_reward_mean": 896.7418103560323, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 551994, "episode_reward_min": 417.0552967048314, "node_ip": "10.138.0.2", "time_total_s": 290.7796492576599, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-51-46", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1940>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abab70>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 42567, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.424075841903687, "timesteps_total": 551994, "iterations_since_restore": 13, "training_iteration": 13, "policy_reward_mean": {}, "time_since_restore": 290.7796492576599}
{"info": {"num_steps_trained": 594093, "load_time_ms": 12.862, "update_time_ms": 7.646, "grad_time_ms": 7983.794, "default": {"kl": 0.008714751340448856, "cur_lr": 0.0005000000237487257, "total_loss": 5.916740417480469, "entropy": 1.3052083253860474, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 5.917958736419678, "policy_loss": -0.0016540419310331345, "vf_explained_var": 0.9293947815895081}, "sample_time_ms": 12724.414, "num_steps_sampled": 594093}, "custom_metrics": {"cost1_min": 74.11871913362532, "system_level_velocity_min": 3.010835334737269, "outflow_rate_min": 286.63260457756974, "cost1_mean": 285.1964233922999, "cost2_max": 0.0, "cost2_mean": -0.056216497208821166, "cost2_min": -0.7036561841398338, "system_level_velocity_mean": 10.869918451329047, "outflow_rate_max": 1191.92760534843, "cost1_max": 380.01998984266726, "outflow_rate_mean": 962.9442942296747, "system_level_velocity_max": 14.178774597413394}, "episodes_total": 207, "episode_reward_max": 1259.901684542849, "timestamp": 1557111126, "episode_reward_mean": 897.9120010323843, "episodes_this_iter": 10, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 594093, "episode_reward_min": 417.0552967048314, "node_ip": "10.138.0.2", "time_total_s": 310.9046161174774, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-52-06", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531860>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45318d0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 42099, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.124966859817505, "timesteps_total": 594093, "iterations_since_restore": 14, "training_iteration": 14, "policy_reward_mean": {}, "time_since_restore": 310.9046161174774}
{"info": {"num_steps_trained": 635288, "load_time_ms": 11.982, "update_time_ms": 7.536, "grad_time_ms": 7847.359, "default": {"kl": 0.007285241968929768, "cur_lr": 0.0005000000237487257, "total_loss": 10.216691970825195, "entropy": 1.2914512157440186, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 10.217129707336426, "policy_loss": -0.0008016080246306956, "vf_explained_var": 0.8777666687965393}, "sample_time_ms": 12699.811, "num_steps_sampled": 635288}, "custom_metrics": {"cost1_min": 74.11871913362532, "system_level_velocity_min": 3.010835334737269, "outflow_rate_min": 286.63260457756974, "cost1_mean": 278.59839037778147, "cost2_max": 0.0, "cost2_mean": -0.06765054231576945, "cost2_min": -0.7036561841398338, "system_level_velocity_mean": 10.615716235485367, "outflow_rate_max": 1191.92760534843, "cost1_max": 380.01998984266726, "outflow_rate_mean": 951.4358832901416, "system_level_velocity_max": 14.178774597413394}, "episodes_total": 224, "episode_reward_max": 1259.901684542849, "timestamp": 1557111146, "episode_reward_mean": 896.3326057466834, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 635288, "episode_reward_min": 417.0552967048314, "node_ip": "10.138.0.2", "time_total_s": 330.3957917690277, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-52-26", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ababa8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba048>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba828>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41195, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 19.491175651550293, "timesteps_total": 635288, "iterations_since_restore": 15, "training_iteration": 15, "policy_reward_mean": {}, "time_since_restore": 330.3957917690277}
{"info": {"num_steps_trained": 677005, "load_time_ms": 11.553, "update_time_ms": 7.611, "grad_time_ms": 7726.188, "default": {"kl": 0.009630154818296432, "cur_lr": 0.0005000000237487257, "total_loss": 10.483613967895508, "entropy": 1.2807906866073608, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 10.484869003295898, "policy_loss": -0.0017365370877087116, "vf_explained_var": 0.8780472278594971}, "sample_time_ms": 12663.889, "num_steps_sampled": 677005}, "custom_metrics": {"cost1_min": 18.837989205020367, "system_level_velocity_min": 3.010835334737269, "outflow_rate_min": 286.63260457756974, "cost1_mean": 278.31467635595646, "cost2_max": 0.0, "cost2_mean": -0.08170638857068724, "cost2_min": -0.7036561841398338, "system_level_velocity_mean": 10.771362101019827, "outflow_rate_max": 1195.0840955331203, "cost1_max": 380.01998984266726, "outflow_rate_mean": 956.207518221954, "system_level_velocity_max": 18.329273067367378}, "episodes_total": 241, "episode_reward_max": 1259.901684542849, "timestamp": 1557111165, "episode_reward_mean": 899.8644472880088, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 677005, "episode_reward_min": 48.559521519093394, "node_ip": "10.138.0.2", "time_total_s": 349.7131493091583, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-52-45", "episode_len_mean": 693.28, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba0b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba320>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ababe0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41717, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 19.317357540130615, "timesteps_total": 677005, "iterations_since_restore": 16, "training_iteration": 16, "policy_reward_mean": {}, "time_since_restore": 349.7131493091583}
{"info": {"num_steps_trained": 717771, "load_time_ms": 11.473, "update_time_ms": 7.528, "grad_time_ms": 7659.253, "default": {"kl": 0.0074429865926504135, "cur_lr": 0.0005000000237487257, "total_loss": 9.673115730285645, "entropy": 1.2645587921142578, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 9.674467086791992, "policy_loss": -0.001723752124235034, "vf_explained_var": 0.8982322216033936}, "sample_time_ms": 12674.578, "num_steps_sampled": 717771}, "custom_metrics": {"cost1_min": 18.837989205020367, "system_level_velocity_min": 3.010835334737269, "outflow_rate_min": 286.63260457756974, "cost1_mean": 278.6344853869482, "cost2_max": 0.0, "cost2_mean": -0.08359619153928731, "cost2_min": -0.7036561841398338, "system_level_velocity_mean": 10.794284583863504, "outflow_rate_max": 1195.0840955331203, "cost1_max": 380.01998984266726, "outflow_rate_mean": 959.575859138334, "system_level_velocity_max": 18.329273067367378}, "episodes_total": 257, "episode_reward_max": 1259.901684542849, "timestamp": 1557111186, "episode_reward_mean": 910.5401639185307, "episodes_this_iter": 16, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 717771, "episode_reward_min": 48.559521519093394, "node_ip": "10.138.0.2", "time_total_s": 370.1039009094238, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-53-06", "episode_len_mean": 693.28, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac15f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1898>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1ac8>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40766, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.390751600265503, "timesteps_total": 717771, "iterations_since_restore": 17, "training_iteration": 17, "policy_reward_mean": {}, "time_since_restore": 370.1039009094238}
{"info": {"num_steps_trained": 759432, "load_time_ms": 11.276, "update_time_ms": 7.196, "grad_time_ms": 7508.313, "default": {"kl": 0.006874495185911655, "cur_lr": 0.0005000000237487257, "total_loss": 11.20557689666748, "entropy": 1.2536516189575195, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 11.2068510055542, "policy_loss": -0.0016174822812899947, "vf_explained_var": 0.865287721157074}, "sample_time_ms": 12783.768, "num_steps_sampled": 759432}, "custom_metrics": {"cost1_min": 18.837989205020367, "system_level_velocity_min": 7.957231455785929, "outflow_rate_min": 489.92596116141834, "cost1_mean": 285.65002666766685, "cost2_max": 0.0, "cost2_mean": -0.09239763158401865, "cost2_min": -0.7036561841398338, "system_level_velocity_mean": 11.063086601522604, "outflow_rate_max": 1195.0840955331203, "cost1_max": 375.1158301669338, "outflow_rate_mean": 984.4492974559283, "system_level_velocity_max": 18.329273067367378}, "episodes_total": 276, "episode_reward_max": 1259.901684542849, "timestamp": 1557111206, "episode_reward_mean": 934.6235376940755, "episodes_this_iter": 19, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 759432, "episode_reward_min": 48.559521519093394, "node_ip": "10.138.0.2", "time_total_s": 390.4791576862335, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-53-26", "episode_len_mean": 693.28, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1cc0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41661, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.375256776809692, "timesteps_total": 759432, "iterations_since_restore": 18, "training_iteration": 18, "policy_reward_mean": {}, "time_since_restore": 390.4791576862335}
{"info": {"num_steps_trained": 800320, "load_time_ms": 10.532, "update_time_ms": 7.102, "grad_time_ms": 7465.003, "default": {"kl": 0.010504698380827904, "cur_lr": 0.0005000000237487257, "total_loss": 6.819743633270264, "entropy": 1.251482367515564, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 6.8222856521606445, "policy_loss": -0.003066662000492215, "vf_explained_var": 0.9164373278617859}, "sample_time_ms": 12755.03, "num_steps_sampled": 800320}, "custom_metrics": {"cost1_min": 18.837989205020367, "system_level_velocity_min": 7.957231455785929, "outflow_rate_min": 489.92596116141834, "cost1_mean": 286.4410051848968, "cost2_max": 0.0, "cost2_mean": -0.08723298298008361, "cost2_min": -0.7036561841398338, "system_level_velocity_mean": 11.093649920111133, "outflow_rate_max": 1195.0840955331203, "cost1_max": 375.1158301669338, "outflow_rate_mean": 988.3750703945442, "system_level_velocity_max": 18.329273067367378}, "episodes_total": 287, "episode_reward_max": 1167.960486535139, "timestamp": 1557111225, "episode_reward_mean": 935.7808697642181, "episodes_this_iter": 11, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 800320, "episode_reward_min": 48.559521519093394, "node_ip": "10.138.0.2", "time_total_s": 409.4254832267761, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-53-45", "episode_len_mean": 693.28, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1cf8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1828>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40888, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 18.946325540542603, "timesteps_total": 800320, "iterations_since_restore": 19, "training_iteration": 19, "policy_reward_mean": {}, "time_since_restore": 409.4254832267761}
{"info": {"num_steps_trained": 841178, "load_time_ms": 10.216, "update_time_ms": 6.969, "grad_time_ms": 7314.884, "default": {"kl": 0.008602248504757881, "cur_lr": 0.0005000000237487257, "total_loss": 11.749700546264648, "entropy": 1.2536662817001343, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 11.751312255859375, "policy_loss": -0.002041429514065385, "vf_explained_var": 0.8694123029708862}, "sample_time_ms": 12677.355, "num_steps_sampled": 841178}, "custom_metrics": {"cost1_min": 18.837989205020367, "system_level_velocity_min": 7.957231455785929, "outflow_rate_min": 489.92596116141834, "cost1_mean": 289.83399392460865, "cost2_max": 0.0, "cost2_mean": -0.07757097198611046, "cost2_min": -0.5857827584647206, "system_level_velocity_mean": 11.228733509440833, "outflow_rate_max": 1195.0840955331203, "cost1_max": 375.1158301669338, "outflow_rate_mean": 1001.6013026633982, "system_level_velocity_max": 18.329273067367378}, "episodes_total": 305, "episode_reward_max": 1167.960486535139, "timestamp": 1557111245, "episode_reward_mean": 952.5254780050725, "episodes_this_iter": 18, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 841178, "episode_reward_min": 48.559521519093394, "node_ip": "10.138.0.2", "time_total_s": 429.1221013069153, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-54-05", "episode_len_mean": 693.28, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1240>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1a20>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40858, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 19.69661808013916, "timesteps_total": 841178, "iterations_since_restore": 20, "training_iteration": 20, "policy_reward_mean": {}, "time_since_restore": 429.1221013069153}
{"info": {"num_steps_trained": 883629, "load_time_ms": 11.13, "update_time_ms": 6.811, "grad_time_ms": 7432.124, "default": {"kl": 0.008843527175486088, "cur_lr": 0.0005000000237487257, "total_loss": 10.398024559020996, "entropy": 1.2448272705078125, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 10.399765014648438, "policy_loss": -0.002183265285566449, "vf_explained_var": 0.8862631320953369}, "sample_time_ms": 12524.564, "num_steps_sampled": 883629}, "custom_metrics": {"cost1_min": 18.837989205020367, "system_level_velocity_min": 7.957231455785929, "outflow_rate_min": 489.92596116141834, "cost1_mean": 294.3423553248338, "cost2_max": 0.0, "cost2_mean": -0.0786784718905142, "cost2_min": -0.5951745938605055, "system_level_velocity_mean": 11.398609161867771, "outflow_rate_max": 1264.7365760321588, "cost1_max": 399.8255415862684, "outflow_rate_mean": 1011.6652675672876, "system_level_velocity_max": 18.329273067367378}, "episodes_total": 320, "episode_reward_max": 1250.9505635494527, "timestamp": 1557111265, "episode_reward_mean": 960.2861095649572, "episodes_this_iter": 15, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 883629, "episode_reward_min": 48.559521519093394, "node_ip": "10.138.0.2", "time_total_s": 449.4223656654358, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-54-25", "episode_len_mean": 693.28, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1cc0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac17f0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 42451, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.300264358520508, "timesteps_total": 883629, "iterations_since_restore": 21, "training_iteration": 21, "policy_reward_mean": {}, "time_since_restore": 449.4223656654358}
{"info": {"num_steps_trained": 925428, "load_time_ms": 12.057, "update_time_ms": 6.9, "grad_time_ms": 7562.166, "default": {"kl": 0.009026220068335533, "cur_lr": 0.0005000000237487257, "total_loss": 9.57805347442627, "entropy": 1.2419270277023315, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 9.579893112182617, "policy_loss": -0.002291910583153367, "vf_explained_var": 0.9033154249191284}, "sample_time_ms": 12349.363, "num_steps_sampled": 925428}, "custom_metrics": {"cost1_min": 203.61277648489005, "system_level_velocity_min": 7.957231455785929, "outflow_rate_min": 857.1443122968441, "cost1_mean": 297.2497719792499, "cost2_max": 0.0, "cost2_mean": -0.07417324822325849, "cost2_min": -0.7973814404742356, "system_level_velocity_mean": 11.340261415533394, "outflow_rate_max": 1264.7365760321588, "cost1_max": 399.8255415862684, "outflow_rate_mean": 1018.7355995134, "system_level_velocity_max": 14.945867250874167}, "episodes_total": 333, "episode_reward_max": 1250.9505635494527, "timestamp": 1557111285, "episode_reward_mean": 967.2320501805715, "episodes_this_iter": 13, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 925428, "episode_reward_min": 811.814093048538, "node_ip": "10.138.0.2", "time_total_s": 469.38351941108704, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-54-45", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1f98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531f60>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41799, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 19.961153745651245, "timesteps_total": 925428, "iterations_since_restore": 22, "training_iteration": 22, "policy_reward_mean": {}, "time_since_restore": 469.38351941108704}
{"info": {"num_steps_trained": 967696, "load_time_ms": 12.732, "update_time_ms": 6.782, "grad_time_ms": 7616.031, "default": {"kl": 0.01107562892138958, "cur_lr": 0.0005000000237487257, "total_loss": 12.443778038024902, "entropy": 1.251587152481079, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 12.446379661560059, "policy_loss": -0.003154348349198699, "vf_explained_var": 0.8736943006515503}, "sample_time_ms": 12147.78, "num_steps_sampled": 967696}, "custom_metrics": {"cost1_min": 233.6830728759173, "system_level_velocity_min": 9.142283166036655, "outflow_rate_min": 870.9939723603567, "cost1_mean": 299.7535381303755, "cost2_max": 0.0, "cost2_mean": -0.06985912606908148, "cost2_min": -0.7973814404742356, "system_level_velocity_mean": 11.433899671030106, "outflow_rate_max": 1264.7365760321588, "cost1_max": 399.8255415862684, "outflow_rate_mean": 1026.06260235906, "system_level_velocity_max": 14.945867250874167}, "episodes_total": 353, "episode_reward_max": 1250.9505635494527, "timestamp": 1557111305, "episode_reward_mean": 975.3368981472179, "episodes_this_iter": 20, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 967696, "episode_reward_min": 811.814093048538, "node_ip": "10.138.0.2", "time_total_s": 489.3305552005768, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-55-05", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45317b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531a20>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45318d0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 42268, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 19.947035789489746, "timesteps_total": 967696, "iterations_since_restore": 23, "training_iteration": 23, "policy_reward_mean": {}, "time_since_restore": 489.3305552005768}
{"info": {"num_steps_trained": 1009412, "load_time_ms": 11.662, "update_time_ms": 6.623, "grad_time_ms": 7877.765, "default": {"kl": 0.007895726710557938, "cur_lr": 0.0005000000237487257, "total_loss": 10.623848915100098, "entropy": 1.241302251815796, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 10.626224517822266, "policy_loss": -0.002772039733827114, "vf_explained_var": 0.9018213152885437}, "sample_time_ms": 12046.111, "num_steps_sampled": 1009412}, "custom_metrics": {"cost1_min": 222.6808140452863, "system_level_velocity_min": 8.774724779430933, "outflow_rate_min": 849.8772148114955, "cost1_mean": 295.9815743779436, "cost2_max": 0.0, "cost2_mean": -0.07087774185644127, "cost2_min": -0.7973814404742356, "system_level_velocity_mean": 11.300972156369534, "outflow_rate_max": 1264.7365760321588, "cost1_max": 399.8255415862684, "outflow_rate_mean": 1017.7793126267462, "system_level_velocity_max": 14.945867250874167}, "episodes_total": 368, "episode_reward_max": 1250.9505635494527, "timestamp": 1557111327, "episode_reward_mean": 967.6804789210804, "episodes_this_iter": 15, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1009412, "episode_reward_min": 801.0891852196269, "node_ip": "10.138.0.2", "time_total_s": 511.04547476768494, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-55-27", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531860>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45319b0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41716, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.714919567108154, "timesteps_total": 1009412, "iterations_since_restore": 24, "training_iteration": 24, "policy_reward_mean": {}, "time_since_restore": 511.04547476768494}
{"info": {"num_steps_trained": 1050356, "load_time_ms": 12.228, "update_time_ms": 6.598, "grad_time_ms": 8245.478, "default": {"kl": 0.009009109809994698, "cur_lr": 0.0005000000237487257, "total_loss": 11.541470527648926, "entropy": 1.2359718084335327, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 11.544189453125, "policy_loss": -0.0031697761733084917, "vf_explained_var": 0.8714571595191956}, "sample_time_ms": 11932.067, "num_steps_sampled": 1050356}, "custom_metrics": {"cost1_min": 222.6808140452863, "system_level_velocity_min": 8.774724779430933, "outflow_rate_min": 849.8772148114955, "cost1_mean": 296.1476211880357, "cost2_max": 0.0, "cost2_mean": -0.0712687323414931, "cost2_min": -0.7973814404742356, "system_level_velocity_mean": 11.314739297649064, "outflow_rate_max": 1264.7365760321588, "cost1_max": 399.8255415862684, "outflow_rate_mean": 1017.8627391908968, "system_level_velocity_max": 14.945867250874167}, "episodes_total": 385, "episode_reward_max": 1250.9505635494527, "timestamp": 1557111349, "episode_reward_mean": 968.6425878339356, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1050356, "episode_reward_min": 801.0891852196269, "node_ip": "10.138.0.2", "time_total_s": 533.0817172527313, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-55-49", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531e48>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531358>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40944, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 22.036242485046387, "timesteps_total": 1050356, "iterations_since_restore": 25, "training_iteration": 25, "policy_reward_mean": {}, "time_since_restore": 533.0817172527313}
{"info": {"num_steps_trained": 1091225, "load_time_ms": 11.617, "update_time_ms": 6.493, "grad_time_ms": 8538.798, "default": {"kl": 0.009489402174949646, "cur_lr": 0.0005000000237487257, "total_loss": 10.859031677246094, "entropy": 1.2298712730407715, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 10.861639022827148, "policy_loss": -0.003082077717408538, "vf_explained_var": 0.9057438373565674}, "sample_time_ms": 11852.01, "num_steps_sampled": 1091225}, "custom_metrics": {"cost1_min": 193.35226100829644, "system_level_velocity_min": 7.581430927856119, "outflow_rate_min": 833.7049679979607, "cost1_mean": 295.2578604063073, "cost2_max": 0.0, "cost2_mean": -0.07819732874859103, "cost2_min": -0.7973814404742356, "system_level_velocity_mean": 11.292560011541138, "outflow_rate_max": 1264.7365760321588, "cost1_max": 399.8255415862684, "outflow_rate_mean": 1016.0456537066525, "system_level_velocity_max": 14.945867250874167}, "episodes_total": 399, "episode_reward_max": 1250.9505635494527, "timestamp": 1557111370, "episode_reward_mean": 963.4659967103631, "episodes_this_iter": 14, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1091225, "episode_reward_min": 801.0891852196269, "node_ip": "10.138.0.2", "time_total_s": 554.5340638160706, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-56-10", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac10b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac13c8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1b38>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40869, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.452346563339233, "timesteps_total": 1091225, "iterations_since_restore": 26, "training_iteration": 26, "policy_reward_mean": {}, "time_since_restore": 554.5340638160706}
{"info": {"num_steps_trained": 1132148, "load_time_ms": 11.213, "update_time_ms": 6.534, "grad_time_ms": 8797.601, "default": {"kl": 0.009096036665141582, "cur_lr": 0.0005000000237487257, "total_loss": 12.44111156463623, "entropy": 1.2217512130737305, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 12.444411277770996, "policy_loss": -0.003755821380764246, "vf_explained_var": 0.8942501544952393}, "sample_time_ms": 11678.048, "num_steps_sampled": 1132148}, "custom_metrics": {"cost1_min": 193.35226100829644, "system_level_velocity_min": 7.581430927856119, "outflow_rate_min": 833.7049679979607, "cost1_mean": 300.27358982329696, "cost2_max": 0.0, "cost2_mean": -0.07075153096109515, "cost2_min": -0.7973814404742356, "system_level_velocity_mean": 11.494730673232038, "outflow_rate_max": 1361.3799504949832, "cost1_max": 468.58687757682287, "outflow_rate_mean": 1026.7150444145932, "system_level_velocity_max": 17.86402904900417}, "episodes_total": 416, "episode_reward_max": 1226.5169093513066, "timestamp": 1557111391, "episode_reward_mean": 965.860363064062, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1132148, "episode_reward_min": 784.4661950517695, "node_ip": "10.138.0.2", "time_total_s": 575.7690801620483, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-56-31", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3acee48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3acee10>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3acee80>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40923, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.235016345977783, "timesteps_total": 1132148, "iterations_since_restore": 27, "training_iteration": 27, "policy_reward_mean": {}, "time_since_restore": 575.7690801620483}
{"info": {"num_steps_trained": 1173095, "load_time_ms": 10.763, "update_time_ms": 6.48, "grad_time_ms": 9095.221, "default": {"kl": 0.009481254033744335, "cur_lr": 0.0005000000237487257, "total_loss": 14.53408432006836, "entropy": 1.225392460823059, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 14.5361909866333, "policy_loss": -0.0025792797096073627, "vf_explained_var": 0.8729002475738525}, "sample_time_ms": 11488.135, "num_steps_sampled": 1173095}, "custom_metrics": {"cost1_min": 193.35226100829644, "system_level_velocity_min": 7.581430927856119, "outflow_rate_min": 833.7049679979607, "cost1_mean": 300.43481512336393, "cost2_max": 0.0, "cost2_mean": -0.06692458508986739, "cost2_min": -0.5, "system_level_velocity_mean": 11.51903900055284, "outflow_rate_max": 1361.3799504949832, "cost1_max": 468.58687757682287, "outflow_rate_mean": 1028.3214981681763, "system_level_velocity_max": 17.86402904900417}, "episodes_total": 436, "episode_reward_max": 1226.5169093513066, "timestamp": 1557111413, "episode_reward_mean": 968.7582158475141, "episodes_this_iter": 20, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1173095, "episode_reward_min": 764.0472005079755, "node_ip": "10.138.0.2", "time_total_s": 597.2250776290894, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-56-53", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1d30>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1908>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40947, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.455997467041016, "timesteps_total": 1173095, "iterations_since_restore": 28, "training_iteration": 28, "policy_reward_mean": {}, "time_since_restore": 597.2250776290894}
{"info": {"num_steps_trained": 1214973, "load_time_ms": 11.833, "update_time_ms": 6.721, "grad_time_ms": 9425.868, "default": {"kl": 0.010683480650186539, "cur_lr": 0.0005000000237487257, "total_loss": 8.866064071655273, "entropy": 1.2322672605514526, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 8.868776321411133, "policy_loss": -0.0032472494058310986, "vf_explained_var": 0.9062269330024719}, "sample_time_ms": 11388.005, "num_steps_sampled": 1214973}, "custom_metrics": {"cost1_min": 193.35226100829644, "system_level_velocity_min": 7.581430927856119, "outflow_rate_min": 833.7049679979607, "cost1_mean": 303.9744760885296, "cost2_max": 0.0, "cost2_mean": -0.07005458392790413, "cost2_min": -0.5, "system_level_velocity_mean": 11.652252844917458, "outflow_rate_max": 1361.3799504949832, "cost1_max": 468.58687757682287, "outflow_rate_mean": 1035.6019332588105, "system_level_velocity_max": 17.86402904900417}, "episodes_total": 448, "episode_reward_max": 1226.5169093513066, "timestamp": 1557111434, "episode_reward_mean": 970.1120808920634, "episodes_this_iter": 12, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1214973, "episode_reward_min": 764.0472005079755, "node_ip": "10.138.0.2", "time_total_s": 618.4894618988037, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-57-14", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45318d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f45317b8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531e10>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41878, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.264384269714355, "timesteps_total": 1214973, "iterations_since_restore": 29, "training_iteration": 29, "policy_reward_mean": {}, "time_since_restore": 618.4894618988037}
{"info": {"num_steps_trained": 1256364, "load_time_ms": 13.503, "update_time_ms": 6.98, "grad_time_ms": 9681.919, "default": {"kl": 0.00938386283814907, "cur_lr": 0.0005000000237487257, "total_loss": 14.193933486938477, "entropy": 1.243764042854309, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 14.195999145507812, "policy_loss": -0.002532359678298235, "vf_explained_var": 0.8851675391197205}, "sample_time_ms": 11326.943, "num_steps_sampled": 1256364}, "custom_metrics": {"cost1_min": 193.35226100829644, "system_level_velocity_min": 7.581430927856119, "outflow_rate_min": 833.7049679979607, "cost1_mean": 307.5745549740116, "cost2_max": 0.0, "cost2_mean": -0.06877537025415367, "cost2_min": -0.5, "system_level_velocity_mean": 11.787245151867872, "outflow_rate_max": 1361.3799504949832, "cost1_max": 468.58687757682287, "outflow_rate_mean": 1045.3510723051343, "system_level_velocity_max": 17.86402904900417}, "episodes_total": 465, "episode_reward_max": 1226.5169093513066, "timestamp": 1557111456, "episode_reward_mean": 982.286043565872, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1256364, "episode_reward_min": 764.0472005079755, "node_ip": "10.138.0.2", "time_total_s": 640.1627972126007, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-57-36", "episode_len_mean": 700.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aced68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aceda0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aceb70>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41391, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.673335313796997, "timesteps_total": 1256364, "iterations_since_restore": 30, "training_iteration": 30, "policy_reward_mean": {}, "time_since_restore": 640.1627972126007}
{"info": {"num_steps_trained": 1297444, "load_time_ms": 12.82, "update_time_ms": 7.064, "grad_time_ms": 9871.171, "default": {"kl": 0.011545139364898205, "cur_lr": 0.0005000000237487257, "total_loss": 12.726041793823242, "entropy": 1.198014259338379, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 12.728853225708008, "policy_loss": -0.0033886339515447617, "vf_explained_var": 0.8951236605644226}, "sample_time_ms": 11214.006, "num_steps_sampled": 1297444}, "custom_metrics": {"cost1_min": 20.618728608917763, "system_level_velocity_min": 7.581430927856119, "outflow_rate_min": 450.8673327363517, "cost1_mean": 308.8654700679342, "cost2_max": 0.0, "cost2_mean": -0.060952815501290496, "cost2_min": -0.4872597567654151, "system_level_velocity_mean": 12.007401177961038, "outflow_rate_max": 1361.3799504949832, "cost1_max": 468.58687757682287, "outflow_rate_mean": 1049.7532496926744, "system_level_velocity_max": 17.864884736073698}, "episodes_total": 481, "episode_reward_max": 1226.5169093513066, "timestamp": 1557111477, "episode_reward_mean": 977.1020275088989, "episodes_this_iter": 16, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1297444, "episode_reward_min": 53.605350731259456, "node_ip": "10.138.0.2", "time_total_s": 661.2252147197723, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-57-57", "episode_len_mean": 693.32, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1908>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac13c8>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41080, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.06241750717163, "timesteps_total": 1297444, "iterations_since_restore": 31, "training_iteration": 31, "policy_reward_mean": {}, "time_since_restore": 661.2252147197723}
{"info": {"num_steps_trained": 1338557, "load_time_ms": 12.608, "update_time_ms": 7.075, "grad_time_ms": 10008.052, "default": {"kl": 0.010912299156188965, "cur_lr": 0.0005000000237487257, "total_loss": 13.047903060913086, "entropy": 1.1788192987442017, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 13.050418853759766, "policy_loss": -0.003061664057895541, "vf_explained_var": 0.9052718877792358}, "sample_time_ms": 11243.158, "num_steps_sampled": 1338557}, "custom_metrics": {"cost1_min": 20.618728608917763, "system_level_velocity_min": 8.603808798621078, "outflow_rate_min": 450.8673327363517, "cost1_mean": 312.96776805547256, "cost2_max": 0.0, "cost2_mean": -0.06639487452703316, "cost2_min": -0.8469808253801833, "system_level_velocity_mean": 12.158208002206516, "outflow_rate_max": 1361.3799504949832, "cost1_max": 468.58687757682287, "outflow_rate_mean": 1057.706437609337, "system_level_velocity_max": 17.864884736073698}, "episodes_total": 499, "episode_reward_max": 1233.0601194641083, "timestamp": 1557111499, "episode_reward_mean": 983.0615421885278, "episodes_this_iter": 18, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1338557, "episode_reward_min": 53.605350731259456, "node_ip": "10.138.0.2", "time_total_s": 682.8475596904755, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-58-19", "episode_len_mean": 693.32, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba1d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abab38>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abaeb8>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41113, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.622344970703125, "timesteps_total": 1338557, "iterations_since_restore": 32, "training_iteration": 32, "policy_reward_mean": {}, "time_since_restore": 682.8475596904755}
{"info": {"num_steps_trained": 1379477, "load_time_ms": 11.906, "update_time_ms": 7.047, "grad_time_ms": 10009.452, "default": {"kl": 0.010486653074622154, "cur_lr": 0.0005000000237487257, "total_loss": 13.149513244628906, "entropy": 1.18051016330719, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 13.151094436645508, "policy_loss": -0.0021046020556241274, "vf_explained_var": 0.9034544229507446}, "sample_time_ms": 11208.007, "num_steps_sampled": 1379477}, "custom_metrics": {"cost1_min": 20.618728608917763, "system_level_velocity_min": 8.603808798621078, "outflow_rate_min": 450.8673327363517, "cost1_mean": 309.4982395473786, "cost2_max": 0.0, "cost2_mean": -0.06613220578985292, "cost2_min": -0.8469808253801833, "system_level_velocity_mean": 12.033680857057547, "outflow_rate_max": 1305.679150788332, "cost1_max": 441.78305602929765, "outflow_rate_mean": 1052.6553307884365, "system_level_velocity_max": 17.864884736073698}, "episodes_total": 517, "episode_reward_max": 1233.0601194641083, "timestamp": 1557111518, "episode_reward_mean": 976.3873758529695, "episodes_this_iter": 18, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1379477, "episode_reward_min": 53.605350731259456, "node_ip": "10.138.0.2", "time_total_s": 702.4538481235504, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-58-38", "episode_len_mean": 693.32, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aceef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aceba8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aceac8>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40920, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 19.60628843307495, "timesteps_total": 1379477, "iterations_since_restore": 33, "training_iteration": 33, "policy_reward_mean": {}, "time_since_restore": 702.4538481235504}
{"info": {"num_steps_trained": 1419177, "load_time_ms": 12.224, "update_time_ms": 6.968, "grad_time_ms": 9957.067, "default": {"kl": 0.010072018019855022, "cur_lr": 0.0005000000237487257, "total_loss": 14.114463806152344, "entropy": 1.1783581972122192, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 14.116235733032227, "policy_loss": -0.0022747432813048363, "vf_explained_var": 0.9162591695785522}, "sample_time_ms": 11154.199, "num_steps_sampled": 1419177}, "custom_metrics": {"cost1_min": 17.25443428741833, "system_level_velocity_min": 8.603808798621078, "outflow_rate_min": 450.8673327363517, "cost1_mean": 307.67247605120076, "cost2_max": 0.0, "cost2_mean": -0.08181486972858433, "cost2_min": -0.981814519132572, "system_level_velocity_mean": 12.31845149998974, "outflow_rate_max": 1305.679150788332, "cost1_max": 441.78305602929765, "outflow_rate_mean": 1051.1084247682936, "system_level_velocity_max": 18.60162887451327}, "episodes_total": 533, "episode_reward_max": 1233.0601194641083, "timestamp": 1557111539, "episode_reward_mean": 963.8863964763008, "episodes_this_iter": 16, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1419177, "episode_reward_min": 44.943757824765626, "node_ip": "10.138.0.2", "time_total_s": 723.1304450035095, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-58-59", "episode_len_mean": 679.97, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1f28>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1400>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 39700, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.676596879959106, "timesteps_total": 1419177, "iterations_since_restore": 34, "training_iteration": 34, "policy_reward_mean": {}, "time_since_restore": 723.1304450035095}
{"info": {"num_steps_trained": 1459641, "load_time_ms": 13.433, "update_time_ms": 7.194, "grad_time_ms": 9885.775, "default": {"kl": 0.01086522825062275, "cur_lr": 0.0005000000237487257, "total_loss": 13.755918502807617, "entropy": 1.1760954856872559, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 13.758684158325195, "policy_loss": -0.0033094321843236685, "vf_explained_var": 0.9142929315567017}, "sample_time_ms": 11173.169, "num_steps_sampled": 1459641}, "custom_metrics": {"cost1_min": 17.25443428741833, "system_level_velocity_min": 8.603808798621078, "outflow_rate_min": 450.8673327363517, "cost1_mean": 308.72578536038736, "cost2_max": 0.0, "cost2_mean": -0.07522936496463968, "cost2_min": -0.981814519132572, "system_level_velocity_mean": 12.373528985869036, "outflow_rate_max": 1329.479195379114, "cost1_max": 443.58390348180103, "outflow_rate_mean": 1053.8790897246488, "system_level_velocity_max": 18.60162887451327}, "episodes_total": 551, "episode_reward_max": 1233.0601194641083, "timestamp": 1557111561, "episode_reward_mean": 959.2671554480662, "episodes_this_iter": 18, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1459641, "episode_reward_min": 44.943757824765626, "node_ip": "10.138.0.2", "time_total_s": 744.6613571643829, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-59-21", "episode_len_mean": 679.97, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1b38>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac12e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1ef0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40464, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.530912160873413, "timesteps_total": 1459641, "iterations_since_restore": 35, "training_iteration": 35, "policy_reward_mean": {}, "time_since_restore": 744.6613571643829}
{"info": {"num_steps_trained": 1500464, "load_time_ms": 14.57, "update_time_ms": 7.065, "grad_time_ms": 9884.852, "default": {"kl": 0.01018128264695406, "cur_lr": 0.0005000000237487257, "total_loss": 11.837125778198242, "entropy": 1.1878221035003662, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 11.839539527893066, "policy_loss": -0.0029234227258712053, "vf_explained_var": 0.9156202673912048}, "sample_time_ms": 11151.068, "num_steps_sampled": 1500464}, "custom_metrics": {"cost1_min": 17.25443428741833, "system_level_velocity_min": 9.738231387392606, "outflow_rate_min": 450.8673327363517, "cost1_mean": 317.01029814194953, "cost2_max": 0.0, "cost2_mean": -0.08678791221249392, "cost2_min": -0.981814519132572, "system_level_velocity_mean": 12.686180501429995, "outflow_rate_max": 1329.479195379114, "cost1_max": 451.0479025536458, "outflow_rate_mean": 1070.1624820459654, "system_level_velocity_max": 18.60162887451327}, "episodes_total": 565, "episode_reward_max": 1233.0601194641083, "timestamp": 1557111582, "episode_reward_mean": 966.0083446442728, "episodes_this_iter": 14, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1500464, "episode_reward_min": 44.943757824765626, "node_ip": "10.138.0.2", "time_total_s": 765.8904905319214, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_02-59-42", "episode_len_mean": 679.97, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace2e8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8198>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40823, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.229133367538452, "timesteps_total": 1500464, "iterations_since_restore": 36, "training_iteration": 36, "policy_reward_mean": {}, "time_since_restore": 765.8904905319214}
{"info": {"num_steps_trained": 1540988, "load_time_ms": 15.495, "update_time_ms": 7.316, "grad_time_ms": 9879.754, "default": {"kl": 0.011999816633760929, "cur_lr": 0.0005000000237487257, "total_loss": 14.30960464477539, "entropy": 1.183007001876831, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 14.312530517578125, "policy_loss": -0.0035277933347970247, "vf_explained_var": 0.873684823513031}, "sample_time_ms": 11128.841, "num_steps_sampled": 1540988}, "custom_metrics": {"cost1_min": 17.25443428741833, "system_level_velocity_min": 9.529484591079028, "outflow_rate_min": 487.91441072641976, "cost1_mean": 317.2974112852996, "cost2_max": 0.0, "cost2_mean": -0.09757634421097532, "cost2_min": -0.981814519132572, "system_level_velocity_mean": 12.553281731196902, "outflow_rate_max": 1329.479195379114, "cost1_max": 451.0479025536458, "outflow_rate_mean": 1069.134341625088, "system_level_velocity_max": 18.60162887451327}, "episodes_total": 582, "episode_reward_max": 1233.0601194641083, "timestamp": 1557111603, "episode_reward_mean": 968.8157008635354, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1540988, "episode_reward_min": 44.943757824765626, "node_ip": "10.138.0.2", "time_total_s": 786.8730065822601, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-00-03", "episode_len_mean": 686.65, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8470>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8940>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8518>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40524, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.982516050338745, "timesteps_total": 1540988, "iterations_since_restore": 37, "training_iteration": 37, "policy_reward_mean": {}, "time_since_restore": 786.8730065822601}
{"info": {"num_steps_trained": 1581559, "load_time_ms": 16.115, "update_time_ms": 7.427, "grad_time_ms": 9871.911, "default": {"kl": 0.011654308997094631, "cur_lr": 0.0005000000237487257, "total_loss": 12.794154167175293, "entropy": 1.1819353103637695, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 12.796566009521484, "policy_loss": -0.0029946158174425364, "vf_explained_var": 0.908118724822998}, "sample_time_ms": 11099.118, "num_steps_sampled": 1581559}, "custom_metrics": {"cost1_min": 17.25443428741833, "system_level_velocity_min": 9.294887633511824, "outflow_rate_min": 487.91441072641976, "cost1_mean": 313.8832301964211, "cost2_max": 0.0, "cost2_mean": -0.08528579695853508, "cost2_min": -0.981814519132572, "system_level_velocity_mean": 12.435272284572372, "outflow_rate_max": 1329.479195379114, "cost1_max": 451.0479025536458, "outflow_rate_mean": 1064.0608038684836, "system_level_velocity_max": 18.60162887451327}, "episodes_total": 599, "episode_reward_max": 1212.1071914491476, "timestamp": 1557111624, "episode_reward_mean": 966.5531356839164, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1581559, "episode_reward_min": 44.943757824765626, "node_ip": "10.138.0.2", "time_total_s": 807.9615364074707, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-00-24", "episode_len_mean": 686.65, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac82e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac80f0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8cf8>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40571, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.08852982521057, "timesteps_total": 1581559, "iterations_since_restore": 38, "training_iteration": 38, "policy_reward_mean": {}, "time_since_restore": 807.9615364074707}
{"info": {"num_steps_trained": 1622625, "load_time_ms": 16.378, "update_time_ms": 7.192, "grad_time_ms": 9847.371, "default": {"kl": 0.011315478011965752, "cur_lr": 0.0005000000237487257, "total_loss": 14.044273376464844, "entropy": 1.1732059717178345, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 14.047246932983398, "policy_loss": -0.0035396136809140444, "vf_explained_var": 0.9044852256774902}, "sample_time_ms": 11117.15, "num_steps_sampled": 1622625}, "custom_metrics": {"cost1_min": 17.25443428741833, "system_level_velocity_min": 9.294887633511824, "outflow_rate_min": 487.91441072641976, "cost1_mean": 311.8214671154006, "cost2_max": 0.0, "cost2_mean": -0.08736871875944374, "cost2_min": -0.981814519132572, "system_level_velocity_mean": 12.547711503145809, "outflow_rate_max": 1329.479195379114, "cost1_max": 451.0479025536458, "outflow_rate_mean": 1059.6974773910101, "system_level_velocity_max": 18.804867720057945}, "episodes_total": 617, "episode_reward_max": 1212.1071914491476, "timestamp": 1557111645, "episode_reward_mean": 957.0834794858025, "episodes_this_iter": 18, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1622625, "episode_reward_min": 44.943757824765626, "node_ip": "10.138.0.2", "time_total_s": 829.1610455513, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-00-45", "episode_len_mean": 680.03, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac81d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8eb8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8748>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 41066, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.199509143829346, "timesteps_total": 1622625, "iterations_since_restore": 39, "training_iteration": 39, "policy_reward_mean": {}, "time_since_restore": 829.1610455513}
{"info": {"num_steps_trained": 1662554, "load_time_ms": 15.077, "update_time_ms": 6.993, "grad_time_ms": 9925.746, "default": {"kl": 0.010909002274274826, "cur_lr": 0.0005000000237487257, "total_loss": 16.52484703063965, "entropy": 1.1558064222335815, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 16.527788162231445, "policy_loss": -0.0034893916454166174, "vf_explained_var": 0.8891328573226929}, "sample_time_ms": 11131.038, "num_steps_sampled": 1662554}, "custom_metrics": {"cost1_min": 25.298548071296665, "system_level_velocity_min": 9.294887633511824, "outflow_rate_min": 508.1533572325594, "cost1_mean": 317.596912418213, "cost2_max": 0.0, "cost2_mean": -0.08041164899731512, "cost2_min": -0.734674366782545, "system_level_velocity_mean": 12.59780929634692, "outflow_rate_max": 1355.8536763932277, "cost1_max": 464.97062150748275, "outflow_rate_mean": 1069.2981690172514, "system_level_velocity_max": 18.804867720057945}, "episodes_total": 634, "episode_reward_max": 1259.1986945296267, "timestamp": 1557111668, "episode_reward_mean": 975.8758319032308, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1662554, "episode_reward_min": 57.86313820001401, "node_ip": "10.138.0.2", "time_total_s": 851.7411906719208, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-01-08", "episode_len_mean": 686.77, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace358>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ace080>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 39929, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 22.580145120620728, "timesteps_total": 1662554, "iterations_since_restore": 40, "training_iteration": 40, "policy_reward_mean": {}, "time_since_restore": 851.7411906719208}
{"info": {"num_steps_trained": 1703050, "load_time_ms": 15.538, "update_time_ms": 7.084, "grad_time_ms": 9952.603, "default": {"kl": 0.010023766197264194, "cur_lr": 0.0005000000237487257, "total_loss": 13.121101379394531, "entropy": 1.157202959060669, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 13.123268127441406, "policy_loss": -0.002667807275429368, "vf_explained_var": 0.9109089374542236}, "sample_time_ms": 11153.804, "num_steps_sampled": 1703050}, "custom_metrics": {"cost1_min": 23.703466818329865, "system_level_velocity_min": 9.294887633511824, "outflow_rate_min": 508.1533572325594, "cost1_mean": 311.80560196306806, "cost2_max": 0.0, "cost2_mean": -0.09010667954552233, "cost2_min": -0.8333333333333333, "system_level_velocity_mean": 12.564818019413613, "outflow_rate_max": 1355.8536763932277, "cost1_max": 464.97062150748275, "outflow_rate_mean": 1058.6374795050858, "system_level_velocity_max": 18.910892927794535}, "episodes_total": 651, "episode_reward_max": 1259.1986945296267, "timestamp": 1557111689, "episode_reward_mean": 964.159453070904, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1703050, "episode_reward_min": 57.86313820001401, "node_ip": "10.138.0.2", "time_total_s": 873.304612159729, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-01-29", "episode_len_mean": 680.13, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8cf8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8cc0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40496, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.563421487808228, "timesteps_total": 1703050, "iterations_since_restore": 41, "training_iteration": 41, "policy_reward_mean": {}, "time_since_restore": 873.304612159729}
{"info": {"num_steps_trained": 1743382, "load_time_ms": 15.681, "update_time_ms": 7.091, "grad_time_ms": 9957.758, "default": {"kl": 0.010280813090503216, "cur_lr": 0.0005000000237487257, "total_loss": 15.40820026397705, "entropy": 1.1543700695037842, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 15.411752700805664, "policy_loss": -0.004065969958901405, "vf_explained_var": 0.9267595410346985}, "sample_time_ms": 11193.554, "num_steps_sampled": 1743382}, "custom_metrics": {"cost1_min": 23.703466818329865, "system_level_velocity_min": 9.294887633511824, "outflow_rate_min": 508.1533572325594, "cost1_mean": 308.73760855979856, "cost2_max": 0.0, "cost2_mean": -0.09251539367299917, "cost2_min": -0.8333333333333333, "system_level_velocity_mean": 12.508017077821473, "outflow_rate_max": 1355.8536763932277, "cost1_max": 464.97062150748275, "outflow_rate_mean": 1053.6241530072625, "system_level_velocity_max": 18.910892927794535}, "episodes_total": 668, "episode_reward_max": 1259.1986945296267, "timestamp": 1557111711, "episode_reward_mean": 959.9333406495363, "episodes_this_iter": 17, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1743382, "episode_reward_min": 57.86313820001401, "node_ip": "10.138.0.2", "time_total_s": 895.3822813034058, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-01-51", "episode_len_mean": 678.76, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac81d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8748>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac84e0>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40332, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 22.077669143676758, "timesteps_total": 1743382, "iterations_since_restore": 42, "training_iteration": 42, "policy_reward_mean": {}, "time_since_restore": 895.3822813034058}
{"info": {"num_steps_trained": 1783347, "load_time_ms": 16.067, "update_time_ms": 7.161, "grad_time_ms": 10101.227, "default": {"kl": 0.010532677173614502, "cur_lr": 0.0005000000237487257, "total_loss": 15.30582046508789, "entropy": 1.162210464477539, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 15.308815956115723, "policy_loss": -0.0035219741985201836, "vf_explained_var": 0.9140304327011108}, "sample_time_ms": 11240.227, "num_steps_sampled": 1783347}, "custom_metrics": {"cost1_min": 16.20900967693933, "system_level_velocity_min": 9.5524023787998, "outflow_rate_min": 484.32039793061296, "cost1_mean": 313.42381443131063, "cost2_max": 0.0, "cost2_mean": -0.09216382518543836, "cost2_min": -0.8333333333333333, "system_level_velocity_mean": 12.866350498203744, "outflow_rate_max": 1358.9763707439881, "cost1_max": 464.97062150748275, "outflow_rate_mean": 1067.7822823788797, "system_level_velocity_max": 18.910892927794535}, "episodes_total": 686, "episode_reward_max": 1312.6504663990154, "timestamp": 1557111733, "episode_reward_mean": 964.5898388903712, "episodes_this_iter": 18, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1783347, "episode_reward_min": 44.600185196878584, "node_ip": "10.138.0.2", "time_total_s": 916.8936429023743, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-02-13", "episode_len_mean": 672.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3abab70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba1d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3aba390>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 39965, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.511361598968506, "timesteps_total": 1783347, "iterations_since_restore": 43, "training_iteration": 43, "policy_reward_mean": {}, "time_since_restore": 916.8936429023743}
{"info": {"num_steps_trained": 1824310, "load_time_ms": 16.136, "update_time_ms": 7.226, "grad_time_ms": 9990.107, "default": {"kl": 0.013519617728888988, "cur_lr": 0.0005000000237487257, "total_loss": 16.12383460998535, "entropy": 1.1866108179092407, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 16.127521514892578, "policy_loss": -0.0043641868978738785, "vf_explained_var": 0.8960843086242676}, "sample_time_ms": 11296.347, "num_steps_sampled": 1824310}, "custom_metrics": {"cost1_min": 16.20900967693933, "system_level_velocity_min": 9.708228686720684, "outflow_rate_min": 484.32039793061296, "cost1_mean": 318.0529894030092, "cost2_max": 0.0, "cost2_mean": -0.10543297501810692, "cost2_min": -0.8333333333333333, "system_level_velocity_mean": 13.053336215960366, "outflow_rate_max": 1358.9763707439881, "cost1_max": 464.97062150748275, "outflow_rate_mean": 1078.4235582709275, "system_level_velocity_max": 18.910892927794535}, "episodes_total": 704, "episode_reward_max": 1312.6504663990154, "timestamp": 1557111753, "episode_reward_mean": 968.1798725804895, "episodes_this_iter": 18, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1824310, "episode_reward_min": 44.600185196878584, "node_ip": "10.138.0.2", "time_total_s": 937.0157616138458, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-02-33", "episode_len_mean": 672.0, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8780>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8c18>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40963, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.122118711471558, "timesteps_total": 1824310, "iterations_since_restore": 44, "training_iteration": 44, "policy_reward_mean": {}, "time_since_restore": 937.0157616138458}
{"info": {"num_steps_trained": 1865086, "load_time_ms": 14.545, "update_time_ms": 7.163, "grad_time_ms": 9979.642, "default": {"kl": 0.01025310717523098, "cur_lr": 0.0005000000237487257, "total_loss": 11.503707885742188, "entropy": 1.18995201587677, "cur_kl_coeff": 0.050000011920928955, "vf_loss": 11.507502555847168, "policy_loss": -0.00430665910243988, "vf_explained_var": 0.9245941638946533}, "sample_time_ms": 11251.16, "num_steps_sampled": 1865086}, "custom_metrics": {"cost1_min": 16.20900967693933, "system_level_velocity_min": 9.586989625993818, "outflow_rate_min": 484.32039793061296, "cost1_mean": 321.30803851261027, "cost2_max": 0.0, "cost2_mean": -0.10606300903131188, "cost2_min": -0.8333333333333333, "system_level_velocity_mean": 13.005373790174504, "outflow_rate_max": 1358.9763707439881, "cost1_max": 464.97062150748275, "outflow_rate_mean": 1084.492068583925, "system_level_velocity_max": 18.910892927794535}, "episodes_total": 716, "episode_reward_max": 1312.6504663990154, "timestamp": 1557111774, "episode_reward_mean": 977.4775097717287, "episodes_this_iter": 12, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1865086, "episode_reward_min": 44.600185196878584, "node_ip": "10.138.0.2", "time_total_s": 957.9649693965912, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-02-54", "episode_len_mean": 678.62, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac82b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac81d0>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8588>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40776, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 20.94920778274536, "timesteps_total": 1865086, "iterations_since_restore": 45, "training_iteration": 45, "policy_reward_mean": {}, "time_since_restore": 957.9649693965912}
{"info": {"num_steps_trained": 1904483, "load_time_ms": 15.005, "update_time_ms": 7.161, "grad_time_ms": 9966.543, "default": {"kl": 0.01162541564553976, "cur_lr": 0.0005000000237487257, "total_loss": 15.617486953735352, "entropy": 1.1536165475845337, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 15.620381355285645, "policy_loss": -0.0034777140244841576, "vf_explained_var": 0.9302715063095093}, "sample_time_ms": 11355.47, "num_steps_sampled": 1904483}, "custom_metrics": {"cost1_min": 16.20900967693933, "system_level_velocity_min": 8.82061554663214, "outflow_rate_min": 484.32039793061296, "cost1_mean": 323.4910137339513, "cost2_max": 0.0, "cost2_mean": -0.1107075570369917, "cost2_min": -0.8333333333333333, "system_level_velocity_mean": 12.926539123626329, "outflow_rate_max": 1358.9763707439881, "cost1_max": 478.4482966329677, "outflow_rate_mean": 1086.9570762173544, "system_level_velocity_max": 18.910892927794535}, "episodes_total": 732, "episode_reward_max": 1312.6504663990154, "timestamp": 1557111796, "episode_reward_mean": 981.5247290935672, "episodes_this_iter": 16, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1904483, "episode_reward_min": 44.600185196878584, "node_ip": "10.138.0.2", "time_total_s": 980.1138300895691, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-03-16", "episode_len_mean": 685.23, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac1978>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f4531198>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 39397, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 22.148860692977905, "timesteps_total": 1904483, "iterations_since_restore": 46, "training_iteration": 46, "policy_reward_mean": {}, "time_since_restore": 980.1138300895691}
{"info": {"num_steps_trained": 1944540, "load_time_ms": 16.003, "update_time_ms": 7.084, "grad_time_ms": 9971.91, "default": {"kl": 0.012446172535419464, "cur_lr": 0.0005000000237487257, "total_loss": 19.78812026977539, "entropy": 1.1560547351837158, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 19.792259216308594, "policy_loss": -0.0047628991305828094, "vf_explained_var": 0.8880462646484375}, "sample_time_ms": 11395.007, "num_steps_sampled": 1944540}, "custom_metrics": {"cost1_min": 16.20900967693933, "system_level_velocity_min": 8.82061554663214, "outflow_rate_min": 484.32039793061296, "cost1_mean": 332.9265024076041, "cost2_max": 0.0, "cost2_mean": -0.11363390287131483, "cost2_min": -0.737149583011977, "system_level_velocity_mean": 13.271774024116725, "outflow_rate_max": 1358.9763707439881, "cost1_max": 492.98794607868126, "outflow_rate_mean": 1104.055835202108, "system_level_velocity_max": 19.035064383247402}, "episodes_total": 753, "episode_reward_max": 1312.6504663990154, "timestamp": 1557111818, "episode_reward_mean": 992.2170631902871, "episodes_this_iter": 21, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1944540, "episode_reward_min": 44.600185196878584, "node_ip": "10.138.0.2", "time_total_s": 1001.5523548126221, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-03-38", "episode_len_mean": 685.81, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8ac8>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac84a8>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40057, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.43852472305298, "timesteps_total": 1944540, "iterations_since_restore": 47, "training_iteration": 47, "policy_reward_mean": {}, "time_since_restore": 1001.5523548126221}
{"info": {"num_steps_trained": 1984171, "load_time_ms": 16.212, "update_time_ms": 7.089, "grad_time_ms": 9989.556, "default": {"kl": 0.01193985901772976, "cur_lr": 0.0005000000237487257, "total_loss": 15.350058555603027, "entropy": 1.1609749794006348, "cur_kl_coeff": 0.05000000819563866, "vf_loss": 15.353536605834961, "policy_loss": -0.00407477468252182, "vf_explained_var": 0.9128108024597168}, "sample_time_ms": 11414.884, "num_steps_sampled": 1984171}, "custom_metrics": {"cost1_min": 16.20900967693933, "system_level_velocity_min": 8.82061554663214, "outflow_rate_min": 484.32039793061296, "cost1_mean": 331.78899230577963, "cost2_max": 0.0, "cost2_mean": -0.111449183854246, "cost2_min": -0.737149583011977, "system_level_velocity_mean": 13.205483779296383, "outflow_rate_max": 1358.9763707439881, "cost1_max": 492.98794607868126, "outflow_rate_mean": 1099.2732543006596, "system_level_velocity_max": 19.035064383247402}, "episodes_total": 769, "episode_reward_max": 1312.6504663990154, "timestamp": 1557111839, "episode_reward_mean": 992.8360811450908, "episodes_this_iter": 16, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 1984171, "episode_reward_min": 44.600185196878584, "node_ip": "10.138.0.2", "time_total_s": 1023.0125851631165, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-03-59", "episode_len_mean": 687.18, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f453f978>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8588>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 39631, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 21.460230350494385, "timesteps_total": 1984171, "iterations_since_restore": 48, "training_iteration": 48, "policy_reward_mean": {}, "time_since_restore": 1023.0125851631165}
{"info": {"num_steps_trained": 2024525, "load_time_ms": 15.926, "update_time_ms": 7.146, "grad_time_ms": 10002.678, "default": {"kl": 0.01516482513397932, "cur_lr": 0.0005000000237487257, "total_loss": 14.687765121459961, "entropy": 1.2089636325836182, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 14.692767143249512, "policy_loss": -0.005760911852121353, "vf_explained_var": 0.9085701107978821}, "sample_time_ms": 11487.888, "num_steps_sampled": 2024525}, "custom_metrics": {"cost1_min": 64.92042750125862, "system_level_velocity_min": 8.82061554663214, "outflow_rate_min": 689.3862323169797, "cost1_mean": 333.70989512684514, "cost2_max": 0.0, "cost2_mean": -0.10393968833267218, "cost2_min": -0.5231095525355639, "system_level_velocity_mean": 13.112634193187194, "outflow_rate_max": 1358.3736632593802, "cost1_max": 492.98794607868126, "outflow_rate_mean": 1099.9860187718955, "system_level_velocity_max": 19.035064383247402}, "episodes_total": 787, "episode_reward_max": 1190.8849274921363, "timestamp": 1557111861, "episode_reward_mean": 993.4188017782709, "episodes_this_iter": 18, "num_metric_batches_dropped": 0, "done": false, "timesteps_since_restore": 2024525, "episode_reward_min": 164.5975892540265, "node_ip": "10.138.0.2", "time_total_s": 1045.0726873874664, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-04-21", "episode_len_mean": 693.94, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8f98>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8908>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 40354, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 22.060102224349976, "timesteps_total": 2024525, "iterations_since_restore": 49, "training_iteration": 49, "policy_reward_mean": {}, "time_since_restore": 1045.0726873874664}
{"info": {"num_steps_trained": 2063603, "load_time_ms": 15.941, "update_time_ms": 7.209, "grad_time_ms": 9874.034, "default": {"kl": 0.010910358279943466, "cur_lr": 0.0005000000237487257, "total_loss": 22.314228057861328, "entropy": 1.1871737241744995, "cur_kl_coeff": 0.05000000447034836, "vf_loss": 22.317493438720703, "policy_loss": -0.0038096357602626085, "vf_explained_var": 0.8941141963005066}, "sample_time_ms": 11567.344, "num_steps_sampled": 2063603}, "custom_metrics": {"cost1_min": 11.069468354373837, "system_level_velocity_min": 8.82061554663214, "outflow_rate_min": 422.76980754305276, "cost1_mean": 325.65951823617894, "cost2_max": 0.0, "cost2_mean": -0.1016362492024091, "cost2_min": -0.5231095525355639, "system_level_velocity_mean": 13.295530989543881, "outflow_rate_max": 1358.3736632593802, "cost1_max": 492.98794607868126, "outflow_rate_mean": 1084.7985437354662, "system_level_velocity_max": 19.125460072576857}, "episodes_total": 807, "episode_reward_max": 1190.8849274921363, "timestamp": 1557111883, "episode_reward_mean": 962.2562616791952, "episodes_this_iter": 20, "num_metric_batches_dropped": 0, "done": true, "timesteps_since_restore": 2063603, "episode_reward_min": 22.81149153541703, "node_ip": "10.138.0.2", "time_total_s": 1067.168612241745, "experiment_id": "a6e56feae7534b3dbed47d87a0699862", "date": "2019-05-06_03-04-43", "episode_len_mean": 674.92, "config": {"use_gae": true, "input": "sampler", "train_batch_size": 30000, "num_cpus_for_driver": 1, "sgd_minibatch_size": 128, "monitor": false, "lr": 0.0005, "straggler_mitigation": false, "clip_param": 0.3, "model": {"zero_mean": true, "squash_to_range": false, "custom_model": null, "fcnet_activation": "tanh", "max_seq_len": 20, "lstm_cell_size": 256, "grayscale": false, "custom_preprocessor": null, "free_log_std": false, "lstm_use_prev_action_reward": false, "conv_activation": "relu", "channel_major": false, "custom_options": {}, "framestack": true, "use_lstm": false, "conv_filters": null, "dim": 84, "fcnet_hiddens": [100, 50, 25]}, "batch_mode": "truncate_episodes", "lambda": 0.97, "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0bottom_[eta1, eta2, eta3]:[1.0, 0.1, 0.1]_t_min:1.0", "output_max_file_size": 67108864, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "kl_coeff": 0.2, "clip_actions": false, "preprocessor_pref": "deepmind", "num_envs_per_worker": 1, "num_gpus": 0, "log_level": "INFO", "sample_batch_size": 200, "compress_observations": false, "sample_async": false, "clip_rewards": null, "lr_schedule": null, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "optimizer": {}, "observation_filter": "NoFilter", "custom_resources_per_worker": {}, "synchronize_filters": true, "simple_optimizer": false, "num_sgd_iter": 10, "gamma": 0.99, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "num_workers": 20, "output": null, "vf_clip_param": 1000000.0, "input_evaluation": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "callbacks": {"on_sample_end": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac8080>", "on_train_result": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f07f3ac84a8>"}, "vf_share_layers": false, "entropy_coeff": 0.0, "collect_metrics_timeout": 180, "kl_target": 0.01, "tf_session_args": {"inter_op_parallelism_threads": 2, "allow_soft_placement": true, "intra_op_parallelism_threads": 2, "device_count": {"CPU": 1}, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "horizon": 1500}, "timesteps_this_iter": 39078, "hostname": "flow-main", "pid": 13225, "time_this_iter_s": 22.095924854278564, "timesteps_total": 2063603, "iterations_since_restore": 50, "training_iteration": 50, "policy_reward_mean": {}, "time_since_restore": 1067.168612241745}
